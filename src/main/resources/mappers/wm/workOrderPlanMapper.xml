<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  	
<mapper namespace="mes.mappers.wm.workOrderPlanMapper">
	<resultMap id="WorkOrderPlanVo" type="mes.domain.wm.WorkOrderPlanVo">
		<result property="equipCd"			column="EQUIP_CD"		/>
		<result property="equipNm"			column="EQUIP_NM"		/>
		<result property="goodsCd"			column="GOODS_CD"		/>
		<result property="goodsNm"			column="GOODS_NM"		/>
		<result property="workGubunCd"		column="WORK_GUBUN_CD"	/>
		<result property="workGubunNm"		column="WORK_GUBUN_NM"	/>
		<result property="planRegDate"		column="PLAN_REG_DATE"	/>
		<result property="regId"			column="REG_ID"			/>
		<result property="regDate"			column="REG_DATE"		/>
		<result property="updId"			column="UPD_ID"			/>
		<result property="updDate"			column="UPD_DATE"		/>
		<result property="equipCondSeq"		column="EQUIP_COND_SEQ"	/>
		
		<result property="model"			column="MODEL"			/>
		<result property="modelNo"			column="MODEL_NO"		/>
		<result property="qutyCd"			column="QUTY_CD"		/>
		<result property="qutyNm"			column="QUTY_NM"		/>
		<result property="chamferYnNm"		column="CHAMFER_YN_NM"	/>
		<result property="surfaceTrtmtCd"	column="SURFACE_TRTMT_CD"/>
		<result property="surfaceTrtmtNm"	column="SURFACE_TRTMT_NM"/>
		<result property="alnicuMatrlCd"	column="ALNICU_MATRL_CD"/>
		<result property="alnicuMatrlNm"	column="ALNICU_MATRL_NM"/>
		<result property="filmMatrlCd"		column="FILM_MATRL_CD"	/>
		<result property="filmMatrlNm"		column="FILM_MATRL_NM"	/>
		<result property="dealCorpCd"		column="DEAL_CORP_CD"	/>
		<result property="dealCorpNm"		column="DEAL_CORP_NM"	/>
	</resultMap>
	
	<resultMap id="ProductionPlanVo" type="mes.domain.wm.ProductionPlanVo">
		<result property="equipLineCd"   column="EQUIP_LINE_CD" />
		<result property="equipLineNm"   column="EQUIP_LINE_NM" />
		<result property="equipCd"       column="EQUIP_CD" />
		<result property="equipNm"       column="EQUIP_NM" />
		<result property="planDate"      column="PLAN_DATE" />
		<result property="countTypeCd"   column="COUNT_TYPE_CD" />
		<result property="countTypeNm"   column="COUNT_TYPE_NM" />
		<result property="countSum"      column="COUNT_SUM" />
		<result property="count1"        column="COUNT1" />
		<result property="count2"        column="COUNT2" />
		<result property="count3"        column="COUNT3" />
		<result property="count4"        column="COUNT4" />
		<result property="count5"        column="COUNT5" />
		<result property="count6"        column="COUNT6" />
		<result property="count7"        column="COUNT7" />
		<result property="count8"        column="COUNT8" />
		<result property="count9"        column="COUNT9" />
		<result property="count10"       column="COUNT10" />
		<result property="count11"       column="COUNT11" />
		<result property="count12"       column="COUNT12" />
		<result property="count13"       column="COUNT13" />
		<result property="count14"       column="COUNT14" />
		<result property="count15"       column="COUNT15" />
		<result property="count16"       column="COUNT16" />
		<result property="count17"       column="COUNT17" />
		<result property="count18"       column="COUNT18" />
		<result property="count19"       column="COUNT19" />
		<result property="count20"       column="COUNT20" />
		<result property="count21"       column="COUNT21" />
		<result property="count22"       column="COUNT22" />
		<result property="count23"       column="COUNT23" />
		<result property="count24"       column="COUNT24" />
		<result property="count25"       column="COUNT25" />
		<result property="count26"       column="COUNT26" />
		<result property="count27"       column="COUNT27" />
		<result property="count28"       column="COUNT28" />
		<result property="count29"       column="COUNT29" />
		<result property="count30"       column="COUNT30" />
		<result property="count31"       column="COUNT31" />
		<result property="regId"         column="REG_ID" />
		<result property="regDate"       column="REG_DATE" />
		<result property="updId"         column="UPD_ID" />
		<result property="updDate"       column="UPD_DATE" />
	</resultMap>
	
	<resultMap id="MonthProductPresentVo" type="mes.domain.wm.MonthProductPresentVo">
		<result property="equipLineCd"   column="EQUIP_LINE_CD" />
		<result property="equipLineNm"   column="EQUIP_LINE_NM" />
		<result property="equipCd"       column="EQUIP_CD" />
		<result property="equipNm"       column="EQUIP_NM" />
		<result property="goodsCd"       column="GOODS_CD" />
		<result property="goodsNm"       column="GOODS_NM" />
		<result property="qutyCd"        column="QUTY_CD" />
		<result property="qutyNm"        column="QUTY_NM" />
		<result property="gubun"        column="GUBUN" />
		<result property="planDate"      column="PLAN_DATE" />
		<result property="countSum"      column="COUNT_SUM" />
		<result property="count1"        column="COUNT1" />
		<result property="count2"        column="COUNT2" />
		<result property="count3"        column="COUNT3" />
		<result property="count4"        column="COUNT4" />
		<result property="count5"        column="COUNT5" />
		<result property="count6"        column="COUNT6" />
		<result property="count7"        column="COUNT7" />
		<result property="count8"        column="COUNT8" />
		<result property="count9"        column="COUNT9" />
		<result property="count10"       column="COUNT10" />
		<result property="count11"       column="COUNT11" />
		<result property="count12"       column="COUNT12" />
		<result property="count13"       column="COUNT13" />
		<result property="count14"       column="COUNT14" />
		<result property="count15"       column="COUNT15" />
		<result property="count16"       column="COUNT16" />
		<result property="count17"       column="COUNT17" />
		<result property="count18"       column="COUNT18" />
		<result property="count19"       column="COUNT19" />
		<result property="count20"       column="COUNT20" />
		<result property="count21"       column="COUNT21" />
		<result property="count22"       column="COUNT22" />
		<result property="count23"       column="COUNT23" />
		<result property="count24"       column="COUNT24" />
		<result property="count25"       column="COUNT25" />
		<result property="count26"       column="COUNT26" />
		<result property="count27"       column="COUNT27" />
		<result property="count28"       column="COUNT28" />
		<result property="count29"       column="COUNT29" />
		<result property="count30"       column="COUNT30" />
		<result property="count31"       column="COUNT31" />
		<result property="regId"         column="REG_ID" />
		<result property="regDate"       column="REG_DATE" />
		<result property="updId"         column="UPD_ID" />
		<result property="updDate"       column="UPD_DATE" />
		<result property="memo"      	 column="MEMO" 		/>
	</resultMap>

	<!-- 선택 제조조건 조회 -->
	<select id="readWorkOrderPlan" resultMap="WorkOrderPlanVo">
		<![CDATA[
			SELECT
				A.EQUIP_CD
				, B.EQUIP_NM
				, A.GOODS_CD
				, C.GOODS_NM
				, C.MODEL
				, C.DEAL_CORP_CD
				, (SELECT DEAL_CORP_NM FROM TB_DEAL_CORP_ADM B WHERE B.DEAL_CORP_CD = C.DEAL_CORP_CD) AS DEAL_CORP_NM
				, D.MATRL_CD ALNICU_MATRL_CD
				, E.MATRL_CD FILM_MATRL_CD
				, D.QUTY_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='007' AND B.BASE_CD = D.QUTY_CD) QUTY_NM
				, D.SURFACE_TRTMT_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='021' AND B.BASE_CD = D.SURFACE_TRTMT_CD) SURFACE_TRTMT_NM
				, A.WORK_GUBUN_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='028' AND B.BASE_CD = A.WORK_GUBUN_CD) WORK_GUBUN_NM
				, A.PLAN_REG_DATE
				, A.EQUIP_COND_SEQ
				, A.REG_ID
				, A.REG_DATE
				, A.UPD_ID
				, A.UPD_DATE
			FROM TB_WORK_ORDER_PLAN A, TB_EQUIP_CODE_ADM B, TB_GOODS_CODE_ADM C, TB_MATRL_CODE_ADM D, TB_MATRL_CODE_ADM E
			WHERE A.EQUIP_CD = B.EQUIP_CD
			AND A.GOODS_CD = C.GOODS_CD
			AND C.ALNICU_MATRL_CD = D.MATRL_CD
			AND C.FILM_MATRL_CD = E.MATRL_CD
			AND A.EQUIP_COND_SEQ = #{equipCondSeq}
			AND A.EQUIP_CD = #{equipCd}
			AND PLAN_REG_DATE = #{planRegDate}
			AND WORK_GUBUN_CD = #{workGubunCd}
		]]>
	</select>
	
	<!-- 해당설비 & 날짜 작업지시 조회 -->
	<select id="searchDay" resultMap="WorkOrderPlanVo">
		<![CDATA[
		SELECT
            A.EQUIP_CD
            , A.GOODS_CD
            , C.GOODS_NM
            , A.WORK_GUBUN_CD
            , A.PLAN_REG_DATE
            , A.REG_ID
            , A.REG_DATE
            , A.UPD_ID
            , A.UPD_DATE
            , A.EQUIP_COND_SEQ
            , C.MODEL
            , C.MODEL_NO
            , D.QUTY_CD
            , (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='007' AND B.BASE_CD = D.QUTY_CD) QUTY_NM
            , (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='020' AND B.BASE_CD = D.CHAMFER_YN_CD) CHAMFER_YN_NM
            , D.SURFACE_TRTMT_CD
            , ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE D WHERE D.BASE_GROUP_CD='021' AND D.BASE_CD = SURFACE_TRTMT_CD),'') SURFACE_TRTMT_NM
         FROM
            TB_WORK_ORDER_PLAN A,
            TB_GOODS_CODE_ADM C,
            TB_MATRL_CODE_ADM D
         WHERE 1=1
            AND   A.EQUIP_CD = #{equipCd}
            AND  A.GOODS_CD = C.GOODS_CD
            AND  C.ALNICU_MATRL_CD = D.MATRL_CD
            AND  A.PLAN_REG_DATE = #{planRegDate}
            AND  A.WORK_GUBUN_CD = 'D'
		]]>
	</select>
	
	<!-- 해당설비 & 날짜 작업지시 조회 -->
	<select id="searchNight" resultMap="WorkOrderPlanVo">
		<![CDATA[
		SELECT
            A.EQUIP_CD
            , A.GOODS_CD
            , C.GOODS_NM
            , A.WORK_GUBUN_CD
            , A.PLAN_REG_DATE
            , A.REG_ID
            , A.REG_DATE
            , A.UPD_ID
            , A.UPD_DATE
            , A.EQUIP_COND_SEQ
            , C.MODEL
            , C.MODEL_NO
            , D.QUTY_CD
            , (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='007' AND B.BASE_CD = D.QUTY_CD) QUTY_NM
            , (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='020' AND B.BASE_CD = D.CHAMFER_YN_CD) CHAMFER_YN_NM
            , D.SURFACE_TRTMT_CD
            , ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE D WHERE D.BASE_GROUP_CD='021' AND D.BASE_CD = SURFACE_TRTMT_CD),'') SURFACE_TRTMT_NM
         FROM
            TB_WORK_ORDER_PLAN A,
            TB_GOODS_CODE_ADM C,
            TB_MATRL_CODE_ADM D
         WHERE 1=1
            AND   A.EQUIP_CD = #{equipCd}
            AND  A.GOODS_CD = C.GOODS_CD
            AND  C.ALNICU_MATRL_CD = D.MATRL_CD
            AND  A.PLAN_REG_DATE = #{planRegDate}
            AND  A.WORK_GUBUN_CD = 'N'
		]]>
	</select>
	
	<!-- 해당설비 & 날짜 작업지시 생성 -->
	<insert id="create" parameterType="mes.domain.wm.WorkOrderPlanVo">
		<![CDATA[
			INSERT INTO TB_WORK_ORDER_PLAN (
				EQUIP_CD
				, GOODS_CD
				, WORK_GUBUN_CD
				, PLAN_REG_DATE
				, REG_ID
				, REG_DATE
				, EQUIP_COND_SEQ
				) 
			VALUES(
				#{equipCd}
				, #{goodsCd}
				, #{workGubunCd}
				, #{planRegDate}
				, #{regId}
				, getDate()
				, #{equipCondSeq}
			)
		]]>
	</insert>

	<!-- 시간 수정 -->
	<update id="update">
		<![CDATA[
			UPDATE	TB_WORK_ORDER_PLAN		 
			SET
				EQUIP_CD = #{equipCd}
				, GOODS_CD = #{goodsCd}
				, WORK_GUBUN_CD = #{workGubunCd}
				, PLAN_REG_DATE = #{planRegDate}
				, UPD_ID = #{updId}
				, UPD_DATE = getDate()
				, EQUIP_COND_SEQ = #{equipCondSeq}
			WHERE
				EQUIP_CD = #{equipCd}
			AND
				PLAN_REG_DATE = #{planRegDate}
			AND
				WORK_GUBUN_CD = #{workGubunCd}
		]]>
	</update>
	
	<!-- 해당날짜의 모든 설비 최근 제조조건 자동등록-->
	<insert id="workPlanAutoCreate">
		<![CDATA[
			INSERT INTO		TB_WORK_ORDER_PLAN
			SELECT
				DISTINCT A.EQUIP_CD,
				A.GOODS_CD,
				A.WORK_GUBUN_CD,
				#{planRegDate} PLAN_REG_DATE,
				A.EQUIP_COND_SEQ,
				#{regId} REG_ID,
				getDate() REG_DATE,
				'' UPD_ID,
				'' UPD_DATE
			FROM TB_WORK_ORDER_PLAN A,
				( SELECT
					EQUIP_CD, 
					max(PLAN_REG_DATE) PLAN_REG_DATE
					FROM TB_WORK_ORDER_PLAN
					WHERE PLAN_REG_DATE < #{planRegDate}
					GROUP BY EQUIP_CD
				) B,
				TB_GOODS_CODE_ADM C
			WHERE A.EQUIP_CD = B.EQUIP_CD
			AND A.PLAN_REG_DATE = B.PLAN_REG_DATE
			AND A.GOODS_CD = C.GOODS_CD
		]]>
	</insert>
	
	<!-- 해당날짜의 모든 설비 최근 제조조건 자동등록 삭제-->
	<delete id="workPlanAutoDelete">
		<![CDATA[
			DELETE	TB_WORK_ORDER_PLAN
			WHERE EXISTS (
				SELECT 1	FROM
				(	SELECT EQUIP_CD, 
				 	#{planRegDate} PLAN_REG_DATE
					FROM TB_WORK_ORDER_PLAN
					WHERE PLAN_REG_DATE < #{planRegDate}
					GROUP BY EQUIP_CD) B
				WHERE B.EQUIP_CD = TB_WORK_ORDER_PLAN.EQUIP_CD
				AND B.PLAN_REG_DATE = TB_WORK_ORDER_PLAN.PLAN_REG_DATE 
				AND TB_WORK_ORDER_PLAN.PLAN_REG_DATE = #{planRegDate})
			AND TB_WORK_ORDER_PLAN.PLAN_REG_DATE = #{planRegDate}
		]]>
	</delete>
	
	
	<!-- 사용자 선택 날짜의 작지계획 생성-->
	<insert id="chooseWorkPlanAutoCreate">
		<![CDATA[
			DECLARE @StartDate VARCHAR(8);
			DECLARE @EndDate VARCHAR(8);
			SET @StartDate = #{chooseDateTo}
			SET @EndDate = #{chooseDateFuture}
			
			WHILE @StartDate <= @EndDate
			BEGIN
				INSERT INTO	TB_WORK_ORDER_PLAN
				SELECT
					DISTINCT A.EQUIP_CD,
					A.GOODS_CD,
					A.WORK_GUBUN_CD,
					@StartDate PLAN_REG_DATE,
					A.EQUIP_COND_SEQ,
					#{regId} REG_ID,
					getDate() REG_DATE,
					'' UPD_ID,
					'' UPD_DATE
				FROM TB_WORK_ORDER_PLAN A,
					(SELECT
						EQUIP_CD, 
						MAX(PLAN_REG_DATE) PLAN_REG_DATE
						FROM TB_WORK_ORDER_PLAN
						WHERE PLAN_REG_DATE < @StartDate
						GROUP BY EQUIP_CD
					) B,
					TB_GOODS_CODE_ADM C
				WHERE A.EQUIP_CD = B.EQUIP_CD
				AND A.PLAN_REG_DATE = B.PLAN_REG_DATE
				AND A.GOODS_CD = C.GOODS_CD
			
			    SET @StartDate = CONVERT(CHAR(8), DATEADD(DAY, 1, @StartDate), 112) 
			END
		]]>
	</insert>
	
	<!-- 사용자 선택 날짜의 작지계획 존재시 삭제 -->
	<delete id="chooseWorkPlanAutoDelete">
		<![CDATA[
			DECLARE @StartDate VARCHAR(8);
			DECLARE @EndDate VARCHAR(8);
			SET @StartDate = #{chooseDateTo}
			SET @EndDate = #{chooseDateFuture}
			
			WHILE @StartDate <= @EndDate
			BEGIN
				DELETE	TB_WORK_ORDER_PLAN
				WHERE EXISTS (
					SELECT 1	FROM
					(	SELECT EQUIP_CD, 
						@StartDate PLAN_REG_DATE
						FROM TB_WORK_ORDER_PLAN
						WHERE PLAN_REG_DATE < @StartDate
						GROUP BY EQUIP_CD) B
					WHERE B.EQUIP_CD = TB_WORK_ORDER_PLAN.EQUIP_CD
					AND B.PLAN_REG_DATE = TB_WORK_ORDER_PLAN.PLAN_REG_DATE 
					AND TB_WORK_ORDER_PLAN.PLAN_REG_DATE = @StartDate)
				AND TB_WORK_ORDER_PLAN.PLAN_REG_DATE = @StartDate
						
			    SET @StartDate = CONVERT(CHAR(8), DATEADD(DAY, 1, @StartDate), 112) 
			END
		]]>
	</delete>
	
	<select id="readProductionPlanNew" resultType="HashMap" parameterType="mes.domain.wm.ProductionPlanVo" >
			   SELECT * FROM
		   (SELECT
	
				 B.EQUIP_CD
				, B.EQUIP_NM
				, A.PLAN_DATE
				, A.COUNT_TYPE_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = A.COUNT_TYPE_CD) COUNT_TYPE_NM
				, A.CNT
			FROM	 TB_EQUIP_CODE_ADM B, TB_PRODUCTION_PLAN_NEW A			 
			WHERE 1=1	
			AND B.USE_YN_CD = '001'
			AND B.ETC1 = ''
			AND A.EQUIP_CD = B.EQUIP_CD
			AND LEFT(PLAN_DATE,6) = #{planDate}) A
		PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList})) as pivot_reslut

		UNION ALL

		 SELECT * FROM
		   (SELECT
		
			 B.EQUIP_CD
			, B.EQUIP_NM
			, '' PLAN_DATE
			, '001' COUNT_TYPE_CD
			, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = '001') COUNT_TYPE_NM
			,  0 CNT
		FROM	TB_EQUIP_CODE_ADM B
		WHERE B.EQUIP_CD NOT IN (
							SELECT
								A.EQUIP_CD
							FROM	TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
							WHERE 1=1
							AND A.EQUIP_CD = B.EQUIP_CD
							AND B.USE_YN_CD = '001'							
							AND LEFT(PLAN_DATE,6) = #{planDate} )
		AND B.USE_YN_CD = '001'	
		AND B.ETC1 = '') A
		PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList})) as pivot_reslut

		UNION ALL

		 SELECT * FROM
		   (SELECT
		
			 B.EQUIP_CD
			, B.EQUIP_NM
			, '' PLAN_DATE
			, '002' COUNT_TYPE_CD
			, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = '002') COUNT_TYPE_NM
			,  0 CNT
		FROM	TB_EQUIP_CODE_ADM B
		WHERE B.EQUIP_CD NOT IN (
							SELECT
								A.EQUIP_CD
							FROM	TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
							WHERE 1=1
							AND A.EQUIP_CD = B.EQUIP_CD
							AND B.USE_YN_CD = '001'							
							AND LEFT(PLAN_DATE,6) = #{planDate} )
		AND B.USE_YN_CD = '001'
		AND B.ETC1 = ''	) A
		PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList})) as pivot_reslut

		UNION ALL

		 SELECT * FROM
		   (SELECT
		
			 B.EQUIP_CD
			, B.EQUIP_NM
			, '' PLAN_DATE
			, '003' COUNT_TYPE_CD
			, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = '003') COUNT_TYPE_NM
			,  0 CNT
		FROM	TB_EQUIP_CODE_ADM B
		WHERE B.EQUIP_CD NOT IN (
							SELECT
								A.EQUIP_CD
							FROM	TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
							WHERE 1=1
							AND A.EQUIP_CD = B.EQUIP_CD
							AND B.USE_YN_CD = '001'						
							AND LEFT(PLAN_DATE,6) = #{planDate} )
		AND B.USE_YN_CD = '001'	
		AND B.ETC1 = '') A
		PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList})) as pivot_reslut

		UNION ALL

		 SELECT * FROM
		   (SELECT
		
			 B.EQUIP_CD
			, B.EQUIP_NM
			, '' PLAN_DATE
			, '004' COUNT_TYPE_CD
			, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = '004') COUNT_TYPE_NM
			,  0 CNT
		FROM	TB_EQUIP_CODE_ADM B
		WHERE B.EQUIP_CD NOT IN (
							SELECT
								A.EQUIP_CD
							FROM	TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
							WHERE 1=1
							AND A.EQUIP_CD = B.EQUIP_CD
							AND B.USE_YN_CD = '001'							
							AND LEFT(PLAN_DATE,6) = #{planDate} )
		AND B.USE_YN_CD = '001'
		AND B.ETC1 = ''	) A
		PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList})) as pivot_reslut

		UNION ALL

		 SELECT * FROM
		   (SELECT
		
			 B.EQUIP_CD
			, B.EQUIP_NM
			, '' PLAN_DATE
			, '005' COUNT_TYPE_CD
			, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = '005') COUNT_TYPE_NM
			,  0 CNT
		FROM	TB_EQUIP_CODE_ADM B
		WHERE B.EQUIP_CD NOT IN (
							SELECT
								A.EQUIP_CD
							FROM	TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
							WHERE 1=1
							AND A.EQUIP_CD = B.EQUIP_CD
							AND B.USE_YN_CD = '001'							
							AND LEFT(PLAN_DATE,6) = #{planDate} )
		AND B.USE_YN_CD = '001'
		AND B.ETC1 = ''	) A
		PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList})) as pivot_reslut
			
		ORDER BY EQUIP_NM, COUNT_TYPE_CD
	</select>
	
	<!-- 해당설비 & 날짜 작업지시 조회 -->
	<select id="readProductionPlan" resultMap="ProductionPlanVo">
		SELECT
			B.EQUIP_LINE_CD
			, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE D WHERE D.BASE_GROUP_CD='049' AND D.BASE_CD = B.EQUIP_LINE_CD) EQUIP_LINE_NM
			, A.EQUIP_CD
			, B.EQUIP_NM
			, A.PLAN_DATE
			, A.COUNT_TYPE_CD
			, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = A.COUNT_TYPE_CD) COUNT_TYPE_NM
			, A.COUNT_SUM
			, A.COUNT1
			, A.COUNT2
			, A.COUNT3
			, A.COUNT4
			, A.COUNT5
			, A.COUNT6
			, A.COUNT7
			, A.COUNT8
			, A.COUNT9
			, A.COUNT10
			, A.COUNT11
			, A.COUNT12
			, A.COUNT13
			, A.COUNT14
			, A.COUNT15
			, A.COUNT16
			, A.COUNT17
			, A.COUNT18
			, A.COUNT19
			, A.COUNT20
			, A.COUNT21
			, A.COUNT22
			, A.COUNT23
			, A.COUNT24
			, A.COUNT25
			, A.COUNT26
			, A.COUNT27
			, A.COUNT28
			, A.COUNT29
			, A.COUNT30
			, A.COUNT31
			, A.REG_ID
			, A.REG_DATE
			, A.UPD_ID
			, A.UPD_DATE
		FROM	TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
		WHERE 1=1
		AND A.EQUIP_CD = B.EQUIP_CD
		AND B.USE_YN_CD = '001'
		AND PLAN_DATE = #{planDate}

		UNION ALL

		SELECT
			B.EQUIP_LINE_CD
			, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE D WHERE D.BASE_GROUP_CD='049' AND D.BASE_CD = B.EQUIP_LINE_CD) EQUIP_LINE_NM
			, B.EQUIP_CD
			, B.EQUIP_NM
			, '' PLAN_DATE
			, '001' COUNT_TYPE_CD
			, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = '001') COUNT_TYPE_NM
			, '' COUNT_SUM
			, '' COUNT1
			, '' COUNT2
			, '' COUNT3
			, '' COUNT4
			, '' COUNT5
			, '' COUNT6
			, '' COUNT7
			, '' COUNT8
			, '' COUNT9
			, '' COUNT10
			, '' COUNT11
			, '' COUNT12
			, '' COUNT13
			, '' COUNT14
			, '' COUNT15
			, '' COUNT16
			, '' COUNT17
			, '' COUNT18
			, '' COUNT19
			, '' COUNT20
			, '' COUNT21
			, '' COUNT22
			, '' COUNT23
			, '' COUNT24
			, '' COUNT25
			, '' COUNT26
			, '' COUNT27
			, '' COUNT28
			, '' COUNT29
			, '' COUNT30
			, '' COUNT31
			, '' REG_ID
			, '' REG_DATE
			, '' UPD_ID
			, '' UPD_DATE
		FROM	TB_EQUIP_CODE_ADM B
		WHERE B.EQUIP_CD NOT IN (
							SELECT
								A.EQUIP_CD
							FROM	TB_PRODUCTION_PLAN A, TB_EQUIP_CODE_ADM B
							WHERE 1=1
							AND A.EQUIP_CD = B.EQUIP_CD
							AND B.USE_YN_CD = '001'
							AND PLAN_DATE = #{planDate} )
		AND B.USE_YN_CD = '001'
		
		UNION ALL

		SELECT
			B.EQUIP_LINE_CD
			, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE D WHERE D.BASE_GROUP_CD='049' AND D.BASE_CD = B.EQUIP_LINE_CD) EQUIP_LINE_NM
			, B.EQUIP_CD
			, B.EQUIP_NM
			, '' PLAN_DATE
			, '002' COUNT_TYPE_CD
			, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = '002') COUNT_TYPE_NM
			, '' COUNT_SUM
			, '' COUNT1
			, '' COUNT2
			, '' COUNT3
			, '' COUNT4
			, '' COUNT5
			, '' COUNT6
			, '' COUNT7
			, '' COUNT8
			, '' COUNT9
			, '' COUNT10
			, '' COUNT11
			, '' COUNT12
			, '' COUNT13
			, '' COUNT14
			, '' COUNT15
			, '' COUNT16
			, '' COUNT17
			, '' COUNT18
			, '' COUNT19
			, '' COUNT20
			, '' COUNT21
			, '' COUNT22
			, '' COUNT23
			, '' COUNT24
			, '' COUNT25
			, '' COUNT26
			, '' COUNT27
			, '' COUNT28
			, '' COUNT29
			, '' COUNT30
			, '' COUNT31
			, '' REG_ID
			, '' REG_DATE
			, '' UPD_ID
			, '' UPD_DATE
		FROM	TB_EQUIP_CODE_ADM B
		WHERE B.EQUIP_CD NOT IN (
							SELECT
								A.EQUIP_CD
							FROM	TB_PRODUCTION_PLAN A, TB_EQUIP_CODE_ADM B
							WHERE 1=1
							AND A.EQUIP_CD = B.EQUIP_CD
							AND B.USE_YN_CD = '001'
							AND PLAN_DATE = #{planDate} )
		AND B.USE_YN_CD = '001'

		UNION ALL

		SELECT
			B.EQUIP_LINE_CD
			, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE D WHERE D.BASE_GROUP_CD='049' AND D.BASE_CD = B.EQUIP_LINE_CD) EQUIP_LINE_NM
			, B.EQUIP_CD
			, B.EQUIP_NM
			, '' PLAN_DATE
			, '003' COUNT_TYPE_CD
			, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = '003') COUNT_TYPE_NM
			, '' COUNT_SUM
			, '' COUNT1
			, '' COUNT2
			, '' COUNT3
			, '' COUNT4
			, '' COUNT5
			, '' COUNT6
			, '' COUNT7
			, '' COUNT8
			, '' COUNT9
			, '' COUNT10
			, '' COUNT11
			, '' COUNT12
			, '' COUNT13
			, '' COUNT14
			, '' COUNT15
			, '' COUNT16
			, '' COUNT17
			, '' COUNT18
			, '' COUNT19
			, '' COUNT20
			, '' COUNT21
			, '' COUNT22
			, '' COUNT23
			, '' COUNT24
			, '' COUNT25
			, '' COUNT26
			, '' COUNT27
			, '' COUNT28
			, '' COUNT29
			, '' COUNT30
			, '' COUNT31
			, '' REG_ID
			, '' REG_DATE
			, '' UPD_ID
			, '' UPD_DATE
		FROM	TB_EQUIP_CODE_ADM B
		WHERE B.EQUIP_CD NOT IN (
							SELECT
								A.EQUIP_CD
							FROM	TB_PRODUCTION_PLAN A, TB_EQUIP_CODE_ADM B
							WHERE 1=1
							AND A.EQUIP_CD = B.EQUIP_CD
							AND B.USE_YN_CD = '001'
							AND PLAN_DATE = #{planDate} )
		AND B.USE_YN_CD = '001'
		
		ORDER BY EQUIP_NM, A.COUNT_TYPE_CD
	</select>
	
	<!--  월별 삭제 -->
	<delete id="deleteProductionPlan">
		<![CDATA[
			DELETE TB_PRODUCTION_PLAN_NEW
			WHERE LEFT(PLAN_DATE,6) = #{planDate}
		]]>
	</delete>
	
	
	<!-- 생산계획 월별 등록 -->
	<insert id="createProductionPlan">
		<![CDATA[
			INSERT INTO TB_PRODUCTION_PLAN_NEW (
				EQUIP_CD
				, PLAN_DATE
				, COUNT_TYPE_CD
				, CNT
				, REG_ID
				, REG_DATE
			)
			VALUES (
				#{equipCd}
				, #{planDate}
				, #{countTypeCd}
				, #{cnt}
				, #{regId}
				, getDate()
			)
		]]>
	</insert>
	<select id="readMonthProductPresentBodyHeaderOnly" resultMap="MonthProductPresentVo">
		<![CDATA[
			SET ANSI_WARNINGS OFF
		SET ARITHIGNORE ON
		SET ARITHABORT OFF

		SELECT ISNULL(B.EQUIP_LINE_CD, '') EQUIP_LINE_CD
			, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE FF WHERE FF.BASE_GROUP_CD='049' AND FF.BASE_CD = B.EQUIP_LINE_CD) EQUIP_LINE_NM
			, AAA.EQUIP_CD
			, B.EQUIP_NM
			, AAA.GOODS_CD
			, C.GOODS_NM
			, D.QUTY_CD
			, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE FF WHERE FF.BASE_GROUP_CD='007' AND FF.BASE_CD = D.QUTY_CD) QUTY_NM
			, AAA.GUBUN
			, COUNT_SUM
			, AAA.[01] AS COUNT1
			, AAA.[02] AS COUNT2
			, AAA.[03] AS COUNT3
			, AAA.[04] AS COUNT4
			, AAA.[05] AS COUNT5
			, AAA.[06] AS COUNT6
			, AAA.[07] AS COUNT7
			, AAA.[08] AS COUNT8
			, AAA.[09] AS COUNT9
			, AAA.[10] AS COUNT10
			, AAA.[11] AS COUNT11
			, AAA.[12] AS COUNT12
			, AAA.[13] AS COUNT13
			, AAA.[14] AS COUNT14
			, AAA.[15] AS COUNT15
			, AAA.[16] AS COUNT16
			, AAA.[17] AS COUNT17
			, AAA.[18] AS COUNT18
			, AAA.[19] AS COUNT19
			, AAA.[20] AS COUNT20
			, AAA.[21] AS COUNT21
			, AAA.[22] AS COUNT22
			, AAA.[23] AS COUNT23
			, AAA.[24] AS COUNT24
			, AAA.[25] AS COUNT25
			, AAA.[26] AS COUNT26
			, AAA.[27] AS COUNT27
			, AAA.[28] AS COUNT28
			, AAA.[29] AS COUNT29
			, AAA.[30] AS COUNT30
			, AAA.[31] AS COUNT31	
		FROM 
			( 
				
			
				 SELECT NULL EQUIP_LINE_CD
					, '' EQUIP_LINE_NM
					, '000000' EQUIP_CD
					, '운영계획수량 총합' EQUIP_NM
					, '111111' GOODS_CD
					, '' GOODS_NM
					, '' QUTY_CD
					, '' QUTY_NM							
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) GUBUN			
				, (ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
							ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
							ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
							ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
							ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
							ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
							ISNULL([31],0)) AS COUNT_SUM
					,  ISNULL(([01]),0) '01', ISNULL(([02]),0) '02', ISNULL(([03]),0) '03', ISNULL(([04]),0) '04', ISNULL(([05]),0) '05', ISNULL(([06]),0) '06', ISNULL(([07]),0) '07', ISNULL(([08]),0) '08', ISNULL(([09]),0) '09', ISNULL(([10]),0) '10'
					,  ISNULL(([11]),0) '11', ISNULL(([12]),0) '12', ISNULL(([13]),0) '13', ISNULL(([14]),0) '14', ISNULL(([15]),0) '15', ISNULL(([16]),0) '16', ISNULL(([17]),0) '17', ISNULL(([18]),0) '18', ISNULL(([19]),0) '19', ISNULL(([20]),0) '20'
					,  ISNULL(([21]),0) '21', ISNULL(([22]),0) '22', ISNULL(([23]),0) '23', ISNULL(([24]),0) '24', ISNULL(([25]),0) '25', ISNULL(([26]),0) '26', ISNULL(([27]),0) '27', ISNULL(([28]),0) '28', ISNULL(([29]),0) '29', ISNULL(([30]),0) '30'
					, ISNULL(([31]),0) '31'
				
				FROM
 (
		SELECT 
			 NULL EQUIP_LINE_CD
			, '' EQUIP_LINE_NM
			, '000000' EQUIP_CD
			, '운영계획수량 총합' EQUIP_NM
			,'trash' GOODS_CD
			, '' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM
			, '' COUNT_TYPE_CD
			, '' GUBUN
			, 0 COUNT_SUM
			,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
			,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
			,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
			,  '' AS '31'  				

		UNION ALL


		SELECT * FROM
		(
				SELECT NULL EQUIP_LINE_CD
					, '' EQUIP_LINE_NM
					, '000000' EQUIP_CD
					, '운영계획수량 총합' EQUIP_NM
					, '000000' GOODS_CD
					, '' GOODS_NM
					, '' QUTY_CD
					, '' QUTY_NM		
					, COUNT_TYPE_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) GUBUN
				, 0 COUNT_SUM

				, SUM(CNT) CNT
				, PLAN_DATE
			FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
			WHERE 1=1
			AND A.EQUIP_CD = B.EQUIP_CD
			AND B.USE_YN_CD = '001'
			AND PLAN_DATE >= #{startDate}
			AND PLAN_DATE <= #{endDate}
			AND COUNT_TYPE_CD = '002'
			GROUP BY  A.COUNT_TYPE_CD, PLAN_DATE, CNT) A
			PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList} ) ) as result_pivot
			) A
			WHERE GOODS_CD != 'trash'
				

			
			) AAA FULL OUTER JOIN TB_GOODS_CODE_ADM C ON AAA.GOODS_CD = C.GOODS_CD
				FULL OUTER JOIN TB_MATRL_CODE_ADM D ON C.ALNICU_MATRL_CD = D.MATRL_CD
		, TB_EQUIP_CODE_ADM B
		WHERE AAA.EQUIP_CD = B.EQUIP_CD

		UNION ALL
	SELECT NULL EQUIP_LINE_CD
					, '' EQUIP_LINE_NM
					, '000000' EQUIP_CD
					, '운영계획수량 총합' EQUIP_NM
					, '111111' GOODS_CD
					, '' GOODS_NM
					, '' QUTY_CD
					, '' QUTY_NM							
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) GUBUN			
				, (ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
							ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
							ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
							ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
							ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
							ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
							ISNULL([31],0)) AS COUNT_SUM
					,  ISNULL(([01]),0) '01', ISNULL(([02]),0) '02', ISNULL(([03]),0) '03', ISNULL(([04]),0) '04', ISNULL(([05]),0) '05', ISNULL(([06]),0) '06', ISNULL(([07]),0) '07', ISNULL(([08]),0) '08', ISNULL(([09]),0) '09', ISNULL(([10]),0) '10'
					,  ISNULL(([11]),0) '11', ISNULL(([12]),0) '12', ISNULL(([13]),0) '13', ISNULL(([14]),0) '14', ISNULL(([15]),0) '15', ISNULL(([16]),0) '16', ISNULL(([17]),0) '17', ISNULL(([18]),0) '18', ISNULL(([19]),0) '19', ISNULL(([20]),0) '20'
					,  ISNULL(([21]),0) '21', ISNULL(([22]),0) '22', ISNULL(([23]),0) '23', ISNULL(([24]),0) '24', ISNULL(([25]),0) '25', ISNULL(([26]),0) '26', ISNULL(([27]),0) '27', ISNULL(([28]),0) '28', ISNULL(([29]),0) '29', ISNULL(([30]),0) '30'
					, ISNULL(([31]),0) '31'
				
				FROM
 (

	 SELECT 
			 NULL EQUIP_LINE_CD
			, '' EQUIP_LINE_NM
			, '000000' EQUIP_CD
			, '운영계획수량 총합' EQUIP_NM
			,'trash' GOODS_CD
			, '' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM
			, '' COUNT_TYPE_CD
			, '' GUBUN
			, 0 COUNT_SUM
			,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
			,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
			,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
			,  '' AS '31'  				

		UNION ALL


		SELECT * FROM
		(
				SELECT NULL EQUIP_LINE_CD
					, '' EQUIP_LINE_NM
					, '000000' EQUIP_CD
					, '운영계획수량 총합' EQUIP_NM
					, '000000' GOODS_CD
					, '' GOODS_NM
					, '' QUTY_CD
					, '' QUTY_NM		
					, COUNT_TYPE_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) GUBUN
				, 0 COUNT_SUM

				, SUM(CNT) CNT
				, PLAN_DATE
			FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
			WHERE 1=1
			AND A.EQUIP_CD = B.EQUIP_CD
			AND B.USE_YN_CD = '001'
			AND PLAN_DATE >= #{startDate}
			AND PLAN_DATE <= #{endDate}
			AND COUNT_TYPE_CD = '002'
			GROUP BY  A.COUNT_TYPE_CD, PLAN_DATE, CNT) A
			PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList}) ) as result_pivot
		) A	
			WHERE GOODS_CD != 'trash'
	UNION ALL

	 SELECT NULL EQUIP_LINE_CD
					, '' EQUIP_LINE_NM
					, '000000' EQUIP_CD
					, '확정계획수량 총합' EQUIP_NM
					, '000000' GOODS_CD
					, '' GOODS_NM
					, '' QUTY_CD
					, '' QUTY_NM							
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) GUBUN			
				, (ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
							ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
							ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
							ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
							ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
							ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
							ISNULL([31],0)) AS COUNT_SUM
					,  ISNULL(([01]),0) '01', ISNULL(([02]),0) '02', ISNULL(([03]),0) '03', ISNULL(([04]),0) '04', ISNULL(([05]),0) '05', ISNULL(([06]),0) '06', ISNULL(([07]),0) '07', ISNULL(([08]),0) '08', ISNULL(([09]),0) '09', ISNULL(([10]),0) '10'
					,  ISNULL(([11]),0) '11', ISNULL(([12]),0) '12', ISNULL(([13]),0) '13', ISNULL(([14]),0) '14', ISNULL(([15]),0) '15', ISNULL(([16]),0) '16', ISNULL(([17]),0) '17', ISNULL(([18]),0) '18', ISNULL(([19]),0) '19', ISNULL(([20]),0) '20'
					,  ISNULL(([21]),0) '21', ISNULL(([22]),0) '22', ISNULL(([23]),0) '23', ISNULL(([24]),0) '24', ISNULL(([25]),0) '25', ISNULL(([26]),0) '26', ISNULL(([27]),0) '27', ISNULL(([28]),0) '28', ISNULL(([29]),0) '29', ISNULL(([30]),0) '30'
					, ISNULL(([31]),0) '31'
				
				FROM
 (
		SELECT 
			 NULL EQUIP_LINE_CD
			, '' EQUIP_LINE_NM
			, '000000' EQUIP_CD
			, '확정계획수량 총합' EQUIP_NM
			,'trash' GOODS_CD
			, '' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM
			, '' COUNT_TYPE_CD
			, '' GUBUN
			, 0 COUNT_SUM
			,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
			,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
			,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
			,  '' AS '31'  				

		UNION ALL


		SELECT * FROM
		(
				SELECT NULL EQUIP_LINE_CD
					, '' EQUIP_LINE_NM
					, '000000' EQUIP_CD
					, '확정계획수량 총합' EQUIP_NM
					, '000000' GOODS_CD
					, '' GOODS_NM
					, '' QUTY_CD
					, '' QUTY_NM		
					, COUNT_TYPE_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) GUBUN
				, 0 COUNT_SUM

				, SUM(CNT) CNT
				, PLAN_DATE
			FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
			WHERE 1=1
			AND A.EQUIP_CD = B.EQUIP_CD
			AND B.USE_YN_CD = '001'
			AND PLAN_DATE >= #{startDate}
			AND PLAN_DATE <= #{endDate}
			AND COUNT_TYPE_CD = '001'
			GROUP BY  A.COUNT_TYPE_CD, PLAN_DATE, CNT) A
			PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList}) ) as result_pivot
			) A
			WHERE GOODS_CD != 'trash'
			
	UNION ALL

	SELECT 
			NULL EQUIP_LINE_CD
			, '' EQUIP_LINE_NM
			, '111111' EQUIP_CD
			, '당일 합계 총합' EQUIP_NM
			, 'XXXXXX' GOODS_CD
			, '' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM		
			, '당일 합계' GUBUN
			,(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,
				  ISNULL([01],0) [01]
				, ISNULL([02],0) [02]
				, ISNULL([03],0) [03]
				, ISNULL([04],0) [04]
				, ISNULL([05],0) [05]
				, ISNULL([06],0) [06]
				, ISNULL([07],0) [07]
				, ISNULL([08],0) [08]
				, ISNULL([09],0) [09]
				, ISNULL([10],0) [10]
				, ISNULL([11],0) [11]
				, ISNULL([12],0) [12]
				, ISNULL([13],0) [13]
				, ISNULL([14],0) [14]
				, ISNULL([15],0) [15]
				, ISNULL([16],0) [16]
				, ISNULL([17],0) [17]
				, ISNULL([18],0) [18]
				, ISNULL([19],0) [19]
				, ISNULL([20],0) [20]
				, ISNULL([21],0) [21]
				, ISNULL([22],0) [22]
				, ISNULL([23],0) [23]
				, ISNULL([24],0) [24]
				, ISNULL([25],0) [25]
				, ISNULL([26],0) [26]
				, ISNULL([27],0) [27]
				, ISNULL([28],0) [28]
				, ISNULL([29],0) [29]
				, ISNULL([30],0) [30]
				, ISNULL([31],0) [31]
				FROM 				
				(
					SELECT *
							FROM (
							
								SELECT 							
									'' EQUIP_CD
									,ISNULL( AA.DAY_,'') DAY_
									,'XXXXXX' GOODS_CD								
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'당일합계' GUBUN
								FROM
								(
									SELECT
										A.EQUIP_CD
										, A.WORK_ORD_NO                     
										, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
										, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
										, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
										, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT
										, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
										, ISNULL(RE_SHIP_FAULTY_CNT,0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT
										B.EQUIP_CD
										, A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE, B.EQUIP_CD
										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									


								) AA
								GROUP BY AA.EQUIP_CD,DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA

		UNION ALL

		SELECT
			NULL EQUIP_LINE_CD
			, '' EQUIP_LINE_NM
			, '222222' EQUIP_CD
			, '누계 총합' EQUIP_NM
			, AA.GOODS_CD
			, '' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM
			, AA.GUBUN
			, AA.COUNT_SUM
				, ISNULL(AA.[01], 0) '01'
				, ISNULL(AA.[01], 0) + ISNULL(AA.[02], 0) '02'
				, ISNULL(AA.[01], 0) + ISNULL(AA.[02], 0) + ISNULL([03],0) '03'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) '4'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) '5'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) '6'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) '7'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) '8'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0)'9'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) '10'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) '11'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) '12'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) '13'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) '14'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) '15'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) '16'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) '17'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) '18'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) '19'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) '20'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) '21'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) '22'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) '23'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) '24'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) '25'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
				ISNULL([26],0) '26'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
				ISNULL([26],0) + ISNULL([27],0) '27'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
				ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) '28'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
				ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) '29'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
				ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) '30'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
				ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
				ISNULL([31],0) '31'
		
			FROM 
				(SELECT  '' EQUIP_CD, 'YYYYYY' GOODS_CD, '누계' GUBUN
					, SUM(ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
					ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
					ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
					ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
					ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
					ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
					ISNULL([31],0)) AS COUNT_SUM
					, SUM([01]) '01', SUM([02]) '02', SUM([03]) '03', SUM([04]) '04', SUM([05]) '05', SUM([06]) '06', SUM([07]) '07', SUM([08]) '08', SUM([09]) '09', SUM([10]) '10'
					, SUM([11]) '11', SUM([12]) '12', SUM([13]) '13', SUM([14]) '14', SUM([15]) '15', SUM([16]) '16', SUM([17]) '17', SUM([18]) '18', SUM([19]) '19', SUM([20]) '20'
					, SUM([21]) '21', SUM([22]) '22', SUM([23]) '23', SUM([24]) '24', SUM([25]) '25', SUM([26]) '26', SUM([27]) '27', SUM([28]) '28', SUM([29]) '29', SUM([30]) '30'
					, SUM([31]) '31'
					FROM (
							SELECT						
				
						(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,
				  ISNULL([01],0) [01]
				, ISNULL([02],0) [02]
				, ISNULL([03],0) [03]
				, ISNULL([04],0) [04]
				, ISNULL([05],0) [05]
				, ISNULL([06],0) [06]
				, ISNULL([07],0) [07]
				, ISNULL([08],0) [08]
				, ISNULL([09],0) [09]
				, ISNULL([10],0) [10]
				, ISNULL([11],0) [11]
				, ISNULL([12],0) [12]
				, ISNULL([13],0) [13]
				, ISNULL([14],0) [14]
				, ISNULL([15],0) [15]
				, ISNULL([16],0) [16]
				, ISNULL([17],0) [17]
				, ISNULL([18],0) [18]
				, ISNULL([19],0) [19]
				, ISNULL([20],0) [20]
				, ISNULL([21],0) [21]
				, ISNULL([22],0) [22]
				, ISNULL([23],0) [23]
				, ISNULL([24],0) [24]
				, ISNULL([25],0) [25]
				, ISNULL([26],0) [26]
				, ISNULL([27],0) [27]
				, ISNULL([28],0) [28]
				, ISNULL([29],0) [29]
				, ISNULL([30],0) [30]
				, ISNULL([31],0) [31]
				FROM 				
				(
					SELECT *
							FROM (
							
								SELECT 							
									'' EQUIP_CD
									,ISNULL( AA.DAY_,'') DAY_
									,'XXXXXX' GOODS_CD								
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'당일합계' GUBUN
								FROM
								(
									SELECT
										A.EQUIP_CD
										, A.WORK_ORD_NO                     
										, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
										, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
										, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
										, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT
										, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
										, ISNULL(RE_SHIP_FAULTY_CNT,0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT
										B.EQUIP_CD
										, A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE, B.EQUIP_CD
										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									


								) AA
								GROUP BY AA.EQUIP_CD,DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT   
																 
								) AA
						) AA
			) AA
			UNION ALL
				
				
				SELECT
				NULL EQUIP_LINE_CD
			, '' EQUIP_LINE_NM
			, '333333' EQUIP_CD
			, '확정 차이량 총합' EQUIP_NM
			,  'ZZZZZZ' GOODS_CD
			, '' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM
			,'확정 차이량' AS GUBUN
				, (ISNULL(BB.[01], 0) - ISNULL(AA.[01], 0) + ISNULL(BB.[02], 0) - ISNULL(AA.[02], 0) + ISNULL(BB.[03], 0) - ISNULL(AA.[03], 0) + ISNULL(BB.[04], 0) - ISNULL(AA.[04], 0) + ISNULL(BB.[05], 0) - ISNULL(AA.[05], 0) +
				ISNULL(BB.[06], 0) - ISNULL(AA.[06], 0) + ISNULL(BB.[07], 0) - ISNULL(AA.[07], 0) + ISNULL(BB.[08], 0) - ISNULL(AA.[08], 0) + ISNULL(BB.[09], 0) - ISNULL(AA.[09], 0) + ISNULL(BB.[10], 0) - ISNULL(AA.[10], 0) +
				ISNULL(BB.[11], 0) - ISNULL(AA.[11], 0) + ISNULL(BB.[12], 0) - ISNULL(AA.[12], 0) + ISNULL(BB.[13], 0) - ISNULL(AA.[13], 0) + ISNULL(BB.[14], 0) - ISNULL(AA.[14], 0) + ISNULL(BB.[15], 0) - ISNULL(AA.[15], 0) +
				ISNULL(BB.[16], 0) - ISNULL(AA.[16], 0) + ISNULL(BB.[17], 0) - ISNULL(AA.[17], 0) + ISNULL(BB.[18], 0) - ISNULL(AA.[18], 0) + ISNULL(BB.[19], 0) - ISNULL(AA.[19], 0) + ISNULL(BB.[20], 0) - ISNULL(AA.[20], 0) +
				ISNULL(BB.[21], 0) - ISNULL(AA.[21], 0) + ISNULL(BB.[22], 0) - ISNULL(AA.[22], 0) + ISNULL(BB.[23], 0) - ISNULL(AA.[23], 0) + ISNULL(BB.[24], 0) - ISNULL(AA.[24], 0) + ISNULL(BB.[25], 0) - ISNULL(AA.[25], 0) +
				ISNULL(BB.[26], 0) - ISNULL(AA.[26], 0) +ISNULL(BB.[27], 0) - ISNULL(AA.[27], 0) + ISNULL(BB.[28], 0) - ISNULL(AA.[28], 0) + ISNULL(BB.[29], 0) - ISNULL(AA.[29], 0) + ISNULL(BB.[30], 0) - ISNULL(AA.[30], 0) + 
				ISNULL(BB.[31], 0) - ISNULL(AA.[31], 0)) COUNT_SUM
				, ISNULL(BB.[01], 0) - ISNULL(AA.[01], 0) AS '01'
				, ISNULL(BB.[02], 0) - ISNULL(AA.[02], 0) AS '02'
				, ISNULL(BB.[03], 0) - ISNULL(AA.[03], 0) AS '03'
				, ISNULL(BB.[04], 0) - ISNULL(AA.[04], 0) AS '04'
				, ISNULL(BB.[05], 0) - ISNULL(AA.[05], 0) AS '05'
				, ISNULL(BB.[06], 0) - ISNULL(AA.[06], 0) AS '06'
				, ISNULL(BB.[07], 0) - ISNULL(AA.[07], 0) AS '07'
				, ISNULL(BB.[08], 0) - ISNULL(AA.[08], 0) AS '08'
				, ISNULL(BB.[09], 0) - ISNULL(AA.[09], 0) AS '09'
				, ISNULL(BB.[10], 0) - ISNULL(AA.[10], 0) AS '10'
				, ISNULL(BB.[11], 0) - ISNULL(AA.[11], 0) AS '11'
				, ISNULL(BB.[12], 0) - ISNULL(AA.[12], 0) AS '12'
				, ISNULL(BB.[13], 0) - ISNULL(AA.[13], 0) AS '13'
				, ISNULL(BB.[14], 0) - ISNULL(AA.[14], 0) AS '14'
				, ISNULL(BB.[15], 0) - ISNULL(AA.[15], 0) AS '15'
				, ISNULL(BB.[16], 0) - ISNULL(AA.[16], 0) AS '16'
				, ISNULL(BB.[17], 0) - ISNULL(AA.[17], 0) AS '17'
				, ISNULL(BB.[18], 0) - ISNULL(AA.[18], 0) AS '18'
				, ISNULL(BB.[19], 0) - ISNULL(AA.[19], 0) AS '19'
				, ISNULL(BB.[20], 0) - ISNULL(AA.[20], 0) AS '20'
				, ISNULL(BB.[21], 0) - ISNULL(AA.[21], 0) AS '21'
				, ISNULL(BB.[22], 0) - ISNULL(AA.[22], 0) AS '22'
				, ISNULL(BB.[23], 0) - ISNULL(AA.[23], 0) AS '23'
				, ISNULL(BB.[24], 0) - ISNULL(AA.[24], 0) AS '24'
				, ISNULL(BB.[25], 0) - ISNULL(AA.[25], 0) AS '25'
				, ISNULL(BB.[26], 0) - ISNULL(AA.[26], 0) AS '26'
				, ISNULL(BB.[27], 0) - ISNULL(AA.[27], 0) AS '27'
				, ISNULL(BB.[28], 0) - ISNULL(AA.[28], 0) AS '28'
				, ISNULL(BB.[29], 0) - ISNULL(AA.[29], 0) AS '29'
				, ISNULL(BB.[30], 0) - ISNULL(AA.[30], 0) AS '30'
				, ISNULL(BB.[31], 0) - ISNULL(AA.[31], 0) AS '31'
			FROM
				( 


				(
				SELECT '차이량' EQUIP_CD
					,'trash' GOODS_CD
					, '' COUNT_TYPE_NM
					, 0 COUNT_SUM
					,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
					,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
					,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
					,  '' AS '31'  				

				UNION ALL

				SELECT * FROM
				(SELECT		
				'차이량' EQUIP_CD
					,'000000' GOODS_CD
					, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) COUNT_TYPE_NM
					, 0 COUNT_SUM
					, SUM(CNT) CNT
					, PLAN_DATE
				FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
				WHERE 1=1
				AND A.EQUIP_CD = B.EQUIP_CD
				AND B.USE_YN_CD = '001'
				AND PLAN_DATE >= #{startDate}
				AND PLAN_DATE <= #{endDate}
				AND COUNT_TYPE_CD = '001'
				GROUP BY  A.COUNT_TYPE_CD, PLAN_DATE, CNT) AS AA
				PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList}) ) as result_pivot

									  ) 
				) AA FULL OUTER JOIN 	(			SELECT						
				'' EQUIP_CD,		
				GOODS_CD,							
				GUBUN,
				(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,
				  ISNULL([01],0) [01]
				, ISNULL([02],0) [02]
				, ISNULL([03],0) [03]
				, ISNULL([04],0) [04]
				, ISNULL([05],0) [05]
				, ISNULL([06],0) [06]
				, ISNULL([07],0) [07]
				, ISNULL([08],0) [08]
				, ISNULL([09],0) [09]
				, ISNULL([10],0) [10]
				, ISNULL([11],0) [11]
				, ISNULL([12],0) [12]
				, ISNULL([13],0) [13]
				, ISNULL([14],0) [14]
				, ISNULL([15],0) [15]
				, ISNULL([16],0) [16]
				, ISNULL([17],0) [17]
				, ISNULL([18],0) [18]
				, ISNULL([19],0) [19]
				, ISNULL([20],0) [20]
				, ISNULL([21],0) [21]
				, ISNULL([22],0) [22]
				, ISNULL([23],0) [23]
				, ISNULL([24],0) [24]
				, ISNULL([25],0) [25]
				, ISNULL([26],0) [26]
				, ISNULL([27],0) [27]
				, ISNULL([28],0) [28]
				, ISNULL([29],0) [29]
				, ISNULL([30],0) [30]
				, ISNULL([31],0) [31]
				FROM 				
				(
					SELECT *
							FROM (
							
								SELECT 							
									'' EQUIP_CD
									,ISNULL( AA.DAY_,'') DAY_
									,'XXXXXX' GOODS_CD								
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'당일합계' GUBUN
								FROM
								(
									SELECT
										A.EQUIP_CD
										, A.WORK_ORD_NO                     
										, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
										, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
										, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
										, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT
										, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
										, ISNULL(RE_SHIP_FAULTY_CNT,0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT
										B.EQUIP_CD
										, A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE, B.EQUIP_CD
										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									


								) AA
								GROUP BY AA.EQUIP_CD,DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA
				
		) BB  ON 1=1 WHERE AA.GOODS_CD != 'trash' 	

		UNION ALL
				
				SELECT
				NULL EQUIP_LINE_CD
			, '' EQUIP_LINE_NM
			, '333333' EQUIP_CD
			, '운영 차이량 총합' EQUIP_NM
			,  'ZZZZZZZ' GOODS_CD
			, '' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM
			,'운영 차이량' AS GUBUN
				, (ISNULL(BB.[01], 0) - ISNULL(AA.[01], 0) + ISNULL(BB.[02], 0) - ISNULL(AA.[02], 0) + ISNULL(BB.[03], 0) - ISNULL(AA.[03], 0) + ISNULL(BB.[04], 0) - ISNULL(AA.[04], 0) + ISNULL(BB.[05], 0) - ISNULL(AA.[05], 0) +
				ISNULL(BB.[06], 0) - ISNULL(AA.[06], 0) + ISNULL(BB.[07], 0) - ISNULL(AA.[07], 0) + ISNULL(BB.[08], 0) - ISNULL(AA.[08], 0) + ISNULL(BB.[09], 0) - ISNULL(AA.[09], 0) + ISNULL(BB.[10], 0) - ISNULL(AA.[10], 0) +
				ISNULL(BB.[11], 0) - ISNULL(AA.[11], 0) + ISNULL(BB.[12], 0) - ISNULL(AA.[12], 0) + ISNULL(BB.[13], 0) - ISNULL(AA.[13], 0) + ISNULL(BB.[14], 0) - ISNULL(AA.[14], 0) + ISNULL(BB.[15], 0) - ISNULL(AA.[15], 0) +
				ISNULL(BB.[16], 0) - ISNULL(AA.[16], 0) + ISNULL(BB.[17], 0) - ISNULL(AA.[17], 0) + ISNULL(BB.[18], 0) - ISNULL(AA.[18], 0) + ISNULL(BB.[19], 0) - ISNULL(AA.[19], 0) + ISNULL(BB.[20], 0) - ISNULL(AA.[20], 0) +
				ISNULL(BB.[21], 0) - ISNULL(AA.[21], 0) + ISNULL(BB.[22], 0) - ISNULL(AA.[22], 0) + ISNULL(BB.[23], 0) - ISNULL(AA.[23], 0) + ISNULL(BB.[24], 0) - ISNULL(AA.[24], 0) + ISNULL(BB.[25], 0) - ISNULL(AA.[25], 0) +
				ISNULL(BB.[26], 0) - ISNULL(AA.[26], 0) +ISNULL(BB.[27], 0) - ISNULL(AA.[27], 0) + ISNULL(BB.[28], 0) - ISNULL(AA.[28], 0) + ISNULL(BB.[29], 0) - ISNULL(AA.[29], 0) + ISNULL(BB.[30], 0) - ISNULL(AA.[30], 0) + 
				ISNULL(BB.[31], 0) - ISNULL(AA.[31], 0)) COUNT_SUM
				, ISNULL(BB.[01], 0) - ISNULL(AA.[01], 0) AS '01'
				, ISNULL(BB.[02], 0) - ISNULL(AA.[02], 0) AS '02'
				, ISNULL(BB.[03], 0) - ISNULL(AA.[03], 0) AS '03'
				, ISNULL(BB.[04], 0) - ISNULL(AA.[04], 0) AS '04'
				, ISNULL(BB.[05], 0) - ISNULL(AA.[05], 0) AS '05'
				, ISNULL(BB.[06], 0) - ISNULL(AA.[06], 0) AS '06'
				, ISNULL(BB.[07], 0) - ISNULL(AA.[07], 0) AS '07'
				, ISNULL(BB.[08], 0) - ISNULL(AA.[08], 0) AS '08'
				, ISNULL(BB.[09], 0) - ISNULL(AA.[09], 0) AS '09'
				, ISNULL(BB.[10], 0) - ISNULL(AA.[10], 0) AS '10'
				, ISNULL(BB.[11], 0) - ISNULL(AA.[11], 0) AS '11'
				, ISNULL(BB.[12], 0) - ISNULL(AA.[12], 0) AS '12'
				, ISNULL(BB.[13], 0) - ISNULL(AA.[13], 0) AS '13'
				, ISNULL(BB.[14], 0) - ISNULL(AA.[14], 0) AS '14'
				, ISNULL(BB.[15], 0) - ISNULL(AA.[15], 0) AS '15'
				, ISNULL(BB.[16], 0) - ISNULL(AA.[16], 0) AS '16'
				, ISNULL(BB.[17], 0) - ISNULL(AA.[17], 0) AS '17'
				, ISNULL(BB.[18], 0) - ISNULL(AA.[18], 0) AS '18'
				, ISNULL(BB.[19], 0) - ISNULL(AA.[19], 0) AS '19'
				, ISNULL(BB.[20], 0) - ISNULL(AA.[20], 0) AS '20'
				, ISNULL(BB.[21], 0) - ISNULL(AA.[21], 0) AS '21'
				, ISNULL(BB.[22], 0) - ISNULL(AA.[22], 0) AS '22'
				, ISNULL(BB.[23], 0) - ISNULL(AA.[23], 0) AS '23'
				, ISNULL(BB.[24], 0) - ISNULL(AA.[24], 0) AS '24'
				, ISNULL(BB.[25], 0) - ISNULL(AA.[25], 0) AS '25'
				, ISNULL(BB.[26], 0) - ISNULL(AA.[26], 0) AS '26'
				, ISNULL(BB.[27], 0) - ISNULL(AA.[27], 0) AS '27'
				, ISNULL(BB.[28], 0) - ISNULL(AA.[28], 0) AS '28'
				, ISNULL(BB.[29], 0) - ISNULL(AA.[29], 0) AS '29'
				, ISNULL(BB.[30], 0) - ISNULL(AA.[30], 0) AS '30'
				, ISNULL(BB.[31], 0) - ISNULL(AA.[31], 0) AS '31'
			FROM
				( 


				(
				SELECT '운영차이량' EQUIP_CD
					,'trash' GOODS_CD
					, '' COUNT_TYPE_NM
					, 0 COUNT_SUM
					,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
					,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
					,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
					,  '' AS '31'  				

				UNION ALL

				SELECT * FROM
				(SELECT		
				'운영차이량' EQUIP_CD
					,'000000' GOODS_CD
					, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) COUNT_TYPE_NM
					, 0 COUNT_SUM
					, SUM(CNT) CNT
					, PLAN_DATE
				FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
				WHERE 1=1
				AND A.EQUIP_CD = B.EQUIP_CD
				AND B.USE_YN_CD = '001'
				AND PLAN_DATE >= #{startDate}
				AND PLAN_DATE <= #{endDate}
				AND COUNT_TYPE_CD = '002'
				GROUP BY  A.COUNT_TYPE_CD, PLAN_DATE, CNT) AS AA
				PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList}) ) as result_pivot

									  ) 
				) AA FULL OUTER JOIN 	( 			SELECT						
				'' EQUIP_CD,		
				GOODS_CD,							
				GUBUN,
				(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,
				  ISNULL([01],0) [01]
				, ISNULL([02],0) [02]
				, ISNULL([03],0) [03]
				, ISNULL([04],0) [04]
				, ISNULL([05],0) [05]
				, ISNULL([06],0) [06]
				, ISNULL([07],0) [07]
				, ISNULL([08],0) [08]
				, ISNULL([09],0) [09]
				, ISNULL([10],0) [10]
				, ISNULL([11],0) [11]
				, ISNULL([12],0) [12]
				, ISNULL([13],0) [13]
				, ISNULL([14],0) [14]
				, ISNULL([15],0) [15]
				, ISNULL([16],0) [16]
				, ISNULL([17],0) [17]
				, ISNULL([18],0) [18]
				, ISNULL([19],0) [19]
				, ISNULL([20],0) [20]
				, ISNULL([21],0) [21]
				, ISNULL([22],0) [22]
				, ISNULL([23],0) [23]
				, ISNULL([24],0) [24]
				, ISNULL([25],0) [25]
				, ISNULL([26],0) [26]
				, ISNULL([27],0) [27]
				, ISNULL([28],0) [28]
				, ISNULL([29],0) [29]
				, ISNULL([30],0) [30]
				, ISNULL([31],0) [31]
				FROM 				
				(
					SELECT *
							FROM (
							
								SELECT 							
									'' EQUIP_CD
									,ISNULL( AA.DAY_,'') DAY_
									,'XXXXXX' GOODS_CD								
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'당일합계' GUBUN
								FROM
								(
									SELECT
										A.EQUIP_CD
										, A.WORK_ORD_NO                     
										, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
										, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
										, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
										, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT
										, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
										, ISNULL(RE_SHIP_FAULTY_CNT,0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT
										B.EQUIP_CD
										, A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE, B.EQUIP_CD
										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									


								) AA
								GROUP BY AA.EQUIP_CD,DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA
				
		) BB  ON 1=1 WHERE AA.GOODS_CD != 'trash'
		ORDER BY B.EQUIP_NM ASC, AAA.GOODS_CD ASC
	]]>
		<!-- ORDER BY AAA.EQUIP_CD ASC, AAA.GOODS_CD ASC -->
		
	</select>
	
	<!-- 월별 FP현황 조회(List) -->
	<select id="readMonthProductPresentBody" resultMap="MonthProductPresentVo">
		<![CDATA[
		SET ANSI_WARNINGS OFF
		SET ARITHIGNORE ON
		SET ARITHABORT OFF
		SELECT ISNULL(B.EQUIP_LINE_CD, '') EQUIP_LINE_CD
			, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE FF WHERE FF.BASE_GROUP_CD='049' AND FF.BASE_CD = B.EQUIP_LINE_CD) EQUIP_LINE_NM
			, AAA.EQUIP_CD
			, B.EQUIP_NM
			, AAA.GOODS_CD
			, C.GOODS_NM
			, D.QUTY_CD
			, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE FF WHERE FF.BASE_GROUP_CD='007' AND FF.BASE_CD = D.QUTY_CD) QUTY_NM
			, AAA.GUBUN
			, COUNT_SUM
			, AAA.[01] AS COUNT1
			, AAA.[02] AS COUNT2
			, AAA.[03] AS COUNT3
			, AAA.[04] AS COUNT4
			, AAA.[05] AS COUNT5
			, AAA.[06] AS COUNT6
			, AAA.[07] AS COUNT7
			, AAA.[08] AS COUNT8
			, AAA.[09] AS COUNT9
			, AAA.[10] AS COUNT10
			, AAA.[11] AS COUNT11
			, AAA.[12] AS COUNT12
			, AAA.[13] AS COUNT13
			, AAA.[14] AS COUNT14
			, AAA.[15] AS COUNT15
			, AAA.[16] AS COUNT16
			, AAA.[17] AS COUNT17
			, AAA.[18] AS COUNT18
			, AAA.[19] AS COUNT19
			, AAA.[20] AS COUNT20
			, AAA.[21] AS COUNT21
			, AAA.[22] AS COUNT22
			, AAA.[23] AS COUNT23
			, AAA.[24] AS COUNT24
			, AAA.[25] AS COUNT25
			, AAA.[26] AS COUNT26
			, AAA.[27] AS COUNT27
			, AAA.[28] AS COUNT28
			, AAA.[29] AS COUNT29
			, AAA.[30] AS COUNT30
			, AAA.[31] AS COUNT31	
		FROM 
			(
			SELECT						
				MM.EQUIP_CD,		
				MM.GOODS_CD,							
				MM.DAY_NIGHT_CD GUBUN,
				(ISNULL(MM.[01],0) + ISNULL(MM.[02],0) + ISNULL(MM.[03],0) + ISNULL(MM.[04],0) + ISNULL(MM.[05],0) +
				ISNULL(MM.[06],0) + ISNULL(MM.[07],0) + ISNULL(MM.[08],0) + ISNULL(MM.[09],0) + ISNULL(MM.[10],0) +
				ISNULL(MM.[11],0) + ISNULL(MM.[12],0) + ISNULL(MM.[13],0) + ISNULL(MM.[14],0) + ISNULL(MM.[15],0) +
				ISNULL(MM.[16],0) + ISNULL(MM.[17],0) + ISNULL(MM.[18],0) + ISNULL(MM.[19],0) + ISNULL(MM.[20],0) +
				ISNULL(MM.[21],0) + ISNULL(MM.[22],0) + ISNULL(MM.[23],0) + ISNULL(MM.[24],0) + ISNULL(MM.[25],0) +
				ISNULL(MM.[26],0) + ISNULL(MM.[27],0) + ISNULL(MM.[28],0) + ISNULL(MM.[29],0) + ISNULL(MM.[30],0) +
				ISNULL(MM.[31],0) + 
				ISNULL(ZZ.[01],0) + ISNULL(ZZ.[02],0) + ISNULL(ZZ.[03],0) + ISNULL(ZZ.[04],0) + ISNULL(ZZ.[05],0) +
				ISNULL(ZZ.[06],0) + ISNULL(ZZ.[07],0) + ISNULL(ZZ.[08],0) + ISNULL(ZZ.[09],0) + ISNULL(ZZ.[10],0) +
				ISNULL(ZZ.[11],0) + ISNULL(ZZ.[12],0) + ISNULL(ZZ.[13],0) + ISNULL(ZZ.[14],0) + ISNULL(ZZ.[15],0) +
				ISNULL(ZZ.[16],0) + ISNULL(ZZ.[17],0) + ISNULL(ZZ.[18],0) + ISNULL(ZZ.[19],0) + ISNULL(ZZ.[20],0) +
				ISNULL(ZZ.[21],0) + ISNULL(ZZ.[22],0) + ISNULL(ZZ.[23],0) + ISNULL(ZZ.[24],0) + ISNULL(ZZ.[25],0) +
				ISNULL(ZZ.[26],0) + ISNULL(ZZ.[27],0) + ISNULL(ZZ.[28],0) + ISNULL(ZZ.[29],0) + ISNULL(ZZ.[30],0) +
				ISNULL(ZZ.[31],0)
				
				) COUNT_SUM,
				   ISNULL(MM.[01],0) +  ISNULL(ZZ.[01],0) [01]
				, ISNULL(MM.[02],0) +  ISNULL(ZZ.[02],0) [02]
				, ISNULL(MM.[03],0) +  ISNULL(ZZ.[03],0) [03]
				, ISNULL(MM.[04],0) +  ISNULL(ZZ.[04],0) [04]
				, ISNULL(MM.[05],0) +  ISNULL(ZZ.[05],0) [05]
				, ISNULL(MM.[06],0) +  ISNULL(ZZ.[06],0) [06]
				, ISNULL(MM.[07],0) +  ISNULL(ZZ.[07],0) [07]
				, ISNULL(MM.[08],0) +  ISNULL(ZZ.[08],0) [08]
				, ISNULL(MM.[09],0) +  ISNULL(ZZ.[09],0) [09]
				, ISNULL(MM.[10],0) +  ISNULL(ZZ.[10],0) [10]
				, ISNULL(MM.[11],0) +  ISNULL(ZZ.[11],0) [11]
				, ISNULL(MM.[12],0) +  ISNULL(ZZ.[12],0) [12]
				, ISNULL(MM.[13],0) +  ISNULL(ZZ.[13],0) [13]
				, ISNULL(MM.[14],0) +  ISNULL(ZZ.[14],0) [14]
				, ISNULL(MM.[15],0) +  ISNULL(ZZ.[15],0) [15]
				, ISNULL(MM.[16],0) +  ISNULL(ZZ.[16],0) [16]
				, ISNULL(MM.[17],0) +  ISNULL(ZZ.[17],0) [17]
				, ISNULL(MM.[18],0) +  ISNULL(ZZ.[18],0) [18]
				, ISNULL(MM.[19],0) +  ISNULL(ZZ.[19],0) [19]
				, ISNULL(MM.[20],0) +  ISNULL(ZZ.[20],0) [20]
				, ISNULL(MM.[21],0) +  ISNULL(ZZ.[21],0) [21]
				, ISNULL(MM.[22],0) +  ISNULL(ZZ.[22],0) [22]
				, ISNULL(MM.[23],0) +  ISNULL(ZZ.[23],0) [23]
				, ISNULL(MM.[24],0) +  ISNULL(ZZ.[24],0) [24]
				, ISNULL(MM.[25],0) +  ISNULL(ZZ.[25],0) [25]
				, ISNULL(MM.[26],0) +  ISNULL(ZZ.[26],0) [26]
				, ISNULL(MM.[27],0) +  ISNULL(ZZ.[27],0) [27]
				, ISNULL(MM.[28],0) +  ISNULL(ZZ.[28],0) [28]
				, ISNULL(MM.[29],0) +  ISNULL(ZZ.[29],0) [29]
				, ISNULL(MM.[30],0) +  ISNULL(ZZ.[30],0) [30]
				, ISNULL(MM.[31],0) +  ISNULL(ZZ.[31],0) [31]
				FROM ( 
				  SELECT  AA.*,XX.EQUIP_NM							
				 FROM
				(SELECT A.EQUIP_CD
				, A.EQUIP_NM				
				, B.DAY_NIGHT_CD
				FROM TB_EQUIP_CODE_ADM A
				, (
					SELECT
						'D' DAY_NIGHT_CD
					UNION
					SELECT
						'N' DAY_NIGHT_CD
						) B
				WHERE USE_YN_CD = '001'
				AND ETC1 = ''
				) XX
				LEFT OUTER JOIN 				
				(
					SELECT *
							FROM (
							
								SELECT 							
									ISNULL(AA.EQUIP_CD,'') EQUIP_CD
									,ISNULL( AA.DAY_,'') DAY_
									,ISNULL(AA.GOODS_CD,'') GOODS_CD								
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 	
							
									,AA.DAY_NIGHT_CD
								FROM
								(
									SELECT
										 A.EQUIP_CD
										, A.WORK_ORD_NO                     
										, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
										, ISNULL(AB.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT					
										, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT			
										, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
										, ISNULL(RE_SHIP_FAULTY_CNT,0) AS RE_SHIP_FAULTY_CNT
										, A.DAY_NIGHT_CD
										, A.GOODS_CD
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT
										 A.WORK_ORD_NO                     
										, WORK_ORD_DATE	
										, DAY_NIGHT_CD
										, B.GOODS_CD
										, B.EQUIP_CD
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A			

									 FULL OUTER JOIN

									 (
										SELECT
											'D' DAY_NIGHT_CD
										UNION
										SELECT
											'N' DAY_NIGHT_CD
											) X
									ON 1=1
						
									, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE, B.GOODS_CD
										, B.EQUIP_CD, DAY_NIGHT_CD
									) A 
									LEFT OUTER JOIN	
									
									(
										SELECT
										 A.WORK_ORD_NO 
										, SUM(OUTPUT_CNT) APPEAR_OUTPUT_CNT
										, GUBUN
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,GUBUN FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO,GUBUN) A	
									
									 GROUP BY A.WORK_ORD_NO,GUBUN
									) AB

									ON 1=1
									AND A.WORK_ORD_NO = AB.WORK_ORD_NO
									AND A.DAY_NIGHT_CD = AB.GUBUN

									LEFT OUTER JOIN				


								(SELECT
										X.WORK_ORD_NO
										,Z.DAY_NIGHT_CD
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT					
										
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO								
			
									GROUP BY X.WORK_ORD_NO,DAY_NIGHT_CD
									) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								AND CC.DAY_NIGHT_CD = A.DAY_NIGHT_CD

									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO
											,DAY_NIGHT_CD
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO,DAY_NIGHT_CD
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
									AND B.DAY_NIGHT_CD = A.DAY_NIGHT_CD
									
									LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT			
										,DAY_NIGHT_CD
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO
											,DAY_NIGHT_CD
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO,DAY_NIGHT_CD) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO,DAY_NIGHT_CD
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
								AND D.DAY_NIGHT_CD = A.DAY_NIGHT_CD
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										,DAY_NIGHT_CD
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO
											,DAY_NIGHT_CD
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO,DAY_NIGHT_CD) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO,DAY_NIGHT_CD
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
								AND E.DAY_NIGHT_CD = A.DAY_NIGHT_CD	
								

								) AA
								GROUP BY AA.EQUIP_CD, AA.GOODS_CD,AA.DAY_NIGHT_CD,DAY_							
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
																 
					) AA
					ON 1=1 AND XX.EQUIP_CD = AA.EQUIP_CD
					AND XX.DAY_NIGHT_CD = AA.DAY_NIGHT_CD
				) MM

				FULL OUTER JOIN

				(

				    SELECT  YY.ETC1,BB.*  FROM
					(SELECT A.EQUIP_CD
							, A.EQUIP_NM
							, A.ETC1
							, B.DAY_NIGHT_CD
						FROM TB_EQUIP_CODE_ADM A
						, (
							SELECT
								'D' DAY_NIGHT_CD
							UNION
							SELECT
								'N' DAY_NIGHT_CD
								) B
						WHERE USE_YN_CD = '001'
						AND ETC1 != ''
					) YY

					LEFT OUTER JOIN 				
					(
						SELECT *
							FROM (
							
								SELECT 							
									ISNULL(AA.EQUIP_CD,'') EQUIP_CD
									,ISNULL( AA.DAY_,'') DAY_
									,ISNULL(AA.GOODS_CD,'') GOODS_CD								
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 	
							
									,AA.DAY_NIGHT_CD
								FROM
								(
									SELECT
										 A.EQUIP_CD
										, A.WORK_ORD_NO                     
										, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
										, ISNULL(AB.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT					
										, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT			
										, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
										, ISNULL(RE_SHIP_FAULTY_CNT,0) AS RE_SHIP_FAULTY_CNT
										, A.DAY_NIGHT_CD
										, A.GOODS_CD
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT
										 A.WORK_ORD_NO                     
										, WORK_ORD_DATE	
										, DAY_NIGHT_CD
										, B.GOODS_CD
										, B.EQUIP_CD
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A			

									 FULL OUTER JOIN

									 (
										SELECT
											'D' DAY_NIGHT_CD
										UNION
										SELECT
											'N' DAY_NIGHT_CD
											) X
									ON 1=1
						
									, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE, B.GOODS_CD
										, B.EQUIP_CD, DAY_NIGHT_CD
									) A 
									LEFT OUTER JOIN	
									
									(
										SELECT
										 A.WORK_ORD_NO 
										, SUM(OUTPUT_CNT) APPEAR_OUTPUT_CNT
										, GUBUN
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,GUBUN FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO,GUBUN) A	
									
									 GROUP BY A.WORK_ORD_NO,GUBUN
									) AB

									ON 1=1
									AND A.WORK_ORD_NO = AB.WORK_ORD_NO
									AND A.DAY_NIGHT_CD = AB.GUBUN

									LEFT OUTER JOIN				


								(SELECT
										X.WORK_ORD_NO
										,Z.DAY_NIGHT_CD
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT					
										
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO								
			
									GROUP BY X.WORK_ORD_NO,DAY_NIGHT_CD
									) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								AND CC.DAY_NIGHT_CD = A.DAY_NIGHT_CD

									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO
											,DAY_NIGHT_CD
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO,DAY_NIGHT_CD
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
									AND B.DAY_NIGHT_CD = A.DAY_NIGHT_CD
									
									LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT			
										,DAY_NIGHT_CD
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO
											,DAY_NIGHT_CD
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO,DAY_NIGHT_CD) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO,DAY_NIGHT_CD
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
								AND D.DAY_NIGHT_CD = A.DAY_NIGHT_CD
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										,DAY_NIGHT_CD
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO
											,DAY_NIGHT_CD
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO,DAY_NIGHT_CD) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO,DAY_NIGHT_CD
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
								AND E.DAY_NIGHT_CD = A.DAY_NIGHT_CD	
								

								) AA
								GROUP BY AA.EQUIP_CD, AA.GOODS_CD,AA.DAY_NIGHT_CD,DAY_							
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  																 
																 
					) BB
					ON 1=1 AND YY.EQUIP_CD = BB.EQUIP_CD
					AND YY.DAY_NIGHT_CD = BB.DAY_NIGHT_CD
					WHERE BB.EQUIP_CD IS NOT NULL
				) ZZ

				ON 1=1
				AND MM.EQUIP_NM = ZZ.ETC1
				AND MM.DAY_NIGHT_CD = ZZ.DAY_NIGHT_CD
			
			UNION ALL
				SELECT						
				MM.EQUIP_CD,		
				MM.GOODS_CD,							
				MM.GUBUN,
				(ISNULL(MM.[01],0) + ISNULL(MM.[02],0) + ISNULL(MM.[03],0) + ISNULL(MM.[04],0) + ISNULL(MM.[05],0) +
				ISNULL(MM.[06],0) + ISNULL(MM.[07],0) + ISNULL(MM.[08],0) + ISNULL(MM.[09],0) + ISNULL(MM.[10],0) +
				ISNULL(MM.[11],0) + ISNULL(MM.[12],0) + ISNULL(MM.[13],0) + ISNULL(MM.[14],0) + ISNULL(MM.[15],0) +
				ISNULL(MM.[16],0) + ISNULL(MM.[17],0) + ISNULL(MM.[18],0) + ISNULL(MM.[19],0) + ISNULL(MM.[20],0) +
				ISNULL(MM.[21],0) + ISNULL(MM.[22],0) + ISNULL(MM.[23],0) + ISNULL(MM.[24],0) + ISNULL(MM.[25],0) +
				ISNULL(MM.[26],0) + ISNULL(MM.[27],0) + ISNULL(MM.[28],0) + ISNULL(MM.[29],0) + ISNULL(MM.[30],0) +
				ISNULL(MM.[31],0) + 
				ISNULL(ZZ.[01],0) + ISNULL(ZZ.[02],0) + ISNULL(ZZ.[03],0) + ISNULL(ZZ.[04],0) + ISNULL(ZZ.[05],0) +
				ISNULL(ZZ.[06],0) + ISNULL(ZZ.[07],0) + ISNULL(ZZ.[08],0) + ISNULL(ZZ.[09],0) + ISNULL(ZZ.[10],0) +
				ISNULL(ZZ.[11],0) + ISNULL(ZZ.[12],0) + ISNULL(ZZ.[13],0) + ISNULL(ZZ.[14],0) + ISNULL(ZZ.[15],0) +
				ISNULL(ZZ.[16],0) + ISNULL(ZZ.[17],0) + ISNULL(ZZ.[18],0) + ISNULL(ZZ.[19],0) + ISNULL(ZZ.[20],0) +
				ISNULL(ZZ.[21],0) + ISNULL(ZZ.[22],0) + ISNULL(ZZ.[23],0) + ISNULL(ZZ.[24],0) + ISNULL(ZZ.[25],0) +
				ISNULL(ZZ.[26],0) + ISNULL(ZZ.[27],0) + ISNULL(ZZ.[28],0) + ISNULL(ZZ.[29],0) + ISNULL(ZZ.[30],0) +
				ISNULL(ZZ.[31],0)
				
				) COUNT_SUM,
				   ISNULL(MM.[01],0) +  ISNULL(ZZ.[01],0) [01]
				, ISNULL(MM.[02],0) +  ISNULL(ZZ.[02],0) [02]
				, ISNULL(MM.[03],0) +  ISNULL(ZZ.[03],0) [03]
				, ISNULL(MM.[04],0) +  ISNULL(ZZ.[04],0) [04]
				, ISNULL(MM.[05],0) +  ISNULL(ZZ.[05],0) [05]
				, ISNULL(MM.[06],0) +  ISNULL(ZZ.[06],0) [06]
				, ISNULL(MM.[07],0) +  ISNULL(ZZ.[07],0) [07]
				, ISNULL(MM.[08],0) +  ISNULL(ZZ.[08],0) [08]
				, ISNULL(MM.[09],0) +  ISNULL(ZZ.[09],0) [09]
				, ISNULL(MM.[10],0) +  ISNULL(ZZ.[10],0) [10]
				, ISNULL(MM.[11],0) +  ISNULL(ZZ.[11],0) [11]
				, ISNULL(MM.[12],0) +  ISNULL(ZZ.[12],0) [12]
				, ISNULL(MM.[13],0) +  ISNULL(ZZ.[13],0) [13]
				, ISNULL(MM.[14],0) +  ISNULL(ZZ.[14],0) [14]
				, ISNULL(MM.[15],0) +  ISNULL(ZZ.[15],0) [15]
				, ISNULL(MM.[16],0) +  ISNULL(ZZ.[16],0) [16]
				, ISNULL(MM.[17],0) +  ISNULL(ZZ.[17],0) [17]
				, ISNULL(MM.[18],0) +  ISNULL(ZZ.[18],0) [18]
				, ISNULL(MM.[19],0) +  ISNULL(ZZ.[19],0) [19]
				, ISNULL(MM.[20],0) +  ISNULL(ZZ.[20],0) [20]
				, ISNULL(MM.[21],0) +  ISNULL(ZZ.[21],0) [21]
				, ISNULL(MM.[22],0) +  ISNULL(ZZ.[22],0) [22]
				, ISNULL(MM.[23],0) +  ISNULL(ZZ.[23],0) [23]
				, ISNULL(MM.[24],0) +  ISNULL(ZZ.[24],0) [24]
				, ISNULL(MM.[25],0) +  ISNULL(ZZ.[25],0) [25]
				, ISNULL(MM.[26],0) +  ISNULL(ZZ.[26],0) [26]
				, ISNULL(MM.[27],0) +  ISNULL(ZZ.[27],0) [27]
				, ISNULL(MM.[28],0) +  ISNULL(ZZ.[28],0) [28]
				, ISNULL(MM.[29],0) +  ISNULL(ZZ.[29],0) [29]
				, ISNULL(MM.[30],0) +  ISNULL(ZZ.[30],0) [30]
				, ISNULL(MM.[31],0) +  ISNULL(ZZ.[31],0) [31]
				FROM ( 
				  SELECT  AA.*,XX.EQUIP_NM							
				 FROM
				(SELECT A.EQUIP_CD,A.EQUIP_NM FROM TB_EQUIP_CODE_ADM A
								WHERE USE_YN_CD = '001' 		
								AND ETC1 = ''
				) XX
				LEFT OUTER JOIN 				
				(
					SELECT *
							FROM (
							
								SELECT 							
									 EQUIP_CD
									,ISNULL( AA.DAY_,'') DAY_
									,'XXXXXX' GOODS_CD								
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'당일합계' GUBUN
								FROM
								(
									SELECT
										A.EQUIP_CD
										, A.WORK_ORD_NO                     
										, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
										, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
										, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
										, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT
										, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
										, ISNULL(RE_SHIP_FAULTY_CNT,0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT
										B.EQUIP_CD
										, A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE, B.EQUIP_CD


										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									


								) AA
								GROUP BY AA.EQUIP_CD,DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
					) AA
					ON 1=1 AND XX.EQUIP_CD = AA.EQUIP_CD
				) MM

				FULL OUTER JOIN

				(

				    SELECT  YY.ETC1,BB.*  FROM
					(SELECT A.EQUIP_CD,A.EQUIP_NM,ETC1 FROM TB_EQUIP_CODE_ADM A
									WHERE USE_YN_CD = '001' 		
									AND ETC1 != ''
					) YY

					LEFT OUTER JOIN 				
					(
						SELECT *
								FROM (
							
									SELECT 							
										 EQUIP_CD										
										,ISNULL( AA.DAY_,'') DAY_
										,'XXXXXX' GOODS_CD								
										,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
										,'당일합계' GUBUN
									FROM
									(
										SELECT
											A.EQUIP_CD
											, A.WORK_ORD_NO                     
											, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
											, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
											, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
											, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT
											, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
											, ISNULL(RE_SHIP_FAULTY_CNT,0) AS RE_SHIP_FAULTY_CNT
											, RIGHT(WORK_ORD_DATE,2) DAY_
										FROM 
										(
											SELECT
											B.EQUIP_CD
											, A.WORK_ORD_NO                     
											, WORK_ORD_DATE                       
											, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								
										 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
										 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
										 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE, B.EQUIP_CD

										) A 
										LEFT OUTER JOIN
									(SELECT
											X.WORK_ORD_NO									
											, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
										FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE 1=1 
										AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
										GROUP BY X.WORK_ORD_NO) CC
									ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
										LEFT OUTER JOIN 
										(
											SELECT                      
												X.WORK_ORD_NO											
												, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
											FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											GROUP BY X.WORK_ORD_NO
										) B
										ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
								LEFT OUTER JOIN 
									(
										SELECT
											B.WORK_ORD_NO					
											, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
										FROM TB_WORK_ORDER A
											, (SELECT
												X.WORK_ORD_NO											
												, SUM(FAULTY_CNT) FAULTY_CNT					
												FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
												WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
												AND RE_INSP_STATUS != '002'
												GROUP BY X.WORK_ORD_NO) B
										WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
										GROUP BY B.WORK_ORD_NO
									) D
									ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
									LEFT OUTER JOIN 
									(
										SELECT
											B.WORK_ORD_NO
											, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
										FROM TB_WORK_ORDER A
											, (SELECT
												X.WORK_ORD_NO											
												, SUM(FAULTY_CNT) FAULTY_CNT					
												FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
												WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
												AND RE_INSP_STATUS = '002'
												GROUP BY X.WORK_ORD_NO) B
										WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
										GROUP BY B.WORK_ORD_NO
									) E
									ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									


									) AA
									GROUP BY AA.EQUIP_CD,DAY_									
												
							) AS AA
								PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																	, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																	, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																	, [31]) ) AS PIVOT_RESULT  
																 
					) BB
					ON 1=1 AND YY.EQUIP_CD = BB.EQUIP_CD
				) ZZ

				ON 1=1
				AND MM.EQUIP_NM = ZZ.ETC1
		
			UNION ALL
		
			SELECT EQUIP_CD
					, '111111' GOODS_CD				
					, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) COUNT_TYPE_NM					
				, (ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
							ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
							ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
							ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
							ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
							ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
							ISNULL([31],0)) AS COUNT_SUM
					,  ISNULL(([01]),0) '01', ISNULL(([02]),0) '02', ISNULL(([03]),0) '03', ISNULL(([04]),0) '04', ISNULL(([05]),0) '05', ISNULL(([06]),0) '06', ISNULL(([07]),0) '07', ISNULL(([08]),0) '08', ISNULL(([09]),0) '09', ISNULL(([10]),0) '10'
					,  ISNULL(([11]),0) '11', ISNULL(([12]),0) '12', ISNULL(([13]),0) '13', ISNULL(([14]),0) '14', ISNULL(([15]),0) '15', ISNULL(([16]),0) '16', ISNULL(([17]),0) '17', ISNULL(([18]),0) '18', ISNULL(([19]),0) '19', ISNULL(([20]),0) '20'
					,  ISNULL(([21]),0) '21', ISNULL(([22]),0) '22', ISNULL(([23]),0) '23', ISNULL(([24]),0) '24', ISNULL(([25]),0) '25', ISNULL(([26]),0) '26', ISNULL(([27]),0) '27', ISNULL(([28]),0) '28', ISNULL(([29]),0) '29', ISNULL(([30]),0) '30'
					, ISNULL(([31]),0) '31'
				
				FROM
 (
		SELECT 
			'' EQUIP_CD
			, 'trash' GOODS_CD
			, ''COUNT_TYPE_CD
			, '' COUNT_TYPE_NM
			, 0 COUNT_SUM		
			,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
			,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
			,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
			,  '' AS '31'  				

		UNION ALL


		SELECT * FROM(
				SELECT
					A.EQUIP_CD
					, '111111' GOODS_CD
					, COUNT_TYPE_CD
					, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) COUNT_TYPE_NM
					, 0 COUNT_SUM
					, CNT
					, PLAN_DATE
				FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
				WHERE 1=1
				AND A.EQUIP_CD = B.EQUIP_CD
				AND B.USE_YN_CD = '001'
				AND PLAN_DATE >= #{startDate}
				AND PLAN_DATE <= #{endDate}
				AND COUNT_TYPE_CD = '002'
			) A
	PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList}) ) as result_pivot
			) A
			WHERE GOODS_CD != 'trash'

			UNION ALL
		
			SELECT EQUIP_CD
					, '000000' GOODS_CD				
					, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) COUNT_TYPE_NM					
				, (ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
							ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
							ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
							ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
							ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
							ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
							ISNULL([31],0)) AS COUNT_SUM
					,  ISNULL(([01]),0) '01', ISNULL(([02]),0) '02', ISNULL(([03]),0) '03', ISNULL(([04]),0) '04', ISNULL(([05]),0) '05', ISNULL(([06]),0) '06', ISNULL(([07]),0) '07', ISNULL(([08]),0) '08', ISNULL(([09]),0) '09', ISNULL(([10]),0) '10'
					,  ISNULL(([11]),0) '11', ISNULL(([12]),0) '12', ISNULL(([13]),0) '13', ISNULL(([14]),0) '14', ISNULL(([15]),0) '15', ISNULL(([16]),0) '16', ISNULL(([17]),0) '17', ISNULL(([18]),0) '18', ISNULL(([19]),0) '19', ISNULL(([20]),0) '20'
					,  ISNULL(([21]),0) '21', ISNULL(([22]),0) '22', ISNULL(([23]),0) '23', ISNULL(([24]),0) '24', ISNULL(([25]),0) '25', ISNULL(([26]),0) '26', ISNULL(([27]),0) '27', ISNULL(([28]),0) '28', ISNULL(([29]),0) '29', ISNULL(([30]),0) '30'
					, ISNULL(([31]),0) '31'
				
				FROM
 (
		SELECT 
			'' EQUIP_CD
			, 'trash' GOODS_CD
			, ''COUNT_TYPE_CD
			, '' COUNT_TYPE_NM
			, 0 COUNT_SUM		
			,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
			,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
			,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
			,  '' AS '31'  				

		UNION ALL


		SELECT * FROM(
				SELECT
					A.EQUIP_CD
					, '000000' GOODS_CD
					, COUNT_TYPE_CD
					, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) COUNT_TYPE_NM
					, 0 COUNT_SUM
					, CNT
					, PLAN_DATE
				FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
				WHERE 1=1
				AND A.EQUIP_CD = B.EQUIP_CD
				AND B.USE_YN_CD = '001'
				AND PLAN_DATE >= #{startDate}
				AND PLAN_DATE <= #{endDate}
				AND COUNT_TYPE_CD = '001'
			) A
	PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList} ) ) as result_pivot
			) A
			WHERE GOODS_CD != 'trash'

				UNION ALL
		
			SELECT EQUIP_CD
					, '222222' GOODS_CD				
					, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) COUNT_TYPE_NM					
				, (ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
							ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
							ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
							ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
							ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
							ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
							ISNULL([31],0)) AS COUNT_SUM
					,  ISNULL(([01]),0) '01', ISNULL(([02]),0) '02', ISNULL(([03]),0) '03', ISNULL(([04]),0) '04', ISNULL(([05]),0) '05', ISNULL(([06]),0) '06', ISNULL(([07]),0) '07', ISNULL(([08]),0) '08', ISNULL(([09]),0) '09', ISNULL(([10]),0) '10'
					,  ISNULL(([11]),0) '11', ISNULL(([12]),0) '12', ISNULL(([13]),0) '13', ISNULL(([14]),0) '14', ISNULL(([15]),0) '15', ISNULL(([16]),0) '16', ISNULL(([17]),0) '17', ISNULL(([18]),0) '18', ISNULL(([19]),0) '19', ISNULL(([20]),0) '20'
					,  ISNULL(([21]),0) '21', ISNULL(([22]),0) '22', ISNULL(([23]),0) '23', ISNULL(([24]),0) '24', ISNULL(([25]),0) '25', ISNULL(([26]),0) '26', ISNULL(([27]),0) '27', ISNULL(([28]),0) '28', ISNULL(([29]),0) '29', ISNULL(([30]),0) '30'
					, ISNULL(([31]),0) '31'
				
				FROM
 (
		SELECT 
			'' EQUIP_CD
			, 'trash' GOODS_CD
			, ''COUNT_TYPE_CD
			, '' COUNT_TYPE_NM
			, 0 COUNT_SUM		
			,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
			,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
			,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
			,  '' AS '31'  				

		UNION ALL


		SELECT * FROM(
				SELECT
					A.EQUIP_CD
					, '222222' GOODS_CD
					, COUNT_TYPE_CD
					, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) COUNT_TYPE_NM
					, 0 COUNT_SUM
					, CNT
					, PLAN_DATE
				FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
				WHERE 1=1
				AND A.EQUIP_CD = B.EQUIP_CD
				AND B.USE_YN_CD = '001'
				AND PLAN_DATE >= #{startDate}
				AND PLAN_DATE <= #{endDate}
				AND COUNT_TYPE_CD = '003'
			) A
	PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList}) ) as result_pivot
			) A
			WHERE GOODS_CD != 'trash'

			UNION ALL

			SELECT AA.EQUIP_CD, 'ZZZZZZ' GOODS_CD, '확정 차이량' AS GUBUN
				, (ISNULL(BB.[01], 0) - ISNULL(AA.[01], 0) + ISNULL(BB.[02], 0) - ISNULL(AA.[02], 0) + ISNULL(BB.[03], 0) - ISNULL(AA.[03], 0) + ISNULL(BB.[04], 0) - ISNULL(AA.[04], 0) + ISNULL(BB.[05], 0) - ISNULL(AA.[05], 0) +
				ISNULL(BB.[06], 0) - ISNULL(AA.[06], 0) + ISNULL(BB.[07], 0) - ISNULL(AA.[07], 0) + ISNULL(BB.[08], 0) - ISNULL(AA.[08], 0) + ISNULL(BB.[09], 0) - ISNULL(AA.[09], 0) + ISNULL(BB.[10], 0) - ISNULL(AA.[10], 0) +
				ISNULL(BB.[11], 0) - ISNULL(AA.[11], 0) + ISNULL(BB.[12], 0) - ISNULL(AA.[12], 0) + ISNULL(BB.[13], 0) - ISNULL(AA.[13], 0) + ISNULL(BB.[14], 0) - ISNULL(AA.[14], 0) + ISNULL(BB.[15], 0) - ISNULL(AA.[15], 0) +
				ISNULL(BB.[16], 0) - ISNULL(AA.[16], 0) + ISNULL(BB.[17], 0) - ISNULL(AA.[17], 0) + ISNULL(BB.[18], 0) - ISNULL(AA.[18], 0) + ISNULL(BB.[19], 0) - ISNULL(AA.[19], 0) + ISNULL(BB.[20], 0) - ISNULL(AA.[20], 0) +
				ISNULL(BB.[21], 0) - ISNULL(AA.[21], 0) + ISNULL(BB.[22], 0) - ISNULL(AA.[22], 0) + ISNULL(BB.[23], 0) - ISNULL(AA.[23], 0) + ISNULL(BB.[24], 0) - ISNULL(AA.[24], 0) + ISNULL(BB.[25], 0) - ISNULL(AA.[25], 0) +
				ISNULL(BB.[26], 0) - ISNULL(AA.[26], 0) +ISNULL(BB.[27], 0) - ISNULL(AA.[27], 0) + ISNULL(BB.[28], 0) - ISNULL(AA.[28], 0) + ISNULL(BB.[29], 0) - ISNULL(AA.[29], 0) + ISNULL(BB.[30], 0) - ISNULL(AA.[30], 0) + 
				ISNULL(BB.[31], 0) - ISNULL(AA.[31], 0)) COUNT_SUM
				, ISNULL(BB.[01], 0) - ISNULL(AA.[01], 0) AS '01'
				, ISNULL(BB.[02], 0) - ISNULL(AA.[02], 0) AS '02'
				, ISNULL(BB.[03], 0) - ISNULL(AA.[03], 0) AS '03'
				, ISNULL(BB.[04], 0) - ISNULL(AA.[04], 0) AS '04'
				, ISNULL(BB.[05], 0) - ISNULL(AA.[05], 0) AS '05'
				, ISNULL(BB.[06], 0) - ISNULL(AA.[06], 0) AS '06'
				, ISNULL(BB.[07], 0) - ISNULL(AA.[07], 0) AS '07'
				, ISNULL(BB.[08], 0) - ISNULL(AA.[08], 0) AS '08'
				, ISNULL(BB.[09], 0) - ISNULL(AA.[09], 0) AS '09'
				, ISNULL(BB.[10], 0) - ISNULL(AA.[10], 0) AS '10'
				, ISNULL(BB.[11], 0) - ISNULL(AA.[11], 0) AS '11'
				, ISNULL(BB.[12], 0) - ISNULL(AA.[12], 0) AS '12'
				, ISNULL(BB.[13], 0) - ISNULL(AA.[13], 0) AS '13'
				, ISNULL(BB.[14], 0) - ISNULL(AA.[14], 0) AS '14'
				, ISNULL(BB.[15], 0) - ISNULL(AA.[15], 0) AS '15'
				, ISNULL(BB.[16], 0) - ISNULL(AA.[16], 0) AS '16'
				, ISNULL(BB.[17], 0) - ISNULL(AA.[17], 0) AS '17'
				, ISNULL(BB.[18], 0) - ISNULL(AA.[18], 0) AS '18'
				, ISNULL(BB.[19], 0) - ISNULL(AA.[19], 0) AS '19'
				, ISNULL(BB.[20], 0) - ISNULL(AA.[20], 0) AS '20'
				, ISNULL(BB.[21], 0) - ISNULL(AA.[21], 0) AS '21'
				, ISNULL(BB.[22], 0) - ISNULL(AA.[22], 0) AS '22'
				, ISNULL(BB.[23], 0) - ISNULL(AA.[23], 0) AS '23'
				, ISNULL(BB.[24], 0) - ISNULL(AA.[24], 0) AS '24'
				, ISNULL(BB.[25], 0) - ISNULL(AA.[25], 0) AS '25'
				, ISNULL(BB.[26], 0) - ISNULL(AA.[26], 0) AS '26'
				, ISNULL(BB.[27], 0) - ISNULL(AA.[27], 0) AS '27'
				, ISNULL(BB.[28], 0) - ISNULL(AA.[28], 0) AS '28'
				, ISNULL(BB.[29], 0) - ISNULL(AA.[29], 0) AS '29'
				, ISNULL(BB.[30], 0) - ISNULL(AA.[30], 0) AS '30'
				, ISNULL(BB.[31], 0) - ISNULL(AA.[31], 0) AS '31'
			FROM
			(  
			SELECT '차이량' EQUIP_CD
					,'trash' GOODS_CD
					, '' COUNT_TYPE_NM
					, 0 COUNT_SUM
					,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
					,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
					,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
					,  '' AS '31'  				

				UNION ALL			
			
			
			SELECT * FROM
				( SELECT
					A.EQUIP_CD
					, '000000' GOODS_CD
					, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) COUNT_TYPE_NM
					, 0 COUNT_SUM
					, CNT
					, PLAN_DATE
				FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
				WHERE 1=1
				AND A.EQUIP_CD = B.EQUIP_CD
				AND B.USE_YN_CD = '001'
				AND PLAN_DATE >= #{startDate}
				AND PLAN_DATE <= #{endDate}
				AND COUNT_TYPE_CD = '001') AS AA
				PIVOT(SUM(CNT) FOR PLAN_DATE IN (
				${dayList}) ) as result_pivot
				) AA FULL OUTER JOIN 	( 			SELECT						
				MM.EQUIP_CD,		
				MM.GOODS_CD,							
				MM.GUBUN,
				(ISNULL(MM.[01],0) + ISNULL(MM.[02],0) + ISNULL(MM.[03],0) + ISNULL(MM.[04],0) + ISNULL(MM.[05],0) +
				ISNULL(MM.[06],0) + ISNULL(MM.[07],0) + ISNULL(MM.[08],0) + ISNULL(MM.[09],0) + ISNULL(MM.[10],0) +
				ISNULL(MM.[11],0) + ISNULL(MM.[12],0) + ISNULL(MM.[13],0) + ISNULL(MM.[14],0) + ISNULL(MM.[15],0) +
				ISNULL(MM.[16],0) + ISNULL(MM.[17],0) + ISNULL(MM.[18],0) + ISNULL(MM.[19],0) + ISNULL(MM.[20],0) +
				ISNULL(MM.[21],0) + ISNULL(MM.[22],0) + ISNULL(MM.[23],0) + ISNULL(MM.[24],0) + ISNULL(MM.[25],0) +
				ISNULL(MM.[26],0) + ISNULL(MM.[27],0) + ISNULL(MM.[28],0) + ISNULL(MM.[29],0) + ISNULL(MM.[30],0) +
				ISNULL(MM.[31],0) + 
				ISNULL(ZZ.[01],0) + ISNULL(ZZ.[02],0) + ISNULL(ZZ.[03],0) + ISNULL(ZZ.[04],0) + ISNULL(ZZ.[05],0) +
				ISNULL(ZZ.[06],0) + ISNULL(ZZ.[07],0) + ISNULL(ZZ.[08],0) + ISNULL(ZZ.[09],0) + ISNULL(ZZ.[10],0) +
				ISNULL(ZZ.[11],0) + ISNULL(ZZ.[12],0) + ISNULL(ZZ.[13],0) + ISNULL(ZZ.[14],0) + ISNULL(ZZ.[15],0) +
				ISNULL(ZZ.[16],0) + ISNULL(ZZ.[17],0) + ISNULL(ZZ.[18],0) + ISNULL(ZZ.[19],0) + ISNULL(ZZ.[20],0) +
				ISNULL(ZZ.[21],0) + ISNULL(ZZ.[22],0) + ISNULL(ZZ.[23],0) + ISNULL(ZZ.[24],0) + ISNULL(ZZ.[25],0) +
				ISNULL(ZZ.[26],0) + ISNULL(ZZ.[27],0) + ISNULL(ZZ.[28],0) + ISNULL(ZZ.[29],0) + ISNULL(ZZ.[30],0) +
				ISNULL(ZZ.[31],0)
				
				) COUNT_SUM,
				   ISNULL(MM.[01],0) +  ISNULL(ZZ.[01],0) [01]
				, ISNULL(MM.[02],0) +  ISNULL(ZZ.[02],0) [02]
				, ISNULL(MM.[03],0) +  ISNULL(ZZ.[03],0) [03]
				, ISNULL(MM.[04],0) +  ISNULL(ZZ.[04],0) [04]
				, ISNULL(MM.[05],0) +  ISNULL(ZZ.[05],0) [05]
				, ISNULL(MM.[06],0) +  ISNULL(ZZ.[06],0) [06]
				, ISNULL(MM.[07],0) +  ISNULL(ZZ.[07],0) [07]
				, ISNULL(MM.[08],0) +  ISNULL(ZZ.[08],0) [08]
				, ISNULL(MM.[09],0) +  ISNULL(ZZ.[09],0) [09]
				, ISNULL(MM.[10],0) +  ISNULL(ZZ.[10],0) [10]
				, ISNULL(MM.[11],0) +  ISNULL(ZZ.[11],0) [11]
				, ISNULL(MM.[12],0) +  ISNULL(ZZ.[12],0) [12]
				, ISNULL(MM.[13],0) +  ISNULL(ZZ.[13],0) [13]
				, ISNULL(MM.[14],0) +  ISNULL(ZZ.[14],0) [14]
				, ISNULL(MM.[15],0) +  ISNULL(ZZ.[15],0) [15]
				, ISNULL(MM.[16],0) +  ISNULL(ZZ.[16],0) [16]
				, ISNULL(MM.[17],0) +  ISNULL(ZZ.[17],0) [17]
				, ISNULL(MM.[18],0) +  ISNULL(ZZ.[18],0) [18]
				, ISNULL(MM.[19],0) +  ISNULL(ZZ.[19],0) [19]
				, ISNULL(MM.[20],0) +  ISNULL(ZZ.[20],0) [20]
				, ISNULL(MM.[21],0) +  ISNULL(ZZ.[21],0) [21]
				, ISNULL(MM.[22],0) +  ISNULL(ZZ.[22],0) [22]
				, ISNULL(MM.[23],0) +  ISNULL(ZZ.[23],0) [23]
				, ISNULL(MM.[24],0) +  ISNULL(ZZ.[24],0) [24]
				, ISNULL(MM.[25],0) +  ISNULL(ZZ.[25],0) [25]
				, ISNULL(MM.[26],0) +  ISNULL(ZZ.[26],0) [26]
				, ISNULL(MM.[27],0) +  ISNULL(ZZ.[27],0) [27]
				, ISNULL(MM.[28],0) +  ISNULL(ZZ.[28],0) [28]
				, ISNULL(MM.[29],0) +  ISNULL(ZZ.[29],0) [29]
				, ISNULL(MM.[30],0) +  ISNULL(ZZ.[30],0) [30]
				, ISNULL(MM.[31],0) +  ISNULL(ZZ.[31],0) [31]
				FROM ( 
				  SELECT  AA.*,XX.EQUIP_NM							
				 FROM
				(SELECT A.EQUIP_CD,A.EQUIP_NM FROM TB_EQUIP_CODE_ADM A
								WHERE USE_YN_CD = '001' 		
								AND ETC1 = ''
				) XX
				LEFT OUTER JOIN 				
				(
					SELECT *
							FROM (
							
								SELECT 							
									 EQUIP_CD
									,ISNULL( AA.DAY_,'') DAY_
									,'XXXXXX' GOODS_CD								
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'당일합계' GUBUN
								FROM
								(
									SELECT
										A.EQUIP_CD
										, A.WORK_ORD_NO                     
										, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
										, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
										, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
										, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT
										, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
										, ISNULL(RE_SHIP_FAULTY_CNT,0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT
										B.EQUIP_CD
										, A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE, B.EQUIP_CD


										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									


								) AA
								GROUP BY AA.EQUIP_CD,DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
					) AA
					ON 1=1 AND XX.EQUIP_CD = AA.EQUIP_CD
				) MM

				FULL OUTER JOIN

				(

				    SELECT  YY.ETC1,BB.*  FROM
					(SELECT A.EQUIP_CD,A.EQUIP_NM,ETC1 FROM TB_EQUIP_CODE_ADM A
									WHERE USE_YN_CD = '001' 		
									AND ETC1 != ''
					) YY

					LEFT OUTER JOIN 				
					(
						SELECT *
								FROM (
							
									SELECT 							
										 EQUIP_CD										
										,ISNULL( AA.DAY_,'') DAY_
										,'XXXXXX' GOODS_CD								
										,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
										,'당일합계' GUBUN
									FROM
									(
										SELECT
											A.EQUIP_CD
											, A.WORK_ORD_NO                     
											, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
											, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
											, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
											, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT
											, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
											, ISNULL(RE_SHIP_FAULTY_CNT,0) AS RE_SHIP_FAULTY_CNT
											, RIGHT(WORK_ORD_DATE,2) DAY_
										FROM 
										(
											SELECT
											B.EQUIP_CD
											, A.WORK_ORD_NO                     
											, WORK_ORD_DATE                       
											, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								
										 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
										 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
										 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE, B.EQUIP_CD

										) A 
										LEFT OUTER JOIN
									(SELECT
											X.WORK_ORD_NO									
											, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
										FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE 1=1 
										AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
										GROUP BY X.WORK_ORD_NO) CC
									ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
										LEFT OUTER JOIN 
										(
											SELECT                      
												X.WORK_ORD_NO											
												, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
											FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											GROUP BY X.WORK_ORD_NO
										) B
										ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
								LEFT OUTER JOIN 
									(
										SELECT
											B.WORK_ORD_NO					
											, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
										FROM TB_WORK_ORDER A
											, (SELECT
												X.WORK_ORD_NO											
												, SUM(FAULTY_CNT) FAULTY_CNT					
												FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
												WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
												AND RE_INSP_STATUS != '002'
												GROUP BY X.WORK_ORD_NO) B
										WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
										GROUP BY B.WORK_ORD_NO
									) D
									ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
									LEFT OUTER JOIN 
									(
										SELECT
											B.WORK_ORD_NO
											, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
										FROM TB_WORK_ORDER A
											, (SELECT
												X.WORK_ORD_NO											
												, SUM(FAULTY_CNT) FAULTY_CNT					
												FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
												WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
												AND RE_INSP_STATUS = '002'
												GROUP BY X.WORK_ORD_NO) B
										WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
										GROUP BY B.WORK_ORD_NO
									) E
									ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									


									) AA
									GROUP BY AA.EQUIP_CD,DAY_									
												
							) AS AA
								PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																	, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																	, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																	, [31]) ) AS PIVOT_RESULT  
																 
					) BB
					ON 1=1 AND YY.EQUIP_CD = BB.EQUIP_CD
				) ZZ

				ON 1=1
				AND MM.EQUIP_NM = ZZ.ETC1
			) BB  ON AA.EQUIP_CD = BB.EQUIP_CD WHERE AA.GOODS_CD != 'trash'
			
			UNION ALL
			SELECT AA.EQUIP_CD, 'ZZZZZZZZ' GOODS_CD, '가동률 (capa)' AS GUBUN
				,( (ISNULL(BB.[01], 0) + ISNULL(BB.[02], 0)  + ISNULL(BB.[03], 0) + ISNULL(BB.[04], 0)  + ISNULL(BB.[05], 0)  +
				ISNULL(BB.[06], 0) + ISNULL(BB.[07], 0) + ISNULL(BB.[08], 0)  + ISNULL(BB.[09], 0) + ISNULL(BB.[10], 0) +
				ISNULL(BB.[11], 0) + ISNULL(BB.[12], 0) + ISNULL(BB.[13], 0)  + ISNULL(BB.[14], 0) + ISNULL(BB.[15], 0) +
				ISNULL(BB.[16], 0) + ISNULL(BB.[17], 0) + ISNULL(BB.[18], 0)  + ISNULL(BB.[19], 0) + ISNULL(BB.[20], 0) +
				ISNULL(BB.[21], 0) + ISNULL(BB.[22], 0) + ISNULL(BB.[23], 0)  + ISNULL(BB.[24], 0) + ISNULL(BB.[25], 0) +
				ISNULL(BB.[26], 0) + ISNULL(BB.[27], 0) + ISNULL(BB.[28], 0)  + ISNULL(BB.[29], 0) + ISNULL(BB.[30], 0) + 
				ISNULL(BB.[31], 0) ) 
				* 100
				/
				(ISNULL(AA.[01], 0) + ISNULL(AA.[02], 0)  + ISNULL(AA.[03], 0) + ISNULL(AA.[04], 0)  + ISNULL(AA.[05], 0)  +
				ISNULL(AA.[06], 0) + ISNULL(AA.[07], 0) + ISNULL(AA.[08], 0)  + ISNULL(AA.[09], 0) + ISNULL(AA.[10], 0) +
				ISNULL(AA.[11], 0) + ISNULL(AA.[12], 0) + ISNULL(AA.[13], 0)  + ISNULL(AA.[14], 0) + ISNULL(AA.[15], 0) +
				ISNULL(AA.[16], 0) + ISNULL(AA.[17], 0) + ISNULL(AA.[18], 0)  + ISNULL(AA.[19], 0) + ISNULL(AA.[20], 0) +
				ISNULL(AA.[21], 0) + ISNULL(AA.[22], 0) + ISNULL(AA.[23], 0)  + ISNULL(AA.[24], 0) + ISNULL(AA.[25], 0) +
				ISNULL(AA.[26], 0) + ISNULL(AA.[27], 0) + ISNULL(AA.[28], 0)  + ISNULL(AA.[29], 0) + ISNULL(AA.[30], 0) + 
				ISNULL(AA.[31], 0))							
				) COUNT_SUM
				, ISNULL(BB.[01], 0) * 100 / ISNULL(AA.[01], 0)  AS '01'
				, ISNULL(BB.[02], 0) * 100 / ISNULL(AA.[02], 0) AS '02'
				, ISNULL(BB.[03], 0)  * 100 / ISNULL(AA.[03], 0) AS '03'
				, ISNULL(BB.[04], 0)  * 100 / ISNULL(AA.[04], 0) AS '04'
				, ISNULL(BB.[05], 0)  * 100 / ISNULL(AA.[05], 0) AS '05'
				, ISNULL(BB.[06], 0)  * 100 / ISNULL(AA.[06], 0) AS '06'
				, ISNULL(BB.[07], 0)  * 100 / ISNULL(AA.[07], 0) AS '07'
				, ISNULL(BB.[08], 0)  * 100 / ISNULL(AA.[08], 0) AS '08'
				, ISNULL(BB.[09], 0)  * 100 / ISNULL(AA.[09], 0) AS '09'
				, ISNULL(BB.[10], 0)  * 100 / ISNULL(AA.[10], 0) AS '10'
				, ISNULL(BB.[11], 0)  * 100 / ISNULL(AA.[11], 0) AS '11'
				, ISNULL(BB.[12], 0)  * 100 / ISNULL(AA.[12], 0) AS '12'
				, ISNULL(BB.[13], 0)  * 100 / ISNULL(AA.[13], 0) AS '13'
				, ISNULL(BB.[14], 0)  * 100 / ISNULL(AA.[14], 0) AS '14'
				, ISNULL(BB.[15], 0)  * 100 / ISNULL(AA.[15], 0) AS '15'
				, ISNULL(BB.[16], 0)  * 100 / ISNULL(AA.[16], 0) AS '16'
				, ISNULL(BB.[17], 0)  * 100 / ISNULL(AA.[17], 0) AS '17'
				, ISNULL(BB.[18], 0)  * 100 / ISNULL(AA.[18], 0) AS '18'
				, ISNULL(BB.[19], 0)  * 100 / ISNULL(AA.[19], 0) AS '19'
				, ISNULL(BB.[20], 0)  * 100 / ISNULL(AA.[20], 0) AS '20'
				, ISNULL(BB.[21], 0)  * 100 / ISNULL(AA.[21], 0) AS '21'
				, ISNULL(BB.[22], 0)  * 100 / ISNULL(AA.[22], 0) AS '22'
				, ISNULL(BB.[23], 0)  * 100 / ISNULL(AA.[23], 0) AS '23'
				, ISNULL(BB.[24], 0)  * 100 / ISNULL(AA.[24], 0) AS '24'
				, ISNULL(BB.[25], 0)  * 100 / ISNULL(AA.[25], 0) AS '25'
				, ISNULL(BB.[26], 0)  * 100 / ISNULL(AA.[26], 0) AS '26'
				, ISNULL(BB.[27], 0)  * 100 / ISNULL(AA.[27], 0) AS '27'
				, ISNULL(BB.[28], 0)  * 100 / ISNULL(AA.[28], 0) AS '28'
				, ISNULL(BB.[29], 0)  * 100 / ISNULL(AA.[29], 0) AS '29'
				, ISNULL(BB.[30], 0)  * 100 / ISNULL(AA.[30], 0) AS '30'
				, ISNULL(BB.[31], 0)  * 100 / ISNULL(AA.[31], 0) AS '31'
			FROM
			(  
			SELECT '차이량' EQUIP_CD
					,'trash' GOODS_CD
					, '' COUNT_TYPE_NM
					, 0 COUNT_SUM
					,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
					,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
					,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
					,  '' AS '31'  				

				UNION ALL			
			
			
			SELECT * FROM
				( SELECT
					A.EQUIP_CD
					, '000000' GOODS_CD
					, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) COUNT_TYPE_NM
					, 0 COUNT_SUM
					, CNT
					, PLAN_DATE
				FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
				WHERE 1=1
				AND A.EQUIP_CD = B.EQUIP_CD
				AND B.USE_YN_CD = '001'
				AND PLAN_DATE >= #{startDate}
				AND PLAN_DATE <= #{endDate}
				AND COUNT_TYPE_CD = '003') AS AA
				PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList} ) ) as result_pivot
				) AA FULL OUTER JOIN 	( 			SELECT						
				MM.EQUIP_CD,		
				MM.GOODS_CD,							
				MM.GUBUN,
				(ISNULL(MM.[01],0) + ISNULL(MM.[02],0) + ISNULL(MM.[03],0) + ISNULL(MM.[04],0) + ISNULL(MM.[05],0) +
				ISNULL(MM.[06],0) + ISNULL(MM.[07],0) + ISNULL(MM.[08],0) + ISNULL(MM.[09],0) + ISNULL(MM.[10],0) +
				ISNULL(MM.[11],0) + ISNULL(MM.[12],0) + ISNULL(MM.[13],0) + ISNULL(MM.[14],0) + ISNULL(MM.[15],0) +
				ISNULL(MM.[16],0) + ISNULL(MM.[17],0) + ISNULL(MM.[18],0) + ISNULL(MM.[19],0) + ISNULL(MM.[20],0) +
				ISNULL(MM.[21],0) + ISNULL(MM.[22],0) + ISNULL(MM.[23],0) + ISNULL(MM.[24],0) + ISNULL(MM.[25],0) +
				ISNULL(MM.[26],0) + ISNULL(MM.[27],0) + ISNULL(MM.[28],0) + ISNULL(MM.[29],0) + ISNULL(MM.[30],0) +
				ISNULL(MM.[31],0) + 
				ISNULL(ZZ.[01],0) + ISNULL(ZZ.[02],0) + ISNULL(ZZ.[03],0) + ISNULL(ZZ.[04],0) + ISNULL(ZZ.[05],0) +
				ISNULL(ZZ.[06],0) + ISNULL(ZZ.[07],0) + ISNULL(ZZ.[08],0) + ISNULL(ZZ.[09],0) + ISNULL(ZZ.[10],0) +
				ISNULL(ZZ.[11],0) + ISNULL(ZZ.[12],0) + ISNULL(ZZ.[13],0) + ISNULL(ZZ.[14],0) + ISNULL(ZZ.[15],0) +
				ISNULL(ZZ.[16],0) + ISNULL(ZZ.[17],0) + ISNULL(ZZ.[18],0) + ISNULL(ZZ.[19],0) + ISNULL(ZZ.[20],0) +
				ISNULL(ZZ.[21],0) + ISNULL(ZZ.[22],0) + ISNULL(ZZ.[23],0) + ISNULL(ZZ.[24],0) + ISNULL(ZZ.[25],0) +
				ISNULL(ZZ.[26],0) + ISNULL(ZZ.[27],0) + ISNULL(ZZ.[28],0) + ISNULL(ZZ.[29],0) + ISNULL(ZZ.[30],0) +
				ISNULL(ZZ.[31],0)
				
				) COUNT_SUM,
				   ISNULL(MM.[01],0) +  ISNULL(ZZ.[01],0) [01]
				, ISNULL(MM.[02],0) +  ISNULL(ZZ.[02],0) [02]
				, ISNULL(MM.[03],0) +  ISNULL(ZZ.[03],0) [03]
				, ISNULL(MM.[04],0) +  ISNULL(ZZ.[04],0) [04]
				, ISNULL(MM.[05],0) +  ISNULL(ZZ.[05],0) [05]
				, ISNULL(MM.[06],0) +  ISNULL(ZZ.[06],0) [06]
				, ISNULL(MM.[07],0) +  ISNULL(ZZ.[07],0) [07]
				, ISNULL(MM.[08],0) +  ISNULL(ZZ.[08],0) [08]
				, ISNULL(MM.[09],0) +  ISNULL(ZZ.[09],0) [09]
				, ISNULL(MM.[10],0) +  ISNULL(ZZ.[10],0) [10]
				, ISNULL(MM.[11],0) +  ISNULL(ZZ.[11],0) [11]
				, ISNULL(MM.[12],0) +  ISNULL(ZZ.[12],0) [12]
				, ISNULL(MM.[13],0) +  ISNULL(ZZ.[13],0) [13]
				, ISNULL(MM.[14],0) +  ISNULL(ZZ.[14],0) [14]
				, ISNULL(MM.[15],0) +  ISNULL(ZZ.[15],0) [15]
				, ISNULL(MM.[16],0) +  ISNULL(ZZ.[16],0) [16]
				, ISNULL(MM.[17],0) +  ISNULL(ZZ.[17],0) [17]
				, ISNULL(MM.[18],0) +  ISNULL(ZZ.[18],0) [18]
				, ISNULL(MM.[19],0) +  ISNULL(ZZ.[19],0) [19]
				, ISNULL(MM.[20],0) +  ISNULL(ZZ.[20],0) [20]
				, ISNULL(MM.[21],0) +  ISNULL(ZZ.[21],0) [21]
				, ISNULL(MM.[22],0) +  ISNULL(ZZ.[22],0) [22]
				, ISNULL(MM.[23],0) +  ISNULL(ZZ.[23],0) [23]
				, ISNULL(MM.[24],0) +  ISNULL(ZZ.[24],0) [24]
				, ISNULL(MM.[25],0) +  ISNULL(ZZ.[25],0) [25]
				, ISNULL(MM.[26],0) +  ISNULL(ZZ.[26],0) [26]
				, ISNULL(MM.[27],0) +  ISNULL(ZZ.[27],0) [27]
				, ISNULL(MM.[28],0) +  ISNULL(ZZ.[28],0) [28]
				, ISNULL(MM.[29],0) +  ISNULL(ZZ.[29],0) [29]
				, ISNULL(MM.[30],0) +  ISNULL(ZZ.[30],0) [30]
				, ISNULL(MM.[31],0) +  ISNULL(ZZ.[31],0) [31]
				FROM ( 
				  SELECT  AA.*,XX.EQUIP_NM							
				 FROM
				(SELECT A.EQUIP_CD,A.EQUIP_NM FROM TB_EQUIP_CODE_ADM A
								WHERE USE_YN_CD = '001' 		
								AND ETC1 = ''
				) XX
				LEFT OUTER JOIN 				
				(
					SELECT *
							FROM (
							
								SELECT 							
									 EQUIP_CD
									,ISNULL( AA.DAY_,'') DAY_
									,'XXXXXX' GOODS_CD								
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'당일합계' GUBUN
								FROM
								(
									SELECT
										A.EQUIP_CD
										, A.WORK_ORD_NO                     
										, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
										, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
										, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
										, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT
										, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
										, ISNULL(RE_SHIP_FAULTY_CNT,0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT
										B.EQUIP_CD
										, A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE, B.EQUIP_CD


										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									


								) AA
								GROUP BY AA.EQUIP_CD,DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
					) AA
					ON 1=1 AND XX.EQUIP_CD = AA.EQUIP_CD
				) MM

				FULL OUTER JOIN

				(

				    SELECT  YY.ETC1,BB.*  FROM
					(SELECT A.EQUIP_CD,A.EQUIP_NM,ETC1 FROM TB_EQUIP_CODE_ADM A
									WHERE USE_YN_CD = '001' 		
									AND ETC1 != ''
					) YY

					LEFT OUTER JOIN 				
					(
						SELECT *
								FROM (
							
									SELECT 							
										 EQUIP_CD										
										,ISNULL( AA.DAY_,'') DAY_
										,'XXXXXX' GOODS_CD								
										,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
										,'당일합계' GUBUN
									FROM
									(
										SELECT
											A.EQUIP_CD
											, A.WORK_ORD_NO                     
											, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
											, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
											, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
											, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT
											, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
											, ISNULL(RE_SHIP_FAULTY_CNT,0) AS RE_SHIP_FAULTY_CNT
											, RIGHT(WORK_ORD_DATE,2) DAY_
										FROM 
										(
											SELECT
											B.EQUIP_CD
											, A.WORK_ORD_NO                     
											, WORK_ORD_DATE                       
											, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								
										 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
										 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
										 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE, B.EQUIP_CD

										) A 
										LEFT OUTER JOIN
									(SELECT
											X.WORK_ORD_NO									
											, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
										FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE 1=1 
										AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
										GROUP BY X.WORK_ORD_NO) CC
									ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
										LEFT OUTER JOIN 
										(
											SELECT                      
												X.WORK_ORD_NO											
												, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
											FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											GROUP BY X.WORK_ORD_NO
										) B
										ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
								LEFT OUTER JOIN 
									(
										SELECT
											B.WORK_ORD_NO					
											, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
										FROM TB_WORK_ORDER A
											, (SELECT
												X.WORK_ORD_NO											
												, SUM(FAULTY_CNT) FAULTY_CNT					
												FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
												WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
												AND RE_INSP_STATUS != '002'
												GROUP BY X.WORK_ORD_NO) B
										WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
										GROUP BY B.WORK_ORD_NO
									) D
									ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
									LEFT OUTER JOIN 
									(
										SELECT
											B.WORK_ORD_NO
											, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
										FROM TB_WORK_ORDER A
											, (SELECT
												X.WORK_ORD_NO											
												, SUM(FAULTY_CNT) FAULTY_CNT					
												FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
												WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
												AND RE_INSP_STATUS = '002'
												GROUP BY X.WORK_ORD_NO) B
										WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
										GROUP BY B.WORK_ORD_NO
									) E
									ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									


									) AA
									GROUP BY AA.EQUIP_CD,DAY_									
												
							) AS AA
								PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																	, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																	, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																	, [31]) ) AS PIVOT_RESULT  
																 
					) BB
					ON 1=1 AND YY.EQUIP_CD = BB.EQUIP_CD
				) ZZ

				ON 1=1
				AND MM.EQUIP_NM = ZZ.ETC1
			) BB  ON AA.EQUIP_CD = BB.EQUIP_CD WHERE AA.GOODS_CD != 'trash'

			UNION ALL
			
				SELECT AA.EQUIP_CD, 'ZZZZZZZ' GOODS_CD, '운영 차이량' AS GUBUN
				, (ISNULL(BB.[01], 0) - ISNULL(AA.[01], 0) + ISNULL(BB.[02], 0) - ISNULL(AA.[02], 0) + ISNULL(BB.[03], 0) - ISNULL(AA.[03], 0) + ISNULL(BB.[04], 0) - ISNULL(AA.[04], 0) + ISNULL(BB.[05], 0) - ISNULL(AA.[05], 0) +
				ISNULL(BB.[06], 0) - ISNULL(AA.[06], 0) + ISNULL(BB.[07], 0) - ISNULL(AA.[07], 0) + ISNULL(BB.[08], 0) - ISNULL(AA.[08], 0) + ISNULL(BB.[09], 0) - ISNULL(AA.[09], 0) + ISNULL(BB.[10], 0) - ISNULL(AA.[10], 0) +
				ISNULL(BB.[11], 0) - ISNULL(AA.[11], 0) + ISNULL(BB.[12], 0) - ISNULL(AA.[12], 0) + ISNULL(BB.[13], 0) - ISNULL(AA.[13], 0) + ISNULL(BB.[14], 0) - ISNULL(AA.[14], 0) + ISNULL(BB.[15], 0) - ISNULL(AA.[15], 0) +
				ISNULL(BB.[16], 0) - ISNULL(AA.[16], 0) + ISNULL(BB.[17], 0) - ISNULL(AA.[17], 0) + ISNULL(BB.[18], 0) - ISNULL(AA.[18], 0) + ISNULL(BB.[19], 0) - ISNULL(AA.[19], 0) + ISNULL(BB.[20], 0) - ISNULL(AA.[20], 0) +
				ISNULL(BB.[21], 0) - ISNULL(AA.[21], 0) + ISNULL(BB.[22], 0) - ISNULL(AA.[22], 0) + ISNULL(BB.[23], 0) - ISNULL(AA.[23], 0) + ISNULL(BB.[24], 0) - ISNULL(AA.[24], 0) + ISNULL(BB.[25], 0) - ISNULL(AA.[25], 0) +
				ISNULL(BB.[26], 0) - ISNULL(AA.[26], 0) +ISNULL(BB.[27], 0) - ISNULL(AA.[27], 0) + ISNULL(BB.[28], 0) - ISNULL(AA.[28], 0) + ISNULL(BB.[29], 0) - ISNULL(AA.[29], 0) + ISNULL(BB.[30], 0) - ISNULL(AA.[30], 0) + 
				ISNULL(BB.[31], 0) - ISNULL(AA.[31], 0)) COUNT_SUM
				, ISNULL(BB.[01], 0) - ISNULL(AA.[01], 0) AS '01'
				, ISNULL(BB.[02], 0) - ISNULL(AA.[02], 0) AS '02'
				, ISNULL(BB.[03], 0) - ISNULL(AA.[03], 0) AS '03'
				, ISNULL(BB.[04], 0) - ISNULL(AA.[04], 0) AS '04'
				, ISNULL(BB.[05], 0) - ISNULL(AA.[05], 0) AS '05'
				, ISNULL(BB.[06], 0) - ISNULL(AA.[06], 0) AS '06'
				, ISNULL(BB.[07], 0) - ISNULL(AA.[07], 0) AS '07'
				, ISNULL(BB.[08], 0) - ISNULL(AA.[08], 0) AS '08'
				, ISNULL(BB.[09], 0) - ISNULL(AA.[09], 0) AS '09'
				, ISNULL(BB.[10], 0) - ISNULL(AA.[10], 0) AS '10'
				, ISNULL(BB.[11], 0) - ISNULL(AA.[11], 0) AS '11'
				, ISNULL(BB.[12], 0) - ISNULL(AA.[12], 0) AS '12'
				, ISNULL(BB.[13], 0) - ISNULL(AA.[13], 0) AS '13'
				, ISNULL(BB.[14], 0) - ISNULL(AA.[14], 0) AS '14'
				, ISNULL(BB.[15], 0) - ISNULL(AA.[15], 0) AS '15'
				, ISNULL(BB.[16], 0) - ISNULL(AA.[16], 0) AS '16'
				, ISNULL(BB.[17], 0) - ISNULL(AA.[17], 0) AS '17'
				, ISNULL(BB.[18], 0) - ISNULL(AA.[18], 0) AS '18'
				, ISNULL(BB.[19], 0) - ISNULL(AA.[19], 0) AS '19'
				, ISNULL(BB.[20], 0) - ISNULL(AA.[20], 0) AS '20'
				, ISNULL(BB.[21], 0) - ISNULL(AA.[21], 0) AS '21'
				, ISNULL(BB.[22], 0) - ISNULL(AA.[22], 0) AS '22'
				, ISNULL(BB.[23], 0) - ISNULL(AA.[23], 0) AS '23'
				, ISNULL(BB.[24], 0) - ISNULL(AA.[24], 0) AS '24'
				, ISNULL(BB.[25], 0) - ISNULL(AA.[25], 0) AS '25'
				, ISNULL(BB.[26], 0) - ISNULL(AA.[26], 0) AS '26'
				, ISNULL(BB.[27], 0) - ISNULL(AA.[27], 0) AS '27'
				, ISNULL(BB.[28], 0) - ISNULL(AA.[28], 0) AS '28'
				, ISNULL(BB.[29], 0) - ISNULL(AA.[29], 0) AS '29'
				, ISNULL(BB.[30], 0) - ISNULL(AA.[30], 0) AS '30'
				, ISNULL(BB.[31], 0) - ISNULL(AA.[31], 0) AS '31'
			FROM
			(  
			SELECT '차이량' EQUIP_CD
					,'trash' GOODS_CD
					, '' COUNT_TYPE_NM
					, 0 COUNT_SUM
					,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
					,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
					,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
					,  '' AS '31'  				

				UNION ALL			
			
			
			SELECT * FROM
				( SELECT
					A.EQUIP_CD
					, '000000' GOODS_CD
					, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) COUNT_TYPE_NM
					, 0 COUNT_SUM
					, CNT
					, PLAN_DATE
				FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
				WHERE 1=1
				AND A.EQUIP_CD = B.EQUIP_CD
				AND B.USE_YN_CD = '001'
				AND PLAN_DATE >= #{startDate}
				AND PLAN_DATE <= #{endDate}
				AND COUNT_TYPE_CD = '002') AS AA
				PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList} ) ) as result_pivot
				) AA FULL OUTER JOIN 	(			SELECT						
				MM.EQUIP_CD,		
				MM.GOODS_CD,							
				MM.GUBUN,
				(ISNULL(MM.[01],0) + ISNULL(MM.[02],0) + ISNULL(MM.[03],0) + ISNULL(MM.[04],0) + ISNULL(MM.[05],0) +
				ISNULL(MM.[06],0) + ISNULL(MM.[07],0) + ISNULL(MM.[08],0) + ISNULL(MM.[09],0) + ISNULL(MM.[10],0) +
				ISNULL(MM.[11],0) + ISNULL(MM.[12],0) + ISNULL(MM.[13],0) + ISNULL(MM.[14],0) + ISNULL(MM.[15],0) +
				ISNULL(MM.[16],0) + ISNULL(MM.[17],0) + ISNULL(MM.[18],0) + ISNULL(MM.[19],0) + ISNULL(MM.[20],0) +
				ISNULL(MM.[21],0) + ISNULL(MM.[22],0) + ISNULL(MM.[23],0) + ISNULL(MM.[24],0) + ISNULL(MM.[25],0) +
				ISNULL(MM.[26],0) + ISNULL(MM.[27],0) + ISNULL(MM.[28],0) + ISNULL(MM.[29],0) + ISNULL(MM.[30],0) +
				ISNULL(MM.[31],0) + 
				ISNULL(ZZ.[01],0) + ISNULL(ZZ.[02],0) + ISNULL(ZZ.[03],0) + ISNULL(ZZ.[04],0) + ISNULL(ZZ.[05],0) +
				ISNULL(ZZ.[06],0) + ISNULL(ZZ.[07],0) + ISNULL(ZZ.[08],0) + ISNULL(ZZ.[09],0) + ISNULL(ZZ.[10],0) +
				ISNULL(ZZ.[11],0) + ISNULL(ZZ.[12],0) + ISNULL(ZZ.[13],0) + ISNULL(ZZ.[14],0) + ISNULL(ZZ.[15],0) +
				ISNULL(ZZ.[16],0) + ISNULL(ZZ.[17],0) + ISNULL(ZZ.[18],0) + ISNULL(ZZ.[19],0) + ISNULL(ZZ.[20],0) +
				ISNULL(ZZ.[21],0) + ISNULL(ZZ.[22],0) + ISNULL(ZZ.[23],0) + ISNULL(ZZ.[24],0) + ISNULL(ZZ.[25],0) +
				ISNULL(ZZ.[26],0) + ISNULL(ZZ.[27],0) + ISNULL(ZZ.[28],0) + ISNULL(ZZ.[29],0) + ISNULL(ZZ.[30],0) +
				ISNULL(ZZ.[31],0)
				
				) COUNT_SUM,
				   ISNULL(MM.[01],0) +  ISNULL(ZZ.[01],0) [01]
				, ISNULL(MM.[02],0) +  ISNULL(ZZ.[02],0) [02]
				, ISNULL(MM.[03],0) +  ISNULL(ZZ.[03],0) [03]
				, ISNULL(MM.[04],0) +  ISNULL(ZZ.[04],0) [04]
				, ISNULL(MM.[05],0) +  ISNULL(ZZ.[05],0) [05]
				, ISNULL(MM.[06],0) +  ISNULL(ZZ.[06],0) [06]
				, ISNULL(MM.[07],0) +  ISNULL(ZZ.[07],0) [07]
				, ISNULL(MM.[08],0) +  ISNULL(ZZ.[08],0) [08]
				, ISNULL(MM.[09],0) +  ISNULL(ZZ.[09],0) [09]
				, ISNULL(MM.[10],0) +  ISNULL(ZZ.[10],0) [10]
				, ISNULL(MM.[11],0) +  ISNULL(ZZ.[11],0) [11]
				, ISNULL(MM.[12],0) +  ISNULL(ZZ.[12],0) [12]
				, ISNULL(MM.[13],0) +  ISNULL(ZZ.[13],0) [13]
				, ISNULL(MM.[14],0) +  ISNULL(ZZ.[14],0) [14]
				, ISNULL(MM.[15],0) +  ISNULL(ZZ.[15],0) [15]
				, ISNULL(MM.[16],0) +  ISNULL(ZZ.[16],0) [16]
				, ISNULL(MM.[17],0) +  ISNULL(ZZ.[17],0) [17]
				, ISNULL(MM.[18],0) +  ISNULL(ZZ.[18],0) [18]
				, ISNULL(MM.[19],0) +  ISNULL(ZZ.[19],0) [19]
				, ISNULL(MM.[20],0) +  ISNULL(ZZ.[20],0) [20]
				, ISNULL(MM.[21],0) +  ISNULL(ZZ.[21],0) [21]
				, ISNULL(MM.[22],0) +  ISNULL(ZZ.[22],0) [22]
				, ISNULL(MM.[23],0) +  ISNULL(ZZ.[23],0) [23]
				, ISNULL(MM.[24],0) +  ISNULL(ZZ.[24],0) [24]
				, ISNULL(MM.[25],0) +  ISNULL(ZZ.[25],0) [25]
				, ISNULL(MM.[26],0) +  ISNULL(ZZ.[26],0) [26]
				, ISNULL(MM.[27],0) +  ISNULL(ZZ.[27],0) [27]
				, ISNULL(MM.[28],0) +  ISNULL(ZZ.[28],0) [28]
				, ISNULL(MM.[29],0) +  ISNULL(ZZ.[29],0) [29]
				, ISNULL(MM.[30],0) +  ISNULL(ZZ.[30],0) [30]
				, ISNULL(MM.[31],0) +  ISNULL(ZZ.[31],0) [31]
				FROM ( 
				  SELECT  AA.*,XX.EQUIP_NM							
				 FROM
				(SELECT A.EQUIP_CD,A.EQUIP_NM FROM TB_EQUIP_CODE_ADM A
								WHERE USE_YN_CD = '001' 		
								AND ETC1 = ''
				) XX
				LEFT OUTER JOIN 				
				(
					SELECT *
							FROM (
							
								SELECT 							
									 EQUIP_CD
									,ISNULL( AA.DAY_,'') DAY_
									,'XXXXXX' GOODS_CD								
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'당일합계' GUBUN
								FROM
								(
									SELECT
										A.EQUIP_CD
										, A.WORK_ORD_NO                     
										, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
										, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
										, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
										, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT
										, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
										, ISNULL(RE_SHIP_FAULTY_CNT,0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT
										B.EQUIP_CD
										, A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE, B.EQUIP_CD


										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									


								) AA
								GROUP BY AA.EQUIP_CD,DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
					) AA
					ON 1=1 AND XX.EQUIP_CD = AA.EQUIP_CD
				) MM

				FULL OUTER JOIN

				(

				    SELECT  YY.ETC1,BB.*  FROM
					(SELECT A.EQUIP_CD,A.EQUIP_NM,ETC1 FROM TB_EQUIP_CODE_ADM A
									WHERE USE_YN_CD = '001' 		
									AND ETC1 != ''
					) YY

					LEFT OUTER JOIN 				
					(
						SELECT *
								FROM (
							
									SELECT 							
										 EQUIP_CD										
										,ISNULL( AA.DAY_,'') DAY_
										,'XXXXXX' GOODS_CD								
										,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
										,'당일합계' GUBUN
									FROM
									(
										SELECT
											A.EQUIP_CD
											, A.WORK_ORD_NO                     
											, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
											, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
											, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
											, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT
											, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
											, ISNULL(RE_SHIP_FAULTY_CNT,0) AS RE_SHIP_FAULTY_CNT
											, RIGHT(WORK_ORD_DATE,2) DAY_
										FROM 
										(
											SELECT
											B.EQUIP_CD
											, A.WORK_ORD_NO                     
											, WORK_ORD_DATE                       
											, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								
										 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
										 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
										 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE, B.EQUIP_CD

										) A 
										LEFT OUTER JOIN
									(SELECT
											X.WORK_ORD_NO									
											, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
										FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE 1=1 
										AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
										GROUP BY X.WORK_ORD_NO) CC
									ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
										LEFT OUTER JOIN 
										(
											SELECT                      
												X.WORK_ORD_NO											
												, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
											FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											GROUP BY X.WORK_ORD_NO
										) B
										ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
								LEFT OUTER JOIN 
									(
										SELECT
											B.WORK_ORD_NO					
											, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
										FROM TB_WORK_ORDER A
											, (SELECT
												X.WORK_ORD_NO											
												, SUM(FAULTY_CNT) FAULTY_CNT					
												FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
												WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
												AND RE_INSP_STATUS != '002'
												GROUP BY X.WORK_ORD_NO) B
										WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
										GROUP BY B.WORK_ORD_NO
									) D
									ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
									LEFT OUTER JOIN 
									(
										SELECT
											B.WORK_ORD_NO
											, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
										FROM TB_WORK_ORDER A
											, (SELECT
												X.WORK_ORD_NO											
												, SUM(FAULTY_CNT) FAULTY_CNT					
												FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
												WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
												AND RE_INSP_STATUS = '002'
												GROUP BY X.WORK_ORD_NO) B
										WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
										GROUP BY B.WORK_ORD_NO
									) E
									ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									


									) AA
									GROUP BY AA.EQUIP_CD,DAY_									
												
							) AS AA
								PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																	, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																	, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																	, [31]) ) AS PIVOT_RESULT  
																 
					) BB
					ON 1=1 AND YY.EQUIP_CD = BB.EQUIP_CD
				) ZZ

				ON 1=1
				AND MM.EQUIP_NM = ZZ.ETC1
			) BB 
			ON AA.EQUIP_CD = BB.EQUIP_CD WHERE AA.GOODS_CD != 'trash'
			
			UNION ALL
		
			SELECT AA.EQUIP_CD, AA.GOODS_CD, AA.GUBUN, AA.COUNT_SUM
				, ISNULL(AA.[01], 0) '01'
				, ISNULL(AA.[01], 0) + ISNULL(AA.[02], 0) '02'
				, ISNULL(AA.[01], 0) + ISNULL(AA.[02], 0) + ISNULL([03],0) '03'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) '4'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) '5'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) '6'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) '7'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) '8'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0)'9'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) '10'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) '11'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) '12'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) '13'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) '14'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) '15'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) '16'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) '17'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) '18'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) '19'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) '20'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) '21'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) '22'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) '23'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) '24'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) '25'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
				ISNULL([26],0) '26'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
				ISNULL([26],0) + ISNULL([27],0) '27'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
				ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) '28'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
				ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) '29'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
				ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) '30'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
				ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
				ISNULL([31],0) '31'
		
			FROM 
				(			SELECT						
				MM.EQUIP_CD,		
				MM.GOODS_CD,							
				MM.GUBUN,
				(ISNULL(MM.[01],0) + ISNULL(MM.[02],0) + ISNULL(MM.[03],0) + ISNULL(MM.[04],0) + ISNULL(MM.[05],0) +
				ISNULL(MM.[06],0) + ISNULL(MM.[07],0) + ISNULL(MM.[08],0) + ISNULL(MM.[09],0) + ISNULL(MM.[10],0) +
				ISNULL(MM.[11],0) + ISNULL(MM.[12],0) + ISNULL(MM.[13],0) + ISNULL(MM.[14],0) + ISNULL(MM.[15],0) +
				ISNULL(MM.[16],0) + ISNULL(MM.[17],0) + ISNULL(MM.[18],0) + ISNULL(MM.[19],0) + ISNULL(MM.[20],0) +
				ISNULL(MM.[21],0) + ISNULL(MM.[22],0) + ISNULL(MM.[23],0) + ISNULL(MM.[24],0) + ISNULL(MM.[25],0) +
				ISNULL(MM.[26],0) + ISNULL(MM.[27],0) + ISNULL(MM.[28],0) + ISNULL(MM.[29],0) + ISNULL(MM.[30],0) +
				ISNULL(MM.[31],0) + 
				ISNULL(ZZ.[01],0) + ISNULL(ZZ.[02],0) + ISNULL(ZZ.[03],0) + ISNULL(ZZ.[04],0) + ISNULL(ZZ.[05],0) +
				ISNULL(ZZ.[06],0) + ISNULL(ZZ.[07],0) + ISNULL(ZZ.[08],0) + ISNULL(ZZ.[09],0) + ISNULL(ZZ.[10],0) +
				ISNULL(ZZ.[11],0) + ISNULL(ZZ.[12],0) + ISNULL(ZZ.[13],0) + ISNULL(ZZ.[14],0) + ISNULL(ZZ.[15],0) +
				ISNULL(ZZ.[16],0) + ISNULL(ZZ.[17],0) + ISNULL(ZZ.[18],0) + ISNULL(ZZ.[19],0) + ISNULL(ZZ.[20],0) +
				ISNULL(ZZ.[21],0) + ISNULL(ZZ.[22],0) + ISNULL(ZZ.[23],0) + ISNULL(ZZ.[24],0) + ISNULL(ZZ.[25],0) +
				ISNULL(ZZ.[26],0) + ISNULL(ZZ.[27],0) + ISNULL(ZZ.[28],0) + ISNULL(ZZ.[29],0) + ISNULL(ZZ.[30],0) +
				ISNULL(ZZ.[31],0)
				
				) COUNT_SUM,
				   ISNULL(MM.[01],0) +  ISNULL(ZZ.[01],0) [01]
				, ISNULL(MM.[02],0) +  ISNULL(ZZ.[02],0) [02]
				, ISNULL(MM.[03],0) +  ISNULL(ZZ.[03],0) [03]
				, ISNULL(MM.[04],0) +  ISNULL(ZZ.[04],0) [04]
				, ISNULL(MM.[05],0) +  ISNULL(ZZ.[05],0) [05]
				, ISNULL(MM.[06],0) +  ISNULL(ZZ.[06],0) [06]
				, ISNULL(MM.[07],0) +  ISNULL(ZZ.[07],0) [07]
				, ISNULL(MM.[08],0) +  ISNULL(ZZ.[08],0) [08]
				, ISNULL(MM.[09],0) +  ISNULL(ZZ.[09],0) [09]
				, ISNULL(MM.[10],0) +  ISNULL(ZZ.[10],0) [10]
				, ISNULL(MM.[11],0) +  ISNULL(ZZ.[11],0) [11]
				, ISNULL(MM.[12],0) +  ISNULL(ZZ.[12],0) [12]
				, ISNULL(MM.[13],0) +  ISNULL(ZZ.[13],0) [13]
				, ISNULL(MM.[14],0) +  ISNULL(ZZ.[14],0) [14]
				, ISNULL(MM.[15],0) +  ISNULL(ZZ.[15],0) [15]
				, ISNULL(MM.[16],0) +  ISNULL(ZZ.[16],0) [16]
				, ISNULL(MM.[17],0) +  ISNULL(ZZ.[17],0) [17]
				, ISNULL(MM.[18],0) +  ISNULL(ZZ.[18],0) [18]
				, ISNULL(MM.[19],0) +  ISNULL(ZZ.[19],0) [19]
				, ISNULL(MM.[20],0) +  ISNULL(ZZ.[20],0) [20]
				, ISNULL(MM.[21],0) +  ISNULL(ZZ.[21],0) [21]
				, ISNULL(MM.[22],0) +  ISNULL(ZZ.[22],0) [22]
				, ISNULL(MM.[23],0) +  ISNULL(ZZ.[23],0) [23]
				, ISNULL(MM.[24],0) +  ISNULL(ZZ.[24],0) [24]
				, ISNULL(MM.[25],0) +  ISNULL(ZZ.[25],0) [25]
				, ISNULL(MM.[26],0) +  ISNULL(ZZ.[26],0) [26]
				, ISNULL(MM.[27],0) +  ISNULL(ZZ.[27],0) [27]
				, ISNULL(MM.[28],0) +  ISNULL(ZZ.[28],0) [28]
				, ISNULL(MM.[29],0) +  ISNULL(ZZ.[29],0) [29]
				, ISNULL(MM.[30],0) +  ISNULL(ZZ.[30],0) [30]
				, ISNULL(MM.[31],0) +  ISNULL(ZZ.[31],0) [31]
				FROM ( 
				  SELECT  AA.*,XX.EQUIP_NM							
				 FROM
				(SELECT A.EQUIP_CD,A.EQUIP_NM FROM TB_EQUIP_CODE_ADM A
								WHERE USE_YN_CD = '001' 		
								AND ETC1 = ''
				) XX
				LEFT OUTER JOIN 				
				(
					SELECT *
							FROM (
							
								SELECT 							
									 EQUIP_CD
									,ISNULL( AA.DAY_,'') DAY_
									,'YYYYYY' GOODS_CD								
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'누계' GUBUN
								FROM
								(
									SELECT
										A.EQUIP_CD
										, A.WORK_ORD_NO                     
										, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
										, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
										, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
										, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT
										, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
										, ISNULL(RE_SHIP_FAULTY_CNT,0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT
										B.EQUIP_CD
										, A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE, B.EQUIP_CD


										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									


								) AA
								GROUP BY AA.EQUIP_CD,DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
					) AA
					ON 1=1 AND XX.EQUIP_CD = AA.EQUIP_CD
				) MM

				FULL OUTER JOIN

				(

				    SELECT  YY.ETC1,BB.*  FROM
					(SELECT A.EQUIP_CD,A.EQUIP_NM,ETC1 FROM TB_EQUIP_CODE_ADM A
									WHERE USE_YN_CD = '001' 		
									AND ETC1 != ''
					) YY

					LEFT OUTER JOIN 				
					(
						SELECT *
								FROM (
							
									SELECT 							
										 EQUIP_CD										
										,ISNULL( AA.DAY_,'') DAY_
										,'YYYYYY' GOODS_CD								
										,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
										,'누계' GUBUN
									FROM
									(
										SELECT
											A.EQUIP_CD
											, A.WORK_ORD_NO                     
											, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
											, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
											, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
											, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT
											, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
											, ISNULL(RE_SHIP_FAULTY_CNT,0) AS RE_SHIP_FAULTY_CNT
											, RIGHT(WORK_ORD_DATE,2) DAY_
										FROM 
										(
											SELECT
											B.EQUIP_CD
											, A.WORK_ORD_NO                     
											, WORK_ORD_DATE                       
											, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								
										 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
										 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
										 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE, B.EQUIP_CD

										) A 
										LEFT OUTER JOIN
									(SELECT
											X.WORK_ORD_NO									
											, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
										FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE 1=1 
										AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
										GROUP BY X.WORK_ORD_NO) CC
									ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
										LEFT OUTER JOIN 
										(
											SELECT                      
												X.WORK_ORD_NO											
												, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
											FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											GROUP BY X.WORK_ORD_NO
										) B
										ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
								LEFT OUTER JOIN 
									(
										SELECT
											B.WORK_ORD_NO					
											, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
										FROM TB_WORK_ORDER A
											, (SELECT
												X.WORK_ORD_NO											
												, SUM(FAULTY_CNT) FAULTY_CNT					
												FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
												WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
												AND RE_INSP_STATUS != '002'
												GROUP BY X.WORK_ORD_NO) B
										WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
										GROUP BY B.WORK_ORD_NO
									) D
									ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
									LEFT OUTER JOIN 
									(
										SELECT
											B.WORK_ORD_NO
											, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
										FROM TB_WORK_ORDER A
											, (SELECT
												X.WORK_ORD_NO											
												, SUM(FAULTY_CNT) FAULTY_CNT					
												FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
												WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
												AND RE_INSP_STATUS = '002'
												GROUP BY X.WORK_ORD_NO) B
										WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
										GROUP BY B.WORK_ORD_NO
									) E
									ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									


									) AA
									GROUP BY AA.EQUIP_CD,DAY_									
												
							) AS AA
								PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																	, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																	, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																	, [31]) ) AS PIVOT_RESULT  
																 
					) BB
					ON 1=1 AND YY.EQUIP_CD = BB.EQUIP_CD
				) ZZ

				ON 1=1
				AND MM.EQUIP_NM = ZZ.ETC1
			) AA	



			
			) AAA FULL OUTER JOIN TB_GOODS_CODE_ADM C ON AAA.GOODS_CD = C.GOODS_CD
				FULL OUTER JOIN TB_MATRL_CODE_ADM D ON C.ALNICU_MATRL_CD = D.MATRL_CD
		, TB_EQUIP_CODE_ADM B
		WHERE AAA.EQUIP_CD = B.EQUIP_CD

		UNION ALL

	 SELECT NULL EQUIP_LINE_CD
					, '' EQUIP_LINE_NM
					, '000000' EQUIP_CD
					, '운영계획수량 총합' EQUIP_NM
					, '111111' GOODS_CD
					, '' GOODS_NM
					, '' QUTY_CD
					, '' QUTY_NM							
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) GUBUN			
				, (ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
							ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
							ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
							ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
							ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
							ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
							ISNULL([31],0)) AS COUNT_SUM
					,  ISNULL(([01]),0) '01', ISNULL(([02]),0) '02', ISNULL(([03]),0) '03', ISNULL(([04]),0) '04', ISNULL(([05]),0) '05', ISNULL(([06]),0) '06', ISNULL(([07]),0) '07', ISNULL(([08]),0) '08', ISNULL(([09]),0) '09', ISNULL(([10]),0) '10'
					,  ISNULL(([11]),0) '11', ISNULL(([12]),0) '12', ISNULL(([13]),0) '13', ISNULL(([14]),0) '14', ISNULL(([15]),0) '15', ISNULL(([16]),0) '16', ISNULL(([17]),0) '17', ISNULL(([18]),0) '18', ISNULL(([19]),0) '19', ISNULL(([20]),0) '20'
					,  ISNULL(([21]),0) '21', ISNULL(([22]),0) '22', ISNULL(([23]),0) '23', ISNULL(([24]),0) '24', ISNULL(([25]),0) '25', ISNULL(([26]),0) '26', ISNULL(([27]),0) '27', ISNULL(([28]),0) '28', ISNULL(([29]),0) '29', ISNULL(([30]),0) '30'
					, ISNULL(([31]),0) '31'
				
				FROM
 (
		SELECT 
			 NULL EQUIP_LINE_CD
			, '' EQUIP_LINE_NM
			, '000000' EQUIP_CD
			, '운영계획수량 총합' EQUIP_NM
			,'trash' GOODS_CD
			, '' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM
			, '' COUNT_TYPE_CD
			, '' GUBUN
			, 0 COUNT_SUM
			,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
			,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
			,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
			,  '' AS '31'  				

		UNION ALL


		SELECT * FROM
		(
				SELECT NULL EQUIP_LINE_CD
					, '' EQUIP_LINE_NM
					, '000000' EQUIP_CD
					, '운영계획수량 총합' EQUIP_NM
					, '000000' GOODS_CD
					, '' GOODS_NM
					, '' QUTY_CD
					, '' QUTY_NM		
					, COUNT_TYPE_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) GUBUN
				, 0 COUNT_SUM

				, SUM(CNT) CNT
				, PLAN_DATE
			FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
			WHERE 1=1
			AND A.EQUIP_CD = B.EQUIP_CD
			AND B.USE_YN_CD = '001'
			AND PLAN_DATE >= #{startDate}
			AND PLAN_DATE <= #{endDate}
			AND COUNT_TYPE_CD = '002'
			GROUP BY  A.COUNT_TYPE_CD, PLAN_DATE, CNT) A
			PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList} ) ) as result_pivot
			) A
			WHERE GOODS_CD != 'trash'
	UNION ALL

	 SELECT NULL EQUIP_LINE_CD
					, '' EQUIP_LINE_NM
					, '000000' EQUIP_CD
					, '확정계획수량 총합' EQUIP_NM
					, '000000' GOODS_CD
					, '' GOODS_NM
					, '' QUTY_CD
					, '' QUTY_NM							
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) GUBUN			
				, (ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
							ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
							ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
							ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
							ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
							ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
							ISNULL([31],0)) AS COUNT_SUM
					,  ISNULL(([01]),0) '01', ISNULL(([02]),0) '02', ISNULL(([03]),0) '03', ISNULL(([04]),0) '04', ISNULL(([05]),0) '05', ISNULL(([06]),0) '06', ISNULL(([07]),0) '07', ISNULL(([08]),0) '08', ISNULL(([09]),0) '09', ISNULL(([10]),0) '10'
					,  ISNULL(([11]),0) '11', ISNULL(([12]),0) '12', ISNULL(([13]),0) '13', ISNULL(([14]),0) '14', ISNULL(([15]),0) '15', ISNULL(([16]),0) '16', ISNULL(([17]),0) '17', ISNULL(([18]),0) '18', ISNULL(([19]),0) '19', ISNULL(([20]),0) '20'
					,  ISNULL(([21]),0) '21', ISNULL(([22]),0) '22', ISNULL(([23]),0) '23', ISNULL(([24]),0) '24', ISNULL(([25]),0) '25', ISNULL(([26]),0) '26', ISNULL(([27]),0) '27', ISNULL(([28]),0) '28', ISNULL(([29]),0) '29', ISNULL(([30]),0) '30'
					, ISNULL(([31]),0) '31'
				
				FROM
 (
		SELECT 
			 NULL EQUIP_LINE_CD
			, '' EQUIP_LINE_NM
			, '000000' EQUIP_CD
			, '확정계획수량 총합' EQUIP_NM
			,'trash' GOODS_CD
			, '' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM
			, '' COUNT_TYPE_CD
			, '' GUBUN
			, 0 COUNT_SUM
			,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
			,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
			,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
			,  '' AS '31'  				

		UNION ALL


		SELECT * FROM
		(
				SELECT NULL EQUIP_LINE_CD
					, '' EQUIP_LINE_NM
					, '000000' EQUIP_CD
					, '확정계획수량 총합' EQUIP_NM
					, '000000' GOODS_CD
					, '' GOODS_NM
					, '' QUTY_CD
					, '' QUTY_NM		
					, COUNT_TYPE_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) GUBUN
				, 0 COUNT_SUM

				, SUM(CNT) CNT
				, PLAN_DATE
			FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
			WHERE 1=1
			AND A.EQUIP_CD = B.EQUIP_CD
			AND B.USE_YN_CD = '001'
			AND PLAN_DATE >= #{startDate}
			AND PLAN_DATE <= #{endDate}
			AND COUNT_TYPE_CD = '001'
			GROUP BY  A.COUNT_TYPE_CD, PLAN_DATE, CNT) A
			PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList} ) ) as result_pivot
			) A
			WHERE GOODS_CD != 'trash'
			
	UNION ALL

	SELECT 
			NULL EQUIP_LINE_CD
			, '' EQUIP_LINE_NM
			, '111111' EQUIP_CD
			, '당일 합계 총합' EQUIP_NM
			, 'XXXXXX' GOODS_CD
			, '' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM		
			, '당일 합계' GUBUN
			,(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,
				  ISNULL([01],0) [01]
				, ISNULL([02],0) [02]
				, ISNULL([03],0) [03]
				, ISNULL([04],0) [04]
				, ISNULL([05],0) [05]
				, ISNULL([06],0) [06]
				, ISNULL([07],0) [07]
				, ISNULL([08],0) [08]
				, ISNULL([09],0) [09]
				, ISNULL([10],0) [10]
				, ISNULL([11],0) [11]
				, ISNULL([12],0) [12]
				, ISNULL([13],0) [13]
				, ISNULL([14],0) [14]
				, ISNULL([15],0) [15]
				, ISNULL([16],0) [16]
				, ISNULL([17],0) [17]
				, ISNULL([18],0) [18]
				, ISNULL([19],0) [19]
				, ISNULL([20],0) [20]
				, ISNULL([21],0) [21]
				, ISNULL([22],0) [22]
				, ISNULL([23],0) [23]
				, ISNULL([24],0) [24]
				, ISNULL([25],0) [25]
				, ISNULL([26],0) [26]
				, ISNULL([27],0) [27]
				, ISNULL([28],0) [28]
				, ISNULL([29],0) [29]
				, ISNULL([30],0) [30]
				, ISNULL([31],0) [31]
				FROM 				
				(
					SELECT *
							FROM (
							
								SELECT 							
									'' EQUIP_CD
									,ISNULL( AA.DAY_,'') DAY_
									,'XXXXXX' GOODS_CD								
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'당일합계' GUBUN
								FROM
								(
									SELECT
										A.EQUIP_CD
										, A.WORK_ORD_NO                     
										, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
										, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
										, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
										, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT
										, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
										, ISNULL(RE_SHIP_FAULTY_CNT,0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT
										B.EQUIP_CD
										, A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE, B.EQUIP_CD
										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									


								) AA
								GROUP BY AA.EQUIP_CD,DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA

		UNION ALL

		SELECT
			NULL EQUIP_LINE_CD
			, '' EQUIP_LINE_NM
			, '222222' EQUIP_CD
			, '누계 총합' EQUIP_NM
			, AA.GOODS_CD
			, '' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM
			, AA.GUBUN
			, AA.COUNT_SUM
				, ISNULL(AA.[01], 0) '01'
				, ISNULL(AA.[01], 0) + ISNULL(AA.[02], 0) '02'
				, ISNULL(AA.[01], 0) + ISNULL(AA.[02], 0) + ISNULL([03],0) '03'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) '4'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) '5'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) '6'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) '7'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) '8'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0)'9'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) '10'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) '11'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) '12'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) '13'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) '14'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) '15'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) '16'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) '17'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) '18'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) '19'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) '20'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) '21'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) '22'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) '23'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) '24'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) '25'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
				ISNULL([26],0) '26'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
				ISNULL([26],0) + ISNULL([27],0) '27'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
				ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) '28'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
				ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) '29'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
				ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) '30'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
				ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
				ISNULL([31],0) '31'
		
			FROM 
				(SELECT  '' EQUIP_CD, 'YYYYYY' GOODS_CD, '누계' GUBUN
					, SUM(ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
					ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
					ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
					ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
					ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
					ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
					ISNULL([31],0)) AS COUNT_SUM
					, SUM([01]) '01', SUM([02]) '02', SUM([03]) '03', SUM([04]) '04', SUM([05]) '05', SUM([06]) '06', SUM([07]) '07', SUM([08]) '08', SUM([09]) '09', SUM([10]) '10'
					, SUM([11]) '11', SUM([12]) '12', SUM([13]) '13', SUM([14]) '14', SUM([15]) '15', SUM([16]) '16', SUM([17]) '17', SUM([18]) '18', SUM([19]) '19', SUM([20]) '20'
					, SUM([21]) '21', SUM([22]) '22', SUM([23]) '23', SUM([24]) '24', SUM([25]) '25', SUM([26]) '26', SUM([27]) '27', SUM([28]) '28', SUM([29]) '29', SUM([30]) '30'
					, SUM([31]) '31'
					FROM (
							SELECT						
				
						(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,
				  ISNULL([01],0) [01]
				, ISNULL([02],0) [02]
				, ISNULL([03],0) [03]
				, ISNULL([04],0) [04]
				, ISNULL([05],0) [05]
				, ISNULL([06],0) [06]
				, ISNULL([07],0) [07]
				, ISNULL([08],0) [08]
				, ISNULL([09],0) [09]
				, ISNULL([10],0) [10]
				, ISNULL([11],0) [11]
				, ISNULL([12],0) [12]
				, ISNULL([13],0) [13]
				, ISNULL([14],0) [14]
				, ISNULL([15],0) [15]
				, ISNULL([16],0) [16]
				, ISNULL([17],0) [17]
				, ISNULL([18],0) [18]
				, ISNULL([19],0) [19]
				, ISNULL([20],0) [20]
				, ISNULL([21],0) [21]
				, ISNULL([22],0) [22]
				, ISNULL([23],0) [23]
				, ISNULL([24],0) [24]
				, ISNULL([25],0) [25]
				, ISNULL([26],0) [26]
				, ISNULL([27],0) [27]
				, ISNULL([28],0) [28]
				, ISNULL([29],0) [29]
				, ISNULL([30],0) [30]
				, ISNULL([31],0) [31]
				FROM 				
				(
					SELECT *
							FROM (
							
								SELECT 							
									'' EQUIP_CD
									,ISNULL( AA.DAY_,'') DAY_
									,'XXXXXX' GOODS_CD								
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'당일합계' GUBUN
								FROM
								(
									SELECT
										A.EQUIP_CD
										, A.WORK_ORD_NO                     
										, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
										, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
										, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
										, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT
										, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
										, ISNULL(RE_SHIP_FAULTY_CNT,0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT
										B.EQUIP_CD
										, A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE, B.EQUIP_CD
										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									


								) AA
								GROUP BY AA.EQUIP_CD,DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT   
																 
								) AA
						) AA
			) AA
			UNION ALL
				
				
				SELECT
				NULL EQUIP_LINE_CD
			, '' EQUIP_LINE_NM
			, '333333' EQUIP_CD
			, '확정 차이량 총합' EQUIP_NM
			,  'ZZZZZZ' GOODS_CD
			, '' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM
			,'확정 차이량' AS GUBUN
				, (ISNULL(BB.[01], 0) - ISNULL(AA.[01], 0) + ISNULL(BB.[02], 0) - ISNULL(AA.[02], 0) + ISNULL(BB.[03], 0) - ISNULL(AA.[03], 0) + ISNULL(BB.[04], 0) - ISNULL(AA.[04], 0) + ISNULL(BB.[05], 0) - ISNULL(AA.[05], 0) +
				ISNULL(BB.[06], 0) - ISNULL(AA.[06], 0) + ISNULL(BB.[07], 0) - ISNULL(AA.[07], 0) + ISNULL(BB.[08], 0) - ISNULL(AA.[08], 0) + ISNULL(BB.[09], 0) - ISNULL(AA.[09], 0) + ISNULL(BB.[10], 0) - ISNULL(AA.[10], 0) +
				ISNULL(BB.[11], 0) - ISNULL(AA.[11], 0) + ISNULL(BB.[12], 0) - ISNULL(AA.[12], 0) + ISNULL(BB.[13], 0) - ISNULL(AA.[13], 0) + ISNULL(BB.[14], 0) - ISNULL(AA.[14], 0) + ISNULL(BB.[15], 0) - ISNULL(AA.[15], 0) +
				ISNULL(BB.[16], 0) - ISNULL(AA.[16], 0) + ISNULL(BB.[17], 0) - ISNULL(AA.[17], 0) + ISNULL(BB.[18], 0) - ISNULL(AA.[18], 0) + ISNULL(BB.[19], 0) - ISNULL(AA.[19], 0) + ISNULL(BB.[20], 0) - ISNULL(AA.[20], 0) +
				ISNULL(BB.[21], 0) - ISNULL(AA.[21], 0) + ISNULL(BB.[22], 0) - ISNULL(AA.[22], 0) + ISNULL(BB.[23], 0) - ISNULL(AA.[23], 0) + ISNULL(BB.[24], 0) - ISNULL(AA.[24], 0) + ISNULL(BB.[25], 0) - ISNULL(AA.[25], 0) +
				ISNULL(BB.[26], 0) - ISNULL(AA.[26], 0) +ISNULL(BB.[27], 0) - ISNULL(AA.[27], 0) + ISNULL(BB.[28], 0) - ISNULL(AA.[28], 0) + ISNULL(BB.[29], 0) - ISNULL(AA.[29], 0) + ISNULL(BB.[30], 0) - ISNULL(AA.[30], 0) + 
				ISNULL(BB.[31], 0) - ISNULL(AA.[31], 0)) COUNT_SUM
				, ISNULL(BB.[01], 0) - ISNULL(AA.[01], 0) AS '01'
				, ISNULL(BB.[02], 0) - ISNULL(AA.[02], 0) AS '02'
				, ISNULL(BB.[03], 0) - ISNULL(AA.[03], 0) AS '03'
				, ISNULL(BB.[04], 0) - ISNULL(AA.[04], 0) AS '04'
				, ISNULL(BB.[05], 0) - ISNULL(AA.[05], 0) AS '05'
				, ISNULL(BB.[06], 0) - ISNULL(AA.[06], 0) AS '06'
				, ISNULL(BB.[07], 0) - ISNULL(AA.[07], 0) AS '07'
				, ISNULL(BB.[08], 0) - ISNULL(AA.[08], 0) AS '08'
				, ISNULL(BB.[09], 0) - ISNULL(AA.[09], 0) AS '09'
				, ISNULL(BB.[10], 0) - ISNULL(AA.[10], 0) AS '10'
				, ISNULL(BB.[11], 0) - ISNULL(AA.[11], 0) AS '11'
				, ISNULL(BB.[12], 0) - ISNULL(AA.[12], 0) AS '12'
				, ISNULL(BB.[13], 0) - ISNULL(AA.[13], 0) AS '13'
				, ISNULL(BB.[14], 0) - ISNULL(AA.[14], 0) AS '14'
				, ISNULL(BB.[15], 0) - ISNULL(AA.[15], 0) AS '15'
				, ISNULL(BB.[16], 0) - ISNULL(AA.[16], 0) AS '16'
				, ISNULL(BB.[17], 0) - ISNULL(AA.[17], 0) AS '17'
				, ISNULL(BB.[18], 0) - ISNULL(AA.[18], 0) AS '18'
				, ISNULL(BB.[19], 0) - ISNULL(AA.[19], 0) AS '19'
				, ISNULL(BB.[20], 0) - ISNULL(AA.[20], 0) AS '20'
				, ISNULL(BB.[21], 0) - ISNULL(AA.[21], 0) AS '21'
				, ISNULL(BB.[22], 0) - ISNULL(AA.[22], 0) AS '22'
				, ISNULL(BB.[23], 0) - ISNULL(AA.[23], 0) AS '23'
				, ISNULL(BB.[24], 0) - ISNULL(AA.[24], 0) AS '24'
				, ISNULL(BB.[25], 0) - ISNULL(AA.[25], 0) AS '25'
				, ISNULL(BB.[26], 0) - ISNULL(AA.[26], 0) AS '26'
				, ISNULL(BB.[27], 0) - ISNULL(AA.[27], 0) AS '27'
				, ISNULL(BB.[28], 0) - ISNULL(AA.[28], 0) AS '28'
				, ISNULL(BB.[29], 0) - ISNULL(AA.[29], 0) AS '29'
				, ISNULL(BB.[30], 0) - ISNULL(AA.[30], 0) AS '30'
				, ISNULL(BB.[31], 0) - ISNULL(AA.[31], 0) AS '31'
			FROM
				( 


				(
				SELECT '차이량' EQUIP_CD
					,'trash' GOODS_CD
					, '' COUNT_TYPE_NM
					, 0 COUNT_SUM
					,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
					,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
					,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
					,  '' AS '31'  				

				UNION ALL

				SELECT * FROM
				(SELECT		
				'차이량' EQUIP_CD
					,'000000' GOODS_CD
					, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) COUNT_TYPE_NM
					, 0 COUNT_SUM
					, SUM(CNT) CNT
					, PLAN_DATE
				FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
				WHERE 1=1
				AND A.EQUIP_CD = B.EQUIP_CD
				AND B.USE_YN_CD = '001'
				AND PLAN_DATE >= #{startDate}
				AND PLAN_DATE <= #{endDate}
				AND COUNT_TYPE_CD = '001'
				GROUP BY  A.COUNT_TYPE_CD, PLAN_DATE, CNT) AS AA
				PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList}) ) as result_pivot

									  ) 
				) AA FULL OUTER JOIN 	(			SELECT						
				'' EQUIP_CD,		
				GOODS_CD,							
				GUBUN,
				(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,
				  ISNULL([01],0) [01]
				, ISNULL([02],0) [02]
				, ISNULL([03],0) [03]
				, ISNULL([04],0) [04]
				, ISNULL([05],0) [05]
				, ISNULL([06],0) [06]
				, ISNULL([07],0) [07]
				, ISNULL([08],0) [08]
				, ISNULL([09],0) [09]
				, ISNULL([10],0) [10]
				, ISNULL([11],0) [11]
				, ISNULL([12],0) [12]
				, ISNULL([13],0) [13]
				, ISNULL([14],0) [14]
				, ISNULL([15],0) [15]
				, ISNULL([16],0) [16]
				, ISNULL([17],0) [17]
				, ISNULL([18],0) [18]
				, ISNULL([19],0) [19]
				, ISNULL([20],0) [20]
				, ISNULL([21],0) [21]
				, ISNULL([22],0) [22]
				, ISNULL([23],0) [23]
				, ISNULL([24],0) [24]
				, ISNULL([25],0) [25]
				, ISNULL([26],0) [26]
				, ISNULL([27],0) [27]
				, ISNULL([28],0) [28]
				, ISNULL([29],0) [29]
				, ISNULL([30],0) [30]
				, ISNULL([31],0) [31]
				FROM 				
				(
					SELECT *
							FROM (
							
								SELECT 							
									'' EQUIP_CD
									,ISNULL( AA.DAY_,'') DAY_
									,'XXXXXX' GOODS_CD								
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'당일합계' GUBUN
								FROM
								(
									SELECT
										A.EQUIP_CD
										, A.WORK_ORD_NO                     
										, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
										, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
										, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
										, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT
										, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
										, ISNULL(RE_SHIP_FAULTY_CNT,0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT
										B.EQUIP_CD
										, A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE, B.EQUIP_CD
										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									


								) AA
								GROUP BY AA.EQUIP_CD,DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA
				
		) BB  ON 1=1 WHERE AA.GOODS_CD != 'trash' 	

		UNION ALL
				
						SELECT
				NULL EQUIP_LINE_CD
			, '' EQUIP_LINE_NM
			, '333333' EQUIP_CD
			, '운영 차이량 총합' EQUIP_NM
			,  'ZZZZZZZ' GOODS_CD
			, '' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM
			,'운영 차이량' AS GUBUN
				, (ISNULL(BB.[01], 0) - ISNULL(AA.[01], 0) + ISNULL(BB.[02], 0) - ISNULL(AA.[02], 0) + ISNULL(BB.[03], 0) - ISNULL(AA.[03], 0) + ISNULL(BB.[04], 0) - ISNULL(AA.[04], 0) + ISNULL(BB.[05], 0) - ISNULL(AA.[05], 0) +
				ISNULL(BB.[06], 0) - ISNULL(AA.[06], 0) + ISNULL(BB.[07], 0) - ISNULL(AA.[07], 0) + ISNULL(BB.[08], 0) - ISNULL(AA.[08], 0) + ISNULL(BB.[09], 0) - ISNULL(AA.[09], 0) + ISNULL(BB.[10], 0) - ISNULL(AA.[10], 0) +
				ISNULL(BB.[11], 0) - ISNULL(AA.[11], 0) + ISNULL(BB.[12], 0) - ISNULL(AA.[12], 0) + ISNULL(BB.[13], 0) - ISNULL(AA.[13], 0) + ISNULL(BB.[14], 0) - ISNULL(AA.[14], 0) + ISNULL(BB.[15], 0) - ISNULL(AA.[15], 0) +
				ISNULL(BB.[16], 0) - ISNULL(AA.[16], 0) + ISNULL(BB.[17], 0) - ISNULL(AA.[17], 0) + ISNULL(BB.[18], 0) - ISNULL(AA.[18], 0) + ISNULL(BB.[19], 0) - ISNULL(AA.[19], 0) + ISNULL(BB.[20], 0) - ISNULL(AA.[20], 0) +
				ISNULL(BB.[21], 0) - ISNULL(AA.[21], 0) + ISNULL(BB.[22], 0) - ISNULL(AA.[22], 0) + ISNULL(BB.[23], 0) - ISNULL(AA.[23], 0) + ISNULL(BB.[24], 0) - ISNULL(AA.[24], 0) + ISNULL(BB.[25], 0) - ISNULL(AA.[25], 0) +
				ISNULL(BB.[26], 0) - ISNULL(AA.[26], 0) +ISNULL(BB.[27], 0) - ISNULL(AA.[27], 0) + ISNULL(BB.[28], 0) - ISNULL(AA.[28], 0) + ISNULL(BB.[29], 0) - ISNULL(AA.[29], 0) + ISNULL(BB.[30], 0) - ISNULL(AA.[30], 0) + 
				ISNULL(BB.[31], 0) - ISNULL(AA.[31], 0)) COUNT_SUM
				, ISNULL(BB.[01], 0) - ISNULL(AA.[01], 0) AS '01'
				, ISNULL(BB.[02], 0) - ISNULL(AA.[02], 0) AS '02'
				, ISNULL(BB.[03], 0) - ISNULL(AA.[03], 0) AS '03'
				, ISNULL(BB.[04], 0) - ISNULL(AA.[04], 0) AS '04'
				, ISNULL(BB.[05], 0) - ISNULL(AA.[05], 0) AS '05'
				, ISNULL(BB.[06], 0) - ISNULL(AA.[06], 0) AS '06'
				, ISNULL(BB.[07], 0) - ISNULL(AA.[07], 0) AS '07'
				, ISNULL(BB.[08], 0) - ISNULL(AA.[08], 0) AS '08'
				, ISNULL(BB.[09], 0) - ISNULL(AA.[09], 0) AS '09'
				, ISNULL(BB.[10], 0) - ISNULL(AA.[10], 0) AS '10'
				, ISNULL(BB.[11], 0) - ISNULL(AA.[11], 0) AS '11'
				, ISNULL(BB.[12], 0) - ISNULL(AA.[12], 0) AS '12'
				, ISNULL(BB.[13], 0) - ISNULL(AA.[13], 0) AS '13'
				, ISNULL(BB.[14], 0) - ISNULL(AA.[14], 0) AS '14'
				, ISNULL(BB.[15], 0) - ISNULL(AA.[15], 0) AS '15'
				, ISNULL(BB.[16], 0) - ISNULL(AA.[16], 0) AS '16'
				, ISNULL(BB.[17], 0) - ISNULL(AA.[17], 0) AS '17'
				, ISNULL(BB.[18], 0) - ISNULL(AA.[18], 0) AS '18'
				, ISNULL(BB.[19], 0) - ISNULL(AA.[19], 0) AS '19'
				, ISNULL(BB.[20], 0) - ISNULL(AA.[20], 0) AS '20'
				, ISNULL(BB.[21], 0) - ISNULL(AA.[21], 0) AS '21'
				, ISNULL(BB.[22], 0) - ISNULL(AA.[22], 0) AS '22'
				, ISNULL(BB.[23], 0) - ISNULL(AA.[23], 0) AS '23'
				, ISNULL(BB.[24], 0) - ISNULL(AA.[24], 0) AS '24'
				, ISNULL(BB.[25], 0) - ISNULL(AA.[25], 0) AS '25'
				, ISNULL(BB.[26], 0) - ISNULL(AA.[26], 0) AS '26'
				, ISNULL(BB.[27], 0) - ISNULL(AA.[27], 0) AS '27'
				, ISNULL(BB.[28], 0) - ISNULL(AA.[28], 0) AS '28'
				, ISNULL(BB.[29], 0) - ISNULL(AA.[29], 0) AS '29'
				, ISNULL(BB.[30], 0) - ISNULL(AA.[30], 0) AS '30'
				, ISNULL(BB.[31], 0) - ISNULL(AA.[31], 0) AS '31'
			FROM
				( 


				(
				SELECT '운영차이량' EQUIP_CD
					,'trash' GOODS_CD
					, '' COUNT_TYPE_NM
					, 0 COUNT_SUM
					,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
					,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
					,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
					,  '' AS '31'  				

				UNION ALL

				SELECT * FROM
				(SELECT		
				'운영차이량' EQUIP_CD
					,'000000' GOODS_CD
					, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) COUNT_TYPE_NM
					, 0 COUNT_SUM
					, SUM(CNT) CNT
					, PLAN_DATE
				FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
				WHERE 1=1
				AND A.EQUIP_CD = B.EQUIP_CD
				AND B.USE_YN_CD = '001'
				AND PLAN_DATE >= #{startDate}
				AND PLAN_DATE <= #{endDate}
				AND COUNT_TYPE_CD = '002'
				GROUP BY  A.COUNT_TYPE_CD, PLAN_DATE, CNT) AS AA
				PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList}) ) as result_pivot

									  ) 
				) AA FULL OUTER JOIN 	( 			SELECT						
				'' EQUIP_CD,		
				GOODS_CD,							
				GUBUN,
				(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,
				  ISNULL([01],0) [01]
				, ISNULL([02],0) [02]
				, ISNULL([03],0) [03]
				, ISNULL([04],0) [04]
				, ISNULL([05],0) [05]
				, ISNULL([06],0) [06]
				, ISNULL([07],0) [07]
				, ISNULL([08],0) [08]
				, ISNULL([09],0) [09]
				, ISNULL([10],0) [10]
				, ISNULL([11],0) [11]
				, ISNULL([12],0) [12]
				, ISNULL([13],0) [13]
				, ISNULL([14],0) [14]
				, ISNULL([15],0) [15]
				, ISNULL([16],0) [16]
				, ISNULL([17],0) [17]
				, ISNULL([18],0) [18]
				, ISNULL([19],0) [19]
				, ISNULL([20],0) [20]
				, ISNULL([21],0) [21]
				, ISNULL([22],0) [22]
				, ISNULL([23],0) [23]
				, ISNULL([24],0) [24]
				, ISNULL([25],0) [25]
				, ISNULL([26],0) [26]
				, ISNULL([27],0) [27]
				, ISNULL([28],0) [28]
				, ISNULL([29],0) [29]
				, ISNULL([30],0) [30]
				, ISNULL([31],0) [31]
				FROM 				
				(
					SELECT *
							FROM (
							
								SELECT 							
									'' EQUIP_CD
									,ISNULL( AA.DAY_,'') DAY_
									,'XXXXXX' GOODS_CD								
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'당일합계' GUBUN
								FROM
								(
									SELECT
										A.EQUIP_CD
										, A.WORK_ORD_NO                     
										, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
										, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
										, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
										, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT
										, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
										, ISNULL(RE_SHIP_FAULTY_CNT,0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT
										B.EQUIP_CD
										, A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE, B.EQUIP_CD
										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									


								) AA
								GROUP BY AA.EQUIP_CD,DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA
				
		) BB  ON 1=1 WHERE AA.GOODS_CD != 'trash'
		ORDER BY B.EQUIP_NM ASC, AAA.GOODS_CD ASC
	]]>
		<!-- ORDER BY AAA.EQUIP_CD ASC, AAA.GOODS_CD ASC -->
		
	</select>
	
	<!-- 공정실적관리(POP)/작업지시선택 - 작업지시 동적추가 -->
	<select id="equipWorkOrdPlanList" resultMap="WorkOrderPlanVo">
		<![CDATA[
			SELECT
				A.EQUIP_COND_SEQ
				, A.EQUIP_CD
				, B.EQUIP_NM
				, A.GOODS_CD
				, C.GOODS_NM
				, C.MODEL
				, D.QUTY_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='007' AND B.BASE_CD = D.QUTY_CD) QUTY_NM
				, D.SURFACE_TRTMT_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='021' AND B.BASE_CD = D.SURFACE_TRTMT_CD) SURFACE_TRTMT_NM
				, A.WORK_GUBUN_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='028' AND B.BASE_CD = A.WORK_GUBUN_CD) WORK_GUBUN_NM
				, A.PLAN_REG_DATE
				, A.EQUIP_CD
			FROM TB_WORK_ORDER_PLAN A, TB_EQUIP_CODE_ADM B, TB_GOODS_CODE_ADM C, TB_MATRL_CODE_ADM D
			WHERE A.EQUIP_CD = B.EQUIP_CD
			AND A.GOODS_CD = C.GOODS_CD
			AND C.ALNICU_MATRL_CD = D.MATRL_CD
			AND B.USE_YN_CD = '001'
			AND A.PLAN_REG_DATE = #{planRegDate}
			AND A.EQUIP_CD = #{equipCd}
			ORDER BY A.WORK_GUBUN_CD
		]]>
	</select>
	
	
	<!-- 월별 FP 메모 조회 -->
	<select id="memoList" resultMap="MonthProductPresentVo">
		<![CDATA[
			SELECT EQUIP_CD
			      ,PLAN_DATE
			      ,MEMO			    
			FROM TB_PRODUCTION_PLAN_MEMO
			WHERE EQUIP_CD = #{equipCd}
			AND PLAN_DATE = #{planDate}
		]]>
	</select>
	
	<!-- 메모 수정 -->
	<update id="memoUpdate">
		<![CDATA[
			UPDATE TB_PRODUCTION_PLAN_MEMO		 
			SET
				MEMO = #{memo}		
				,UPD_ID = #{updId}
				,UPD_DATE = getDate()	
			WHERE
				EQUIP_CD = #{equipCd}
				AND PLAN_DATE = #{planDate}
			
		]]>
	</update>
	
	<!-- 메모 등록 -->
	<insert id="memoCreate">
		<![CDATA[
			INSERT INTO TB_PRODUCTION_PLAN_MEMO (
				EQUIP_CD
				, PLAN_DATE
				, MEMO				
				, REG_ID
				, REG_DATE
				
				) 
			VALUES(
				#{equipCd}				
				, #{planDate}
				, #{memo}
				, #{regId}
				, getDate()				
			)
			
		]]>
	</insert>
	
	<!-- 메모 삭제-->
	<delete id="memoDelete">
		<![CDATA[
			DELETE	TB_PRODUCTION_PLAN_MEMO
			WHERE
				EQUIP_CD = #{equipCd}
				AND PLAN_DATE = #{planDate}
		]]>
	</delete>
	
	<!-- 월별 FP현황 조회(List) -->
	<select id="readMonthProductPresentBody2" resultMap="MonthProductPresentVo">
		<![CDATA[		

		SET ANSI_WARNINGS OFF
		SET ARITHIGNORE ON
		SET ARITHABORT OFF
	
		SELECT			
			AAA.GOODS_CD
			, AAA.GOODS_NM
			, D.QUTY_CD
			, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE FF WHERE FF.BASE_GROUP_CD='007' AND FF.BASE_CD = D.QUTY_CD) QUTY_NM
			, AAA.GUBUN
			, COUNT_SUM
			, AAA.[01] AS COUNT1
			, AAA.[02] AS COUNT2
			, AAA.[03] AS COUNT3
			, AAA.[04] AS COUNT4
			, AAA.[05] AS COUNT5
			, AAA.[06] AS COUNT6
			, AAA.[07] AS COUNT7
			, AAA.[08] AS COUNT8
			, AAA.[09] AS COUNT9
			, AAA.[10] AS COUNT10
			, AAA.[11] AS COUNT11
			, AAA.[12] AS COUNT12
			, AAA.[13] AS COUNT13
			, AAA.[14] AS COUNT14
			, AAA.[15] AS COUNT15
			, AAA.[16] AS COUNT16
			, AAA.[17] AS COUNT17
			, AAA.[18] AS COUNT18
			, AAA.[19] AS COUNT19
			, AAA.[20] AS COUNT20
			, AAA.[21] AS COUNT21
			, AAA.[22] AS COUNT22
			, AAA.[23] AS COUNT23
			, AAA.[24] AS COUNT24
			, AAA.[25] AS COUNT25
			, AAA.[26] AS COUNT26
			, AAA.[27] AS COUNT27
			, AAA.[28] AS COUNT28
			, AAA.[29] AS COUNT29
			, AAA.[30] AS COUNT30
			, AAA.[31] AS COUNT31	
		FROM 
			(
			 					SELECT						
				
				GOODS_CD,
				(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM X WHERE X.GOODS_CD = AA.GOODS_CD) GOODS_NM,
				GUBUN,
				(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,
				  ISNULL([01],0) [01]
				, ISNULL([02],0) [02]
				, ISNULL([03],0) [03]
				, ISNULL([04],0) [04]
				, ISNULL([05],0) [05]
				, ISNULL([06],0) [06]
				, ISNULL([07],0) [07]
				, ISNULL([08],0) [08]
				, ISNULL([09],0) [09]
				, ISNULL([10],0) [10]
				, ISNULL([11],0) [11]
				, ISNULL([12],0) [12]
				, ISNULL([13],0) [13]
				, ISNULL([14],0) [14]
				, ISNULL([15],0) [15]
				, ISNULL([16],0) [16]
				, ISNULL([17],0) [17]
				, ISNULL([18],0) [18]
				, ISNULL([19],0) [19]
				, ISNULL([20],0) [20]
				, ISNULL([21],0) [21]
				, ISNULL([22],0) [22]
				, ISNULL([23],0) [23]
				, ISNULL([24],0) [24]
				, ISNULL([25],0) [25]
				, ISNULL([26],0) [26]
				, ISNULL([27],0) [27]
				, ISNULL([28],0) [28]
				, ISNULL([29],0) [29]
				, ISNULL([30],0) [30]
				, ISNULL([31],0) [31]
				FROM 		
				(
					SELECT *
							FROM (
							
								SELECT 					
								
									ISNULL( AA.DAY_,'') DAY_
									, GOODS_CD								
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'당월 합계' GUBUN
								FROM
								(
									SELECT
										A.GOODS_CD
										, A.WORK_ORD_NO                     
										, ISNULL(SUM(CC.FAULTY_CNT),0) AS APPEAR_FAULTY_CNT
										, ISNULL(SUM(A.APPEAR_OUTPUT_CNT),0) AS APPEAR_OUTPUT_CNT								
										, ISNULL(SUM(B.E_FAULTY_CNT),0) AS E_FAULTY_CNT
										, ISNULL(SUM(SHIP_FAULTY_CNT),0) AS SHIP_FAULTY_CNT
										, ISNULL(SUM(RE_SHIP_FAULTY_CNT),0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT
										B.GOODS_CD
										, A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE, B.GOODS_CD
										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT					
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									
									GROUP BY A.GOODS_CD
										, A.WORK_ORD_NO   
										,A.WORK_ORD_DATE

								) AA
								GROUP BY AA.GOODS_CD,DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA 
				
	
			UNION ALL
			
							SELECT						
				
				'N999999' GOODS_CD, 'NICU 합계' GOODS_NM, 'NICU 합계' GUBUN,
				(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,
				  ISNULL([01],0) [01]
				, ISNULL([02],0) [02]
				, ISNULL([03],0) [03]
				, ISNULL([04],0) [04]
				, ISNULL([05],0) [05]
				, ISNULL([06],0) [06]
				, ISNULL([07],0) [07]
				, ISNULL([08],0) [08]
				, ISNULL([09],0) [09]
				, ISNULL([10],0) [10]
				, ISNULL([11],0) [11]
				, ISNULL([12],0) [12]
				, ISNULL([13],0) [13]
				, ISNULL([14],0) [14]
				, ISNULL([15],0) [15]
				, ISNULL([16],0) [16]
				, ISNULL([17],0) [17]
				, ISNULL([18],0) [18]
				, ISNULL([19],0) [19]
				, ISNULL([20],0) [20]
				, ISNULL([21],0) [21]
				, ISNULL([22],0) [22]
				, ISNULL([23],0) [23]
				, ISNULL([24],0) [24]
				, ISNULL([25],0) [25]
				, ISNULL([26],0) [26]
				, ISNULL([27],0) [27]
				, ISNULL([28],0) [28]
				, ISNULL([29],0) [29]
				, ISNULL([30],0) [30]
				, ISNULL([31],0) [31]
				FROM 		
				(
					SELECT *
							FROM (
							
								SELECT 					
								
									ISNULL( AA.DAY_,'') DAY_																	
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'당월 합계' GUBUN
								FROM
								(
									SELECT
										A.WORK_ORD_NO                     
										, ISNULL(SUM(CC.FAULTY_CNT),0) AS APPEAR_FAULTY_CNT
										, ISNULL(SUM(A.APPEAR_OUTPUT_CNT),0) AS APPEAR_OUTPUT_CNT								
										, ISNULL(SUM(B.E_FAULTY_CNT),0) AS E_FAULTY_CNT
										, ISNULL(SUM(SHIP_FAULTY_CNT),0) AS SHIP_FAULTY_CNT
										, ISNULL(SUM(RE_SHIP_FAULTY_CNT),0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT
										B.GOODS_CD
										, A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
										
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									 AND LEFT(B.GOODS_CD,1) = 'N'
									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE, B.GOODS_CD
										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT					
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									
									GROUP BY A.WORK_ORD_NO   
										,A.WORK_ORD_DATE

								) AA
								GROUP BY DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA 
				
	

			
				UNION ALL

					SELECT  'A999999' GOODS_CD,'AL합계' GOODS_NM, 'AL 합계' GUBUN,							
				(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,
				  ISNULL([01],0) [01]
				, ISNULL([02],0) [02]
				, ISNULL([03],0) [03]
				, ISNULL([04],0) [04]
				, ISNULL([05],0) [05]
				, ISNULL([06],0) [06]
				, ISNULL([07],0) [07]
				, ISNULL([08],0) [08]
				, ISNULL([09],0) [09]
				, ISNULL([10],0) [10]
				, ISNULL([11],0) [11]
				, ISNULL([12],0) [12]
				, ISNULL([13],0) [13]
				, ISNULL([14],0) [14]
				, ISNULL([15],0) [15]
				, ISNULL([16],0) [16]
				, ISNULL([17],0) [17]
				, ISNULL([18],0) [18]
				, ISNULL([19],0) [19]
				, ISNULL([20],0) [20]
				, ISNULL([21],0) [21]
				, ISNULL([22],0) [22]
				, ISNULL([23],0) [23]
				, ISNULL([24],0) [24]
				, ISNULL([25],0) [25]
				, ISNULL([26],0) [26]
				, ISNULL([27],0) [27]
				, ISNULL([28],0) [28]
				, ISNULL([29],0) [29]
				, ISNULL([30],0) [30]
				, ISNULL([31],0) [31]
				FROM 		
				(
					SELECT *
							FROM (
							
								SELECT 					
								
									ISNULL( AA.DAY_,'') DAY_
																
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'당월 합계' GUBUN
								FROM
								(
									SELECT
										 A.WORK_ORD_NO                     
										, ISNULL(SUM(CC.FAULTY_CNT),0) AS APPEAR_FAULTY_CNT
										, ISNULL(SUM(A.APPEAR_OUTPUT_CNT),0) AS APPEAR_OUTPUT_CNT								
										, ISNULL(SUM(B.E_FAULTY_CNT),0) AS E_FAULTY_CNT
										, ISNULL(SUM(SHIP_FAULTY_CNT),0) AS SHIP_FAULTY_CNT
										, ISNULL(SUM(RE_SHIP_FAULTY_CNT),0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT
										B.GOODS_CD
										, A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
										
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									 AND LEFT(B.GOODS_CD,1) = 'A'
									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE, B.GOODS_CD
										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT					
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									
									GROUP BY 
										 A.WORK_ORD_NO   
										,A.WORK_ORD_DATE

								) AA
								GROUP BY DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA 
				
	
		
			UNION ALL

							SELECT						
				
				'O 999999' GOODS_CD
				, '당월 합계' GOODS_NM				
				, '당월 합계' GUBUN
				,(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,
				  ISNULL([01],0) [01]
				, ISNULL([02],0) [02]
				, ISNULL([03],0) [03]
				, ISNULL([04],0) [04]
				, ISNULL([05],0) [05]
				, ISNULL([06],0) [06]
				, ISNULL([07],0) [07]
				, ISNULL([08],0) [08]
				, ISNULL([09],0) [09]
				, ISNULL([10],0) [10]
				, ISNULL([11],0) [11]
				, ISNULL([12],0) [12]
				, ISNULL([13],0) [13]
				, ISNULL([14],0) [14]
				, ISNULL([15],0) [15]
				, ISNULL([16],0) [16]
				, ISNULL([17],0) [17]
				, ISNULL([18],0) [18]
				, ISNULL([19],0) [19]
				, ISNULL([20],0) [20]
				, ISNULL([21],0) [21]
				, ISNULL([22],0) [22]
				, ISNULL([23],0) [23]
				, ISNULL([24],0) [24]
				, ISNULL([25],0) [25]
				, ISNULL([26],0) [26]
				, ISNULL([27],0) [27]
				, ISNULL([28],0) [28]
				, ISNULL([29],0) [29]
				, ISNULL([30],0) [30]
				, ISNULL([31],0) [31]
				FROM 		
				(
					SELECT *
							FROM (
							
								SELECT 					
								
									ISNULL( AA.DAY_,'') DAY_																
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'당월 합계' GUBUN
								FROM
								(
									SELECT
										 A.WORK_ORD_NO                     
										, ISNULL(SUM(CC.FAULTY_CNT),0) AS APPEAR_FAULTY_CNT
										, ISNULL(SUM(A.APPEAR_OUTPUT_CNT),0) AS APPEAR_OUTPUT_CNT								
										, ISNULL(SUM(B.E_FAULTY_CNT),0) AS E_FAULTY_CNT
										, ISNULL(SUM(SHIP_FAULTY_CNT),0) AS SHIP_FAULTY_CNT
										, ISNULL(SUM(RE_SHIP_FAULTY_CNT),0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT										
										 A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
										
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO

									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE
										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT					
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									
									GROUP BY 
										 A.WORK_ORD_NO   
										,A.WORK_ORD_DATE

								) AA
								GROUP BY DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA 
				
	
			
			) AAA LEFT OUTER JOIN TB_GOODS_CODE_ADM C ON AAA.GOODS_CD = C.GOODS_CD
				LEFT OUTER JOIN TB_MATRL_CODE_ADM D ON C.ALNICU_MATRL_CD = D.MATRL_CD

		
		UNION ALL

	 SELECT
					
					'WWWWWW' GOODS_CD
					, '변경운영계획 Total' GOODS_NM
					, '' QUTY_CD
					, '' QUTY_NM							
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) GUBUN			
				, (ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
							ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
							ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
							ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
							ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
							ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
							ISNULL([31],0)) AS COUNT_SUM
					,  ISNULL(([01]),0) '01', ISNULL(([02]),0) '02', ISNULL(([03]),0) '03', ISNULL(([04]),0) '04', ISNULL(([05]),0) '05', ISNULL(([06]),0) '06', ISNULL(([07]),0) '07', ISNULL(([08]),0) '08', ISNULL(([09]),0) '09', ISNULL(([10]),0) '10'
					,  ISNULL(([11]),0) '11', ISNULL(([12]),0) '12', ISNULL(([13]),0) '13', ISNULL(([14]),0) '14', ISNULL(([15]),0) '15', ISNULL(([16]),0) '16', ISNULL(([17]),0) '17', ISNULL(([18]),0) '18', ISNULL(([19]),0) '19', ISNULL(([20]),0) '20'
					,  ISNULL(([21]),0) '21', ISNULL(([22]),0) '22', ISNULL(([23]),0) '23', ISNULL(([24]),0) '24', ISNULL(([25]),0) '25', ISNULL(([26]),0) '26', ISNULL(([27]),0) '27', ISNULL(([28]),0) '28', ISNULL(([29]),0) '29', ISNULL(([30]),0) '30'
					, ISNULL(([31]),0) '31'
				
				FROM
 (
		SELECT 
		
			
			'trash' GOODS_CD
			, '' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM
			, '' COUNT_TYPE_CD
			, '' GUBUN
			, 0 COUNT_SUM
			,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
			,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
			,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
			,  '' AS '31'  				

		UNION ALL


		SELECT * FROM
		(
				SELECT
				
					 'VVVVVV' GOODS_CD
					, '' GOODS_NM
					, '' QUTY_CD
					, '' QUTY_NM		
					, COUNT_TYPE_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) GUBUN
				, 0 COUNT_SUM

				, SUM(CNT) CNT
				, PLAN_DATE
			FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
			WHERE 1=1
			AND A.EQUIP_CD = B.EQUIP_CD
			AND B.USE_YN_CD = '001'
			AND PLAN_DATE >= #{startDate}
			AND PLAN_DATE <= #{endDate}
			AND COUNT_TYPE_CD = '002'
			GROUP BY  A.COUNT_TYPE_CD, PLAN_DATE, CNT) A
			PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList}) ) as result_pivot
			) A
			WHERE GOODS_CD != 'trash'

	UNION ALL

	 SELECT 					
				 'VVVVVV' GOODS_CD
				, '확정판 계획 Total' GOODS_NM	
				, '' QUTY_CD
				, '' QUTY_NM
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) GUBUN			
				, (ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
							ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
							ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
							ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
							ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
							ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
							ISNULL([31],0)) AS COUNT_SUM
					,  ISNULL(([01]),0) '01', ISNULL(([02]),0) '02', ISNULL(([03]),0) '03', ISNULL(([04]),0) '04', ISNULL(([05]),0) '05', ISNULL(([06]),0) '06', ISNULL(([07]),0) '07', ISNULL(([08]),0) '08', ISNULL(([09]),0) '09', ISNULL(([10]),0) '10'
					,  ISNULL(([11]),0) '11', ISNULL(([12]),0) '12', ISNULL(([13]),0) '13', ISNULL(([14]),0) '14', ISNULL(([15]),0) '15', ISNULL(([16]),0) '16', ISNULL(([17]),0) '17', ISNULL(([18]),0) '18', ISNULL(([19]),0) '19', ISNULL(([20]),0) '20'
					,  ISNULL(([21]),0) '21', ISNULL(([22]),0) '22', ISNULL(([23]),0) '23', ISNULL(([24]),0) '24', ISNULL(([25]),0) '25', ISNULL(([26]),0) '26', ISNULL(([27]),0) '27', ISNULL(([28]),0) '28', ISNULL(([29]),0) '29', ISNULL(([30]),0) '30'
					, ISNULL(([31]),0) '31'
				
				FROM
		(
		SELECT 
			'trash' GOODS_CD
			, '' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM
			, '' COUNT_TYPE_CD
			, '' GUBUN
			, 0 COUNT_SUM
			,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
			,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
			,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
			,  '' AS '31'  				

		UNION ALL


		SELECT * FROM
		(
				SELECT 
					 '000000' GOODS_CD
					, '' GOODS_NM
					, '' QUTY_CD
					, '' QUTY_NM		
					, COUNT_TYPE_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) GUBUN
				, 0 COUNT_SUM

				, SUM(CNT) CNT
				, PLAN_DATE
			FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
			WHERE 1=1
			AND A.EQUIP_CD = B.EQUIP_CD
			AND B.USE_YN_CD = '001'
			AND PLAN_DATE >= #{startDate}
			AND PLAN_DATE <= #{endDate}
			AND COUNT_TYPE_CD = '001'
			GROUP BY  A.COUNT_TYPE_CD, PLAN_DATE, CNT) A
			PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList}) ) as result_pivot
			) A
			WHERE GOODS_CD != 'trash'
			
		UNION ALL

			SELECT
			  'ZZZZZZ' GOODS_CD
			, '확정판 계획대비 차이수량' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM
			,'확정 차이량' AS GUBUN
				, (ISNULL(BB.[01], 0) - ISNULL(AA.[01], 0) + ISNULL(BB.[02], 0) - ISNULL(AA.[02], 0) + ISNULL(BB.[03], 0) - ISNULL(AA.[03], 0) + ISNULL(BB.[04], 0) - ISNULL(AA.[04], 0) + ISNULL(BB.[05], 0) - ISNULL(AA.[05], 0) +
				ISNULL(BB.[06], 0) - ISNULL(AA.[06], 0) + ISNULL(BB.[07], 0) - ISNULL(AA.[07], 0) + ISNULL(BB.[08], 0) - ISNULL(AA.[08], 0) + ISNULL(BB.[09], 0) - ISNULL(AA.[09], 0) + ISNULL(BB.[10], 0) - ISNULL(AA.[10], 0) +
				ISNULL(BB.[11], 0) - ISNULL(AA.[11], 0) + ISNULL(BB.[12], 0) - ISNULL(AA.[12], 0) + ISNULL(BB.[13], 0) - ISNULL(AA.[13], 0) + ISNULL(BB.[14], 0) - ISNULL(AA.[14], 0) + ISNULL(BB.[15], 0) - ISNULL(AA.[15], 0) +
				ISNULL(BB.[16], 0) - ISNULL(AA.[16], 0) + ISNULL(BB.[17], 0) - ISNULL(AA.[17], 0) + ISNULL(BB.[18], 0) - ISNULL(AA.[18], 0) + ISNULL(BB.[19], 0) - ISNULL(AA.[19], 0) + ISNULL(BB.[20], 0) - ISNULL(AA.[20], 0) +
				ISNULL(BB.[21], 0) - ISNULL(AA.[21], 0) + ISNULL(BB.[22], 0) - ISNULL(AA.[22], 0) + ISNULL(BB.[23], 0) - ISNULL(AA.[23], 0) + ISNULL(BB.[24], 0) - ISNULL(AA.[24], 0) + ISNULL(BB.[25], 0) - ISNULL(AA.[25], 0) +
				ISNULL(BB.[26], 0) - ISNULL(AA.[26], 0) +ISNULL(BB.[27], 0) - ISNULL(AA.[27], 0) + ISNULL(BB.[28], 0) - ISNULL(AA.[28], 0) + ISNULL(BB.[29], 0) - ISNULL(AA.[29], 0) + ISNULL(BB.[30], 0) - ISNULL(AA.[30], 0) + 
				ISNULL(BB.[31], 0) - ISNULL(AA.[31], 0)) COUNT_SUM
				, ISNULL(BB.[01], 0) - ISNULL(AA.[01], 0) AS '01'
				, ISNULL(BB.[02], 0) - ISNULL(AA.[02], 0) AS '02'
				, ISNULL(BB.[03], 0) - ISNULL(AA.[03], 0) AS '03'
				, ISNULL(BB.[04], 0) - ISNULL(AA.[04], 0) AS '04'
				, ISNULL(BB.[05], 0) - ISNULL(AA.[05], 0) AS '05'
				, ISNULL(BB.[06], 0) - ISNULL(AA.[06], 0) AS '06'
				, ISNULL(BB.[07], 0) - ISNULL(AA.[07], 0) AS '07'
				, ISNULL(BB.[08], 0) - ISNULL(AA.[08], 0) AS '08'
				, ISNULL(BB.[09], 0) - ISNULL(AA.[09], 0) AS '09'
				, ISNULL(BB.[10], 0) - ISNULL(AA.[10], 0) AS '10'
				, ISNULL(BB.[11], 0) - ISNULL(AA.[11], 0) AS '11'
				, ISNULL(BB.[12], 0) - ISNULL(AA.[12], 0) AS '12'
				, ISNULL(BB.[13], 0) - ISNULL(AA.[13], 0) AS '13'
				, ISNULL(BB.[14], 0) - ISNULL(AA.[14], 0) AS '14'
				, ISNULL(BB.[15], 0) - ISNULL(AA.[15], 0) AS '15'
				, ISNULL(BB.[16], 0) - ISNULL(AA.[16], 0) AS '16'
				, ISNULL(BB.[17], 0) - ISNULL(AA.[17], 0) AS '17'
				, ISNULL(BB.[18], 0) - ISNULL(AA.[18], 0) AS '18'
				, ISNULL(BB.[19], 0) - ISNULL(AA.[19], 0) AS '19'
				, ISNULL(BB.[20], 0) - ISNULL(AA.[20], 0) AS '20'
				, ISNULL(BB.[21], 0) - ISNULL(AA.[21], 0) AS '21'
				, ISNULL(BB.[22], 0) - ISNULL(AA.[22], 0) AS '22'
				, ISNULL(BB.[23], 0) - ISNULL(AA.[23], 0) AS '23'
				, ISNULL(BB.[24], 0) - ISNULL(AA.[24], 0) AS '24'
				, ISNULL(BB.[25], 0) - ISNULL(AA.[25], 0) AS '25'
				, ISNULL(BB.[26], 0) - ISNULL(AA.[26], 0) AS '26'
				, ISNULL(BB.[27], 0) - ISNULL(AA.[27], 0) AS '27'
				, ISNULL(BB.[28], 0) - ISNULL(AA.[28], 0) AS '28'
				, ISNULL(BB.[29], 0) - ISNULL(AA.[29], 0) AS '29'
				, ISNULL(BB.[30], 0) - ISNULL(AA.[30], 0) AS '30'
				, ISNULL(BB.[31], 0) - ISNULL(AA.[31], 0) AS '31'
			FROM
				( 


				(
				SELECT '차이량' EQUIP_CD
					,'trash' GOODS_CD
					, '' COUNT_TYPE_NM
					, 0 COUNT_SUM
					,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
					,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
					,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
					,  '' AS '31'  				

				UNION ALL

				SELECT * FROM
				(SELECT		
				'차이량' EQUIP_CD
					,'000000' GOODS_CD
					, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) COUNT_TYPE_NM
					, 0 COUNT_SUM
					, SUM(CNT) CNT
					, PLAN_DATE
				FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
				WHERE 1=1
				AND A.EQUIP_CD = B.EQUIP_CD
				AND B.USE_YN_CD = '001'
				AND PLAN_DATE >= #{startDate}
				AND PLAN_DATE <= #{endDate}
				AND COUNT_TYPE_CD = '001'
				GROUP BY  A.COUNT_TYPE_CD, PLAN_DATE, CNT) AS AA
				PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList}) ) as result_pivot

									  ) 
				) AA FULL OUTER JOIN 	( 				SELECT						
				
				'XXXXXX' GOODS_CD, '당월 합계' GUBUN
				,(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,
				  ISNULL([01],0) [01]
				, ISNULL([02],0) [02]
				, ISNULL([03],0) [03]
				, ISNULL([04],0) [04]
				, ISNULL([05],0) [05]
				, ISNULL([06],0) [06]
				, ISNULL([07],0) [07]
				, ISNULL([08],0) [08]
				, ISNULL([09],0) [09]
				, ISNULL([10],0) [10]
				, ISNULL([11],0) [11]
				, ISNULL([12],0) [12]
				, ISNULL([13],0) [13]
				, ISNULL([14],0) [14]
				, ISNULL([15],0) [15]
				, ISNULL([16],0) [16]
				, ISNULL([17],0) [17]
				, ISNULL([18],0) [18]
				, ISNULL([19],0) [19]
				, ISNULL([20],0) [20]
				, ISNULL([21],0) [21]
				, ISNULL([22],0) [22]
				, ISNULL([23],0) [23]
				, ISNULL([24],0) [24]
				, ISNULL([25],0) [25]
				, ISNULL([26],0) [26]
				, ISNULL([27],0) [27]
				, ISNULL([28],0) [28]
				, ISNULL([29],0) [29]
				, ISNULL([30],0) [30]
				, ISNULL([31],0) [31]
				FROM 		
				(
					SELECT *
							FROM (
							
								SELECT 					
								
									ISNULL( AA.DAY_,'') DAY_																
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'당월 합계' GUBUN
								FROM
								(
									SELECT
										 A.WORK_ORD_NO                     
										, ISNULL(SUM(CC.FAULTY_CNT),0) AS APPEAR_FAULTY_CNT
										, ISNULL(SUM(A.APPEAR_OUTPUT_CNT),0) AS APPEAR_OUTPUT_CNT								
										, ISNULL(SUM(B.E_FAULTY_CNT),0) AS E_FAULTY_CNT
										, ISNULL(SUM(SHIP_FAULTY_CNT),0) AS SHIP_FAULTY_CNT
										, ISNULL(SUM(RE_SHIP_FAULTY_CNT),0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT										
										 A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
										
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO

									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE
										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT					
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									
									GROUP BY 
										 A.WORK_ORD_NO   
										,A.WORK_ORD_DATE

								) AA
								GROUP BY DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA 
				
	
		) BB  ON 1=1 WHERE AA.GOODS_CD != 'trash' 	

		UNION ALL
				
				SELECT
				  'ZZZZZZZ' GOODS_CD
			, '변경운영계획대비 차이수량' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM
			,'운영 차이량' AS GUBUN
				, (ISNULL(BB.[01], 0) - ISNULL(AA.[01], 0) + ISNULL(BB.[02], 0) - ISNULL(AA.[02], 0) + ISNULL(BB.[03], 0) - ISNULL(AA.[03], 0) + ISNULL(BB.[04], 0) - ISNULL(AA.[04], 0) + ISNULL(BB.[05], 0) - ISNULL(AA.[05], 0) +
				ISNULL(BB.[06], 0) - ISNULL(AA.[06], 0) + ISNULL(BB.[07], 0) - ISNULL(AA.[07], 0) + ISNULL(BB.[08], 0) - ISNULL(AA.[08], 0) + ISNULL(BB.[09], 0) - ISNULL(AA.[09], 0) + ISNULL(BB.[10], 0) - ISNULL(AA.[10], 0) +
				ISNULL(BB.[11], 0) - ISNULL(AA.[11], 0) + ISNULL(BB.[12], 0) - ISNULL(AA.[12], 0) + ISNULL(BB.[13], 0) - ISNULL(AA.[13], 0) + ISNULL(BB.[14], 0) - ISNULL(AA.[14], 0) + ISNULL(BB.[15], 0) - ISNULL(AA.[15], 0) +
				ISNULL(BB.[16], 0) - ISNULL(AA.[16], 0) + ISNULL(BB.[17], 0) - ISNULL(AA.[17], 0) + ISNULL(BB.[18], 0) - ISNULL(AA.[18], 0) + ISNULL(BB.[19], 0) - ISNULL(AA.[19], 0) + ISNULL(BB.[20], 0) - ISNULL(AA.[20], 0) +
				ISNULL(BB.[21], 0) - ISNULL(AA.[21], 0) + ISNULL(BB.[22], 0) - ISNULL(AA.[22], 0) + ISNULL(BB.[23], 0) - ISNULL(AA.[23], 0) + ISNULL(BB.[24], 0) - ISNULL(AA.[24], 0) + ISNULL(BB.[25], 0) - ISNULL(AA.[25], 0) +
				ISNULL(BB.[26], 0) - ISNULL(AA.[26], 0) +ISNULL(BB.[27], 0) - ISNULL(AA.[27], 0) + ISNULL(BB.[28], 0) - ISNULL(AA.[28], 0) + ISNULL(BB.[29], 0) - ISNULL(AA.[29], 0) + ISNULL(BB.[30], 0) - ISNULL(AA.[30], 0) + 
				ISNULL(BB.[31], 0) - ISNULL(AA.[31], 0)) COUNT_SUM
				, ISNULL(BB.[01], 0) - ISNULL(AA.[01], 0) AS '01'
				, ISNULL(BB.[02], 0) - ISNULL(AA.[02], 0) AS '02'
				, ISNULL(BB.[03], 0) - ISNULL(AA.[03], 0) AS '03'
				, ISNULL(BB.[04], 0) - ISNULL(AA.[04], 0) AS '04'
				, ISNULL(BB.[05], 0) - ISNULL(AA.[05], 0) AS '05'
				, ISNULL(BB.[06], 0) - ISNULL(AA.[06], 0) AS '06'
				, ISNULL(BB.[07], 0) - ISNULL(AA.[07], 0) AS '07'
				, ISNULL(BB.[08], 0) - ISNULL(AA.[08], 0) AS '08'
				, ISNULL(BB.[09], 0) - ISNULL(AA.[09], 0) AS '09'
				, ISNULL(BB.[10], 0) - ISNULL(AA.[10], 0) AS '10'
				, ISNULL(BB.[11], 0) - ISNULL(AA.[11], 0) AS '11'
				, ISNULL(BB.[12], 0) - ISNULL(AA.[12], 0) AS '12'
				, ISNULL(BB.[13], 0) - ISNULL(AA.[13], 0) AS '13'
				, ISNULL(BB.[14], 0) - ISNULL(AA.[14], 0) AS '14'
				, ISNULL(BB.[15], 0) - ISNULL(AA.[15], 0) AS '15'
				, ISNULL(BB.[16], 0) - ISNULL(AA.[16], 0) AS '16'
				, ISNULL(BB.[17], 0) - ISNULL(AA.[17], 0) AS '17'
				, ISNULL(BB.[18], 0) - ISNULL(AA.[18], 0) AS '18'
				, ISNULL(BB.[19], 0) - ISNULL(AA.[19], 0) AS '19'
				, ISNULL(BB.[20], 0) - ISNULL(AA.[20], 0) AS '20'
				, ISNULL(BB.[21], 0) - ISNULL(AA.[21], 0) AS '21'
				, ISNULL(BB.[22], 0) - ISNULL(AA.[22], 0) AS '22'
				, ISNULL(BB.[23], 0) - ISNULL(AA.[23], 0) AS '23'
				, ISNULL(BB.[24], 0) - ISNULL(AA.[24], 0) AS '24'
				, ISNULL(BB.[25], 0) - ISNULL(AA.[25], 0) AS '25'
				, ISNULL(BB.[26], 0) - ISNULL(AA.[26], 0) AS '26'
				, ISNULL(BB.[27], 0) - ISNULL(AA.[27], 0) AS '27'
				, ISNULL(BB.[28], 0) - ISNULL(AA.[28], 0) AS '28'
				, ISNULL(BB.[29], 0) - ISNULL(AA.[29], 0) AS '29'
				, ISNULL(BB.[30], 0) - ISNULL(AA.[30], 0) AS '30'
				, ISNULL(BB.[31], 0) - ISNULL(AA.[31], 0) AS '31'
			FROM
				( 


				(
				SELECT '운영차이량' EQUIP_CD
					,'trash' GOODS_CD
					, '' COUNT_TYPE_NM
					, 0 COUNT_SUM
					,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
					,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
					,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
					,  '' AS '31'  				

				UNION ALL

				SELECT * FROM
				(SELECT		
				'운영차이량' EQUIP_CD
					,'000000' GOODS_CD
					, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) COUNT_TYPE_NM
					, 0 COUNT_SUM
					, SUM(CNT) CNT
					, PLAN_DATE
				FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
				WHERE 1=1
				AND A.EQUIP_CD = B.EQUIP_CD
				AND B.USE_YN_CD = '001'
				AND PLAN_DATE >= #{startDate}
				AND PLAN_DATE <= #{endDate}
				AND COUNT_TYPE_CD = '002'
				GROUP BY  A.COUNT_TYPE_CD, PLAN_DATE, CNT) AS AA
				PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList}) ) as result_pivot

									  ) 
				) AA FULL OUTER JOIN 	( 				SELECT						
				
				'XXXXXX' GOODS_CD, '당월 합계' GUBUN
				,(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,
				  ISNULL([01],0) [01]
				, ISNULL([02],0) [02]
				, ISNULL([03],0) [03]
				, ISNULL([04],0) [04]
				, ISNULL([05],0) [05]
				, ISNULL([06],0) [06]
				, ISNULL([07],0) [07]
				, ISNULL([08],0) [08]
				, ISNULL([09],0) [09]
				, ISNULL([10],0) [10]
				, ISNULL([11],0) [11]
				, ISNULL([12],0) [12]
				, ISNULL([13],0) [13]
				, ISNULL([14],0) [14]
				, ISNULL([15],0) [15]
				, ISNULL([16],0) [16]
				, ISNULL([17],0) [17]
				, ISNULL([18],0) [18]
				, ISNULL([19],0) [19]
				, ISNULL([20],0) [20]
				, ISNULL([21],0) [21]
				, ISNULL([22],0) [22]
				, ISNULL([23],0) [23]
				, ISNULL([24],0) [24]
				, ISNULL([25],0) [25]
				, ISNULL([26],0) [26]
				, ISNULL([27],0) [27]
				, ISNULL([28],0) [28]
				, ISNULL([29],0) [29]
				, ISNULL([30],0) [30]
				, ISNULL([31],0) [31]
				FROM 		
				(
					SELECT *
							FROM (
							
								SELECT 					
								
									ISNULL( AA.DAY_,'') DAY_																
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'당월 합계' GUBUN
								FROM
								(
									SELECT
										 A.WORK_ORD_NO                     
										, ISNULL(SUM(CC.FAULTY_CNT),0) AS APPEAR_FAULTY_CNT
										, ISNULL(SUM(A.APPEAR_OUTPUT_CNT),0) AS APPEAR_OUTPUT_CNT								
										, ISNULL(SUM(B.E_FAULTY_CNT),0) AS E_FAULTY_CNT
										, ISNULL(SUM(SHIP_FAULTY_CNT),0) AS SHIP_FAULTY_CNT
										, ISNULL(SUM(RE_SHIP_FAULTY_CNT),0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT										
										 A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
										
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO

									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE
										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT					
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									
									GROUP BY 
										 A.WORK_ORD_NO   
										,A.WORK_ORD_DATE

								) AA
								GROUP BY DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA 
				
	
		) BB  ON 1=1 WHERE AA.GOODS_CD != 'trash' 	

		UNION ALL

				SELECT 'ZZZZZZZZ0' GOODS_CD
			, '' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM
			, '' GUBUN
			, 0 COUNT_SUM
			, 0 COUNT1
			, 0 COUNT2
			, 0 COUNT3
			, 0 COUNT4
			, 0 COUNT5
			, 0 COUNT6
			, 0 COUNT7
			, 0 COUNT8
			, 0 COUNT9
			, 0 COUNT10
			, 0 COUNT11
			, 0 COUNT12
			, 0 COUNT13
			, 0 COUNT14
			, 0 COUNT15
			, 0 COUNT16
			, 0 COUNT17
			, 0 COUNT18
			, 0 COUNT19
			, 0 COUNT20
			, 0 COUNT21
			, 0 COUNT22
			, 0 COUNT23
			, 0 COUNT24
			, 0 COUNT25
			, 0 COUNT26
			, 0 COUNT27
			, 0 COUNT28
			, 0 COUNT29
			, 0 COUNT30
			, 0 COUNT31
			UNION ALL
	
	SELECT			
			AAA.GOODS_CD
			, AAA.GOODS_NM
			, D.QUTY_CD
			, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE FF WHERE FF.BASE_GROUP_CD='007' AND FF.BASE_CD = D.QUTY_CD) QUTY_NM
			, AAA.GUBUN
			, COUNT_SUM
			, AAA.[01] AS COUNT1
			, AAA.[02] AS COUNT2
			, AAA.[03] AS COUNT3
			, AAA.[04] AS COUNT4
			, AAA.[05] AS COUNT5
			, AAA.[06] AS COUNT6
			, AAA.[07] AS COUNT7
			, AAA.[08] AS COUNT8
			, AAA.[09] AS COUNT9
			, AAA.[10] AS COUNT10
			, AAA.[11] AS COUNT11
			, AAA.[12] AS COUNT12
			, AAA.[13] AS COUNT13
			, AAA.[14] AS COUNT14
			, AAA.[15] AS COUNT15
			, AAA.[16] AS COUNT16
			, AAA.[17] AS COUNT17
			, AAA.[18] AS COUNT18
			, AAA.[19] AS COUNT19
			, AAA.[20] AS COUNT20
			, AAA.[21] AS COUNT21
			, AAA.[22] AS COUNT22
			, AAA.[23] AS COUNT23
			, AAA.[24] AS COUNT24
			, AAA.[25] AS COUNT25
			, AAA.[26] AS COUNT26
			, AAA.[27] AS COUNT27
			, AAA.[28] AS COUNT28
			, AAA.[29] AS COUNT29
			, AAA.[30] AS COUNT30
			, AAA.[31] AS COUNT31	
		FROM 
			(
				 SELECT 					
				 'ZZZZZZZZ1' GOODS_CD
				, 'CAPA' GOODS_NM	
				, '' QUTY_CD
				, '' QUTY_NM
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) GUBUN			
				, (ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
							ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
							ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
							ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
							ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
							ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
							ISNULL([31],0)) AS COUNT_SUM
					,  ISNULL(([01]),0) '01', ISNULL(([02]),0) '02', ISNULL(([03]),0) '03', ISNULL(([04]),0) '04', ISNULL(([05]),0) '05', ISNULL(([06]),0) '06', ISNULL(([07]),0) '07', ISNULL(([08]),0) '08', ISNULL(([09]),0) '09', ISNULL(([10]),0) '10'
					,  ISNULL(([11]),0) '11', ISNULL(([12]),0) '12', ISNULL(([13]),0) '13', ISNULL(([14]),0) '14', ISNULL(([15]),0) '15', ISNULL(([16]),0) '16', ISNULL(([17]),0) '17', ISNULL(([18]),0) '18', ISNULL(([19]),0) '19', ISNULL(([20]),0) '20'
					,  ISNULL(([21]),0) '21', ISNULL(([22]),0) '22', ISNULL(([23]),0) '23', ISNULL(([24]),0) '24', ISNULL(([25]),0) '25', ISNULL(([26]),0) '26', ISNULL(([27]),0) '27', ISNULL(([28]),0) '28', ISNULL(([29]),0) '29', ISNULL(([30]),0) '30'
					, ISNULL(([31]),0) '31'
				
				FROM
		(
		SELECT 
			'trash' GOODS_CD
			, '' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM
			, '' COUNT_TYPE_CD
			, '' GUBUN
			, 0 COUNT_SUM
			,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
			,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
			,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
			,  '' AS '31'  				

		UNION ALL


		SELECT * FROM
		(
				SELECT 
					 '111111' GOODS_CD
					, '' GOODS_NM
					, '' QUTY_CD
					, '' QUTY_NM		
					, COUNT_TYPE_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) GUBUN
				, 0 COUNT_SUM

				, SUM(CNT) CNT
				, PLAN_DATE
			FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
			WHERE 1=1
			AND A.EQUIP_CD = B.EQUIP_CD
			AND B.USE_YN_CD = '001'
			AND PLAN_DATE >= #{startDate}
			AND PLAN_DATE <= #{endDate}
			AND COUNT_TYPE_CD = '003'
			GROUP BY  A.COUNT_TYPE_CD, PLAN_DATE, CNT) A
			PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList}) ) as result_pivot
			) A
			WHERE GOODS_CD != 'trash'

			UNION ALL

			 SELECT					
					'ZZZZZZZZ3' GOODS_CD
					, '운영계획 月 수량' GOODS_NM
					, '' QUTY_CD
					, '' QUTY_NM							
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) GUBUN			
				, (ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
							ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
							ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
							ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
							ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
							ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
							ISNULL([31],0)) AS COUNT_SUM
					,  ISNULL(([01]),0) '01', ISNULL(([02]),0) '02', ISNULL(([03]),0) '03', ISNULL(([04]),0) '04', ISNULL(([05]),0) '05', ISNULL(([06]),0) '06', ISNULL(([07]),0) '07', ISNULL(([08]),0) '08', ISNULL(([09]),0) '09', ISNULL(([10]),0) '10'
					,  ISNULL(([11]),0) '11', ISNULL(([12]),0) '12', ISNULL(([13]),0) '13', ISNULL(([14]),0) '14', ISNULL(([15]),0) '15', ISNULL(([16]),0) '16', ISNULL(([17]),0) '17', ISNULL(([18]),0) '18', ISNULL(([19]),0) '19', ISNULL(([20]),0) '20'
					,  ISNULL(([21]),0) '21', ISNULL(([22]),0) '22', ISNULL(([23]),0) '23', ISNULL(([24]),0) '24', ISNULL(([25]),0) '25', ISNULL(([26]),0) '26', ISNULL(([27]),0) '27', ISNULL(([28]),0) '28', ISNULL(([29]),0) '29', ISNULL(([30]),0) '30'
					, ISNULL(([31]),0) '31'
				
				FROM
	(
		SELECT 
		
			
			'trash' GOODS_CD
			, '' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM
			, '' COUNT_TYPE_CD
			, '' GUBUN
			, 0 COUNT_SUM
			,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
			,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
			,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
			,  '' AS '31'  				

		UNION ALL


		SELECT * FROM
		(
				SELECT
				
					 'VVVVVV' GOODS_CD
					, '' GOODS_NM
					, '' QUTY_CD
					, '' QUTY_NM		
					, COUNT_TYPE_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) GUBUN
				, 0 COUNT_SUM

				, SUM(CNT) CNT
				, PLAN_DATE
			FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
			WHERE 1=1
			AND A.EQUIP_CD = B.EQUIP_CD
			AND B.USE_YN_CD = '001'
			AND PLAN_DATE >= #{startDate}
			AND PLAN_DATE <= #{endDate}
			AND COUNT_TYPE_CD = '002'
			GROUP BY  A.COUNT_TYPE_CD, PLAN_DATE, CNT) A
			PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList} ) ) as result_pivot
			) A
			WHERE GOODS_CD != 'trash'

	UNION ALL

	 SELECT 					
				 'ZZZZZZZZ2' GOODS_CD
				, '확정판 계획수량' GOODS_NM	
				, '' QUTY_CD
				, '' QUTY_NM
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) GUBUN			
				, (ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
							ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
							ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
							ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
							ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
							ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
							ISNULL([31],0)) AS COUNT_SUM
					,  ISNULL(([01]),0) '01', ISNULL(([02]),0) '02', ISNULL(([03]),0) '03', ISNULL(([04]),0) '04', ISNULL(([05]),0) '05', ISNULL(([06]),0) '06', ISNULL(([07]),0) '07', ISNULL(([08]),0) '08', ISNULL(([09]),0) '09', ISNULL(([10]),0) '10'
					,  ISNULL(([11]),0) '11', ISNULL(([12]),0) '12', ISNULL(([13]),0) '13', ISNULL(([14]),0) '14', ISNULL(([15]),0) '15', ISNULL(([16]),0) '16', ISNULL(([17]),0) '17', ISNULL(([18]),0) '18', ISNULL(([19]),0) '19', ISNULL(([20]),0) '20'
					,  ISNULL(([21]),0) '21', ISNULL(([22]),0) '22', ISNULL(([23]),0) '23', ISNULL(([24]),0) '24', ISNULL(([25]),0) '25', ISNULL(([26]),0) '26', ISNULL(([27]),0) '27', ISNULL(([28]),0) '28', ISNULL(([29]),0) '29', ISNULL(([30]),0) '30'
					, ISNULL(([31]),0) '31'
				
				FROM
		(
		SELECT 
			'trash' GOODS_CD
			, '' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM
			, '' COUNT_TYPE_CD
			, '' GUBUN
			, 0 COUNT_SUM
			,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
			,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
			,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
			,  '' AS '31'  				

		UNION ALL


		SELECT * FROM
		(
				SELECT 
					 '000000' GOODS_CD
					, '' GOODS_NM
					, '' QUTY_CD
					, '' QUTY_NM		
					, COUNT_TYPE_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) GUBUN
				, 0 COUNT_SUM

				, SUM(CNT) CNT
				, PLAN_DATE
			FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
			WHERE 1=1
			AND A.EQUIP_CD = B.EQUIP_CD
			AND B.USE_YN_CD = '001'
			AND PLAN_DATE >= #{startDate}
			AND PLAN_DATE <= #{endDate}
			AND COUNT_TYPE_CD = '001'
			GROUP BY  A.COUNT_TYPE_CD, PLAN_DATE, CNT) A
			PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList}) ) as result_pivot
			) A
			WHERE GOODS_CD != 'trash'

			
			) AAA LEFT OUTER JOIN TB_GOODS_CODE_ADM C ON AAA.GOODS_CD = C.GOODS_CD
				LEFT OUTER JOIN TB_MATRL_CODE_ADM D ON C.ALNICU_MATRL_CD = D.MATRL_CD

		
	 UNION ALL

	 SELECT 
			 'ZZZZZZZZ4' GOODS_CD
			, '月 생산량' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM		
			, '당월 합계' GUBUN
					,(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,
				  ISNULL([01],0) [01]
				, ISNULL([02],0) [02]
				, ISNULL([03],0) [03]
				, ISNULL([04],0) [04]
				, ISNULL([05],0) [05]
				, ISNULL([06],0) [06]
				, ISNULL([07],0) [07]
				, ISNULL([08],0) [08]
				, ISNULL([09],0) [09]
				, ISNULL([10],0) [10]
				, ISNULL([11],0) [11]
				, ISNULL([12],0) [12]
				, ISNULL([13],0) [13]
				, ISNULL([14],0) [14]
				, ISNULL([15],0) [15]
				, ISNULL([16],0) [16]
				, ISNULL([17],0) [17]
				, ISNULL([18],0) [18]
				, ISNULL([19],0) [19]
				, ISNULL([20],0) [20]
				, ISNULL([21],0) [21]
				, ISNULL([22],0) [22]
				, ISNULL([23],0) [23]
				, ISNULL([24],0) [24]
				, ISNULL([25],0) [25]
				, ISNULL([26],0) [26]
				, ISNULL([27],0) [27]
				, ISNULL([28],0) [28]
				, ISNULL([29],0) [29]
				, ISNULL([30],0) [30]
				, ISNULL([31],0) [31]
				FROM 		
				(
					SELECT *
							FROM (
							
								SELECT 					
								
									ISNULL( AA.DAY_,'') DAY_																
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'당월 합계' GUBUN
								FROM
								(
									SELECT
										 A.WORK_ORD_NO                     
										, ISNULL(SUM(CC.FAULTY_CNT),0) AS APPEAR_FAULTY_CNT
										, ISNULL(SUM(A.APPEAR_OUTPUT_CNT),0) AS APPEAR_OUTPUT_CNT								
										, ISNULL(SUM(B.E_FAULTY_CNT),0) AS E_FAULTY_CNT
										, ISNULL(SUM(SHIP_FAULTY_CNT),0) AS SHIP_FAULTY_CNT
										, ISNULL(SUM(RE_SHIP_FAULTY_CNT),0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT										
										 A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
										
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO

									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE
										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT					
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									
									GROUP BY 
										 A.WORK_ORD_NO   
										,A.WORK_ORD_DATE

								) AA
								GROUP BY DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA 

		UNION ALL


		SELECT
			
			  'ZZZZZZZZ5' GOODS_CD
			, '月 누적생산량' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM
			, AA.GUBUN
			, AA.COUNT_SUM
				, ISNULL(AA.[01], 0) '01'
				, ISNULL(AA.[01], 0) + ISNULL(AA.[02], 0) '02'
				, ISNULL(AA.[01], 0) + ISNULL(AA.[02], 0) + ISNULL([03],0) '03'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) '4'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) '5'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) '6'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) '7'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) '8'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0)'9'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) '10'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) '11'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) '12'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) '13'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) '14'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) '15'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) '16'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) '17'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) '18'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) '19'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) '20'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) '21'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) '22'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) '23'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) '24'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) '25'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
				ISNULL([26],0) '26'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
				ISNULL([26],0) + ISNULL([27],0) '27'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
				ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) '28'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
				ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) '29'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
				ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) '30'
				, ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
				ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
				ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
				ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
				ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
				ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
				ISNULL([31],0) '31'
		
			FROM 
				(SELECT  '' EQUIP_CD, 'YYYYYY' GOODS_CD, '누계' GUBUN
					,(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,
				  ISNULL([01],0) [01]
				, ISNULL([02],0) [02]
				, ISNULL([03],0) [03]
				, ISNULL([04],0) [04]
				, ISNULL([05],0) [05]
				, ISNULL([06],0) [06]
				, ISNULL([07],0) [07]
				, ISNULL([08],0) [08]
				, ISNULL([09],0) [09]
				, ISNULL([10],0) [10]
				, ISNULL([11],0) [11]
				, ISNULL([12],0) [12]
				, ISNULL([13],0) [13]
				, ISNULL([14],0) [14]
				, ISNULL([15],0) [15]
				, ISNULL([16],0) [16]
				, ISNULL([17],0) [17]
				, ISNULL([18],0) [18]
				, ISNULL([19],0) [19]
				, ISNULL([20],0) [20]
				, ISNULL([21],0) [21]
				, ISNULL([22],0) [22]
				, ISNULL([23],0) [23]
				, ISNULL([24],0) [24]
				, ISNULL([25],0) [25]
				, ISNULL([26],0) [26]
				, ISNULL([27],0) [27]
				, ISNULL([28],0) [28]
				, ISNULL([29],0) [29]
				, ISNULL([30],0) [30]
				, ISNULL([31],0) [31]
				FROM 		
				(
					SELECT *
							FROM (
							
								SELECT 					
								
									ISNULL( AA.DAY_,'') DAY_																
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'당월 합계' GUBUN
								FROM
								(
									SELECT
										 A.WORK_ORD_NO                     
										, ISNULL(SUM(CC.FAULTY_CNT),0) AS APPEAR_FAULTY_CNT
										, ISNULL(SUM(A.APPEAR_OUTPUT_CNT),0) AS APPEAR_OUTPUT_CNT								
										, ISNULL(SUM(B.E_FAULTY_CNT),0) AS E_FAULTY_CNT
										, ISNULL(SUM(SHIP_FAULTY_CNT),0) AS SHIP_FAULTY_CNT
										, ISNULL(SUM(RE_SHIP_FAULTY_CNT),0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT										
										 A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
										
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO

									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE
										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT					
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									
									GROUP BY 
										 A.WORK_ORD_NO   
										,A.WORK_ORD_DATE

								) AA
								GROUP BY DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA 
			) AA


			UNION ALL

		

			SELECT
			  'ZZZZZZZZ6' GOODS_CD
			, '확정판 계획수량 차이수량' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM
			,'확정 차이량' AS GUBUN
				, (ISNULL(BB.[01], 0) - ISNULL(AA.[01], 0) + ISNULL(BB.[02], 0) - ISNULL(AA.[02], 0) + ISNULL(BB.[03], 0) - ISNULL(AA.[03], 0) + ISNULL(BB.[04], 0) - ISNULL(AA.[04], 0) + ISNULL(BB.[05], 0) - ISNULL(AA.[05], 0) +
				ISNULL(BB.[06], 0) - ISNULL(AA.[06], 0) + ISNULL(BB.[07], 0) - ISNULL(AA.[07], 0) + ISNULL(BB.[08], 0) - ISNULL(AA.[08], 0) + ISNULL(BB.[09], 0) - ISNULL(AA.[09], 0) + ISNULL(BB.[10], 0) - ISNULL(AA.[10], 0) +
				ISNULL(BB.[11], 0) - ISNULL(AA.[11], 0) + ISNULL(BB.[12], 0) - ISNULL(AA.[12], 0) + ISNULL(BB.[13], 0) - ISNULL(AA.[13], 0) + ISNULL(BB.[14], 0) - ISNULL(AA.[14], 0) + ISNULL(BB.[15], 0) - ISNULL(AA.[15], 0) +
				ISNULL(BB.[16], 0) - ISNULL(AA.[16], 0) + ISNULL(BB.[17], 0) - ISNULL(AA.[17], 0) + ISNULL(BB.[18], 0) - ISNULL(AA.[18], 0) + ISNULL(BB.[19], 0) - ISNULL(AA.[19], 0) + ISNULL(BB.[20], 0) - ISNULL(AA.[20], 0) +
				ISNULL(BB.[21], 0) - ISNULL(AA.[21], 0) + ISNULL(BB.[22], 0) - ISNULL(AA.[22], 0) + ISNULL(BB.[23], 0) - ISNULL(AA.[23], 0) + ISNULL(BB.[24], 0) - ISNULL(AA.[24], 0) + ISNULL(BB.[25], 0) - ISNULL(AA.[25], 0) +
				ISNULL(BB.[26], 0) - ISNULL(AA.[26], 0) +ISNULL(BB.[27], 0) - ISNULL(AA.[27], 0) + ISNULL(BB.[28], 0) - ISNULL(AA.[28], 0) + ISNULL(BB.[29], 0) - ISNULL(AA.[29], 0) + ISNULL(BB.[30], 0) - ISNULL(AA.[30], 0) + 
				ISNULL(BB.[31], 0) - ISNULL(AA.[31], 0)) COUNT_SUM
				, ISNULL(BB.[01], 0) - ISNULL(AA.[01], 0) AS '01'
				, ISNULL(BB.[02], 0) - ISNULL(AA.[02], 0) AS '02'
				, ISNULL(BB.[03], 0) - ISNULL(AA.[03], 0) AS '03'
				, ISNULL(BB.[04], 0) - ISNULL(AA.[04], 0) AS '04'
				, ISNULL(BB.[05], 0) - ISNULL(AA.[05], 0) AS '05'
				, ISNULL(BB.[06], 0) - ISNULL(AA.[06], 0) AS '06'
				, ISNULL(BB.[07], 0) - ISNULL(AA.[07], 0) AS '07'
				, ISNULL(BB.[08], 0) - ISNULL(AA.[08], 0) AS '08'
				, ISNULL(BB.[09], 0) - ISNULL(AA.[09], 0) AS '09'
				, ISNULL(BB.[10], 0) - ISNULL(AA.[10], 0) AS '10'
				, ISNULL(BB.[11], 0) - ISNULL(AA.[11], 0) AS '11'
				, ISNULL(BB.[12], 0) - ISNULL(AA.[12], 0) AS '12'
				, ISNULL(BB.[13], 0) - ISNULL(AA.[13], 0) AS '13'
				, ISNULL(BB.[14], 0) - ISNULL(AA.[14], 0) AS '14'
				, ISNULL(BB.[15], 0) - ISNULL(AA.[15], 0) AS '15'
				, ISNULL(BB.[16], 0) - ISNULL(AA.[16], 0) AS '16'
				, ISNULL(BB.[17], 0) - ISNULL(AA.[17], 0) AS '17'
				, ISNULL(BB.[18], 0) - ISNULL(AA.[18], 0) AS '18'
				, ISNULL(BB.[19], 0) - ISNULL(AA.[19], 0) AS '19'
				, ISNULL(BB.[20], 0) - ISNULL(AA.[20], 0) AS '20'
				, ISNULL(BB.[21], 0) - ISNULL(AA.[21], 0) AS '21'
				, ISNULL(BB.[22], 0) - ISNULL(AA.[22], 0) AS '22'
				, ISNULL(BB.[23], 0) - ISNULL(AA.[23], 0) AS '23'
				, ISNULL(BB.[24], 0) - ISNULL(AA.[24], 0) AS '24'
				, ISNULL(BB.[25], 0) - ISNULL(AA.[25], 0) AS '25'
				, ISNULL(BB.[26], 0) - ISNULL(AA.[26], 0) AS '26'
				, ISNULL(BB.[27], 0) - ISNULL(AA.[27], 0) AS '27'
				, ISNULL(BB.[28], 0) - ISNULL(AA.[28], 0) AS '28'
				, ISNULL(BB.[29], 0) - ISNULL(AA.[29], 0) AS '29'
				, ISNULL(BB.[30], 0) - ISNULL(AA.[30], 0) AS '30'
				, ISNULL(BB.[31], 0) - ISNULL(AA.[31], 0) AS '31'
			FROM
				( 


				(
				SELECT '차이량' EQUIP_CD
					,'trash' GOODS_CD
					, '' COUNT_TYPE_NM
					, 0 COUNT_SUM
					,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
					,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
					,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
					,  '' AS '31'  				

				UNION ALL

				SELECT * FROM
				(SELECT		
				'차이량' EQUIP_CD
					,'000000' GOODS_CD
					, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) COUNT_TYPE_NM
					, 0 COUNT_SUM
					, SUM(CNT) CNT
					, PLAN_DATE
				FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
				WHERE 1=1
				AND A.EQUIP_CD = B.EQUIP_CD
				AND B.USE_YN_CD = '001'
				AND PLAN_DATE >= #{startDate}
				AND PLAN_DATE <= #{endDate}
				AND COUNT_TYPE_CD = '001'
				GROUP BY  A.COUNT_TYPE_CD, PLAN_DATE, CNT) AS AA
				PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList}) ) as result_pivot

									  ) 
				) AA FULL OUTER JOIN 	( SELECT   'XXXXXX' GOODS_CD, '당월 합계' GUBUN
						,(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,
				  ISNULL([01],0) [01]
				, ISNULL([02],0) [02]
				, ISNULL([03],0) [03]
				, ISNULL([04],0) [04]
				, ISNULL([05],0) [05]
				, ISNULL([06],0) [06]
				, ISNULL([07],0) [07]
				, ISNULL([08],0) [08]
				, ISNULL([09],0) [09]
				, ISNULL([10],0) [10]
				, ISNULL([11],0) [11]
				, ISNULL([12],0) [12]
				, ISNULL([13],0) [13]
				, ISNULL([14],0) [14]
				, ISNULL([15],0) [15]
				, ISNULL([16],0) [16]
				, ISNULL([17],0) [17]
				, ISNULL([18],0) [18]
				, ISNULL([19],0) [19]
				, ISNULL([20],0) [20]
				, ISNULL([21],0) [21]
				, ISNULL([22],0) [22]
				, ISNULL([23],0) [23]
				, ISNULL([24],0) [24]
				, ISNULL([25],0) [25]
				, ISNULL([26],0) [26]
				, ISNULL([27],0) [27]
				, ISNULL([28],0) [28]
				, ISNULL([29],0) [29]
				, ISNULL([30],0) [30]
				, ISNULL([31],0) [31]
				FROM 		
				(
					SELECT *
							FROM (
							
								SELECT 					
								
									ISNULL( AA.DAY_,'') DAY_																
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'당월 합계' GUBUN
								FROM
								(
									SELECT
										 A.WORK_ORD_NO                     
										, ISNULL(SUM(CC.FAULTY_CNT),0) AS APPEAR_FAULTY_CNT
										, ISNULL(SUM(A.APPEAR_OUTPUT_CNT),0) AS APPEAR_OUTPUT_CNT								
										, ISNULL(SUM(B.E_FAULTY_CNT),0) AS E_FAULTY_CNT
										, ISNULL(SUM(SHIP_FAULTY_CNT),0) AS SHIP_FAULTY_CNT
										, ISNULL(SUM(RE_SHIP_FAULTY_CNT),0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT										
										 A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
										
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO

									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE
										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT					
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									
									GROUP BY 
										 A.WORK_ORD_NO   
										,A.WORK_ORD_DATE

								) AA
								GROUP BY DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA 
		) BB  ON 1=1 WHERE AA.GOODS_CD != 'trash' 	

		UNION ALL
				
				SELECT
				  'ZZZZZZZZ66' GOODS_CD
			, '운용계획대비 차이수량' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM
			,'운영 차이량' AS GUBUN
				, (ISNULL(BB.[01], 0) - ISNULL(AA.[01], 0) + ISNULL(BB.[02], 0) - ISNULL(AA.[02], 0) + ISNULL(BB.[03], 0) - ISNULL(AA.[03], 0) + ISNULL(BB.[04], 0) - ISNULL(AA.[04], 0) + ISNULL(BB.[05], 0) - ISNULL(AA.[05], 0) +
				ISNULL(BB.[06], 0) - ISNULL(AA.[06], 0) + ISNULL(BB.[07], 0) - ISNULL(AA.[07], 0) + ISNULL(BB.[08], 0) - ISNULL(AA.[08], 0) + ISNULL(BB.[09], 0) - ISNULL(AA.[09], 0) + ISNULL(BB.[10], 0) - ISNULL(AA.[10], 0) +
				ISNULL(BB.[11], 0) - ISNULL(AA.[11], 0) + ISNULL(BB.[12], 0) - ISNULL(AA.[12], 0) + ISNULL(BB.[13], 0) - ISNULL(AA.[13], 0) + ISNULL(BB.[14], 0) - ISNULL(AA.[14], 0) + ISNULL(BB.[15], 0) - ISNULL(AA.[15], 0) +
				ISNULL(BB.[16], 0) - ISNULL(AA.[16], 0) + ISNULL(BB.[17], 0) - ISNULL(AA.[17], 0) + ISNULL(BB.[18], 0) - ISNULL(AA.[18], 0) + ISNULL(BB.[19], 0) - ISNULL(AA.[19], 0) + ISNULL(BB.[20], 0) - ISNULL(AA.[20], 0) +
				ISNULL(BB.[21], 0) - ISNULL(AA.[21], 0) + ISNULL(BB.[22], 0) - ISNULL(AA.[22], 0) + ISNULL(BB.[23], 0) - ISNULL(AA.[23], 0) + ISNULL(BB.[24], 0) - ISNULL(AA.[24], 0) + ISNULL(BB.[25], 0) - ISNULL(AA.[25], 0) +
				ISNULL(BB.[26], 0) - ISNULL(AA.[26], 0) +ISNULL(BB.[27], 0) - ISNULL(AA.[27], 0) + ISNULL(BB.[28], 0) - ISNULL(AA.[28], 0) + ISNULL(BB.[29], 0) - ISNULL(AA.[29], 0) + ISNULL(BB.[30], 0) - ISNULL(AA.[30], 0) + 
				ISNULL(BB.[31], 0) - ISNULL(AA.[31], 0)) COUNT_SUM
				, ISNULL(BB.[01], 0) - ISNULL(AA.[01], 0) AS '01'
				, ISNULL(BB.[02], 0) - ISNULL(AA.[02], 0) AS '02'
				, ISNULL(BB.[03], 0) - ISNULL(AA.[03], 0) AS '03'
				, ISNULL(BB.[04], 0) - ISNULL(AA.[04], 0) AS '04'
				, ISNULL(BB.[05], 0) - ISNULL(AA.[05], 0) AS '05'
				, ISNULL(BB.[06], 0) - ISNULL(AA.[06], 0) AS '06'
				, ISNULL(BB.[07], 0) - ISNULL(AA.[07], 0) AS '07'
				, ISNULL(BB.[08], 0) - ISNULL(AA.[08], 0) AS '08'
				, ISNULL(BB.[09], 0) - ISNULL(AA.[09], 0) AS '09'
				, ISNULL(BB.[10], 0) - ISNULL(AA.[10], 0) AS '10'
				, ISNULL(BB.[11], 0) - ISNULL(AA.[11], 0) AS '11'
				, ISNULL(BB.[12], 0) - ISNULL(AA.[12], 0) AS '12'
				, ISNULL(BB.[13], 0) - ISNULL(AA.[13], 0) AS '13'
				, ISNULL(BB.[14], 0) - ISNULL(AA.[14], 0) AS '14'
				, ISNULL(BB.[15], 0) - ISNULL(AA.[15], 0) AS '15'
				, ISNULL(BB.[16], 0) - ISNULL(AA.[16], 0) AS '16'
				, ISNULL(BB.[17], 0) - ISNULL(AA.[17], 0) AS '17'
				, ISNULL(BB.[18], 0) - ISNULL(AA.[18], 0) AS '18'
				, ISNULL(BB.[19], 0) - ISNULL(AA.[19], 0) AS '19'
				, ISNULL(BB.[20], 0) - ISNULL(AA.[20], 0) AS '20'
				, ISNULL(BB.[21], 0) - ISNULL(AA.[21], 0) AS '21'
				, ISNULL(BB.[22], 0) - ISNULL(AA.[22], 0) AS '22'
				, ISNULL(BB.[23], 0) - ISNULL(AA.[23], 0) AS '23'
				, ISNULL(BB.[24], 0) - ISNULL(AA.[24], 0) AS '24'
				, ISNULL(BB.[25], 0) - ISNULL(AA.[25], 0) AS '25'
				, ISNULL(BB.[26], 0) - ISNULL(AA.[26], 0) AS '26'
				, ISNULL(BB.[27], 0) - ISNULL(AA.[27], 0) AS '27'
				, ISNULL(BB.[28], 0) - ISNULL(AA.[28], 0) AS '28'
				, ISNULL(BB.[29], 0) - ISNULL(AA.[29], 0) AS '29'
				, ISNULL(BB.[30], 0) - ISNULL(AA.[30], 0) AS '30'
				, ISNULL(BB.[31], 0) - ISNULL(AA.[31], 0) AS '31'
			FROM
				( 


				(
				SELECT '운영차이량' EQUIP_CD
					,'trash' GOODS_CD
					, '' COUNT_TYPE_NM
					, 0 COUNT_SUM
					,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
					,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
					,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
					,  '' AS '31'  				

				UNION ALL

				SELECT * FROM
				(SELECT		
				'운영차이량' EQUIP_CD
					,'000000' GOODS_CD
					, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) COUNT_TYPE_NM
					, 0 COUNT_SUM
					, SUM(CNT) CNT
					, PLAN_DATE
				FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
				WHERE 1=1
				AND A.EQUIP_CD = B.EQUIP_CD
				AND B.USE_YN_CD = '001'
				AND PLAN_DATE >= #{startDate}
				AND PLAN_DATE <= #{endDate}
				AND COUNT_TYPE_CD = '002'
				GROUP BY  A.COUNT_TYPE_CD, PLAN_DATE, CNT) AS AA
				PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList}) ) as result_pivot

									  ) 
				) AA FULL OUTER JOIN 	( SELECT   'XXXXXX' GOODS_CD, '당월 합계' GUBUN
						,(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,
				  ISNULL([01],0) [01]
				, ISNULL([02],0) [02]
				, ISNULL([03],0) [03]
				, ISNULL([04],0) [04]
				, ISNULL([05],0) [05]
				, ISNULL([06],0) [06]
				, ISNULL([07],0) [07]
				, ISNULL([08],0) [08]
				, ISNULL([09],0) [09]
				, ISNULL([10],0) [10]
				, ISNULL([11],0) [11]
				, ISNULL([12],0) [12]
				, ISNULL([13],0) [13]
				, ISNULL([14],0) [14]
				, ISNULL([15],0) [15]
				, ISNULL([16],0) [16]
				, ISNULL([17],0) [17]
				, ISNULL([18],0) [18]
				, ISNULL([19],0) [19]
				, ISNULL([20],0) [20]
				, ISNULL([21],0) [21]
				, ISNULL([22],0) [22]
				, ISNULL([23],0) [23]
				, ISNULL([24],0) [24]
				, ISNULL([25],0) [25]
				, ISNULL([26],0) [26]
				, ISNULL([27],0) [27]
				, ISNULL([28],0) [28]
				, ISNULL([29],0) [29]
				, ISNULL([30],0) [30]
				, ISNULL([31],0) [31]
				FROM 		
				(
					SELECT *
							FROM (
							
								SELECT 					
								
									ISNULL( AA.DAY_,'') DAY_																
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'당월 합계' GUBUN
								FROM
								(
									SELECT
										 A.WORK_ORD_NO                     
										, ISNULL(SUM(CC.FAULTY_CNT),0) AS APPEAR_FAULTY_CNT
										, ISNULL(SUM(A.APPEAR_OUTPUT_CNT),0) AS APPEAR_OUTPUT_CNT								
										, ISNULL(SUM(B.E_FAULTY_CNT),0) AS E_FAULTY_CNT
										, ISNULL(SUM(SHIP_FAULTY_CNT),0) AS SHIP_FAULTY_CNT
										, ISNULL(SUM(RE_SHIP_FAULTY_CNT),0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT										
										 A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
										
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO

									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE
										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT					
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									
									GROUP BY 
										 A.WORK_ORD_NO   
										,A.WORK_ORD_DATE

								) AA
								GROUP BY DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA 
		) BB  ON 1=1 WHERE AA.GOODS_CD != 'trash' 	

		UNION ALL

		SELECT  'ZZZZZZZZ7' GOODS_CD
				, '확정판 달성률(%)' GOODS_NM
				, '' QUTY_CD
				, '' QUTY_NM
				,'확정판 달성률(%)' AS GUBUN
				,( (ISNULL(BB.[01], 0) + ISNULL(BB.[02], 0)  + ISNULL(BB.[03], 0) + ISNULL(BB.[04], 0)  + ISNULL(BB.[05], 0)  +
				ISNULL(BB.[06], 0) + ISNULL(BB.[07], 0) + ISNULL(BB.[08], 0)  + ISNULL(BB.[09], 0) + ISNULL(BB.[10], 0) +
				ISNULL(BB.[11], 0) + ISNULL(BB.[12], 0) + ISNULL(BB.[13], 0)  + ISNULL(BB.[14], 0) + ISNULL(BB.[15], 0) +
				ISNULL(BB.[16], 0) + ISNULL(BB.[17], 0) + ISNULL(BB.[18], 0)  + ISNULL(BB.[19], 0) + ISNULL(BB.[20], 0) +
				ISNULL(BB.[21], 0) + ISNULL(BB.[22], 0) + ISNULL(BB.[23], 0)  + ISNULL(BB.[24], 0) + ISNULL(BB.[25], 0) +
				ISNULL(BB.[26], 0) + ISNULL(BB.[27], 0) + ISNULL(BB.[28], 0)  + ISNULL(BB.[29], 0) + ISNULL(BB.[30], 0) + 
				ISNULL(BB.[31], 0) ) 
				* 100
				/
				(ISNULL(AA.[01], 0) + ISNULL(AA.[02], 0)  + ISNULL(AA.[03], 0) + ISNULL(AA.[04], 0)  + ISNULL(AA.[05], 0)  +
				ISNULL(AA.[06], 0) + ISNULL(AA.[07], 0) + ISNULL(AA.[08], 0)  + ISNULL(AA.[09], 0) + ISNULL(AA.[10], 0) +
				ISNULL(AA.[11], 0) + ISNULL(AA.[12], 0) + ISNULL(AA.[13], 0)  + ISNULL(AA.[14], 0) + ISNULL(AA.[15], 0) +
				ISNULL(AA.[16], 0) + ISNULL(AA.[17], 0) + ISNULL(AA.[18], 0)  + ISNULL(AA.[19], 0) + ISNULL(AA.[20], 0) +
				ISNULL(AA.[21], 0) + ISNULL(AA.[22], 0) + ISNULL(AA.[23], 0)  + ISNULL(AA.[24], 0) + ISNULL(AA.[25], 0) +
				ISNULL(AA.[26], 0) + ISNULL(AA.[27], 0) + ISNULL(AA.[28], 0)  + ISNULL(AA.[29], 0) + ISNULL(AA.[30], 0) + 
				ISNULL(AA.[31], 0))							
				) COUNT_SUM
				, ISNULL(BB.[01], 0) * 100 / ISNULL(AA.[01], 0)  AS '01'
				, ISNULL(BB.[02], 0) * 100 / ISNULL(AA.[02], 0) AS '02'
				, ISNULL(BB.[03], 0)  * 100 / ISNULL(AA.[03], 0) AS '03'
				, ISNULL(BB.[04], 0)  * 100 / ISNULL(AA.[04], 0) AS '04'
				, ISNULL(BB.[05], 0)  * 100 / ISNULL(AA.[05], 0) AS '05'
				, ISNULL(BB.[06], 0)  * 100 / ISNULL(AA.[06], 0) AS '06'
				, ISNULL(BB.[07], 0)  * 100 / ISNULL(AA.[07], 0) AS '07'
				, ISNULL(BB.[08], 0)  * 100 / ISNULL(AA.[08], 0) AS '08'
				, ISNULL(BB.[09], 0)  * 100 / ISNULL(AA.[09], 0) AS '09'
				, ISNULL(BB.[10], 0)  * 100 / ISNULL(AA.[10], 0) AS '10'
				, ISNULL(BB.[11], 0)  * 100 / ISNULL(AA.[11], 0) AS '11'
				, ISNULL(BB.[12], 0)  * 100 / ISNULL(AA.[12], 0) AS '12'
				, ISNULL(BB.[13], 0)  * 100 / ISNULL(AA.[13], 0) AS '13'
				, ISNULL(BB.[14], 0)  * 100 / ISNULL(AA.[14], 0) AS '14'
				, ISNULL(BB.[15], 0)  * 100 / ISNULL(AA.[15], 0) AS '15'
				, ISNULL(BB.[16], 0)  * 100 / ISNULL(AA.[16], 0) AS '16'
				, ISNULL(BB.[17], 0)  * 100 / ISNULL(AA.[17], 0) AS '17'
				, ISNULL(BB.[18], 0)  * 100 / ISNULL(AA.[18], 0) AS '18'
				, ISNULL(BB.[19], 0)  * 100 / ISNULL(AA.[19], 0) AS '19'
				, ISNULL(BB.[20], 0)  * 100 / ISNULL(AA.[20], 0) AS '20'
				, ISNULL(BB.[21], 0)  * 100 / ISNULL(AA.[21], 0) AS '21'
				, ISNULL(BB.[22], 0)  * 100 / ISNULL(AA.[22], 0) AS '22'
				, ISNULL(BB.[23], 0)  * 100 / ISNULL(AA.[23], 0) AS '23'
				, ISNULL(BB.[24], 0)  * 100 / ISNULL(AA.[24], 0) AS '24'
				, ISNULL(BB.[25], 0)  * 100 / ISNULL(AA.[25], 0) AS '25'
				, ISNULL(BB.[26], 0)  * 100 / ISNULL(AA.[26], 0) AS '26'
				, ISNULL(BB.[27], 0)  * 100 / ISNULL(AA.[27], 0) AS '27'
				, ISNULL(BB.[28], 0)  * 100 / ISNULL(AA.[28], 0) AS '28'
				, ISNULL(BB.[29], 0)  * 100 / ISNULL(AA.[29], 0) AS '29'
				, ISNULL(BB.[30], 0)  * 100 / ISNULL(AA.[30], 0) AS '30'
				, ISNULL(BB.[31], 0)  * 100 / ISNULL(AA.[31], 0) AS '31'
			FROM
			(  
			SELECT '차이량' EQUIP_CD
					,'trash' GOODS_CD
					, '' COUNT_TYPE_NM
					, 0 COUNT_SUM
					,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
					,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
					,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
					,  '' AS '31'  				

				UNION ALL			
			
			
			SELECT * FROM
				( SELECT		
					'' EQUIP_CD
					,'777777' GOODS_CD
					, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) COUNT_TYPE_NM
					, 0 COUNT_SUM
					, SUM(CNT) CNT
					, PLAN_DATE
				FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
				WHERE 1=1
				AND A.EQUIP_CD = B.EQUIP_CD
				AND B.USE_YN_CD = '001'
				AND PLAN_DATE >= #{startDate}
				AND PLAN_DATE <= #{endDate}
				AND COUNT_TYPE_CD = '001'
				GROUP BY  A.COUNT_TYPE_CD, PLAN_DATE, CNT) AS AA
				PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList}) ) as result_pivot
				) AA FULL OUTER JOIN 	(  
				SELECT 
			 '777777' GOODS_CD
			, '당월 합계' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM		
			, '당월 합계' GUBUN
					,(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,
				  ISNULL([01],0) [01]
				, ISNULL([02],0) [02]
				, ISNULL([03],0) [03]
				, ISNULL([04],0) [04]
				, ISNULL([05],0) [05]
				, ISNULL([06],0) [06]
				, ISNULL([07],0) [07]
				, ISNULL([08],0) [08]
				, ISNULL([09],0) [09]
				, ISNULL([10],0) [10]
				, ISNULL([11],0) [11]
				, ISNULL([12],0) [12]
				, ISNULL([13],0) [13]
				, ISNULL([14],0) [14]
				, ISNULL([15],0) [15]
				, ISNULL([16],0) [16]
				, ISNULL([17],0) [17]
				, ISNULL([18],0) [18]
				, ISNULL([19],0) [19]
				, ISNULL([20],0) [20]
				, ISNULL([21],0) [21]
				, ISNULL([22],0) [22]
				, ISNULL([23],0) [23]
				, ISNULL([24],0) [24]
				, ISNULL([25],0) [25]
				, ISNULL([26],0) [26]
				, ISNULL([27],0) [27]
				, ISNULL([28],0) [28]
				, ISNULL([29],0) [29]
				, ISNULL([30],0) [30]
				, ISNULL([31],0) [31]
				FROM 		
				(
					SELECT *
							FROM (
							
								SELECT 					
								
									ISNULL( AA.DAY_,'') DAY_																
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'당월 합계' GUBUN
								FROM
								(
									SELECT
										 A.WORK_ORD_NO                     
										, ISNULL(SUM(CC.FAULTY_CNT),0) AS APPEAR_FAULTY_CNT
										, ISNULL(SUM(A.APPEAR_OUTPUT_CNT),0) AS APPEAR_OUTPUT_CNT								
										, ISNULL(SUM(B.E_FAULTY_CNT),0) AS E_FAULTY_CNT
										, ISNULL(SUM(SHIP_FAULTY_CNT),0) AS SHIP_FAULTY_CNT
										, ISNULL(SUM(RE_SHIP_FAULTY_CNT),0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT										
										 A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
										
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO

									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE
										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT					
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									
									GROUP BY 
										 A.WORK_ORD_NO   
										,A.WORK_ORD_DATE

								) AA
								GROUP BY DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA 
				) BB ON AA.GOODS_CD = BB.GOODS_CD WHERE AA.GOODS_CD != 'trash'

				UNION ALL

		SELECT  'ZZZZZZZZ8' GOODS_CD
				, '운용계획 달성률(%)' GOODS_NM
				, '' QUTY_CD
				, '' QUTY_NM
				,'운용계획 당성 률(%)' AS GUBUN
				,( (ISNULL(BB.[01], 0) + ISNULL(BB.[02], 0)  + ISNULL(BB.[03], 0) + ISNULL(BB.[04], 0)  + ISNULL(BB.[05], 0)  +
				ISNULL(BB.[06], 0) + ISNULL(BB.[07], 0) + ISNULL(BB.[08], 0)  + ISNULL(BB.[09], 0) + ISNULL(BB.[10], 0) +
				ISNULL(BB.[11], 0) + ISNULL(BB.[12], 0) + ISNULL(BB.[13], 0)  + ISNULL(BB.[14], 0) + ISNULL(BB.[15], 0) +
				ISNULL(BB.[16], 0) + ISNULL(BB.[17], 0) + ISNULL(BB.[18], 0)  + ISNULL(BB.[19], 0) + ISNULL(BB.[20], 0) +
				ISNULL(BB.[21], 0) + ISNULL(BB.[22], 0) + ISNULL(BB.[23], 0)  + ISNULL(BB.[24], 0) + ISNULL(BB.[25], 0) +
				ISNULL(BB.[26], 0) + ISNULL(BB.[27], 0) + ISNULL(BB.[28], 0)  + ISNULL(BB.[29], 0) + ISNULL(BB.[30], 0) + 
				ISNULL(BB.[31], 0) ) 
				* 100
				/
				(ISNULL(AA.[01], 0) + ISNULL(AA.[02], 0)  + ISNULL(AA.[03], 0) + ISNULL(AA.[04], 0)  + ISNULL(AA.[05], 0)  +
				ISNULL(AA.[06], 0) + ISNULL(AA.[07], 0) + ISNULL(AA.[08], 0)  + ISNULL(AA.[09], 0) + ISNULL(AA.[10], 0) +
				ISNULL(AA.[11], 0) + ISNULL(AA.[12], 0) + ISNULL(AA.[13], 0)  + ISNULL(AA.[14], 0) + ISNULL(AA.[15], 0) +
				ISNULL(AA.[16], 0) + ISNULL(AA.[17], 0) + ISNULL(AA.[18], 0)  + ISNULL(AA.[19], 0) + ISNULL(AA.[20], 0) +
				ISNULL(AA.[21], 0) + ISNULL(AA.[22], 0) + ISNULL(AA.[23], 0)  + ISNULL(AA.[24], 0) + ISNULL(AA.[25], 0) +
				ISNULL(AA.[26], 0) + ISNULL(AA.[27], 0) + ISNULL(AA.[28], 0)  + ISNULL(AA.[29], 0) + ISNULL(AA.[30], 0) + 
				ISNULL(AA.[31], 0))							
				) COUNT_SUM
				, ISNULL(BB.[01], 0) * 100 / ISNULL(AA.[01], 0)  AS '01'
				, ISNULL(BB.[02], 0) * 100 / ISNULL(AA.[02], 0) AS '02'
				, ISNULL(BB.[03], 0)  * 100 / ISNULL(AA.[03], 0) AS '03'
				, ISNULL(BB.[04], 0)  * 100 / ISNULL(AA.[04], 0) AS '04'
				, ISNULL(BB.[05], 0)  * 100 / ISNULL(AA.[05], 0) AS '05'
				, ISNULL(BB.[06], 0)  * 100 / ISNULL(AA.[06], 0) AS '06'
				, ISNULL(BB.[07], 0)  * 100 / ISNULL(AA.[07], 0) AS '07'
				, ISNULL(BB.[08], 0)  * 100 / ISNULL(AA.[08], 0) AS '08'
				, ISNULL(BB.[09], 0)  * 100 / ISNULL(AA.[09], 0) AS '09'
				, ISNULL(BB.[10], 0)  * 100 / ISNULL(AA.[10], 0) AS '10'
				, ISNULL(BB.[11], 0)  * 100 / ISNULL(AA.[11], 0) AS '11'
				, ISNULL(BB.[12], 0)  * 100 / ISNULL(AA.[12], 0) AS '12'
				, ISNULL(BB.[13], 0)  * 100 / ISNULL(AA.[13], 0) AS '13'
				, ISNULL(BB.[14], 0)  * 100 / ISNULL(AA.[14], 0) AS '14'
				, ISNULL(BB.[15], 0)  * 100 / ISNULL(AA.[15], 0) AS '15'
				, ISNULL(BB.[16], 0)  * 100 / ISNULL(AA.[16], 0) AS '16'
				, ISNULL(BB.[17], 0)  * 100 / ISNULL(AA.[17], 0) AS '17'
				, ISNULL(BB.[18], 0)  * 100 / ISNULL(AA.[18], 0) AS '18'
				, ISNULL(BB.[19], 0)  * 100 / ISNULL(AA.[19], 0) AS '19'
				, ISNULL(BB.[20], 0)  * 100 / ISNULL(AA.[20], 0) AS '20'
				, ISNULL(BB.[21], 0)  * 100 / ISNULL(AA.[21], 0) AS '21'
				, ISNULL(BB.[22], 0)  * 100 / ISNULL(AA.[22], 0) AS '22'
				, ISNULL(BB.[23], 0)  * 100 / ISNULL(AA.[23], 0) AS '23'
				, ISNULL(BB.[24], 0)  * 100 / ISNULL(AA.[24], 0) AS '24'
				, ISNULL(BB.[25], 0)  * 100 / ISNULL(AA.[25], 0) AS '25'
				, ISNULL(BB.[26], 0)  * 100 / ISNULL(AA.[26], 0) AS '26'
				, ISNULL(BB.[27], 0)  * 100 / ISNULL(AA.[27], 0) AS '27'
				, ISNULL(BB.[28], 0)  * 100 / ISNULL(AA.[28], 0) AS '28'
				, ISNULL(BB.[29], 0)  * 100 / ISNULL(AA.[29], 0) AS '29'
				, ISNULL(BB.[30], 0)  * 100 / ISNULL(AA.[30], 0) AS '30'
				, ISNULL(BB.[31], 0)  * 100 / ISNULL(AA.[31], 0) AS '31'
			FROM
			(  
			SELECT '차이량' EQUIP_CD
					,'trash' GOODS_CD
					, '' COUNT_TYPE_NM
					, 0 COUNT_SUM
					,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
					,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
					,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
					,  '' AS '31'  				

				UNION ALL			
			
			
			SELECT * FROM
				( SELECT		
					'' EQUIP_CD
					,'888888' GOODS_CD
					, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) COUNT_TYPE_NM
					, 0 COUNT_SUM
					, SUM(CNT) CNT
					, PLAN_DATE
				FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
				WHERE 1=1
				AND A.EQUIP_CD = B.EQUIP_CD
				AND B.USE_YN_CD = '001'
				AND PLAN_DATE >= #{startDate}
				AND PLAN_DATE <= #{endDate}
				AND COUNT_TYPE_CD = '002'
				GROUP BY  A.COUNT_TYPE_CD, PLAN_DATE, CNT) AS AA
				PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList}) ) as result_pivot
				) AA FULL OUTER JOIN 	(  
				SELECT 
			 '888888' GOODS_CD
			, '당월 합계' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM		
			, '당월 합계' GUBUN
					,(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,
				  ISNULL([01],0) [01]
				, ISNULL([02],0) [02]
				, ISNULL([03],0) [03]
				, ISNULL([04],0) [04]
				, ISNULL([05],0) [05]
				, ISNULL([06],0) [06]
				, ISNULL([07],0) [07]
				, ISNULL([08],0) [08]
				, ISNULL([09],0) [09]
				, ISNULL([10],0) [10]
				, ISNULL([11],0) [11]
				, ISNULL([12],0) [12]
				, ISNULL([13],0) [13]
				, ISNULL([14],0) [14]
				, ISNULL([15],0) [15]
				, ISNULL([16],0) [16]
				, ISNULL([17],0) [17]
				, ISNULL([18],0) [18]
				, ISNULL([19],0) [19]
				, ISNULL([20],0) [20]
				, ISNULL([21],0) [21]
				, ISNULL([22],0) [22]
				, ISNULL([23],0) [23]
				, ISNULL([24],0) [24]
				, ISNULL([25],0) [25]
				, ISNULL([26],0) [26]
				, ISNULL([27],0) [27]
				, ISNULL([28],0) [28]
				, ISNULL([29],0) [29]
				, ISNULL([30],0) [30]
				, ISNULL([31],0) [31]
				FROM 		
				(
					SELECT *
							FROM (
							
								SELECT 					
								
									ISNULL( AA.DAY_,'') DAY_																
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'당월 합계' GUBUN
								FROM
								(
									SELECT
										 A.WORK_ORD_NO                     
										, ISNULL(SUM(CC.FAULTY_CNT),0) AS APPEAR_FAULTY_CNT
										, ISNULL(SUM(A.APPEAR_OUTPUT_CNT),0) AS APPEAR_OUTPUT_CNT								
										, ISNULL(SUM(B.E_FAULTY_CNT),0) AS E_FAULTY_CNT
										, ISNULL(SUM(SHIP_FAULTY_CNT),0) AS SHIP_FAULTY_CNT
										, ISNULL(SUM(RE_SHIP_FAULTY_CNT),0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT										
										 A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
										
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO

									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE
										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT					
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									
									GROUP BY 
										 A.WORK_ORD_NO   
										,A.WORK_ORD_DATE

								) AA
								GROUP BY DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA 
				) BB ON AA.GOODS_CD = BB.GOODS_CD WHERE AA.GOODS_CD != 'trash'

		UNION ALL

		SELECT  'ZZZZZZZZ9' GOODS_CD
				, 'CAPA 가동률(%)' GOODS_NM
				, '' QUTY_CD
				, '' QUTY_NM
				,'CAPA 가동률(%)' AS GUBUN
				,( (ISNULL(BB.[01], 0) + ISNULL(BB.[02], 0)  + ISNULL(BB.[03], 0) + ISNULL(BB.[04], 0)  + ISNULL(BB.[05], 0)  +
				ISNULL(BB.[06], 0) + ISNULL(BB.[07], 0) + ISNULL(BB.[08], 0)  + ISNULL(BB.[09], 0) + ISNULL(BB.[10], 0) +
				ISNULL(BB.[11], 0) + ISNULL(BB.[12], 0) + ISNULL(BB.[13], 0)  + ISNULL(BB.[14], 0) + ISNULL(BB.[15], 0) +
				ISNULL(BB.[16], 0) + ISNULL(BB.[17], 0) + ISNULL(BB.[18], 0)  + ISNULL(BB.[19], 0) + ISNULL(BB.[20], 0) +
				ISNULL(BB.[21], 0) + ISNULL(BB.[22], 0) + ISNULL(BB.[23], 0)  + ISNULL(BB.[24], 0) + ISNULL(BB.[25], 0) +
				ISNULL(BB.[26], 0) + ISNULL(BB.[27], 0) + ISNULL(BB.[28], 0)  + ISNULL(BB.[29], 0) + ISNULL(BB.[30], 0) + 
				ISNULL(BB.[31], 0) ) 
				* 100
				/
				(ISNULL(AA.[01], 0) + ISNULL(AA.[02], 0)  + ISNULL(AA.[03], 0) + ISNULL(AA.[04], 0)  + ISNULL(AA.[05], 0)  +
				ISNULL(AA.[06], 0) + ISNULL(AA.[07], 0) + ISNULL(AA.[08], 0)  + ISNULL(AA.[09], 0) + ISNULL(AA.[10], 0) +
				ISNULL(AA.[11], 0) + ISNULL(AA.[12], 0) + ISNULL(AA.[13], 0)  + ISNULL(AA.[14], 0) + ISNULL(AA.[15], 0) +
				ISNULL(AA.[16], 0) + ISNULL(AA.[17], 0) + ISNULL(AA.[18], 0)  + ISNULL(AA.[19], 0) + ISNULL(AA.[20], 0) +
				ISNULL(AA.[21], 0) + ISNULL(AA.[22], 0) + ISNULL(AA.[23], 0)  + ISNULL(AA.[24], 0) + ISNULL(AA.[25], 0) +
				ISNULL(AA.[26], 0) + ISNULL(AA.[27], 0) + ISNULL(AA.[28], 0)  + ISNULL(AA.[29], 0) + ISNULL(AA.[30], 0) + 
				ISNULL(AA.[31], 0))							
				) COUNT_SUM
				, ISNULL(BB.[01], 0) * 100 / ISNULL(AA.[01], 0)  AS '01'
				, ISNULL(BB.[02], 0) * 100 / ISNULL(AA.[02], 0) AS '02'
				, ISNULL(BB.[03], 0)  * 100 / ISNULL(AA.[03], 0) AS '03'
				, ISNULL(BB.[04], 0)  * 100 / ISNULL(AA.[04], 0) AS '04'
				, ISNULL(BB.[05], 0)  * 100 / ISNULL(AA.[05], 0) AS '05'
				, ISNULL(BB.[06], 0)  * 100 / ISNULL(AA.[06], 0) AS '06'
				, ISNULL(BB.[07], 0)  * 100 / ISNULL(AA.[07], 0) AS '07'
				, ISNULL(BB.[08], 0)  * 100 / ISNULL(AA.[08], 0) AS '08'
				, ISNULL(BB.[09], 0)  * 100 / ISNULL(AA.[09], 0) AS '09'
				, ISNULL(BB.[10], 0)  * 100 / ISNULL(AA.[10], 0) AS '10'
				, ISNULL(BB.[11], 0)  * 100 / ISNULL(AA.[11], 0) AS '11'
				, ISNULL(BB.[12], 0)  * 100 / ISNULL(AA.[12], 0) AS '12'
				, ISNULL(BB.[13], 0)  * 100 / ISNULL(AA.[13], 0) AS '13'
				, ISNULL(BB.[14], 0)  * 100 / ISNULL(AA.[14], 0) AS '14'
				, ISNULL(BB.[15], 0)  * 100 / ISNULL(AA.[15], 0) AS '15'
				, ISNULL(BB.[16], 0)  * 100 / ISNULL(AA.[16], 0) AS '16'
				, ISNULL(BB.[17], 0)  * 100 / ISNULL(AA.[17], 0) AS '17'
				, ISNULL(BB.[18], 0)  * 100 / ISNULL(AA.[18], 0) AS '18'
				, ISNULL(BB.[19], 0)  * 100 / ISNULL(AA.[19], 0) AS '19'
				, ISNULL(BB.[20], 0)  * 100 / ISNULL(AA.[20], 0) AS '20'
				, ISNULL(BB.[21], 0)  * 100 / ISNULL(AA.[21], 0) AS '21'
				, ISNULL(BB.[22], 0)  * 100 / ISNULL(AA.[22], 0) AS '22'
				, ISNULL(BB.[23], 0)  * 100 / ISNULL(AA.[23], 0) AS '23'
				, ISNULL(BB.[24], 0)  * 100 / ISNULL(AA.[24], 0) AS '24'
				, ISNULL(BB.[25], 0)  * 100 / ISNULL(AA.[25], 0) AS '25'
				, ISNULL(BB.[26], 0)  * 100 / ISNULL(AA.[26], 0) AS '26'
				, ISNULL(BB.[27], 0)  * 100 / ISNULL(AA.[27], 0) AS '27'
				, ISNULL(BB.[28], 0)  * 100 / ISNULL(AA.[28], 0) AS '28'
				, ISNULL(BB.[29], 0)  * 100 / ISNULL(AA.[29], 0) AS '29'
				, ISNULL(BB.[30], 0)  * 100 / ISNULL(AA.[30], 0) AS '30'
				, ISNULL(BB.[31], 0)  * 100 / ISNULL(AA.[31], 0) AS '31'
			FROM
			(  
			SELECT '차이량' EQUIP_CD
					,'trash' GOODS_CD
					, '' COUNT_TYPE_NM
					, 0 COUNT_SUM
					,  '' AS '01',  '' AS '02',  '' AS '03',  '' AS '04', '' AS '05', '' AS '06', '' AS '07', '' AS '08', '' AS '09', '' AS '10'
					,  '' AS '11',  '' AS '12',  '' AS '13',  '' AS '14', '' AS '15', '' AS '16', '' AS '17', '' AS '18', '' AS '19', '' AS '20'
					,  '' AS '21',  '' AS '22',  '' AS '23',  '' AS '24', '' AS '25', '' AS '26', '' AS '27', '' AS '28', '' AS '29', '' AS '30'
					,  '' AS '31'  				

				UNION ALL			
			
			
			SELECT * FROM
				( SELECT		
					'' EQUIP_CD
					,'999999' GOODS_CD
					, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE B WHERE B.BASE_GROUP_CD='050' AND B.BASE_CD = COUNT_TYPE_CD) COUNT_TYPE_NM
					, 0 COUNT_SUM
					, SUM(CNT) CNT
					, PLAN_DATE
				FROM TB_PRODUCTION_PLAN_NEW A, TB_EQUIP_CODE_ADM B
				WHERE 1=1
				AND A.EQUIP_CD = B.EQUIP_CD
				AND B.USE_YN_CD = '001'
				AND PLAN_DATE >= #{startDate}
				AND PLAN_DATE <= #{endDate}
				AND COUNT_TYPE_CD = '003'
				GROUP BY  A.COUNT_TYPE_CD, PLAN_DATE, CNT) AS AA
				PIVOT(SUM(CNT) FOR PLAN_DATE IN (${dayList}) ) as result_pivot
				) AA FULL OUTER JOIN 	(  
				SELECT 
			 '999999' GOODS_CD
			, '당월 합계' GOODS_NM
			, '' QUTY_CD
			, '' QUTY_NM		
			, '당월 합계' GUBUN
					,(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,
				  ISNULL([01],0) [01]
				, ISNULL([02],0) [02]
				, ISNULL([03],0) [03]
				, ISNULL([04],0) [04]
				, ISNULL([05],0) [05]
				, ISNULL([06],0) [06]
				, ISNULL([07],0) [07]
				, ISNULL([08],0) [08]
				, ISNULL([09],0) [09]
				, ISNULL([10],0) [10]
				, ISNULL([11],0) [11]
				, ISNULL([12],0) [12]
				, ISNULL([13],0) [13]
				, ISNULL([14],0) [14]
				, ISNULL([15],0) [15]
				, ISNULL([16],0) [16]
				, ISNULL([17],0) [17]
				, ISNULL([18],0) [18]
				, ISNULL([19],0) [19]
				, ISNULL([20],0) [20]
				, ISNULL([21],0) [21]
				, ISNULL([22],0) [22]
				, ISNULL([23],0) [23]
				, ISNULL([24],0) [24]
				, ISNULL([25],0) [25]
				, ISNULL([26],0) [26]
				, ISNULL([27],0) [27]
				, ISNULL([28],0) [28]
				, ISNULL([29],0) [29]
				, ISNULL([30],0) [30]
				, ISNULL([31],0) [31]
				FROM 		
				(
					SELECT *
							FROM (
							
								SELECT 					
								
									ISNULL( AA.DAY_,'') DAY_																
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) +  SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 								
									,'당월 합계' GUBUN
								FROM
								(
									SELECT
										 A.WORK_ORD_NO                     
										, ISNULL(SUM(CC.FAULTY_CNT),0) AS APPEAR_FAULTY_CNT
										, ISNULL(SUM(A.APPEAR_OUTPUT_CNT),0) AS APPEAR_OUTPUT_CNT								
										, ISNULL(SUM(B.E_FAULTY_CNT),0) AS E_FAULTY_CNT
										, ISNULL(SUM(SHIP_FAULTY_CNT),0) AS SHIP_FAULTY_CNT
										, ISNULL(SUM(RE_SHIP_FAULTY_CNT),0) AS RE_SHIP_FAULTY_CNT
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT										
										 A.WORK_ORD_NO                     
										, WORK_ORD_DATE                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
										
									 FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate} GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
									 WHERE A.WORK_ORD_NO = B.WORK_ORD_NO

									 GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE
										

									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO									
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT					
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO
								
									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO											
											, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO     
								
							LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO					
										, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
										
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS != '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) D
								ON A.WORK_ORD_NO = D.WORK_ORD_NO  
						
								LEFT OUTER JOIN 
								(
									SELECT
										B.WORK_ORD_NO
										, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
									FROM TB_WORK_ORDER A
										, (SELECT
											X.WORK_ORD_NO											
											, SUM(FAULTY_CNT) FAULTY_CNT					
											FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{startDate} AND #{endDate}) X
											WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY B.WORK_ORD_NO
								) E
								ON A.WORK_ORD_NO = E.WORK_ORD_NO  
									
									GROUP BY 
										 A.WORK_ORD_NO   
										,A.WORK_ORD_DATE

								) AA
								GROUP BY DAY_									
												
						) AS AA
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA 
				) BB ON AA.GOODS_CD = BB.GOODS_CD WHERE AA.GOODS_CD != 'trash'
		ORDER BY AAA.GOODS_CD ASC
		
		]]>
		
	</select>
	
</mapper>