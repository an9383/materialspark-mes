<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  	
<mapper namespace="mes.mappers.wm.monthProductionPlanMapper">

	<resultMap id="MonthProductionPlanVo" type="mes.domain.wm.MonthProductionPlanVo">

		<result property="equipCd"					column="EQUIP_CD"			/>	         
		<result property="equipNm"					column="EQUIP_NM"			/>	         
		<result property="goodsCd"					column="GOODS_CD"			/>	       
		<result property="goodsNm"					column="GOODS_NM"			/>			
		<result property="regId"					column="REG_ID"				/>	           
		<result property="regDate"					column="REG_DATE"			/>	         
		<result property="updId"					column="UPD_ID"				/>	           
		<result property="updDate"					column="UPD_DATE"			/>	         
	
		<result property="model"					column="MODEL"				/>				
		<result property="modelNo"					column="MODEL_NO"			/>				
		<result property="qutyCd"					column="QUTY_CD"			/>				
		<result property="qutyNm"					column="QUTY_NM"			/>				
		<result property="chamferYnNm"				column="CHAMFER_YN_NM"		/>			
		<result property="surfaceTrtmtCd"			column="SURFACE_TRTMT_CD"	/>	  
		<result property="surfaceTrtmtNm"			column="SURFACE_TRTMT_NM"	/>	  
		
		<result property="cplGubun"					column="CPL_GUBUN"			/>	
		<result property="fpDate"					column="FP_DATE"			/>	  
		<result property="npTime"					column="NP_TIME"			/>	  
		<result property="npGubun"					column="NP_GUBUN"			/>	 
		<result property="completeYn"				column="COMPLETE_YN"		/>	 
		<result property="opTime"					column="OP_TIME"			/>	 
		<result property="tecTime"					column="TEC_TIME"			/>	
		<result property="planCnt"					column="PLAN_CNT"			/>
		<result property="planCnt2"					column="PLAN_CNT2"			/>	
		<result property="jobChangeDate"			column="JOB_CHANGE_DATE"	/>	 
		<result property="jobChangeApply"			column="JOB_CHANGE_APPLY"	/>	 
		<result property="jobChangeStartDate"		column="JOB_CHANGE_START_DATE"	/>	 
		<result property="jobChangeEndDate"			column="JOB_CHANGE_END_DATE"	/>	 

		<result property="gubun"                        column="GUBUN"	/>	 
		<result property="gubunNm"                      column="GUBUN_NM"	/>	 
		<result property="dataSum"                      column="DATA_SUM"	/>	 
		<result property="dataSumSub"                   column="DATA_SUM_SUB"	/>	 
		<result property="fpDate1"                      column="FP_DATE1"	/>	 
		<result property="fpDate2"                      column="FP_DATE2"	/>	 
		<result property="fpDate3"                      column="FP_DATE3"	/>	 
		<result property="fpDate4"                      column="FP_DATE4"	/>	 
		<result property="fpDate5"                      column="FP_DATE5"	/>	 
		<result property="fpDate6"                      column="FP_DATE6"	/>	 
		<result property="fpDate7"                      column="FP_DATE7"	/>	 
		<result property="fpDate8"                      column="FP_DATE8"	/>	 
		<result property="fpDate9"                      column="FP_DATE9"	/>	 
		<result property="fpDate10"                     column="FP_DATE10"	/>	 
		<result property="fpDate11"                     column="FP_DATE11"	/>	 
		<result property="fpDate12"                     column="FP_DATE12"	/>	 
		<result property="fpDate13"                     column="FP_DATE13"	/>	 
		<result property="fpDate14"                     column="FP_DATE14"	/>	 
		<result property="fpDate15"                     column="FP_DATE15"	/>	 
		<result property="fpDate16"                     column="FP_DATE16"	/>	 
		<result property="fpDate17"                     column="FP_DATE17"	/>	 
		<result property="fpDate18"                     column="FP_DATE18"	/>	 
		<result property="fpDate19"                     column="FP_DATE19"	/>	 
		<result property="fpDate20"                     column="FP_DATE20"	/>	 
		<result property="fpDate21"                     column="FP_DATE21"	/>	 
		<result property="fpDate22"                     column="FP_DATE22"	/>	 
		<result property="fpDate23"                     column="FP_DATE23"	/>	 
		<result property="fpDate24"                     column="FP_DATE24"	/>	 
		<result property="fpDate25"                     column="FP_DATE25"	/>	 
		<result property="fpDate26"                     column="FP_DATE26"	/>	 
		<result property="fpDate27"                     column="FP_DATE27"	/>	 
		<result property="fpDate28"                     column="FP_DATE28"	/>	 
		<result property="fpDate29"                     column="FP_DATE29"	/>	 
		<result property="fpDate30"                     column="FP_DATE30"	/>	 
		<result property="fpDate31"                     column="FP_DATE31"	/>	 
		
		<result property="dayNightGubun"			    column="DAY_NIGHT_GUBUN" />
		<result property="productGroup"                 column="PRODUCT_GROUP"	 />
		<result property="productMan"                   column="PRODUCT_MAN"	 />
		
		<result property="gijongCd"                     column="GIJONG_CD"	 	/>
		<result property="gijongNm"                     column="GIJONG_NM"	 	/>
		
		<result property="day_"                         column="DAY_"				/>
		<result property="gubunCnt"                     column="GUBUN_CNT"			/>
		<result property="maxValue"                     column="MAX_VALUE"	 		/>
		<result property="sumOutputCnt"					column="SUM_OUPUT_CNT"	 	/>
		
		<result property="theoryCapa"               	column="THEORY_CAPA"		/>
		<result property="theoryEquipCnt"           	column="THEORY_EQUIP_CNT"	/>
		<result property="theoryPlanCnt"           	    column="THEORY_PLAN_CNT"	/>
		<result property="dualCapa"                	    column="DUAL_CAPA"	 		/>
		<result property="equipCnt"               	    column="EQUIP_CNT"	 		/>
		<result property="yeild1"                       column="YEILD1"	 		/>
		<result property="yeild2"                       column="YEILD2"	 		/>
		<result property="yeildTotal"                   column="YEILD_TOTAL"	 		/>
		
		<result property="outGubun"                		column="OUT_GUBUN"	 			/>
		<result property="dealCorpCd"               	column="DEAL_CORP_CD"	 		/>
		<result property="dealCorpNm"              	 	column="DEAL_CORP_NM"	 		/>
		<result property="lastMonthStock"           	column="LAST_MONTH_STOCK"	 	/>
		<result property="outputCnt"                	column="OUTPUT_CNT"	 			/>
		<result property="memo"                         column="MEMO"		/>	
		<result property="memoGubun"                    column="MEMO_GUBUN"		/>	
		<result property="planDate"                     column="PLAN_DATE"	/>	

	</resultMap>
	
	<resultMap id="TestDataVo" type="mes.domain.wm.TestDataVo">

		<result property="equipCd"					column="EQUIP_CD"			/>	         
		<result property="equipNm"					column="EQUIP_NM"			/>	         
		<result property="goodsCd"					column="GOODS_CD"			/>	       
		<result property="goodsNm"					column="GOODS_NM"			/>		

		<result property="gubun"                        column="GUBUN"	/>	 
		<result property="gubunNm"                      column="GUBUN_NM"	/>	 
		<result property="dataSum"                      column="DATA_SUM"	/>	 

		<result property="fpDate1"                      column="FP_DATE1"	/>	 
		<result property="fpDate2"                      column="FP_DATE2"	/>	 
		<result property="fpDate3"                      column="FP_DATE3"	/>	 
		<result property="fpDate4"                      column="FP_DATE4"	/>	 
		<result property="fpDate5"                      column="FP_DATE5"	/>	 
		<result property="fpDate6"                      column="FP_DATE6"	/>	 
		<result property="fpDate7"                      column="FP_DATE7"	/>	 
		<result property="fpDate8"                      column="FP_DATE8"	/>	 
		<result property="fpDate9"                      column="FP_DATE9"	/>	 
		<result property="fpDate10"                     column="FP_DATE10"	/>	 
		<result property="fpDate11"                     column="FP_DATE11"	/>	 
		<result property="fpDate12"                     column="FP_DATE12"	/>	 
		<result property="fpDate13"                     column="FP_DATE13"	/>	 
		<result property="fpDate14"                     column="FP_DATE14"	/>	 
		<result property="fpDate15"                     column="FP_DATE15"	/>	 
		<result property="fpDate16"                     column="FP_DATE16"	/>	 
		<result property="fpDate17"                     column="FP_DATE17"	/>	 
		<result property="fpDate18"                     column="FP_DATE18"	/>	 
		<result property="fpDate19"                     column="FP_DATE19"	/>	 
		<result property="fpDate20"                     column="FP_DATE20"	/>	 
		<result property="fpDate21"                     column="FP_DATE21"	/>	 
		<result property="fpDate22"                     column="FP_DATE22"	/>	 
		<result property="fpDate23"                     column="FP_DATE23"	/>	 
		<result property="fpDate24"                     column="FP_DATE24"	/>	 
		<result property="fpDate25"                     column="FP_DATE25"	/>	 
		<result property="fpDate26"                     column="FP_DATE26"	/>	 
		<result property="fpDate27"                     column="FP_DATE27"	/>	 
		<result property="fpDate28"                     column="FP_DATE28"	/>	 
		<result property="fpDate29"                     column="FP_DATE29"	/>	 
		<result property="fpDate30"                     column="FP_DATE30"	/>	 
		<result property="fpDate31"                     column="FP_DATE31"	/>	 
		


	</resultMap>
	

	
	<!-- 월별 FP 목록 조회 -->
	<select id="monthProductionPlanListGubun" resultType="HashMap" parameterType="mes.domain.wm.MonthProductionPlanVo" >		
	
			SELECT DISTINCT 
				LEFT(A.equip_nm,5) EQUIP_NM
				, LEFT(A.EQUIP_CD,10) EQUIP_CD 				
				<!-- ,ISNULL((SELECT TOP(1) GOODS_CD FROM TB_MONTH_PRODUCTION_PLAN_DTL X WHERE LEFT(FP_DATE,6) = #{fpDate}
					AND CPL_GUBUN = '001' AND X.EQUIP_CD = LEFT(A.EQUIP_CD,10)),E.GOODS_CD) GOODS_CD
			    ,ISNULL((SELECT TOP(1) (SELECT GOODS_NM FROM TB_GOODS_CODE_ADM WHERE GOODS_CD =  X.GOODS_CD  ) GOODS_NM FROM TB_MONTH_PRODUCTION_PLAN_DTL X WHERE LEFT(FP_DATE,6) = #{fpDate}
					AND CPL_GUBUN = '001' AND X.EQUIP_CD = LEFT(A.EQUIP_CD,10)),D.GOODS_NM) GOODS_NM
				,C.QUTY_CD
				,(SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '007' AND C.QUTY_CD = X.BASE_CD) QUTY_NM -->
				, ISNULL(E.GOODS_CD,'') GOODS_CD
			    , ISNULL(D.GOODS_NM,'') GOODS_NM
				, ISNULL(C.QUTY_CD,'')  QUTY_CD
				, ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '007' AND C.QUTY_CD = X.BASE_CD),'') QUTY_NM
				, B.*
			from TB_EQUIP_CODE_ADM A 
			LEFT OUTER JOIN
			(
					
				    SELECT * FROM
				   (SELECT 
					EQUIP_CD EQUIP_CD_PLAN,					
					NP_GUBUN,					
					FP_DATE		

					FROM		
					TB_MONTH_PRODUCTION_PLAN B
					WHERE LEFT(FP_DATE,6) = #{fpDate}
					AND CPL_GUBUN = #{cplGubun}

				
						) A
					PIVOT(MAX(NP_GUBUN) FOR FP_DATE IN (${dayList})) as pivot_reslut
			) B
			
			ON 1=1
			AND LEFT(A.EQUIP_CD,10) = B.EQUIP_CD_PLAN
			<if test="fpGubunja == null or fpGubunja == ''">
			LEFT OUTER JOIN
				(
					SELECT DISTINCT EQUIP_CD,GOODS_CD FROM TB_MONTH_PRODUCTION_GOODS
					WHERE FP_DATE= #{fpDate} + '01'
					AND CPL_GUBUN = #{cplGubun}					
					
				) E
				ON 1=1
				AND LEFT(A.EQUIP_CD,10) = LEFT(E.EQUIP_CD,10)
			</if>

			<if test="fpGubunja != null and fpGubunja != ''"> 
				<if test="fpGubunja == '001'"> 
					LEFT OUTER JOIN
						(
							SELECT DISTINCT EQUIP_CD,GOODS_CD FROM TB_MONTH_PRODUCTION_GOODS
							WHERE FP_DATE= #{fpDate} + '01'
							AND CPL_GUBUN = #{cplGubun}
							
							
						) E
						ON 1=1
						AND LEFT(A.EQUIP_CD,10) = LEFT(E.EQUIP_CD,10)
				</if>
				<if test="fpGubunja == '002'"> 
					LEFT OUTER JOIN
					(
						SELECT DISTINCT EQUIP_CD,GOODS_CD FROM TB_MONTH_PRODUCTION_PLAN_DTL
						WHERE FP_DATE= REPLACE(DATEADD(DAY, -1 ,CONVERT(DATE, CONVERT(VARCHAR(6),#{fpDate},112)+ '01')),'-','')
						AND CPL_GUBUN = #{cplGubun}
						
						
					) E
					ON 1=1
					AND LEFT(A.EQUIP_CD,10) = LEFT(E.EQUIP_CD,10)
				</if>
				<if test="fpGubunja == '003'"> 
					LEFT OUTER JOIN
					TB_EQUIP_COND_COMMON_ADM E
					ON 1=1
					AND LEFT(A.EQUIP_CD,10) = LEFT(E.EQUIP_CD,10)
					AND E.FP_MAIN_GUBUN = '001'
				</if>
			</if>
			

			LEFT OUTER JOIN
			TB_GOODS_CODE_ADM D
			ON 1=1
			AND D.GOODS_CD = E.GOODS_CD

			LEFT OUTER JOIN
			TB_MATRL_CODE_ADM C
			ON 1=1
			AND C.MATRL_CD = D.ALNICU_MATRL_CD
			

	</select >
	
	<!-- 월별 FP 목록 조회 -->
	<select id="monthProductionPlanListTime" resultType="HashMap" parameterType="mes.domain.wm.MonthProductionPlanVo" >		
	
			SELECT DISTINCT 
				LEFT(A.equip_nm,5) EQUIP_NM
				, LEFT(A.EQUIP_CD,10) EQUIP_CD 				
				<!-- ,ISNULL((SELECT TOP(1) GOODS_CD FROM TB_MONTH_PRODUCTION_PLAN_DTL X WHERE LEFT(FP_DATE,6) = #{fpDate}
					AND CPL_GUBUN = '001' AND X.EQUIP_CD = LEFT(A.EQUIP_CD,10)),E.GOODS_CD) GOODS_CD
			    ,ISNULL((SELECT TOP(1) (SELECT GOODS_NM FROM TB_GOODS_CODE_ADM WHERE GOODS_CD =  X.GOODS_CD  ) GOODS_NM FROM TB_MONTH_PRODUCTION_PLAN_DTL X WHERE LEFT(FP_DATE,6) = #{fpDate}
					AND CPL_GUBUN = '001' AND X.EQUIP_CD = LEFT(A.EQUIP_CD,10)),D.GOODS_NM) GOODS_NM
				, C.QUTY_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '007' AND C.QUTY_CD = X.BASE_CD) QUTY_NM -->
				, ISNULL(E.GOODS_CD,'') GOODS_CD
			    , ISNULL(D.GOODS_NM,'') GOODS_NM
				, ISNULL(C.QUTY_CD,'')  QUTY_CD
				, ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '007' AND C.QUTY_CD = X.BASE_CD),'') QUTY_NM
				, B.*
			from TB_EQUIP_CODE_ADM A 
			LEFT OUTER JOIN
			(
					
				   SELECT * FROM
				   (SELECT 
					EQUIP_CD EQUIP_CD_PLAN,					
					CONVERT(INT,NP_TIME) NP_TIME,
					FP_DATE		
		
					FROM		
					TB_MONTH_PRODUCTION_PLAN B
					WHERE LEFT(FP_DATE,6) = #{fpDate}
					AND CPL_GUBUN = #{cplGubun}
					
			

						) A
					PIVOT(SUM(NP_TIME) FOR FP_DATE IN (${dayList})) as pivot_reslut
			) B
			
			ON 1=1
			AND LEFT(A.EQUIP_CD,10) = B.EQUIP_CD_PLAN
			<if test="fpGubunja == null or fpGubunja == ''">
			LEFT OUTER JOIN
				(
					SELECT DISTINCT EQUIP_CD,GOODS_CD FROM TB_MONTH_PRODUCTION_GOODS
					WHERE FP_DATE= #{fpDate} + '01'
					AND CPL_GUBUN = #{cplGubun}
					
					
				) E
				ON 1=1
				AND LEFT(A.EQUIP_CD,10) = LEFT(E.EQUIP_CD,10)
			</if>
			<if test="fpGubunja != null and fpGubunja != ''"> 
				<if test="fpGubunja == '001'"> 
					LEFT OUTER JOIN
						(
							SELECT DISTINCT EQUIP_CD,GOODS_CD FROM TB_MONTH_PRODUCTION_GOODS
							WHERE FP_DATE= #{fpDate} + '01'
							AND CPL_GUBUN = #{cplGubun}
							
							
						) E
						ON 1=1
						AND LEFT(A.EQUIP_CD,10) = LEFT(E.EQUIP_CD,10)
				</if>
				<if test="fpGubunja == '002'"> 
					LEFT OUTER JOIN
					(
						SELECT DISTINCT EQUIP_CD,GOODS_CD FROM TB_MONTH_PRODUCTION_PLAN_DTL
						WHERE FP_DATE= REPLACE(DATEADD(DAY, -1 ,CONVERT(DATE, CONVERT(VARCHAR(6),#{fpDate},112)+ '01')),'-','')
						AND CPL_GUBUN = #{cplGubun}
						
						
					) E
					ON 1=1
					AND LEFT(A.EQUIP_CD,10) = LEFT(E.EQUIP_CD,10)
				</if>
				<if test="fpGubunja == '003'"> 
					LEFT OUTER JOIN
					TB_EQUIP_COND_COMMON_ADM E
					ON 1=1
					AND LEFT(A.EQUIP_CD,10) = LEFT(E.EQUIP_CD,10)
					AND E.FP_MAIN_GUBUN = '001'
				</if>
			</if>

			LEFT OUTER JOIN
			TB_GOODS_CODE_ADM D
			ON 1=1
			AND D.GOODS_CD = E.GOODS_CD

			LEFT OUTER JOIN
			TB_MATRL_CODE_ADM C
			ON 1=1
			AND C.MATRL_CD = D.ALNICU_MATRL_CD
			

	</select >	
	
	<!-- 월별 FP 확정여부 체크 -->
	<select id="checkCompleteYn" resultMap="MonthProductionPlanVo" >
			
		SELECT DISTINCT 
			COMPLETE_YN 
		FROM TB_MONTH_PRODUCTION_PLAN 
		WHERE 
		CPL_GUBUN = #{cplGubun}
		AND LEFT(FP_DATE,6) = #{fpDate}
		
	</select >
	
	<!-- 월별 FP 잡체인지 체크 -->
	<select id="checkJobChange" resultType="int" >
			
		SELECT DISTINCT 
			COUNT(NP_GUBUN) NP_GUBUN
			 
		FROM TB_MONTH_PRODUCTION_PLAN
		WHERE 
		CPL_GUBUN = #{cplGubun}
		AND LEFT(FP_DATE,6) = #{fpDate}
		AND NP_GUBUN = '999'
		
	</select >
	
	<!-- 월별 FP 잡체인지 모달 -->
	<select id="jobChangeModal" resultMap="MonthProductionPlanVo" >
			
		SELECT DISTINCT 
			LEFT(B.EQUIP_CD,10) EQUIP_CD,
			LEFT(C.EQUIP_NM,5) EQUIP_NM,
			ISNULL(A.GOODS_CD,(SELECT GOODS_CD FROM TB_EQUIP_COND_COMMON_ADM X WHERE LEFT(X.EQUIP_CD,10) = LEFT(B.EQUIP_CD,10) AND X.FP_MAIN_GUBUN = '001')) GOODS_CD,
			ISNULL((SELECT GOODS_NM FROM TB_GOODS_CODE_ADM WHERE A.GOODS_CD = GOODS_CD)
			,(SELECT GOODS_NM FROM TB_EQUIP_COND_COMMON_ADM X, TB_GOODS_CODE_ADM Z WHERE LEFT(X.EQUIP_CD,10) = LEFT(B.EQUIP_CD,10) AND X.FP_MAIN_GUBUN = '001' AND X.GOODS_CD = Z.GOODS_CD)
			) GOODS_NM,		
			OP_TIME,			
			JOB_CHANGE_DATE,
			JOB_CHANGE_START_DATE,
			JOB_CHANGE_END_DATE
			
		FROM
			TB_EQUIP_COND_COMMON_ADM B
		LEFT OUTER JOIN
			TB_MONTH_PRODUCTION_PLAN_DTL A
			ON 1=1
				AND LEFT(A.EQUIP_CD,10) = LEFT(B.EQUIP_CD,10)				
				AND CPL_GUBUN = #{cplGubun}
				AND JOB_CHANGE_DATE = #{fpDate}
			,TB_EQUIP_CODE_ADM C
		WHERE
			LEFT(B.EQUIP_CD,10) = #{equipCd}
			AND C.EQUIP_CD = B.EQUIP_CD
		
		
	</select >
			
	<!-- 월별 FP 확정여부 수정 -->
	<update id="updateCompleteYn">
			
		UPDATE TB_MONTH_PRODUCTION_PLAN
		SET 
			COMPLETE_YN = #{completeYn}
			,UPD_ID = #{updId}
			,UPD_DATE = getDate() 		
		WHERE 
		CPL_GUBUN = #{cplGubun}
		AND LEFT(FP_DATE,6) = #{fpDate}
		
		UPDATE TB_MONTH_PRODUCTION_PLAN_DTL
		SET 
			COMPLETE_YN = #{completeYn}
			,UPD_ID = #{updId}
			,UPD_DATE = getDate() 		
		WHERE 
		CPL_GUBUN = #{cplGubun}
		AND LEFT(FP_DATE,6) = #{fpDate}
		
	</update >
	
		
	<!-- 월별 FP 목록 등록 -->
	<insert id="create" parameterType="java.util.List">
	
		INSERT INTO TB_MONTH_PRODUCTION_PLAN
        (  CPL_GUBUN
           ,EQUIP_CD           
           ,FP_DATE
           ,NP_TIME
           ,NP_GUBUN
           ,COMPLETE_YN
           ,OP_TIME          
           ,REG_ID
           ,REG_DATE
        )
    	VALUES 
    	<foreach collection="list" item="item" separator=",">
	    	(
	    	
	    		#{item.cplGubun}
	    		,#{item.equipCd}    	
				,#{item.fpDate}
				,#{item.npTime}		
				,#{item.npGubun}		
				,#{item.completeYn}	
				,#{item.opTime}				
				,#{item.regId}
				,getDate()
			
	    	)
		</foreach>

	</insert >
	
	<!-- 월별 FP 목록 상세 등록 -->
	<insert id="createDtl" parameterType="java.util.List">
		INSERT INTO TB_MONTH_PRODUCTION_PLAN_DTL
        (  CPL_GUBUN
           ,EQUIP_CD
           ,GOODS_CD
           ,FP_DATE
           ,OP_TIME
           ,TEC_TIME
           ,PLAN_CNT
           ,JOB_CHANGE_DATE
           ,JOB_CHANGE_START_DATE
           ,JOB_CHANGE_END_DATE
           ,COMPLETE_YN          
           ,REG_ID
           ,REG_DATE
        )
    	VALUES
    	<foreach collection="list" item="item" separator=",">
	    	 (
	    		 #{item.cplGubun}
	    		,#{item.equipCd}
	    		,#{item.goodsCd}
				,#{item.fpDate}			
				,#{item.opTime}		
				,#{item.tecTime}		
				,#{item.planCnt}		
				,#{item.jobChangeDate}
				,#{item.jobChangeStartDate}
				,#{item.jobChangeEndDate}
				,#{item.completeYn}				
				,#{item.regId}
				,getDate()
	    	)
		</foreach>
	</insert >
	
	<!-- 월별 FP 목록 설비별 제품 등록 -->
	<insert id="createGoods" parameterType="java.util.List">
		INSERT INTO TB_MONTH_PRODUCTION_GOODS
        (  CPL_GUBUN
           ,EQUIP_CD
           ,GOODS_CD
           ,FP_DATE      
           ,REG_ID
           ,REG_DATE
        )
    	VALUES
    	<foreach collection="list" item="item" separator=",">
	    	 (
	    		 #{item.cplGubun}
	    		,#{item.equipCd}
	    		,#{item.goodsCd}
				,#{item.fpDate}					
				,#{item.regId}
				,getDate()
	    	)
		</foreach>
	</insert >
	
	<!-- 월별 FP 목록 삭제-->
	<delete id="delete">
		DELETE TB_MONTH_PRODUCTION_PLAN
		WHERE 1=1	
		<if test="cplGubun != null and cplGubun != ''"> 
			AND CPL_GUBUN = #{cplGubun}
		</if>
		<if test="equipCd != null and equipCd != ''"> 
			AND EQUIP_CD = #{equipCd}
		</if>
		<if test="fpDate != null and fpDate != ''"> 
			AND LEFT(FP_DATE,6) = #{fpDate}
		</if>
		<if test="chooseDateFrom != null and chooseDateFrom != ''"> 
			AND FP_DATE = #{chooseDateFrom}
		</if>
	</delete >
	
		
	<!-- 월별 FP 목록 상세 삭제-->
	<delete id="deleteDtl">
		DELETE TB_MONTH_PRODUCTION_PLAN_DTL
		WHERE 1=1	
		<if test="cplGubun != null and cplGubun != ''"> 
			AND CPL_GUBUN = #{cplGubun}
		</if>
		<if test="equipCd != null and equipCd != ''"> 
			AND EQUIP_CD = #{equipCd}
		</if>
		<if test="goodsCd != null and goodsCd != ''"> 
			AND GOODS_CD = #{goodsCd}
		</if>
		<if test="fpDate != null and fpDate != ''"> 
			AND LEFT(FP_DATE,6) = #{fpDate}
		</if>
		<if test="chooseDateFrom != null and chooseDateFrom != ''"> 
			AND FP_DATE = #{chooseDateFrom}
		</if>
	</delete >
	
	<!-- 월별 FP 제품 목록 삭제-->
	<delete id="deleteGoods">
		DELETE TB_MONTH_PRODUCTION_GOODS
		WHERE 1=1	
		<if test="cplGubun != null and cplGubun != ''"> 
			AND CPL_GUBUN = #{cplGubun}
		</if>
		<if test="equipCd != null and equipCd != ''"> 
			AND EQUIP_CD = #{equipCd}
		</if>
		<if test="fpDate != null and fpDate != ''"> 
			AND LEFT(FP_DATE,6) = #{fpDate}
		</if>
	</delete >
	
	
	<!-- 월별 FP 잡체인지 업데이트 -->
	<update id="jobChangeUpdate">
		UPDATE TB_MONTH_PRODUCTION_PLAN_DTL
		SET GOODS_CD = #{goodsCd}
		, TEC_TIME = #{tecTime}
		WHERE 1=1			
			AND FP_DATE >= #{jobChangeStartDate}
			AND #{jobChangeEndDate} >= FP_DATE
			AND EQUIP_CD = #{equipCd} 
			AND CPL_GUBUN = #{cplGubun}	
			
		UPDATE TB_MONTH_PRODUCTION_PLAN_DTL
			 set TB_MONTH_PRODUCTION_PLAN_DTL.PLAN_CNT = A.PLAN_CNT

			from ( SELECT 
			   B.CPL_GUBUN
			  ,EQUIP_CD
			  ,GOODS_CD
			  ,B.FP_DATE
			  ,OP_TIME
			  ,TEC_TIME
			  ,(A.YEILD_TOTAL) DATA_SUM_SUB
			  ,(((B.OP_TIME * 60 * 60) / TEC_TIME )* (SELECT DISTINCT EQUIP_CAPA FROM TB_EQUIP_CODE_ADM X WHERE LEFT(X.EQUIP_CD,10) = B.EQUIP_CD) * A.YEILD_TOTAL) as PLAN_CNT
			  
			  FROM								 
			TB_MONTH_PRODUCTION_PLAN_DTL B,
			TB_MONTH_PRODUCTION_PLAN_YEILD A
			WHERE B.CPL_GUBUN = #{cplGubun}	
			AND A.FP_DATE = LEFT(B.FP_DATE,6)
			AND EQUIP_CD = #{equipCd} 
			AND B.FP_DATE >= #{jobChangeStartDate}
			AND #{jobChangeEndDate} >= B.FP_DATE) A
			WHERE 1=1			
			AND A.CPL_GUBUN = TB_MONTH_PRODUCTION_PLAN_DTL.CPL_GUBUN
			AND A.FP_DATE = TB_MONTH_PRODUCTION_PLAN_DTL.FP_DATE
			AND A.EQUIP_CD = TB_MONTH_PRODUCTION_PLAN_DTL.EQUIP_CD
			AND A.GOODS_CD = TB_MONTH_PRODUCTION_PLAN_DTL.GOODS_CD
		
	</update >
	
	<!-- 월별 FP 설비별, 제품별 테이블 조회 -->
	<select id="readDtl" resultMap="MonthProductionPlanVo" >
			
		SELECT CPL_GUBUN
		      ,EQUIP_CD
		      ,GOODS_CD
		      ,FP_DATE
		      ,OP_TIME
		      ,TEC_TIME
		      ,PLAN_CNT
		      ,JOB_CHANGE_DATE
		      ,JOB_CHANGE_START_DATE
		      ,JOB_CHANGE_END_DATE
		      ,COMPLETE_YN		      
		      ,REG_ID
		      ,REG_DATE
			
		FROM TB_MONTH_PRODUCTION_PLAN_DTL
		WHERE 1=1
			<if test="cplGubun != null and cplGubun != ''"> 
			AND CPL_GUBUN = #{cplGubun}
			</if>
			<if test="equipCd != null and equipCd != ''"> 
				AND EQUIP_CD = #{equipCd}
			</if>
			<if test="goodsCd != null and goodsCd != ''"> 
				AND GOODS_CD = #{goodsCd}
			</if>
			<if test="fpDate != null and fpDate != ''"> 
				AND LEFT(FP_DATE,6) = #{fpDate}
			</if>
			<if test="chooseDateFrom != null and chooseDateFrom != ''"> 
				AND FP_DATE = #{chooseDateFrom}
			</if>
			<if test="jobChangeDate != null and jobChangeDate != ''"> 
				AND JOB_CHANGE_DATE IS NOT NULL
			</if>
		
		
	</select >
	
	<!-- 월별 FP 듀얼케파 확정 등록 -->
	<insert id="createCplDualCapa">
		INSERT INTO TB_FP_TOTAL_COMPLETE(
			GUBUN
			,CPL_GUBUN
			,EQUIP_CD
			,GOODS_CD
			,FP_DATE	
			,DATA_SUM
			,DATA_SUM_SUB
			,FP_DATE1
			,FP_DATE2
			,FP_DATE3
			,FP_DATE4
			,FP_DATE5
			,FP_DATE6
			,FP_DATE7
			,FP_DATE8
			,FP_DATE9
			,FP_DATE10
			,FP_DATE11
			,FP_DATE12
			,FP_DATE13
			,FP_DATE14
			,FP_DATE15
			,FP_DATE16
			,FP_DATE17
			,FP_DATE18
			,FP_DATE19
			,FP_DATE20
			,FP_DATE21
			,FP_DATE22
			,FP_DATE23
			,FP_DATE24
			,FP_DATE25
			,FP_DATE26
			,FP_DATE27
			,FP_DATE28
			,FP_DATE29
			,FP_DATE30
			,FP_DATE31			
			,REG_ID
			,REG_DATE
		)
		
		SELECT 
			'001' GUBUN
			,CPL_GUBUN
			,EQUIP_CD
			,GOODS_CD				 			
			, #{fpDate} FP_DATE
			, ${dataSum} DATA_SUM
			, DATA_SUM_SUB
			, ${dayListNull}
			, #{regId} REG_ID
			 ,getDate() REG_DATE
			
		FROM
		   (  SELECT 
			   B.CPL_GUBUN
			  ,EQUIP_CD
			  ,GOODS_CD
			  ,B.FP_DATE
			  ,(A.YEILD_TOTAL) DATA_SUM_SUB
			  ,(((B.OP_TIME * 60 * 60) / TEC_TIME )* (SELECT DISTINCT EQUIP_CAPA FROM TB_EQUIP_CODE_ADM X WHERE LEFT(X.EQUIP_CD,10) = B.EQUIP_CD)) PLAN_CNT
					
			FROM						
			 
			TB_MONTH_PRODUCTION_PLAN_DTL B,
			TB_MONTH_PRODUCTION_PLAN_YEILD A
			WHERE LEFT(B.FP_DATE,6) = #{fpDate}
			AND B.CPL_GUBUN = #{cplGubun}		
			AND A.FP_DATE = LEFT(B.FP_DATE,6)
			<if test="equipCd != null and equipCd != ''"> 
				AND EQUIP_CD = #{equipCd}
			</if>
			<if test="goodsCd != null and goodsCd != ''"> 
				AND GOODS_CD = #{goodsCd}
			</if>	
				) A
			PIVOT(SUM([PLAN_CNT]) FOR FP_DATE IN (			
			${dayList}			
			)) as pivot_reslut
	</insert >


	
	<!-- 월별 FP 택타임 확정 등록 -->
	<insert id="createCplTecTime">
		SET ANSI_WARNINGS OFF
		SET ARITHIGNORE ON
		SET ARITHABORT OFF

		INSERT INTO TB_FP_TOTAL_COMPLETE(
			GUBUN
			,CPL_GUBUN
			,EQUIP_CD
			,GOODS_CD
			,FP_DATE	
			,DATA_SUM
			,FP_DATE1
			,FP_DATE2
			,FP_DATE3
			,FP_DATE4
			,FP_DATE5
			,FP_DATE6
			,FP_DATE7
			,FP_DATE8
			,FP_DATE9
			,FP_DATE10
			,FP_DATE11
			,FP_DATE12
			,FP_DATE13
			,FP_DATE14
			,FP_DATE15
			,FP_DATE16
			,FP_DATE17
			,FP_DATE18
			,FP_DATE19
			,FP_DATE20
			,FP_DATE21
			,FP_DATE22
			,FP_DATE23
			,FP_DATE24
			,FP_DATE25
			,FP_DATE26
			,FP_DATE27
			,FP_DATE28
			,FP_DATE29
			,FP_DATE30
			,FP_DATE31			
			,REG_ID
			,REG_DATE
		)
		
		SELECT 
			'002' GUBUN
			,CPL_GUBUN
			,EQUIP_CD
			,GOODS_CD				 			
			, #{fpDate} FP_DATE
			, TEC_TIME DATA_SUM
			, ${dayListNull}
			, #{regId} REG_ID
			 ,getDate() REG_DATE
			
		FROM
		   (SELECT 
			   CPL_GUBUN
			  ,EQUIP_CD
			  ,GOODS_CD
			  ,FP_DATE
			  ,TEC_TIME	
			  ,OP_TIME * 60 OP_TIME	
					
			FROM						
			 
			TB_MONTH_PRODUCTION_PLAN_DTL B
			WHERE LEFT(FP_DATE,6) = #{fpDate}
			AND CPL_GUBUN = #{cplGubun}		
			<if test="equipCd != null and equipCd != ''"> 
				AND EQUIP_CD = #{equipCd}
			</if>
			<if test="goodsCd != null and goodsCd != ''"> 
				AND GOODS_CD = #{goodsCd}
			</if>	
				) A
			PIVOT(SUM(OP_TIME) FOR FP_DATE IN (			
			${dayList}			
			)) as pivot_reslut
	</insert >
	
	<!-- 월별 FP second 확정 등록 -->
	<insert id="createCplSecond">
		SET ANSI_WARNINGS OFF
		SET ARITHIGNORE ON
		SET ARITHABORT OFF
		INSERT INTO TB_FP_TOTAL_COMPLETE(
			GUBUN
			,CPL_GUBUN
			,EQUIP_CD
			,GOODS_CD
			,FP_DATE	
			,DATA_SUM
			,FP_DATE1
			,FP_DATE2
			,FP_DATE3
			,FP_DATE4
			,FP_DATE5
			,FP_DATE6
			,FP_DATE7
			,FP_DATE8
			,FP_DATE9
			,FP_DATE10
			,FP_DATE11
			,FP_DATE12
			,FP_DATE13
			,FP_DATE14
			,FP_DATE15
			,FP_DATE16
			,FP_DATE17
			,FP_DATE18
			,FP_DATE19
			,FP_DATE20
			,FP_DATE21
			,FP_DATE22
			,FP_DATE23
			,FP_DATE24
			,FP_DATE25
			,FP_DATE26
			,FP_DATE27
			,FP_DATE28
			,FP_DATE29
			,FP_DATE30
			,FP_DATE31			
			,REG_ID
			,REG_DATE
		)
		
		SELECT 
			'003' GUBUN
			,CPL_GUBUN
			,EQUIP_CD
			,GOODS_CD				 			
			, #{fpDate} FP_DATE
			, '60' DATA_SUM
			, ${dayListNull}
			, #{regId} REG_ID
			 ,getDate() REG_DATE
			
		FROM
		   (SELECT 
			   CPL_GUBUN
			  ,EQUIP_CD
			  ,GOODS_CD
			  ,FP_DATE
			  ,TEC_TIME	
			,OP_TIME*60*60 OP_TIME	
					
			FROM						
			 
			TB_MONTH_PRODUCTION_PLAN_DTL B
			WHERE LEFT(FP_DATE,6) = #{fpDate}
			AND CPL_GUBUN = #{cplGubun}						
			<if test="equipCd != null and equipCd != ''"> 
				AND EQUIP_CD = #{equipCd}
			</if>
			<if test="goodsCd != null and goodsCd != ''"> 
				AND GOODS_CD = #{goodsCd}
			</if>
				) A
			PIVOT(SUM(OP_TIME) FOR FP_DATE IN (			
			${dayList}			
			)) as pivot_reslut
	</insert >
	
	
	
	
	<!-- 월별 FP 확정수량 확정 등록 -->
	<insert id="createCplPlanCnt">
		SET ANSI_WARNINGS OFF
		SET ARITHIGNORE ON
		SET ARITHABORT OFF
		INSERT INTO TB_FP_TOTAL_COMPLETE(
			GUBUN
			,CPL_GUBUN
			,EQUIP_CD
			,GOODS_CD
			,FP_DATE	
			,DATA_SUM
			,FP_DATE1
			,FP_DATE2
			,FP_DATE3
			,FP_DATE4
			,FP_DATE5
			,FP_DATE6
			,FP_DATE7
			,FP_DATE8
			,FP_DATE9
			,FP_DATE10
			,FP_DATE11
			,FP_DATE12
			,FP_DATE13
			,FP_DATE14
			,FP_DATE15
			,FP_DATE16
			,FP_DATE17
			,FP_DATE18
			,FP_DATE19
			,FP_DATE20
			,FP_DATE21
			,FP_DATE22
			,FP_DATE23
			,FP_DATE24
			,FP_DATE25
			,FP_DATE26
			,FP_DATE27
			,FP_DATE28
			,FP_DATE29
			,FP_DATE30
			,FP_DATE31			
			,REG_ID
			,REG_DATE
		)
		
		SELECT 
			'004' GUBUN
			,CPL_GUBUN
			,EQUIP_CD
			,GOODS_CD				 			
			, #{fpDate} FP_DATE
			, ${dataSum} DATA_SUM
			, ${dayListNull}
			, #{regId} REG_ID
			 ,getDate() REG_DATE
			
		FROM
		   (SELECT 
			   CPL_GUBUN
			  ,EQUIP_CD
			  ,GOODS_CD
			  ,FP_DATE
			  ,PLAN_CNT PLAN_CNT
			FROM						
			 
			TB_MONTH_PRODUCTION_PLAN_DTL B
			WHERE LEFT(FP_DATE,6) = #{fpDate}
			AND CPL_GUBUN = #{cplGubun}
			<if test="equipCd != null and equipCd != ''"> 
				AND EQUIP_CD = #{equipCd}
			</if>
			<if test="goodsCd != null and goodsCd != ''"> 
				AND GOODS_CD = #{goodsCd}
			</if>
								
				) A
			PIVOT(SUM([PLAN_CNT]) FOR FP_DATE IN (			
			${dayList}			
			)) as pivot_reslut
	</insert>
	
	<!-- 월별 FP 운영수량 확정 등록 -->
	<insert id="createCplPlanCntModify">
		SET ANSI_WARNINGS OFF
		SET ARITHIGNORE ON
		SET ARITHABORT OFF
		INSERT INTO TB_FP_TOTAL_COMPLETE(
			GUBUN
			,CPL_GUBUN
			,EQUIP_CD
			,GOODS_CD
			,FP_DATE	
			,DATA_SUM
			,FP_DATE1
			,FP_DATE2
			,FP_DATE3
			,FP_DATE4
			,FP_DATE5
			,FP_DATE6
			,FP_DATE7
			,FP_DATE8
			,FP_DATE9
			,FP_DATE10
			,FP_DATE11
			,FP_DATE12
			,FP_DATE13
			,FP_DATE14
			,FP_DATE15
			,FP_DATE16
			,FP_DATE17
			,FP_DATE18
			,FP_DATE19
			,FP_DATE20
			,FP_DATE21
			,FP_DATE22
			,FP_DATE23
			,FP_DATE24
			,FP_DATE25
			,FP_DATE26
			,FP_DATE27
			,FP_DATE28
			,FP_DATE29
			,FP_DATE30
			,FP_DATE31			
			,REG_ID
			,REG_DATE
		)
		
		SELECT 
			'005' GUBUN
			,CPL_GUBUN
			,EQUIP_CD
			,GOODS_CD				 			
			, #{fpDate} FP_DATE
			, ${dataSum} DATA_SUM
			, ${dayListNull}
			, #{regId} REG_ID
			 ,getDate() REG_DATE
			
		FROM
		   (SELECT 
			   CPL_GUBUN
			  ,EQUIP_CD
			  ,GOODS_CD
			  ,FP_DATE
			  ,PLAN_CNT PLAN_CNT
					
			FROM						
			 
			TB_MONTH_PRODUCTION_PLAN_DTL B
			WHERE LEFT(FP_DATE,6) = #{fpDate}
			AND CPL_GUBUN = #{cplGubun}					
			<if test="equipCd != null and equipCd != ''"> 
				AND EQUIP_CD = #{equipCd}
			</if>
			<if test="goodsCd != null and goodsCd != ''"> 
				AND GOODS_CD = #{goodsCd}
			</if>
				
				) A
			PIVOT(SUM([PLAN_CNT]) FOR FP_DATE IN (			
			${dayList}			
			)) as pivot_reslut
	</insert>
	
	<!-- 월별 FP 확정계획 삭제-->
	<delete id="deleteCplPlan">
		DELETE TB_FP_TOTAL_COMPLETE
		WHERE FP_DATE = #{fpDate}
		AND CPL_GUBUN = #{cplGubun}
		<if test="equipCd != null and equipCd != ''"> 
			AND EQUIP_CD = #{equipCd}
		</if>
		<if test="gubun != null and gubun != ''"> 
			AND GUBUN = #{gubun}
		</if>
	</delete>
	
	<!-- 월별 FP 확정계획 확정에 없는 잡체인지 입력할떄 삭제-->
	<delete id="deleteCplPlanEx">
		DELETE TB_FP_TOTAL_COMPLETE
		WHERE FP_DATE = #{fpDate}
		AND CPL_GUBUN = #{cplGubun}
		AND GUBUN = '005'
	</delete>
	
	
	<!-- 월별 FP 확정계획 읽기-->
	<select id="readFpTotalComplete" resultMap="MonthProductionPlanVo">
		SELECT * FROM TB_FP_TOTAL_COMPLETE
		WHERE FP_DATE = #{fpDate}		
		AND EQUIP_CD = #{equipCd}
		AND GOODS_CD = #{goodsCd}
		AND GUBUN = #{gubun}
	</select>
	
	<!-- 월별 FP 운영판 잡체인지 이후 케파,텍타임,있는지 확인-->
	<select id="selectCnt" resultType="String">
		select count(gubun) gubun 
		from TB_FP_TOTAL_COMPLETE
		where EQUIP_CD = #{equipCd}
		AND GOODS_CD = #{goodsCd}
		AND FP_DATE = #{fpDate}
	
	</select>

	<!-- 월별 FP 확정판 확정계획 0으로 입력 -->
	<insert id="createFpTotalList">
		INSERT INTO TB_FP_TOTAL_COMPLETE(
			GUBUN
			,CPL_GUBUN
			,EQUIP_CD
			,GOODS_CD
			,FP_DATE	
			,DATA_SUM
			,FP_DATE1
			,FP_DATE2
			,FP_DATE3
			,FP_DATE4
			,FP_DATE5
			,FP_DATE6
			,FP_DATE7
			,FP_DATE8
			,FP_DATE9
			,FP_DATE10
			,FP_DATE11
			,FP_DATE12
			,FP_DATE13
			,FP_DATE14
			,FP_DATE15
			,FP_DATE16L
			,FP_DATE17
			,FP_DATE18
			,FP_DATE19
			,FP_DATE20
			,FP_DATE21
			,FP_DATE22
			,FP_DATE23
			,FP_DATE24
			,FP_DATE25
			,FP_DATE26
			,FP_DATE27
			,FP_DATE28
			,FP_DATE29
			,FP_DATE30
			,FP_DATE31			
			,REG_ID
			,REG_DATE
		)
		VALUES(
		
			#{gubun}
			,#{cplGubun}
			,#{equipCd}
			,#{goodsCd}
			,#{fpDate}	
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'
			,'0'			
			,#{regId}
			,getDate()	
		)
		
	</insert >

	<!-- 월별 FP 작업자 등록 -->
	<insert id="createMan" parameterType="java.util.List">
		INSERT INTO TB_MONTH_PRODUCTION_PLAN_MAN
        (  CPL_GUBUN
           ,DAY_NIGHT_GUBUN
           ,FP_DATE
           ,PRODUCT_MAN          
           ,REG_ID
           ,REG_DATE
        )
    	VALUES
    	<foreach collection="list" item="item" separator=",">
	    	 (
	    		 #{item.cplGubun}
	    		,#{item.dayNightGubun}
				,#{item.fpDate}						
				,#{item.productMan}
				,#{item.regId}
				,getDate()
	    	)
		</foreach>
	</insert >
	
	<!-- 월별 FP 목록 삭제-->
	<delete id="deleteMan">
		DELETE TB_MONTH_PRODUCTION_PLAN_MAN
		WHERE 1=1		
		AND CPL_GUBUN = #{cplGubun}
		AND LEFT(FP_DATE,6) = #{fpDate}	
		
	</delete >
	
	<!-- 월별 FP 작업자 조회 -->
	<select id="monthProductionPlanMan" resultType="HashMap" parameterType="mes.domain.wm.MonthProductionPlanVo" >		
		
		SELECT  
			 GUBUNJA
			,DAY_NIGHT_GUBUN
			,${dayList}
		FROM
			
			(select 'D' GUBUNJA
			union ALL
			select 'N' GUBUNJA) BB
			LEFT OUTER JOIN

			(
			SELECT * FROM
				   (SELECT
						CPL_GUBUN
						,FP_DATE
						,DAY_NIGHT_GUBUN
						,PRODUCT_MAN									
					FROM TB_MONTH_PRODUCTION_PLAN_MAN				
					WHERE LEFT(FP_DATE,6) = #{fpDate}		
					AND CPL_GUBUN = #{cplGubun}
						) A
					PIVOT(MAX(PRODUCT_MAN) FOR FP_DATE IN (${dayList})) as pivot_reslut
			) AA

			ON 1=1
			AND BB.GUBUNJA = AA.DAY_NIGHT_GUBUN
	</select>
	
	<!-- 월별 최고 검사량 조회 -->
	<select id="bestOutputCnt" resultMap="MonthProductionPlanVo" >		
		<![CDATA[
			SELECT BB.*
				FROM (
				
				SELECT
											                     
					 SUM(A.OUTPUT_CNT) AS SUM_OUPUT_CNT						 
					
					, RIGHT(A.WORK_ORD_DATE, 2) DAY_
					FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo} GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A, TB_WORK_ORDER B
					WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
					GROUP BY WORK_ORD_DATE			
				
				) BB,
				(
				
					SELECT DAY_ ,BB.SUM_OUPUT_CNT,MAX(BB.SUM_OUPUT_CNT) OVER() AS MA
				
					FROM (
				
						SELECT
											                     
						 SUM(A.OUTPUT_CNT) AS SUM_OUPUT_CNT						 
						
						, RIGHT(A.WORK_ORD_DATE, 2) DAY_
						FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo} GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A, TB_WORK_ORDER B
						WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
						GROUP BY WORK_ORD_DATE					
				
				
					) BB
				) AA
				
				WHERE AA.SUM_OUPUT_CNT = BB.SUM_OUPUT_CNT
				AND AA.MA = BB.SUM_OUPUT_CNT
			
		]]>
	</select>
	
	<!-- 전일 근무자 주야 뽑기 -->
	<select id="lastDayWorker" resultMap="MonthProductionPlanVo" >		
		<![CDATA[
			SELECT * 
	
			FROM 
			
			(SELECT 'D' DAY_NIGHT_GUBUN
			UNION ALL
			SELECT 'N' DAY_NIGHT_GUBUN) AA
			
			LEFT OUTER JOIN
			
			TB_MONTH_PRODUCTION_PLAN_MAN BB
			ON 1=1
			AND FP_DATE =  #{chooseDateTo}
			AND CPL_GUBUN = '002'
			AND AA.DAY_NIGHT_GUBUN = BB.DAY_NIGHT_GUBUN
			
			ORDER BY AA.DAY_NIGHT_GUBUN
		
			
		]]>
	</select>
	
	<!-- 전일 설비대수 주야 뽑기 -->
	<select id="lastDayEquipCnt" resultMap="MonthProductionPlanVo" >		
		<![CDATA[
			SELECT GUBUN, COUNT(*) GUBUN_CNT
			FROM (
				SELECT 
				LEFT(A.EQUIP_CD,10) EQUIP_CD					
				, B.GUBUN							
				FROM TB_WORK_ORDER A, TB_WORK_ORDER_OUTPUT_SUB B, TB_EQUIP_CODE_ADM C
				WHERE 1=1
				AND A.WORK_ORD_NO = B.WORK_ORD_NO
				AND A.EQUIP_CD = C.EQUIP_CD
				AND C.USE_YN_CD = '001'				
				AND B.WORK_ORD_DATE = #{chooseDateTo}				
				AND C.ETC1 = ''										
				GROUP BY LEFT(A.EQUIP_CD,10), B.GUBUN
				) AA
			GROUP BY GUBUN

			
		]]>
	</select>
	
	
	<!-- 가동률 최고/ 일자 -->
	<select id="bestCapaDay" resultMap="MonthProductionPlanVo" >		
		<![CDATA[			
			SET ANSI_WARNINGS OFF
			SET ARITHIGNORE ON
			SET ARITHABORT OFF

			SELECT MAX_VALUE, FP_DATE,RIGHT(FP_DATE,PATINDEX ('[0-9]%', REVERSE(FP_DATE))) DAY_ FROM 
			(
				SELECT 
					[01] / FP_DATE1  * 100 AS FP_DATE1
					,[02] / FP_DATE2  * 100   AS FP_DATE2 
					,[03] / FP_DATE3  * 100   AS FP_DATE3 
					,[04] / FP_DATE4  * 100   AS FP_DATE4 
					,[05] / FP_DATE5  * 100   AS FP_DATE5 
					,[06] / FP_DATE6  * 100   AS FP_DATE6 
					,[07] / FP_DATE7  * 100   AS FP_DATE7 
					,[08] / FP_DATE8  * 100   AS FP_DATE8 
					,[09] / FP_DATE9  * 100   AS FP_DATE9 
					,[10] / FP_DATE10 * 100   AS FP_DATE10
					,[11] / FP_DATE11 * 100   AS FP_DATE11
					,[12] / FP_DATE12 * 100   AS FP_DATE12
					,[13] / FP_DATE13 * 100   AS FP_DATE13
					,[14] / FP_DATE14 * 100   AS FP_DATE14
					,[15] / FP_DATE15 * 100   AS FP_DATE15
					,[16] / FP_DATE16 * 100   AS FP_DATE16
					,[17] / FP_DATE17 * 100   AS FP_DATE17
					,[18] / FP_DATE18 * 100   AS FP_DATE18
					,[19] / FP_DATE19 * 100   AS FP_DATE19
					,[20] / FP_DATE20 * 100   AS FP_DATE20
					,[21] / FP_DATE21 * 100   AS FP_DATE21
					,[22] / FP_DATE22 * 100   AS FP_DATE22
					,[23] / FP_DATE23 * 100   AS FP_DATE23
					,[24] / FP_DATE24 * 100   AS FP_DATE24
					,[25] / FP_DATE25 * 100   AS FP_DATE25
					,[26] / FP_DATE26 * 100   AS FP_DATE26
					,[27] / FP_DATE27 * 100   AS FP_DATE27
					,[28] / FP_DATE28 * 100   AS FP_DATE28
					,[29] / FP_DATE29 * 100   AS FP_DATE29
					,[30] / FP_DATE30 * 100   AS FP_DATE30
					,[31] / FP_DATE31 * 100   AS FP_DATE31
					,(SELECT MAX(val) FROM (VALUES ([01] / FP_DATE1  * 100)
						, ([02] / FP_DATE2  * 100)	
						,([02] / FP_DATE2  * 100)
						,([03] / FP_DATE3  * 100)
						,([04] / FP_DATE4  * 100)
						,([05] / FP_DATE5  * 100)
						,([06] / FP_DATE6  * 100)
						,([07] / FP_DATE7  * 100)
						,([08] / FP_DATE8  * 100)
						,([09] / FP_DATE9  * 100)
						,([10] / FP_DATE10 * 100)
						,([11] / FP_DATE11 * 100)
						,([12] / FP_DATE12 * 100)
						,([13] / FP_DATE13 * 100)
						,([14] / FP_DATE14 * 100)
						,([15] / FP_DATE15 * 100)
						,([16] / FP_DATE16 * 100)
						,([17] / FP_DATE17 * 100)
						,([18] / FP_DATE18 * 100)
						,([19] / FP_DATE19 * 100)
						,([20] / FP_DATE20 * 100)
						,([21] / FP_DATE21 * 100)
						,([22] / FP_DATE22 * 100)
						,([23] / FP_DATE23 * 100)
						,([24] / FP_DATE24 * 100)
						,([25] / FP_DATE25 * 100)
						,([26] / FP_DATE26 * 100)
						,([27] / FP_DATE27 * 100)
						,([28] / FP_DATE28 * 100)
						,([29] / FP_DATE29 * 100)
						,([30] / FP_DATE30 * 100)
						,([31] / FP_DATE31 * 100)
					) val_tbl(val) 
					) MAX_VALUE
				FROM
				(
					SELECT DISTINCT
						GUBUN
						,'' AS GUBUN_NM									 
						,'' GOODS_CD
						,ISNULL(SUM(DATA_SUM) ,0) DATA_SUM
						,ISNULL(SUM(FP_DATE1) ,0) FP_DATE1
						,ISNULL(SUM(FP_DATE2) ,0) FP_DATE2
						,ISNULL(SUM(FP_DATE3) ,0) FP_DATE3
						,ISNULL(SUM(FP_DATE4) ,0) FP_DATE4
						,ISNULL(SUM(FP_DATE5) ,0) FP_DATE5
						,ISNULL(SUM(FP_DATE6) ,0) FP_DATE6
						,ISNULL(SUM(FP_DATE7) ,0) FP_DATE7
						,ISNULL(SUM(FP_DATE8) ,0) FP_DATE8
						,ISNULL(SUM(FP_DATE9) ,0) FP_DATE9
						,ISNULL(SUM(FP_DATE10),0) FP_DATE10
						,ISNULL(SUM(FP_DATE11),0) FP_DATE11
						,ISNULL(SUM(FP_DATE12),0) FP_DATE12
						,ISNULL(SUM(FP_DATE13),0) FP_DATE13
						,ISNULL(SUM(FP_DATE14),0) FP_DATE14
						,ISNULL(SUM(FP_DATE15),0) FP_DATE15
						,ISNULL(SUM(FP_DATE16),0) FP_DATE16
						,ISNULL(SUM(FP_DATE17),0) FP_DATE17
						,ISNULL(SUM(FP_DATE18),0) FP_DATE18
						,ISNULL(SUM(FP_DATE19),0) FP_DATE19
						,ISNULL(SUM(FP_DATE20),0) FP_DATE20
						,ISNULL(SUM(FP_DATE21),0) FP_DATE21
						,ISNULL(SUM(FP_DATE22),0) FP_DATE22
						,ISNULL(SUM(FP_DATE23),0) FP_DATE23
						,ISNULL(SUM(FP_DATE24),0) FP_DATE24
						,ISNULL(SUM(FP_DATE25),0) FP_DATE25
						,ISNULL(SUM(FP_DATE26),0) FP_DATE26
						,ISNULL(SUM(FP_DATE27),0) FP_DATE27
						,ISNULL(SUM(FP_DATE28),0) FP_DATE28
						,ISNULL(SUM(FP_DATE29),0) FP_DATE29
						,ISNULL(SUM(FP_DATE30),0) FP_DATE30
						,ISNULL(SUM(FP_DATE31),0) FP_DATE31
			
				FROM 
				TB_FP_TOTAL_COMPLETE A
			
				where 1=1
				AND A.FP_DATE = #{fpDate}
				AND GUBUN = '001' 
				group by GUBUN
			
				) AA,
				(
				SELECT *
					FROM (
						SELECT 							
									
							ISNULL( AA.DAY_,'') DAY_														
							,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) + SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 	 	
              
						FROM
						(
							SELECT										
								             
								 ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
								, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
								, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
								, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT
								, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
								, ISNULL(RE_SHIP_FAULTY_CNT, 0 ) AS RE_SHIP_FAULTY_CNT
								, RIGHT(WORK_ORD_DATE,2) DAY_
							FROM 
							(
								SELECT
								A.WORK_ORD_NO
								,SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								
								, WORK_ORD_DATE
								FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo} GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A, TB_WORK_ORDER B
								WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
								GROUP BY A.WORK_ORD_NO,WORK_ORD_DATE
							) A 
							LEFT OUTER JOIN
						(SELECT
								X.WORK_ORD_NO
								, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
		
							FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
							WHERE 1=1 
							AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
	
							GROUP BY X.WORK_ORD_NO) CC
						ON CC.WORK_ORD_NO = A.WORK_ORD_NO

							LEFT OUTER JOIN 
							(
								SELECT                      
									X.WORK_ORD_NO
								, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                      
								FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
								WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
								GROUP BY X.WORK_ORD_NO
							) B
							ON A.WORK_ORD_NO = B.WORK_ORD_NO         
		  
		  					LEFT OUTER JOIN
							(	SELECT 									
									 ISNULL(SUM(A.FAULTY_CNT),0) SHIP_FAULTY_CNT
									,GOODS_CD
									,X.WORK_ORD_NO
							
								FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
								WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
								AND E.WORK_ORD_NO = X.WORK_ORD_NO
								AND A.SHIP_INSP_IDX = B.IDX
								AND RE_INSP_STATUS != '002'
								GROUP BY X.WORK_ORD_NO,GOODS_CD
								) HH
		
							ON A.WORK_ORD_NO = HH.WORK_ORD_NO						
		
							LEFT OUTER JOIN
		
								(	SELECT 
									
										 ISNULL(SUM(A.FAULTY_CNT),0) RE_SHIP_FAULTY_CNT
										,GOODS_CD
										,X.WORK_ORD_NO
										FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
										WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
										AND E.WORK_ORD_NO = X.WORK_ORD_NO
										AND A.SHIP_INSP_IDX = B.IDX
										AND RE_INSP_STATUS = '002'
										GROUP BY X.WORK_ORD_NO,GOODS_CD
								) II
		
							ON A.WORK_ORD_NO = II.WORK_ORD_NO 
							              
						) AA
						GROUP BY DAY_
			
					) AS AA
				PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
												, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
												, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
												, [31]) ) AS PIVOT_RESULT
				) BB
			) CC UNPIVOT ( DATA FOR FP_DATE IN (FP_DATE1,FP_DATE2 
					,FP_DATE3 
					,FP_DATE4 
					,FP_DATE5 
					,FP_DATE6 
					,FP_DATE7 
					,FP_DATE8 
					,FP_DATE9 
					,FP_DATE10
					,FP_DATE11
					,FP_DATE12
					,FP_DATE13
					,FP_DATE14
					,FP_DATE15
					,FP_DATE16
					,FP_DATE17
					,FP_DATE18
					,FP_DATE19
					,FP_DATE20
					,FP_DATE21
					,FP_DATE22
					,FP_DATE23
					,FP_DATE24
					,FP_DATE25
					,FP_DATE26
					,FP_DATE27
					,FP_DATE28
					,FP_DATE29
					,FP_DATE30
					,FP_DATE31)) AS unpvt
			
				where 1=1
				AND unpvt.MAX_VALUE = unpvt.DATA


				
						
		]]>
	</select>
	

	
	<!-- 월별 FP 작업자상세  조회 -->
	<select id="monthProductionPlanManList" resultMap="MonthProductionPlanVo" >		
		
		SELECT
			CPL_GUBUN
			,FP_DATE
			,DAY_NIGHT_GUBUN
			,PRODUCT_MAN
			,REG_ID
			,REG_DATE									
		FROM TB_MONTH_PRODUCTION_PLAN_MAN				
		WHERE LEFT(FP_DATE,6) = #{fpDate}
		AND CPL_GUBUN = #{cplGubun}
	</select>
	
	<!-- 월별 FP 요약본 조회 -->
	<select id="monthProductionPlanSumList" resultMap="MonthProductionPlanVo" >		
	
		<![CDATA[
			SET ANSI_WARNINGS OFF
		SET ARITHIGNORE ON
		SET ARITHABORT OFF
		SELECT DISTINCT 
					GUBUN
					,(CASE WHEN GUBUN = '001' THEN 'CAPA 수량(이론 capa)'
						WHEN GUBUN = '004' THEN '월간 MP 확정판 계획' 
						WHEN GUBUN = '005' THEN '변경 운영 계획' 
					END ) AS GUBUN_NM									 
					,'' GOODS_CD					
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(CASE WHEN GUBUN = '001' THEN (SELECT ISNULL(SUM(TOTAL),0) TOTAL FROM
														(SELECT SUM(DATA) TOTAL,REPLACE(RIGHT(FP_DATE,2),'E','0') FP_DATE FROM(
															SELECT FP_DATE1	
																,FP_DATE2 
																,FP_DATE3 
																,FP_DATE4 
																,FP_DATE5 
																,FP_DATE6 
																,FP_DATE7 
																,FP_DATE8 
																,FP_DATE9 
																,FP_DATE10
																,FP_DATE11
																,FP_DATE12
																,FP_DATE13
																,FP_DATE14
																,FP_DATE15
																,FP_DATE16
																,FP_DATE17
																,FP_DATE18
																,FP_DATE19
																,FP_DATE20
																,FP_DATE21
																,FP_DATE22
																,FP_DATE23
																,FP_DATE24
																,FP_DATE25
																,FP_DATE26
																,FP_DATE27
																,FP_DATE28
																,FP_DATE29
																,FP_DATE30
																,FP_DATE31 
															FROM TB_FP_TOTAL_COMPLETE	
															WHERE FP_DATE = #{fpDate} AND GUBUN='001'
														) A 
														 UNPIVOT ( DATA FOR FP_DATE IN 
																			(FP_DATE1
																			,FP_DATE2 
																			,FP_DATE3 
																			,FP_DATE4 
																			,FP_DATE5 
																			,FP_DATE6 
																			,FP_DATE7 
																			,FP_DATE8 
																			,FP_DATE9 
																			,FP_DATE10
																			,FP_DATE11
																			,FP_DATE12
																			,FP_DATE13
																			,FP_DATE14
																			,FP_DATE15
																			,FP_DATE16
																			,FP_DATE17
																			,FP_DATE18
																			,FP_DATE19
																			,FP_DATE20
																			,FP_DATE21
																			,FP_DATE22
																			,FP_DATE23
																			,FP_DATE24
																			,FP_DATE25
																			,FP_DATE26
																			,FP_DATE27
																			,FP_DATE28
																			,FP_DATE29
																			,FP_DATE30
																			,FP_DATE31)
														) AS UNPVT
														
														GROUP BY FP_DATE
														) AA
														WHERE FP_DATE >= RIGHT(#{chooseDateFrom},2) AND FP_DATE <= RIGHT(#{chooseDateTo},2))
						WHEN GUBUN = '004' THEN  (SELECT SUM(PLAN_CNT)  DATA_SUM
													FROM TB_MONTH_PRODUCTION_PLAN_DTL B
													WHERE B.FP_DATE >= #{chooseDateFrom}
														AND B.FP_DATE <= #{chooseDateTo}
														AND CPL_GUBUN = '001'
														AND COMPLETE_YN = '001')
						WHEN GUBUN = '005' THEN (SELECT SUM(PLAN_CNT)  DATA_SUM
													FROM TB_MONTH_PRODUCTION_PLAN_DTL B
													WHERE B.FP_DATE >= #{chooseDateFrom}
														AND B.FP_DATE <= #{chooseDateTo}
														AND CPL_GUBUN = '002') END ))) AS DATA_SUM
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE1) ,0))) FP_DATE1
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE2) ,0))) FP_DATE2
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE3) ,0))) FP_DATE3
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE4) ,0))) FP_DATE4
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE5) ,0))) FP_DATE5
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE6) ,0))) FP_DATE6
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE7) ,0))) FP_DATE7
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE8) ,0))) FP_DATE8
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE9) ,0))) FP_DATE9
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE10),0))) FP_DATE10
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE11),0))) FP_DATE11
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE12),0))) FP_DATE12
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE13),0))) FP_DATE13
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE14),0))) FP_DATE14
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE15),0))) FP_DATE15
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE16),0))) FP_DATE16
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE17),0))) FP_DATE17
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE18),0))) FP_DATE18
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE19),0))) FP_DATE19
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE20),0))) FP_DATE20
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE21),0))) FP_DATE21
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE22),0))) FP_DATE22
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE23),0))) FP_DATE23
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE24),0))) FP_DATE24
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE25),0))) FP_DATE25
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE26),0))) FP_DATE26
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE27),0))) FP_DATE27
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE28),0))) FP_DATE28
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE29),0))) FP_DATE29
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE30),0))) FP_DATE30
					,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,ISNULL(SUM(FP_DATE31),0))) FP_DATE31
		
		FROM 
		TB_FP_TOTAL_COMPLETE A
		
		where 1=1
		AND A.FP_DATE = #{fpDate}
		AND (GUBUN = '001' OR GUBUN ='004' OR GUBUN='005')
		group by GUBUN
		
		UNION ALL
		
		SELECT      
			'006' AS GUBUN								
			,'생산' AS GUBUN_NM
			,  (CASE WHEN LEFT(GOODS_CD,1) = 'A' THEN 'AL' 
				WHEN LEFT(GOODS_CD,1) = 'N' THEN 'NICU' END ) GOODS_CD
				, CONVERT(NUMERIC(18,2) ,SUM((ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
						ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
						ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
						ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
						ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
						ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
						ISNULL([31],0)))) AS COUNT_SUM
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([01]))) '01'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([02]))) '02'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([03]))) '03'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([04]))) '04'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([05]))) '05'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([06]))) '06'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([07]))) '07'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([08]))) '08'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([09]))) '09'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([10]))) '10'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([11]))) '11'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([12]))) '12'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([13]))) '13'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([14]))) '14'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([15]))) '15'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([16]))) '16'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([17]))) '17'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([18]))) '18'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([19]))) '19'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([20]))) '20'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([21]))) '21'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([22]))) '22'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([23]))) '23'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([24]))) '24'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([25]))) '25'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([26]))) '26'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([27]))) '27'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([28]))) '28'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([29]))) '29'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([30]))) '30'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([31]))) '31'
		FROM (
			SELECT 							
							ISNULL(AA.EQUIP_CD,'') EQUIP_CD
							,ISNULL( AA.DAY_,'') DAY_
							,ISNULL(AA.GOODS_CD,'') GOODS_CD								
							,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) + SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT	
                
						FROM
						(
							SELECT
								LEFT(A.EQUIP_CD,10) EQUIP_CD
								, A.WORK_ORD_NO                     
								, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
								, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
								, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
								, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT						
								, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
								, ISNULL(RE_SHIP_FAULTY_CNT, 0 ) AS RE_SHIP_FAULTY_CNT
								, A.GOODS_CD
								, RIGHT(WORK_ORD_DATE,2) DAY_
							FROM 
							(
								SELECT
								B.EQUIP_CD
								, A.WORK_ORD_NO                      
										                       
								, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								, B.GOODS_CD
								, WORK_ORD_DATE
								FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo} GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A, TB_WORK_ORDER B
								WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
								GROUP BY A.WORK_ORD_NO, B.EQUIP_CD, B.GOODS_CD,WORK_ORD_DATE
							) A 
							LEFT OUTER JOIN
						(SELECT
								X.WORK_ORD_NO
								, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
							FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
							WHERE 1=1 
							AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
							GROUP BY X.WORK_ORD_NO) CC
						ON CC.WORK_ORD_NO = A.WORK_ORD_NO

							LEFT OUTER JOIN 
							(
								SELECT                      
									X.WORK_ORD_NO
								, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
								FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
								WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
								GROUP BY X.WORK_ORD_NO
							) B
							ON A.WORK_ORD_NO = B.WORK_ORD_NO       
							
							LEFT OUTER JOIN
							(	SELECT 									
									 ISNULL(SUM(A.FAULTY_CNT),0) SHIP_FAULTY_CNT
									,GOODS_CD
									,X.WORK_ORD_NO
							
								FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
								WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
								AND E.WORK_ORD_NO = X.WORK_ORD_NO
								AND A.SHIP_INSP_IDX = B.IDX
								AND RE_INSP_STATUS != '002'
								GROUP BY X.WORK_ORD_NO,GOODS_CD
								) HH
			
							ON A.WORK_ORD_NO = HH.WORK_ORD_NO						
			
							LEFT OUTER JOIN
			
							(	SELECT 
								
									 ISNULL(SUM(A.FAULTY_CNT),0) RE_SHIP_FAULTY_CNT
									,GOODS_CD
									,X.WORK_ORD_NO
									FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
									WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
									AND E.WORK_ORD_NO = X.WORK_ORD_NO
									AND A.SHIP_INSP_IDX = B.IDX
									AND RE_INSP_STATUS = '002'
									GROUP BY X.WORK_ORD_NO,GOODS_CD
							) II
			
							ON A.WORK_ORD_NO = II.WORK_ORD_NO   
				  
									              
						) AA
						GROUP BY AA.EQUIP_CD, AA.GOODS_CD,DAY_				
										
			) AS AA						 
			PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
													, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
													, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
													, [31]) ) AS PIVOT_RESULT
		GROUP BY LEFT(GOODS_CD,1)
		UNION ALL
		
		
		SELECT      
			'007' AS GUBUN								
			,'생산' AS GUBUN_NM
			, 'Total' GOODS_CD
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) , SUM((ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
					ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
					ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
					ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
					ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
					ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
					ISNULL([31],0))))) AS COUNT_SUM
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([01]))) '01'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([02]))) '02'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([03]))) '03'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([04]))) '04'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([05]))) '05'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([06]))) '06'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([07]))) '07'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([08]))) '08'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([09]))) '09'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([10]))) '10'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([11]))) '11'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([12]))) '12'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([13]))) '13'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([14]))) '14'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([15]))) '15'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([16]))) '16'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([17]))) '17'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([18]))) '18'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([19]))) '19'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([20]))) '20'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([21]))) '21'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([22]))) '22'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([23]))) '23'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([24]))) '24'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([25]))) '25'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([26]))) '26'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([27]))) '27'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([28]))) '28'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([29]))) '29'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([30]))) '30'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([31]))) '31'
		FROM (
				SELECT 							
					ISNULL(AA.EQUIP_CD,'') EQUIP_CD
					,ISNULL( AA.DAY_,'') DAY_
					,ISNULL(AA.GOODS_CD,'') GOODS_CD								
					,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) + SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 	
	             
				FROM
				(
					SELECT
						LEFT(A.EQUIP_CD,10) EQUIP_CD
						, A.WORK_ORD_NO                     
						, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
						, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
						, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
						, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT								
						, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
						, ISNULL(RE_SHIP_FAULTY_CNT, 0 ) AS RE_SHIP_FAULTY_CNT		
						, A.GOODS_CD
						, RIGHT(WORK_ORD_DATE,2) DAY_
					FROM 
					(
						SELECT
						B.EQUIP_CD
						, A.WORK_ORD_NO                      
								                       
						, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
						, B.GOODS_CD
						, WORK_ORD_DATE
						FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo} GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A, TB_WORK_ORDER B
						WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
						GROUP BY A.WORK_ORD_NO, B.EQUIP_CD, B.GOODS_CD,WORK_ORD_DATE
					) A 
					LEFT OUTER JOIN
				(SELECT
						X.WORK_ORD_NO
						, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
		
					FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
					WHERE 1=1 
					AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
	
					GROUP BY X.WORK_ORD_NO) CC
				ON CC.WORK_ORD_NO = A.WORK_ORD_NO
	
					LEFT OUTER JOIN 
					(
						SELECT                      
							X.WORK_ORD_NO
						, SUM(A.FAULTY_CNT) E_FAULTY_CNT
	                     
						FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
						WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
						GROUP BY X.WORK_ORD_NO
					) B
					ON A.WORK_ORD_NO = B.WORK_ORD_NO 
					
					LEFT OUTER JOIN
					(	SELECT 									
							 ISNULL(SUM(A.FAULTY_CNT),0) SHIP_FAULTY_CNT
							,GOODS_CD
							,X.WORK_ORD_NO
					
						FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
						WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
						AND E.WORK_ORD_NO = X.WORK_ORD_NO
						AND A.SHIP_INSP_IDX = B.IDX
						AND RE_INSP_STATUS != '002'
						GROUP BY X.WORK_ORD_NO,GOODS_CD
						) HH

					ON A.WORK_ORD_NO = HH.WORK_ORD_NO						

					LEFT OUTER JOIN

					(	SELECT 
						
							 ISNULL(SUM(A.FAULTY_CNT),0) RE_SHIP_FAULTY_CNT
							,GOODS_CD
							,X.WORK_ORD_NO
							FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
							WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
							AND E.WORK_ORD_NO = X.WORK_ORD_NO
							AND A.SHIP_INSP_IDX = B.IDX
							AND RE_INSP_STATUS = '002'
							GROUP BY X.WORK_ORD_NO,GOODS_CD
					) II

					ON A.WORK_ORD_NO = II.WORK_ORD_NO        
		  
							              
				) AA
				GROUP BY AA.EQUIP_CD, AA.GOODS_CD,DAY_	
										
			) AS AA						 
			PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
													, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
													, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
													, [31]) ) AS PIVOT_RESULT
		UNION ALL
		
			
		SELECT BB.GUBUN
			, BB.GUBUN_NM
			, BB.GOODS_CD
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(COUNT_SUM / DATA_SUM * 100))) AS  DATA_SUM
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([01] / FP_DATE1  * 100)))  AS FP_DATE1 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([02] / FP_DATE2  * 100)))  AS FP_DATE2 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([03] / FP_DATE3  * 100)))  AS FP_DATE3 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([04] / FP_DATE4  * 100)))  AS FP_DATE4 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([05] / FP_DATE5  * 100)))  AS FP_DATE5 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([06] / FP_DATE6  * 100)))  AS FP_DATE6 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([07] / FP_DATE7  * 100)))  AS FP_DATE7 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([08] / FP_DATE8  * 100)))  AS FP_DATE8 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([09] / FP_DATE9  * 100)))  AS FP_DATE9 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([10] / FP_DATE10 * 100)))  AS FP_DATE10
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([11] / FP_DATE11 * 100)))  AS FP_DATE11
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([12] / FP_DATE12 * 100)))  AS FP_DATE12
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([13] / FP_DATE13 * 100)))  AS FP_DATE13
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([14] / FP_DATE14 * 100)))  AS FP_DATE14
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([15] / FP_DATE15 * 100)))  AS FP_DATE15
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([16] / FP_DATE16 * 100)))  AS FP_DATE16
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([17] / FP_DATE17 * 100)))  AS FP_DATE17
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([18] / FP_DATE18 * 100)))  AS FP_DATE18
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([19] / FP_DATE19 * 100)))  AS FP_DATE19
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([20] / FP_DATE20 * 100)))  AS FP_DATE20
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([21] / FP_DATE21 * 100)))  AS FP_DATE21
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([22] / FP_DATE22 * 100)))  AS FP_DATE22
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([23] / FP_DATE23 * 100)))  AS FP_DATE23
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([24] / FP_DATE24 * 100)))  AS FP_DATE24
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([25] / FP_DATE25 * 100)))  AS FP_DATE25
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([26] / FP_DATE26 * 100)))  AS FP_DATE26
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([27] / FP_DATE27 * 100)))  AS FP_DATE27
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([28] / FP_DATE28 * 100)))  AS FP_DATE28
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([29] / FP_DATE29 * 100)))  AS FP_DATE29
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([30] / FP_DATE30 * 100)))  AS FP_DATE30
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),([31] / FP_DATE31 * 100)))  AS FP_DATE31
		
		FROM
		(
			SELECT DISTINCT
				GUBUN
				,'' AS GUBUN_NM									 
				,'' GOODS_CD
				,(SELECT ISNULL(SUM(TOTAL),0) TOTAL FROM
														(SELECT SUM(DATA) TOTAL,REPLACE(RIGHT(FP_DATE,2),'E','0') FP_DATE FROM(
															SELECT FP_DATE1	
																,FP_DATE2 
																,FP_DATE3 
																,FP_DATE4 
																,FP_DATE5 
																,FP_DATE6 
																,FP_DATE7 
																,FP_DATE8 
																,FP_DATE9 
																,FP_DATE10
																,FP_DATE11
																,FP_DATE12
																,FP_DATE13
																,FP_DATE14
																,FP_DATE15
																,FP_DATE16
																,FP_DATE17
																,FP_DATE18
																,FP_DATE19
																,FP_DATE20
																,FP_DATE21
																,FP_DATE22
																,FP_DATE23
																,FP_DATE24
																,FP_DATE25
																,FP_DATE26
																,FP_DATE27
																,FP_DATE28
																,FP_DATE29
																,FP_DATE30
																,FP_DATE31 
															FROM TB_FP_TOTAL_COMPLETE	
															WHERE FP_DATE = #{fpDate} AND GUBUN='001'
														) A 
														 UNPIVOT ( DATA FOR FP_DATE IN 
																			(FP_DATE1
																			,FP_DATE2 
																			,FP_DATE3 
																			,FP_DATE4 
																			,FP_DATE5 
																			,FP_DATE6 
																			,FP_DATE7 
																			,FP_DATE8 
																			,FP_DATE9 
																			,FP_DATE10
																			,FP_DATE11
																			,FP_DATE12
																			,FP_DATE13
																			,FP_DATE14
																			,FP_DATE15
																			,FP_DATE16
																			,FP_DATE17
																			,FP_DATE18
																			,FP_DATE19
																			,FP_DATE20
																			,FP_DATE21
																			,FP_DATE22
																			,FP_DATE23
																			,FP_DATE24
																			,FP_DATE25
																			,FP_DATE26
																			,FP_DATE27
																			,FP_DATE28
																			,FP_DATE29
																			,FP_DATE30
																			,FP_DATE31)
														) AS UNPVT
														
														GROUP BY FP_DATE
														) AA
														WHERE FP_DATE >= RIGHT(#{chooseDateFrom},2) AND FP_DATE <= RIGHT(#{chooseDateTo},2) ) DATA_SUM 	
				,ISNULL(SUM(FP_DATE1) ,0) FP_DATE1
				,ISNULL(SUM(FP_DATE2) ,0) FP_DATE2
				,ISNULL(SUM(FP_DATE3) ,0) FP_DATE3
				,ISNULL(SUM(FP_DATE4) ,0) FP_DATE4
				,ISNULL(SUM(FP_DATE5) ,0) FP_DATE5
				,ISNULL(SUM(FP_DATE6) ,0) FP_DATE6
				,ISNULL(SUM(FP_DATE7) ,0) FP_DATE7
				,ISNULL(SUM(FP_DATE8) ,0) FP_DATE8
				,ISNULL(SUM(FP_DATE9) ,0) FP_DATE9
				,ISNULL(SUM(FP_DATE10),0) FP_DATE10
				,ISNULL(SUM(FP_DATE11),0) FP_DATE11
				,ISNULL(SUM(FP_DATE12),0) FP_DATE12
				,ISNULL(SUM(FP_DATE13),0) FP_DATE13
				,ISNULL(SUM(FP_DATE14),0) FP_DATE14
				,ISNULL(SUM(FP_DATE15),0) FP_DATE15
				,ISNULL(SUM(FP_DATE16),0) FP_DATE16
				,ISNULL(SUM(FP_DATE17),0) FP_DATE17
				,ISNULL(SUM(FP_DATE18),0) FP_DATE18
				,ISNULL(SUM(FP_DATE19),0) FP_DATE19
				,ISNULL(SUM(FP_DATE20),0) FP_DATE20
				,ISNULL(SUM(FP_DATE21),0) FP_DATE21
				,ISNULL(SUM(FP_DATE22),0) FP_DATE22
				,ISNULL(SUM(FP_DATE23),0) FP_DATE23
				,ISNULL(SUM(FP_DATE24),0) FP_DATE24
				,ISNULL(SUM(FP_DATE25),0) FP_DATE25
				,ISNULL(SUM(FP_DATE26),0) FP_DATE26
				,ISNULL(SUM(FP_DATE27),0) FP_DATE27
				,ISNULL(SUM(FP_DATE28),0) FP_DATE28
				,ISNULL(SUM(FP_DATE29),0) FP_DATE29
				,ISNULL(SUM(FP_DATE30),0) FP_DATE30
				,ISNULL(SUM(FP_DATE31),0) FP_DATE31
		
		FROM 
		TB_FP_TOTAL_COMPLETE A
		
		where 1=1
		AND A.FP_DATE = #{fpDate}
		AND GUBUN = '001' 
		group by GUBUN
		
		) AA
		,
		(SELECT      
			'008' AS GUBUN								
			,'생산' AS GUBUN_NM
			, '가동률' GOODS_CD
			, SUM((ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
					ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
					ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
					ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
					ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
					ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
					ISNULL([31],0))) AS COUNT_SUM
			, SUM([01]) '01', SUM([02]) '02', SUM([03]) '03', SUM([04]) '04', SUM([05]) '05', SUM([06]) '06', SUM([07]) '07', SUM([08]) '08', SUM([09]) '09', SUM([10]) '10'
			, SUM([11]) '11', SUM([12]) '12', SUM([13]) '13', SUM([14]) '14', SUM([15]) '15', SUM([16]) '16', SUM([17]) '17', SUM([18]) '18', SUM([19]) '19', SUM([20]) '20'
			, SUM([21]) '21', SUM([22]) '22', SUM([23]) '23', SUM([24]) '24', SUM([25]) '25', SUM([26]) '26', SUM([27]) '27', SUM([28]) '28', SUM([29]) '29', SUM([30]) '30'
			, SUM([31]) '31'
		FROM (
		SELECT 							
							ISNULL(AA.EQUIP_CD,'') EQUIP_CD
							,ISNULL( AA.DAY_,'') DAY_
							,ISNULL(AA.GOODS_CD,'') GOODS_CD								
							,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) + SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 	
                
						FROM
						(
							SELECT
								LEFT(A.EQUIP_CD,10) EQUIP_CD
								, A.WORK_ORD_NO                     
								, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
								, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
								, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
								, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT								
								, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
								, ISNULL(RE_SHIP_FAULTY_CNT, 0 ) AS RE_SHIP_FAULTY_CNT		
								, A.GOODS_CD
								, RIGHT(WORK_ORD_DATE,2) DAY_
							FROM 
							(
								SELECT
								B.EQUIP_CD
								, A.WORK_ORD_NO                      
										                       
								, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								, B.GOODS_CD
								, WORK_ORD_DATE
								FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo} GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A, TB_WORK_ORDER B
								WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
								GROUP BY A.WORK_ORD_NO, B.EQUIP_CD, B.GOODS_CD,WORK_ORD_DATE
							) A 
							LEFT OUTER JOIN
						(SELECT
								X.WORK_ORD_NO
								, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
							FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
							WHERE 1=1 
							AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
							GROUP BY X.WORK_ORD_NO) CC
						ON CC.WORK_ORD_NO = A.WORK_ORD_NO

							LEFT OUTER JOIN 
							(
								SELECT                      
									X.WORK_ORD_NO
								, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
								FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
								WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
								GROUP BY X.WORK_ORD_NO
							) B
							ON A.WORK_ORD_NO = B.WORK_ORD_NO  
							
							LEFT OUTER JOIN
							(	SELECT 									
									 ISNULL(SUM(A.FAULTY_CNT),0) SHIP_FAULTY_CNT
									,GOODS_CD
									,X.WORK_ORD_NO
							
								FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
								WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
								AND E.WORK_ORD_NO = X.WORK_ORD_NO
								AND A.SHIP_INSP_IDX = B.IDX
								AND RE_INSP_STATUS != '002'
								GROUP BY X.WORK_ORD_NO,GOODS_CD
								) HH
		
							ON A.WORK_ORD_NO = HH.WORK_ORD_NO						
		
							LEFT OUTER JOIN
		
							(	SELECT 
								
									 ISNULL(SUM(A.FAULTY_CNT),0) RE_SHIP_FAULTY_CNT
									,GOODS_CD
									,X.WORK_ORD_NO
									FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
									WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
									AND E.WORK_ORD_NO = X.WORK_ORD_NO
									AND A.SHIP_INSP_IDX = B.IDX
									AND RE_INSP_STATUS = '002'
									GROUP BY X.WORK_ORD_NO,GOODS_CD
							) II
		
							ON A.WORK_ORD_NO = II.WORK_ORD_NO       
				  
									              
						) AA
						GROUP BY AA.EQUIP_CD, AA.GOODS_CD,DAY_	
										
			) AS AA						 
				PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
													, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
													, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
													, [31]) ) AS PIVOT_RESULT
		
			) BB
		
		UNION ALL
		
		SELECT     
			'009' AS GUBUN								
			,'검사' AS GUBUN_NM
			,  (CASE WHEN LEFT(GOODS_CD,1) = 'A' THEN 'AL' 
				WHEN LEFT(GOODS_CD,1) = 'N' THEN 'NICU' END ) GOODS_CD
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) , SUM((ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
					ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
					ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
					ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
					ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
					ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
					ISNULL([31],0))))) AS COUNT_SUM
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([01]))) '01'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([02]))) '02'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([03]))) '03'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([04]))) '04'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([05]))) '05'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([06]))) '06'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([07]))) '07'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([08]))) '08'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([09]))) '09'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([10]))) '10'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([11]))) '11'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([12]))) '12'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([13]))) '13'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([14]))) '14'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([15]))) '15'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([16]))) '16'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([17]))) '17'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([18]))) '18'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([19]))) '19'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([20]))) '20'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([21]))) '21'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([22]))) '22'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([23]))) '23'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([24]))) '24'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([25]))) '25'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([26]))) '26'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([27]))) '27'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([28]))) '28'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([29]))) '29'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([30]))) '30'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([31]))) '31'
		FROM (
		
				SELECT 							
					ISNULL(AA.EQUIP_CD,'') EQUIP_CD
					,ISNULL( AA.DAY_,'') DAY_
					,ISNULL(AA.GOODS_CD,'') GOODS_CD											
					, SUM(APPEAR_OUTPUT_CNT) AS SUM_OUPUT_CNT 	
            
				FROM
				(
					SELECT
						LEFT(A.EQUIP_CD,10) EQUIP_CD
						, A.WORK_ORD_NO  
						, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT														
						, A.GOODS_CD
						, RIGHT(WORK_ORD_DATE,2) DAY_
					FROM 
					(
						SELECT
						B.EQUIP_CD
						, A.WORK_ORD_NO    
						, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
						, B.GOODS_CD
						, WORK_ORD_DATE
						FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo} GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A, TB_WORK_ORDER B
						WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
						GROUP BY A.WORK_ORD_NO, B.EQUIP_CD, B.GOODS_CD,WORK_ORD_DATE
					) A 									
					              
				) AA
				GROUP BY AA.EQUIP_CD, AA.GOODS_CD,DAY_
										
			) AS AA						 
			PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
													, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
													, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
													, [31]) ) AS PIVOT_RESULT
		GROUP BY LEFT(GOODS_CD,1)
		
		UNION ALL
		SELECT      
			'010' AS GUBUN								
			,'검사' AS GUBUN_NM
			, 'Total' GOODS_CD
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM((ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
					ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
					ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
					ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
					ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
					ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
					ISNULL([31],0))))) AS COUNT_SUM
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([01]))) '01'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([02]))) '02'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([03]))) '03'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([04]))) '04'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([05]))) '05'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([06]))) '06'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([07]))) '07'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([08]))) '08'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([09]))) '09'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([10]))) '10'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([11]))) '11'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([12]))) '12'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([13]))) '13'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([14]))) '14'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([15]))) '15'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([16]))) '16'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([17]))) '17'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([18]))) '18'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([19]))) '19'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([20]))) '20'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([21]))) '21'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([22]))) '22'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([23]))) '23'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([24]))) '24'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([25]))) '25'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([26]))) '26'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([27]))) '27'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([28]))) '28'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([29]))) '29'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([30]))) '30'
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM([31]))) '31'
		FROM (
				SELECT 							
					ISNULL(AA.EQUIP_CD,'') EQUIP_CD
					,ISNULL( AA.DAY_,'') DAY_
					,ISNULL(AA.GOODS_CD,'') GOODS_CD											
					, SUM(APPEAR_OUTPUT_CNT) AS SUM_OUPUT_CNT 	
            
				FROM
				(
					SELECT
						LEFT(A.EQUIP_CD,10) EQUIP_CD
						, A.WORK_ORD_NO  
						, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT														
						, A.GOODS_CD
						, RIGHT(WORK_ORD_DATE,2) DAY_
					FROM 
					(
						SELECT
						B.EQUIP_CD
						, A.WORK_ORD_NO    
						, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
						, B.GOODS_CD
						, WORK_ORD_DATE
						FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo} GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A, TB_WORK_ORDER B
						WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
						GROUP BY A.WORK_ORD_NO, B.EQUIP_CD, B.GOODS_CD,WORK_ORD_DATE
					) A 									
					              
				) AA
				GROUP BY AA.EQUIP_CD, AA.GOODS_CD,DAY_
										
			) AS AA						 
			PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
													, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
													, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
													, [31]) ) AS PIVOT_RESULT

		UNION ALL

		select 

		'011' AS GUBUN								
		,'검사' AS GUBUN_NM
		, '수율' GOODS_CD
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM(BB.COUNT_SUM) / SUM(AA.COUNT_SUM) * 100))	AS COUNT_SUM
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[01])/SUM(AA.[01])*100))) '01'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[02])/SUM(AA.[02])*100))) '02'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[03])/SUM(AA.[03])*100))) '03'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[04])/SUM(AA.[04])*100))) '04'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[05])/SUM(AA.[05])*100))) '05'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[06])/SUM(AA.[06])*100))) '06'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[07])/SUM(AA.[07])*100))) '07'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[08])/SUM(AA.[08])*100))) '08'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[09])/SUM(AA.[09])*100))) '09'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[10])/SUM(AA.[10])*100))) '10'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[11])/SUM(AA.[11])*100))) '11'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[12])/SUM(AA.[12])*100))) '12'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[13])/SUM(AA.[13])*100))) '13'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[14])/SUM(AA.[14])*100))) '14'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[15])/SUM(AA.[15])*100))) '15'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[16])/SUM(AA.[16])*100))) '16'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[17])/SUM(AA.[17])*100))) '17'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[18])/SUM(AA.[18])*100))) '18'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[19])/SUM(AA.[19])*100))) '19'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[20])/SUM(AA.[20])*100))) '20'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[21])/SUM(AA.[21])*100))) '21'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[22])/SUM(AA.[22])*100))) '22'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[23])/SUM(AA.[23])*100))) '23'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[24])/SUM(AA.[24])*100))) '24'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[25])/SUM(AA.[25])*100))) '25'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[26])/SUM(AA.[26])*100))) '26'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[27])/SUM(AA.[27])*100))) '27'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[28])/SUM(AA.[28])*100))) '28'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[29])/SUM(AA.[29])*100))) '29'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[30])/SUM(AA.[30])*100))) '30'
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(SUM(BB.[31])/SUM(AA.[31])*100))) '31'


from
(
	SELECT      
			'007' AS GUBUN								
			,'생산' AS GUBUN_NM
			, 'Total' GOODS_CD
			,CONVERT(NUMERIC(18,2) , SUM((ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
					ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
					ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
					ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
					ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
					ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
					ISNULL([31],0)))) AS COUNT_SUM
			, CONVERT(NUMERIC(18,2) ,SUM([01])) '01'
			, CONVERT(NUMERIC(18,2) ,SUM([02])) '02'
			, CONVERT(NUMERIC(18,2) ,SUM([03])) '03'
			, CONVERT(NUMERIC(18,2) ,SUM([04])) '04'
			, CONVERT(NUMERIC(18,2) ,SUM([05])) '05'
			, CONVERT(NUMERIC(18,2) ,SUM([06])) '06'
			, CONVERT(NUMERIC(18,2) ,SUM([07])) '07'
			, CONVERT(NUMERIC(18,2) ,SUM([08])) '08'
			, CONVERT(NUMERIC(18,2) ,SUM([09])) '09'
			, CONVERT(NUMERIC(18,2) ,SUM([10])) '10'
			, CONVERT(NUMERIC(18,2) ,SUM([11])) '11'
			, CONVERT(NUMERIC(18,2) ,SUM([12])) '12'
			, CONVERT(NUMERIC(18,2) ,SUM([13])) '13'
			, CONVERT(NUMERIC(18,2) ,SUM([14])) '14'
			, CONVERT(NUMERIC(18,2) ,SUM([15])) '15'
			, CONVERT(NUMERIC(18,2) ,SUM([16])) '16'
			, CONVERT(NUMERIC(18,2) ,SUM([17])) '17'
			, CONVERT(NUMERIC(18,2) ,SUM([18])) '18'
			, CONVERT(NUMERIC(18,2) ,SUM([19])) '19'
			, CONVERT(NUMERIC(18,2) ,SUM([20])) '20'
			, CONVERT(NUMERIC(18,2) ,SUM([21])) '21'
			, CONVERT(NUMERIC(18,2) ,SUM([22])) '22'
			, CONVERT(NUMERIC(18,2) ,SUM([23])) '23'
			, CONVERT(NUMERIC(18,2) ,SUM([24])) '24'
			, CONVERT(NUMERIC(18,2) ,SUM([25])) '25'
			, CONVERT(NUMERIC(18,2) ,SUM([26])) '26'
			, CONVERT(NUMERIC(18,2) ,SUM([27])) '27'
			, CONVERT(NUMERIC(18,2) ,SUM([28])) '28'
			, CONVERT(NUMERIC(18,2) ,SUM([29])) '29'
			, CONVERT(NUMERIC(18,2) ,SUM([30])) '30'
			, CONVERT(NUMERIC(18,2) ,SUM([31])) '31'
		FROM (
				SELECT 							
					ISNULL(AA.EQUIP_CD,'') EQUIP_CD
					,ISNULL( AA.DAY_,'') DAY_
					,ISNULL(AA.GOODS_CD,'') GOODS_CD								
					,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) + SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 	
	             
				FROM
				(
					SELECT
						LEFT(A.EQUIP_CD,10) EQUIP_CD
						, A.WORK_ORD_NO                     
						, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
						, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
						, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
						, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT								
						, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
						, ISNULL(RE_SHIP_FAULTY_CNT, 0 ) AS RE_SHIP_FAULTY_CNT		
						, A.GOODS_CD
						, RIGHT(WORK_ORD_DATE,2) DAY_
					FROM 
					(
						SELECT
						B.EQUIP_CD
						, A.WORK_ORD_NO                      
								                       
						, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
						, B.GOODS_CD
						, WORK_ORD_DATE
						FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo} GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A, TB_WORK_ORDER B
						WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
						GROUP BY A.WORK_ORD_NO, B.EQUIP_CD, B.GOODS_CD,WORK_ORD_DATE
					) A 
					LEFT OUTER JOIN
				(SELECT
						X.WORK_ORD_NO
						, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
		
					FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
					WHERE 1=1 
					AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
	
					GROUP BY X.WORK_ORD_NO) CC
				ON CC.WORK_ORD_NO = A.WORK_ORD_NO
	
					LEFT OUTER JOIN 
					(
						SELECT                      
							X.WORK_ORD_NO
						, SUM(A.FAULTY_CNT) E_FAULTY_CNT
	                     
						FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
						WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
						GROUP BY X.WORK_ORD_NO
					) B
					ON A.WORK_ORD_NO = B.WORK_ORD_NO       
					
					LEFT OUTER JOIN
					(	SELECT 									
							 ISNULL(SUM(A.FAULTY_CNT),0) SHIP_FAULTY_CNT
							,GOODS_CD
							,X.WORK_ORD_NO
					
						FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
						WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
						AND E.WORK_ORD_NO = X.WORK_ORD_NO
						AND A.SHIP_INSP_IDX = B.IDX
						AND RE_INSP_STATUS != '002'
						GROUP BY X.WORK_ORD_NO,GOODS_CD
						) HH
	
					ON A.WORK_ORD_NO = HH.WORK_ORD_NO						
	
					LEFT OUTER JOIN
	
					(	SELECT 
						
							 ISNULL(SUM(A.FAULTY_CNT),0) RE_SHIP_FAULTY_CNT
							,GOODS_CD
							,X.WORK_ORD_NO
							FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
							WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
							AND E.WORK_ORD_NO = X.WORK_ORD_NO
							AND A.SHIP_INSP_IDX = B.IDX
							AND RE_INSP_STATUS = '002'
							GROUP BY X.WORK_ORD_NO,GOODS_CD
					) II
	
					ON A.WORK_ORD_NO = II.WORK_ORD_NO  
		  
							              
				) AA
				GROUP BY AA.EQUIP_CD, AA.GOODS_CD,DAY_	
										
			) AS AA						 
			PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
													, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
													, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
												, [31]) ) AS PIVOT_RESULT

												) AA
												,
			(SELECT      
			'010' AS GUBUN								
			,'검사' AS GUBUN_NM
			, 'Total' GOODS_CD
			,CONVERT(NUMERIC(18,2) ,SUM((ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
					ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
					ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
					ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
					ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
					ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
					ISNULL([31],0)))) AS COUNT_SUM
			, CONVERT(NUMERIC(18,2) ,SUM([01])) '01'
			, CONVERT(NUMERIC(18,2) ,SUM([02])) '02'
			, CONVERT(NUMERIC(18,2) ,SUM([03])) '03'
			, CONVERT(NUMERIC(18,2) ,SUM([04])) '04'
			, CONVERT(NUMERIC(18,2) ,SUM([05])) '05'
			, CONVERT(NUMERIC(18,2) ,SUM([06])) '06'
			, CONVERT(NUMERIC(18,2) ,SUM([07])) '07'
			, CONVERT(NUMERIC(18,2) ,SUM([08])) '08'
			, CONVERT(NUMERIC(18,2) ,SUM([09])) '09'
			, CONVERT(NUMERIC(18,2) ,SUM([10])) '10'
			, CONVERT(NUMERIC(18,2) ,SUM([11])) '11'
			, CONVERT(NUMERIC(18,2) ,SUM([12])) '12'
			, CONVERT(NUMERIC(18,2) ,SUM([13])) '13'
			, CONVERT(NUMERIC(18,2) ,SUM([14])) '14'
			, CONVERT(NUMERIC(18,2) ,SUM([15])) '15'
			, CONVERT(NUMERIC(18,2) ,SUM([16])) '16'
			, CONVERT(NUMERIC(18,2) ,SUM([17])) '17'
			, CONVERT(NUMERIC(18,2) ,SUM([18])) '18'
			, CONVERT(NUMERIC(18,2) ,SUM([19])) '19'
			, CONVERT(NUMERIC(18,2) ,SUM([20])) '20'
			, CONVERT(NUMERIC(18,2) ,SUM([21])) '21'
			, CONVERT(NUMERIC(18,2) ,SUM([22])) '22'
			, CONVERT(NUMERIC(18,2) ,SUM([23])) '23'
			, CONVERT(NUMERIC(18,2) ,SUM([24])) '24'
			, CONVERT(NUMERIC(18,2) ,SUM([25])) '25'
			, CONVERT(NUMERIC(18,2) ,SUM([26])) '26'
			, CONVERT(NUMERIC(18,2) ,SUM([27])) '27'
			, CONVERT(NUMERIC(18,2) ,SUM([28])) '28'
			, CONVERT(NUMERIC(18,2) ,SUM([29])) '29'
			, CONVERT(NUMERIC(18,2) ,SUM([30])) '30'
			, CONVERT(NUMERIC(18,2) ,SUM([31])) '31'
		FROM (
				SELECT 							
					ISNULL(AA.EQUIP_CD,'') EQUIP_CD
					,ISNULL( AA.DAY_,'') DAY_
					,ISNULL(AA.GOODS_CD,'') GOODS_CD											
					, SUM(APPEAR_OUTPUT_CNT) AS SUM_OUPUT_CNT 	
            
				FROM
				(
					SELECT
						LEFT(A.EQUIP_CD,10) EQUIP_CD
						, A.WORK_ORD_NO  
						, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT														
						, A.GOODS_CD
						, RIGHT(WORK_ORD_DATE,2) DAY_
					FROM 
					(
						SELECT
						B.EQUIP_CD
						, A.WORK_ORD_NO    
						, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
						, B.GOODS_CD
						, WORK_ORD_DATE
						FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo} GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A, TB_WORK_ORDER B
						WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
						GROUP BY A.WORK_ORD_NO, B.EQUIP_CD, B.GOODS_CD,WORK_ORD_DATE
					) A 									
					              
				) AA
				GROUP BY AA.EQUIP_CD, AA.GOODS_CD,DAY_
										
			) AS AA						 
			PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
													, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
													, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
													, [31]) ) AS PIVOT_RESULT
													) BB
			
		UNION ALL
		SELECT 
			BB.GUBUN
			, BB.GUBUN_NM
			, BB.GOODS_CD
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(COUNT_SUM - DATA_SUM)))  DATA_SUM
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[01] - FP_DATE1)))  + ('/'+ISNULL(CC.[01],''))   AS FP_DATE1 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[02] - FP_DATE2 ))) + ('/'+ISNULL(CC.[02],''))  AS FP_DATE2 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[03] - FP_DATE3 ))) + ('/'+ISNULL(CC.[03],''))  AS FP_DATE3 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[04] - FP_DATE4 ))) + ('/'+ISNULL(CC.[04],''))  AS FP_DATE4 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[05] - FP_DATE5 ))) + ('/'+ISNULL(CC.[05],''))  AS FP_DATE5 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[06] - FP_DATE6 ))) + ('/'+ISNULL(CC.[06],''))  AS FP_DATE6 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[07] - FP_DATE7 ))) + ('/'+ISNULL(CC.[07],''))  AS FP_DATE7 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[08] - FP_DATE8 ))) + ('/'+ISNULL(CC.[08],''))  AS FP_DATE8 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[09] - FP_DATE9 ))) + ('/'+ISNULL(CC.[09],''))  AS FP_DATE9 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[10] - FP_DATE10))) + ('/'+ISNULL(CC.[10],''))  AS FP_DATE10
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[11] - FP_DATE11))) + ('/'+ISNULL(CC.[11],''))  AS FP_DATE11
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[12] - FP_DATE12))) + ('/'+ISNULL(CC.[12],''))  AS FP_DATE12
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[13] - FP_DATE13))) + ('/'+ISNULL(CC.[13],''))  AS FP_DATE13
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[14] - FP_DATE14))) + ('/'+ISNULL(CC.[14],''))  AS FP_DATE14
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[15] - FP_DATE15))) + ('/'+ISNULL(CC.[15],''))  AS FP_DATE15
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[16] - FP_DATE16))) + ('/'+ISNULL(CC.[16],''))  AS FP_DATE16
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[17] - FP_DATE17))) + ('/'+ISNULL(CC.[17],''))  AS FP_DATE17
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[18] - FP_DATE18))) + ('/'+ISNULL(CC.[18],''))  AS FP_DATE18
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[19] - FP_DATE19))) + ('/'+ISNULL(CC.[19],''))  AS FP_DATE19
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[20] - FP_DATE20))) + ('/'+ISNULL(CC.[20],''))  AS FP_DATE20
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[21] - FP_DATE21))) + ('/'+ISNULL(CC.[21],''))  AS FP_DATE21
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[22] - FP_DATE22))) + ('/'+ISNULL(CC.[22],''))  AS FP_DATE22
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[23] - FP_DATE23))) + ('/'+ISNULL(CC.[23],''))  AS FP_DATE23
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[24] - FP_DATE24))) + ('/'+ISNULL(CC.[24],''))  AS FP_DATE24
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[25] - FP_DATE25))) + ('/'+ISNULL(CC.[25],''))  AS FP_DATE25
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[26] - FP_DATE26))) + ('/'+ISNULL(CC.[26],''))  AS FP_DATE26
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[27] - FP_DATE27))) + ('/'+ISNULL(CC.[27],''))  AS FP_DATE27
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[28] - FP_DATE28))) + ('/'+ISNULL(CC.[28],''))  AS FP_DATE28
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[29] - FP_DATE29))) + ('/'+ISNULL(CC.[29],''))  AS FP_DATE29
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[30] - FP_DATE30))) + ('/'+ISNULL(CC.[30],''))  AS FP_DATE30
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[31] - FP_DATE31))) + ('/'+ISNULL(CC.[31],''))  AS FP_DATE31
		FROM
		(
			SELECT DISTINCT  GUBUN
				,'' AS GUBUN_NM									 
				,'' GOODS_CD
				,(SELECT SUM(PLAN_CNT)  DATA_SUM FROM
					TB_MONTH_PRODUCTION_PLAN_DTL B
					WHERE B.FP_DATE >= #{chooseDateFrom}
						AND B.FP_DATE <= #{chooseDateTo}
						AND CPL_GUBUN = '001'
						AND COMPLETE_YN = '001'
				) DATA_SUM
				,ISNULL(SUM(FP_DATE1) ,0) FP_DATE1
				,ISNULL(SUM(FP_DATE2) ,0) FP_DATE2
				,ISNULL(SUM(FP_DATE3) ,0) FP_DATE3
				,ISNULL(SUM(FP_DATE4) ,0) FP_DATE4
				,ISNULL(SUM(FP_DATE5) ,0) FP_DATE5
				,ISNULL(SUM(FP_DATE6) ,0) FP_DATE6
				,ISNULL(SUM(FP_DATE7) ,0) FP_DATE7
				,ISNULL(SUM(FP_DATE8) ,0) FP_DATE8
				,ISNULL(SUM(FP_DATE9) ,0) FP_DATE9
				,ISNULL(SUM(FP_DATE10),0) FP_DATE10
				,ISNULL(SUM(FP_DATE11),0) FP_DATE11
				,ISNULL(SUM(FP_DATE12),0) FP_DATE12
				,ISNULL(SUM(FP_DATE13),0) FP_DATE13
				,ISNULL(SUM(FP_DATE14),0) FP_DATE14
				,ISNULL(SUM(FP_DATE15),0) FP_DATE15
				,ISNULL(SUM(FP_DATE16),0) FP_DATE16
				,ISNULL(SUM(FP_DATE17),0) FP_DATE17
				,ISNULL(SUM(FP_DATE18),0) FP_DATE18
				,ISNULL(SUM(FP_DATE19),0) FP_DATE19
				,ISNULL(SUM(FP_DATE20),0) FP_DATE20
				,ISNULL(SUM(FP_DATE21),0) FP_DATE21
				,ISNULL(SUM(FP_DATE22),0) FP_DATE22
				,ISNULL(SUM(FP_DATE23),0) FP_DATE23
				,ISNULL(SUM(FP_DATE24),0) FP_DATE24
				,ISNULL(SUM(FP_DATE25),0) FP_DATE25
				,ISNULL(SUM(FP_DATE26),0) FP_DATE26
				,ISNULL(SUM(FP_DATE27),0) FP_DATE27
				,ISNULL(SUM(FP_DATE28),0) FP_DATE28
				,ISNULL(SUM(FP_DATE29),0) FP_DATE29
				,ISNULL(SUM(FP_DATE30),0) FP_DATE30
				,ISNULL(SUM(FP_DATE31),0) FP_DATE31
		
			FROM 
			TB_FP_TOTAL_COMPLETE A
		
			where 1=1
		
			AND A.FP_DATE = #{fpDate}
			AND GUBUN = '004' 
		
			group by GUBUN
		
		) AA
		,
		(SELECT      
			'012' AS GUBUN								
			,'차이량' AS GUBUN_NM
			, '확정 계획 대비' GOODS_CD
			, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,SUM((ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
					ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
					ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
					ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
					ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
					ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
					ISNULL([31],0))))) AS COUNT_SUM
			, SUM([01]) '01', SUM([02]) '02', SUM([03]) '03', SUM([04]) '04', SUM([05]) '05', SUM([06]) '06', SUM([07]) '07', SUM([08]) '08', SUM([09]) '09', SUM([10]) '10'
			, SUM([11]) '11', SUM([12]) '12', SUM([13]) '13', SUM([14]) '14', SUM([15]) '15', SUM([16]) '16', SUM([17]) '17', SUM([18]) '18', SUM([19]) '19', SUM([20]) '20'
			, SUM([21]) '21', SUM([22]) '22', SUM([23]) '23', SUM([24]) '24', SUM([25]) '25', SUM([26]) '26', SUM([27]) '27', SUM([28]) '28', SUM([29]) '29', SUM([30]) '30'
			, SUM([31]) '31'
			FROM (
				SELECT 							
					ISNULL(AA.EQUIP_CD,'') EQUIP_CD
					,ISNULL( AA.DAY_,'') DAY_
					,ISNULL(AA.GOODS_CD,'') GOODS_CD											
					, SUM(APPEAR_OUTPUT_CNT) AS SUM_OUPUT_CNT 	
            
				FROM
				(
					SELECT
						LEFT(A.EQUIP_CD,10) EQUIP_CD
						, A.WORK_ORD_NO  
						, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT														
						, A.GOODS_CD
						, RIGHT(WORK_ORD_DATE,2) DAY_
					FROM 
					(
						SELECT
						B.EQUIP_CD
						, A.WORK_ORD_NO    
						, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
						, B.GOODS_CD
						, WORK_ORD_DATE
						FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo} GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A, TB_WORK_ORDER B
						WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
						GROUP BY A.WORK_ORD_NO, B.EQUIP_CD, B.GOODS_CD,WORK_ORD_DATE
					) A 									
					              
				) AA
				GROUP BY AA.EQUIP_CD, AA.GOODS_CD,DAY_
										
			) AS AA						 
			PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
													, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
													, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
													, [31]) ) AS PIVOT_RESULT
		
		) BB
		LEFT OUTER JOIN

			
			(				SELECT *
												FROM (
											
												SELECT 							
													ISNULL(AA.EQUIP_CD,'') EQUIP_CD
													,ISNULL(AA.GOODS_CD,'') GOODS_CD		
													,ISNULL( AA.DAY_,'') DAY_
													,ISNULL( MEMO, '') MEMO 
				                
												FROM
												(
													SELECT EQUIP_CD
													,GOODS_CD
													,RIGHT(PLAN_DATE,2) DAY_
													,MEMO 
													 FROM TB_MONTH_PRODUCTION_MEMO 
													 WHERE 1=1        											
													 AND PLAN_DATE >= #{chooseDateFrom}
													 AND PLAN_DATE <= #{chooseDateTo}
													 AND MEMO_GUBUN = '002'
												) AA
												GROUP BY AA.EQUIP_CD, AA.GOODS_CD,DAY_,MEMO						
											
															
											) AS AA								
													 
							PIVOT ( MAX(MEMO) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																	, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																	, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																	, [31]) ) AS PIVOT_RESULT

			) CC

			ON 1=1
						
		UNION ALL
		SELECT 
			BB.GUBUN
			, BB.GUBUN_NM
			, BB.GOODS_CD
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(COUNT_SUM - DATA_SUM)))  DATA_SUM
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[01] - FP_DATE1)))  + ('/'+ISNULL(CC.[01],''))  AS FP_DATE1 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[02] - FP_DATE2 ))) + ('/'+ISNULL(CC.[02],''))  AS FP_DATE2 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[03] - FP_DATE3 ))) + ('/'+ISNULL(CC.[03],''))  AS FP_DATE3 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[04] - FP_DATE4 ))) + ('/'+ISNULL(CC.[04],''))  AS FP_DATE4 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[05] - FP_DATE5 ))) + ('/'+ISNULL(CC.[05],''))  AS FP_DATE5 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[06] - FP_DATE6 ))) + ('/'+ISNULL(CC.[06],''))  AS FP_DATE6 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[07] - FP_DATE7 ))) + ('/'+ISNULL(CC.[07],''))  AS FP_DATE7 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[08] - FP_DATE8 ))) + ('/'+ISNULL(CC.[08],''))  AS FP_DATE8 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[09] - FP_DATE9 ))) + ('/'+ISNULL(CC.[09],''))  AS FP_DATE9 
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[10] - FP_DATE10))) + ('/'+ISNULL(CC.[10],''))  AS FP_DATE10
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[11] - FP_DATE11))) + ('/'+ISNULL(CC.[11],''))  AS FP_DATE11
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[12] - FP_DATE12))) + ('/'+ISNULL(CC.[12],''))  AS FP_DATE12
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[13] - FP_DATE13))) + ('/'+ISNULL(CC.[13],''))  AS FP_DATE13
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[14] - FP_DATE14))) + ('/'+ISNULL(CC.[14],''))  AS FP_DATE14
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[15] - FP_DATE15))) + ('/'+ISNULL(CC.[15],''))  AS FP_DATE15
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[16] - FP_DATE16))) + ('/'+ISNULL(CC.[16],''))  AS FP_DATE16
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[17] - FP_DATE17))) + ('/'+ISNULL(CC.[17],''))  AS FP_DATE17
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[18] - FP_DATE18))) + ('/'+ISNULL(CC.[18],''))  AS FP_DATE18
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[19] - FP_DATE19))) + ('/'+ISNULL(CC.[19],''))  AS FP_DATE19
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[20] - FP_DATE20))) + ('/'+ISNULL(CC.[20],''))  AS FP_DATE20
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[21] - FP_DATE21))) + ('/'+ISNULL(CC.[21],''))  AS FP_DATE21
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[22] - FP_DATE22))) + ('/'+ISNULL(CC.[22],''))  AS FP_DATE22
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[23] - FP_DATE23))) + ('/'+ISNULL(CC.[23],''))  AS FP_DATE23
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[24] - FP_DATE24))) + ('/'+ISNULL(CC.[24],''))  AS FP_DATE24
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[25] - FP_DATE25))) + ('/'+ISNULL(CC.[25],''))  AS FP_DATE25
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[26] - FP_DATE26))) + ('/'+ISNULL(CC.[26],''))  AS FP_DATE26
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[27] - FP_DATE27))) + ('/'+ISNULL(CC.[27],''))  AS FP_DATE27
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[28] - FP_DATE28))) + ('/'+ISNULL(CC.[28],''))  AS FP_DATE28
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[29] - FP_DATE29))) + ('/'+ISNULL(CC.[29],''))  AS FP_DATE29
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[30] - FP_DATE30))) + ('/'+ISNULL(CC.[30],''))  AS FP_DATE30
			,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.[31] - FP_DATE31))) + ('/'+ISNULL(CC.[31],''))  AS FP_DATE31

		
		FROM
		(
			SELECT DISTINCT  GUBUN
				,'' AS GUBUN_NM									 
				,'' GOODS_CD
				,(SELECT SUM(PLAN_CNT)  DATA_SUM FROM
					TB_MONTH_PRODUCTION_PLAN_DTL B
					WHERE B.FP_DATE >= #{chooseDateFrom}
						AND B.FP_DATE <= #{chooseDateTo}
						AND CPL_GUBUN = '002'						
				) DATA_SUM
				,ISNULL(SUM(FP_DATE1) ,0) FP_DATE1
				,ISNULL(SUM(FP_DATE2) ,0) FP_DATE2
				,ISNULL(SUM(FP_DATE3) ,0) FP_DATE3
				,ISNULL(SUM(FP_DATE4) ,0) FP_DATE4
				,ISNULL(SUM(FP_DATE5) ,0) FP_DATE5
				,ISNULL(SUM(FP_DATE6) ,0) FP_DATE6
				,ISNULL(SUM(FP_DATE7) ,0) FP_DATE7
				,ISNULL(SUM(FP_DATE8) ,0) FP_DATE8
				,ISNULL(SUM(FP_DATE9) ,0) FP_DATE9
				,ISNULL(SUM(FP_DATE10),0) FP_DATE10
				,ISNULL(SUM(FP_DATE11),0) FP_DATE11
				,ISNULL(SUM(FP_DATE12),0) FP_DATE12
				,ISNULL(SUM(FP_DATE13),0) FP_DATE13
				,ISNULL(SUM(FP_DATE14),0) FP_DATE14
				,ISNULL(SUM(FP_DATE15),0) FP_DATE15
				,ISNULL(SUM(FP_DATE16),0) FP_DATE16
				,ISNULL(SUM(FP_DATE17),0) FP_DATE17
				,ISNULL(SUM(FP_DATE18),0) FP_DATE18
				,ISNULL(SUM(FP_DATE19),0) FP_DATE19
				,ISNULL(SUM(FP_DATE20),0) FP_DATE20
				,ISNULL(SUM(FP_DATE21),0) FP_DATE21
				,ISNULL(SUM(FP_DATE22),0) FP_DATE22
				,ISNULL(SUM(FP_DATE23),0) FP_DATE23
				,ISNULL(SUM(FP_DATE24),0) FP_DATE24
				,ISNULL(SUM(FP_DATE25),0) FP_DATE25
				,ISNULL(SUM(FP_DATE26),0) FP_DATE26
				,ISNULL(SUM(FP_DATE27),0) FP_DATE27
				,ISNULL(SUM(FP_DATE28),0) FP_DATE28
				,ISNULL(SUM(FP_DATE29),0) FP_DATE29
				,ISNULL(SUM(FP_DATE30),0) FP_DATE30
				,ISNULL(SUM(FP_DATE31),0) FP_DATE31
		
			FROM 
			TB_FP_TOTAL_COMPLETE A
		
			where 1=1
		
			AND A.FP_DATE = #{fpDate}
			AND GUBUN = '005' 
		
			group by GUBUN
		
		) AA
		,
			(SELECT      
				'013' AS GUBUN								
				,'차이량' AS GUBUN_NM
				, '운영 계획 대비' GOODS_CD
				, SUM((ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
						ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
						ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
						ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
						ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
						ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
						ISNULL([31],0))) AS COUNT_SUM
				, SUM([01]) '01', SUM([02]) '02', SUM([03]) '03', SUM([04]) '04', SUM([05]) '05', SUM([06]) '06', SUM([07]) '07', SUM([08]) '08', SUM([09]) '09', SUM([10]) '10'
				, SUM([11]) '11', SUM([12]) '12', SUM([13]) '13', SUM([14]) '14', SUM([15]) '15', SUM([16]) '16', SUM([17]) '17', SUM([18]) '18', SUM([19]) '19', SUM([20]) '20'
				, SUM([21]) '21', SUM([22]) '22', SUM([23]) '23', SUM([24]) '24', SUM([25]) '25', SUM([26]) '26', SUM([27]) '27', SUM([28]) '28', SUM([29]) '29', SUM([30]) '30'
				, SUM([31]) '31'
			FROM (
				SELECT 							
					ISNULL(AA.EQUIP_CD,'') EQUIP_CD
					,ISNULL( AA.DAY_,'') DAY_
					,ISNULL(AA.GOODS_CD,'') GOODS_CD											
					, SUM(APPEAR_OUTPUT_CNT) AS SUM_OUPUT_CNT 	
            
				FROM
				(
					SELECT
						LEFT(A.EQUIP_CD,10) EQUIP_CD
						, A.WORK_ORD_NO  
						, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT														
						, A.GOODS_CD
						, RIGHT(WORK_ORD_DATE,2) DAY_
					FROM 
					(
						SELECT
						B.EQUIP_CD
						, A.WORK_ORD_NO    
						, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
						, B.GOODS_CD
						, WORK_ORD_DATE
						FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo} GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A, TB_WORK_ORDER B
						WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
						GROUP BY A.WORK_ORD_NO, B.EQUIP_CD, B.GOODS_CD,WORK_ORD_DATE
					) A 									
					              
				) AA
				GROUP BY AA.EQUIP_CD, AA.GOODS_CD,DAY_
										
				) AS AA						 
				PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
														, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
														, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
														, [31]) ) AS PIVOT_RESULT
		
		) BB
		LEFT OUTER JOIN

			
			(				SELECT *
												FROM (
											
												SELECT 							
													ISNULL(AA.EQUIP_CD,'') EQUIP_CD
													,ISNULL(AA.GOODS_CD,'') GOODS_CD		
													,ISNULL( AA.DAY_,'') DAY_
													,ISNULL( MEMO, '') MEMO 
				                
												FROM
												(
													SELECT EQUIP_CD
													,GOODS_CD
													,RIGHT(PLAN_DATE,2) DAY_
													,MEMO 
													 FROM TB_MONTH_PRODUCTION_MEMO 
													 WHERE 1=1        											
													 AND PLAN_DATE >= #{chooseDateFrom}
													 AND PLAN_DATE <= #{chooseDateTo}
													 AND MEMO_GUBUN = '003'
												) AA
												GROUP BY AA.EQUIP_CD, AA.GOODS_CD,DAY_,MEMO						
											
															
											) AS AA								
													 
							PIVOT ( MAX(MEMO) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																	, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																	, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																	, [31]) ) AS PIVOT_RESULT

			) CC

			ON 1=1		
			
		
		ORDER BY GUBUN
	]]>

	</select >
	
	<!-- 월별 FP 기종별 요약본 조회 -->
	<select id="monthProductionPlanGijongList" resultMap="MonthProductionPlanVo" >		
	
	
		<!-- SELECT DISTINCT				
			'001' GUBUN
			,B.GOODS_CD
			,B.GOODS_NM
			,'계획수량' AS GUBUN_NM
			,B.GIJONG_CD
			,(SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '080' AND B.GIJONG_CD = X.BASE_CD) GIJONG_NM
			,C.QUTY_CD
			,(SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '007' AND C.QUTY_CD = X.BASE_CD) QUTY_NM
			,COUNT(A.EQUIP_CD) EQUIP_CD
					
			,ISNULL(SUM(D.DATA_SUM) ,0) DATA_SUM
			,ISNULL(SUM(FP_DATE1) ,0) FP_DATE1
			,ISNULL(SUM(FP_DATE2) ,0) FP_DATE2
			,ISNULL(SUM(FP_DATE3) ,0) FP_DATE3
			,ISNULL(SUM(FP_DATE4) ,0) FP_DATE4
			,ISNULL(SUM(FP_DATE5) ,0) FP_DATE5
			,ISNULL(SUM(FP_DATE6) ,0) FP_DATE6
			,ISNULL(SUM(FP_DATE7) ,0) FP_DATE7
			,ISNULL(SUM(FP_DATE8) ,0) FP_DATE8
			,ISNULL(SUM(FP_DATE9) ,0) FP_DATE9
			,ISNULL(SUM(FP_DATE10),0) FP_DATE10
			,ISNULL(SUM(FP_DATE11),0) FP_DATE11
			,ISNULL(SUM(FP_DATE12),0) FP_DATE12
			,ISNULL(SUM(FP_DATE13),0) FP_DATE13
			,ISNULL(SUM(FP_DATE14),0) FP_DATE14
			,ISNULL(SUM(FP_DATE15),0) FP_DATE15
			,ISNULL(SUM(FP_DATE16),0) FP_DATE16
			,ISNULL(SUM(FP_DATE17),0) FP_DATE17
			,ISNULL(SUM(FP_DATE18),0) FP_DATE18
			,ISNULL(SUM(FP_DATE19),0) FP_DATE19
			,ISNULL(SUM(FP_DATE20),0) FP_DATE20
			,ISNULL(SUM(FP_DATE21),0) FP_DATE21
			,ISNULL(SUM(FP_DATE22),0) FP_DATE22
			,ISNULL(SUM(FP_DATE23),0) FP_DATE23
			,ISNULL(SUM(FP_DATE24),0) FP_DATE24
			,ISNULL(SUM(FP_DATE25),0) FP_DATE25
			,ISNULL(SUM(FP_DATE26),0) FP_DATE26
			,ISNULL(SUM(FP_DATE27),0) FP_DATE27
			,ISNULL(SUM(FP_DATE28),0) FP_DATE28
			,ISNULL(SUM(FP_DATE29),0) FP_DATE29
			,ISNULL(SUM(FP_DATE30),0) FP_DATE30
			,ISNULL(SUM(FP_DATE31),0) FP_DATE31
		
		FROM 
		TB_GOODS_CODE_ADM B
		LEFT OUTER JOIN
		TB_FP_TOTAL_COMPLETE A
		ON 1=1 
		AND B.GOODS_CD = A.GOODS_CD
		AND A.FP_DATE = #{fpDate}
		AND GUBUN ='004'
		
		LEFT OUTER JOIN
		(SELECT EQUIP_CD,GOODS_CD, SUM(PLAN_CNT) DATA_SUM FROM
			TB_MONTH_PRODUCTION_PLAN_DTL B
			WHERE B.FP_DATE >= #{chooseDateFrom}
				AND B.FP_DATE <= #{chooseDateTo}
				AND CPL_GUBUN = '001'
				AND COMPLETE_YN = '001'
			GROUP BY EQUIP_CD,GOODS_CD	) D
				ON 1=1
				AND A.EQUIP_CD = D.EQUIP_CD 
				AND A.GOODS_CD = D.GOODS_CD
		
		,TB_MATRL_CODE_ADM C
		where 1=1
		
		AND B.ALNICU_MATRL_CD = C.MATRL_CD
		AND B.USE_YN_CD = '001'
		AND B.GIJONG_CD != ''
		
		
		group by B.GOODS_CD,B.GOODS_NM,B.GIJONG_CD,C.QUTY_CD
		
		
		UNION ALL
		
		
		SELECT		
			'002' GUBUN
			,B.GOODS_CD			
			,B.GOODS_NM
			,'생산수량' AS GUBUN_NM
			,B.GIJONG_CD
			,(SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '080' AND B.GIJONG_CD = X.BASE_CD) GIJONG_NM
			,C.QUTY_CD
			,(SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '007' AND C.QUTY_CD = X.BASE_CD) QUTY_NM
			,'' EQUIP_CD
			,(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
			ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
			ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
			ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
			ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
			ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
			ISNULL(AA.[31],0)) COUNT_SUM,
			AA.[01], AA.[02], AA.[03], AA.[04], AA.[05],
			AA.[06], AA.[07], AA.[08], AA.[09], AA.[10],
			AA.[11], AA.[12], AA.[13], AA.[14], AA.[15],
			AA.[16], AA.[17], AA.[18], AA.[19], AA.[20],
			AA.[21], AA.[22], AA.[23], AA.[24], AA.[25],
			AA.[26], AA.[27], AA.[28], AA.[29], AA.[30],
			AA.[31]
			FROM 		
						
			TB_GOODS_CODE_ADM B
			LEFT OUTER JOIN
		
				(
				SELECT *
						FROM (
							SELECT 							
							AA.DAY_
							, GOODS_CD								
							, SUM_OUPUT_CNT 							
						FROM 
								(
								SELECT 
								A.GOODS_CD									
								,RIGHT(B.WORK_ORD_DATE, 2) DAY_ 
								,(CASE WHEN LEFT(A.GOODS_CD,1) = 'A' THEN (ISNULL(SUM(B.OUTPUT_CNT+B.VISION_EDGE_CNT),0))
									WHEN LEFT(A.GOODS_CD,1) = 'N' THEN (ISNULL(SUM(B.OUTPUT_CNT+B.VISION_EDGE_CNT),0) )  END )
								AS SUM_OUPUT_CNT						
								FROM TB_WORK_ORDER A, TB_WORK_ORDER_OUTPUT_SUB B
								WHERE 1=1
								AND A.WORK_ORD_NO = B.WORK_ORD_NO								
								AND B.WORK_ORD_DATE >= #{chooseDateFrom}
								AND B.WORK_ORD_DATE <= #{chooseDateTo}			
											
									
								GROUP BY A.GOODS_CD, B.WORK_ORD_DATE) AS AA 
						) AA
										
										
														
								
		
						PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
															, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
															, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
															, [31]) ) AS PIVOT_RESULT  
															 
				 	) AA
					ON 1=1
					AND B.GOODS_CD = AA.GOODS_CD
					,TB_MATRL_CODE_ADM C
					where 1=1
		
					AND B.ALNICU_MATRL_CD = C.MATRL_CD
					AND B.USE_YN_CD = '001'
					AND B.GIJONG_CD != ''
		
		ORDER BY GIJONG_NM DESC,GOODS_CD,GUBUN ASC -->
		
		<![CDATA[
		
		SELECT DISTINCT				
			'001' GUBUN			
			,'계획수량' AS GUBUN_NM
			,B.GIJONG_CD
			,(SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '080' AND B.GIJONG_CD = X.BASE_CD) GIJONG_NM
			,C.QUTY_CD
			,(SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '007' AND C.QUTY_CD = X.BASE_CD) QUTY_NM
			,COUNT(A.EQUIP_CD) EQUIP_CD
					
			,ISNULL(SUM(D.DATA_SUM) ,0) DATA_SUM
			,ISNULL(SUM(FP_DATE1) ,0) FP_DATE1
			,ISNULL(SUM(FP_DATE2) ,0) FP_DATE2
			,ISNULL(SUM(FP_DATE3) ,0) FP_DATE3
			,ISNULL(SUM(FP_DATE4) ,0) FP_DATE4
			,ISNULL(SUM(FP_DATE5) ,0) FP_DATE5
			,ISNULL(SUM(FP_DATE6) ,0) FP_DATE6
			,ISNULL(SUM(FP_DATE7) ,0) FP_DATE7
			,ISNULL(SUM(FP_DATE8) ,0) FP_DATE8
			,ISNULL(SUM(FP_DATE9) ,0) FP_DATE9
			,ISNULL(SUM(FP_DATE10),0) FP_DATE10
			,ISNULL(SUM(FP_DATE11),0) FP_DATE11
			,ISNULL(SUM(FP_DATE12),0) FP_DATE12
			,ISNULL(SUM(FP_DATE13),0) FP_DATE13
			,ISNULL(SUM(FP_DATE14),0) FP_DATE14
			,ISNULL(SUM(FP_DATE15),0) FP_DATE15
			,ISNULL(SUM(FP_DATE16),0) FP_DATE16
			,ISNULL(SUM(FP_DATE17),0) FP_DATE17
			,ISNULL(SUM(FP_DATE18),0) FP_DATE18
			,ISNULL(SUM(FP_DATE19),0) FP_DATE19
			,ISNULL(SUM(FP_DATE20),0) FP_DATE20
			,ISNULL(SUM(FP_DATE21),0) FP_DATE21
			,ISNULL(SUM(FP_DATE22),0) FP_DATE22
			,ISNULL(SUM(FP_DATE23),0) FP_DATE23
			,ISNULL(SUM(FP_DATE24),0) FP_DATE24
			,ISNULL(SUM(FP_DATE25),0) FP_DATE25
			,ISNULL(SUM(FP_DATE26),0) FP_DATE26
			,ISNULL(SUM(FP_DATE27),0) FP_DATE27
			,ISNULL(SUM(FP_DATE28),0) FP_DATE28
			,ISNULL(SUM(FP_DATE29),0) FP_DATE29
			,ISNULL(SUM(FP_DATE30),0) FP_DATE30
			,ISNULL(SUM(FP_DATE31),0) FP_DATE31
		
		FROM 
		TB_GOODS_CODE_ADM B
		LEFT OUTER JOIN
		TB_FP_TOTAL_COMPLETE A
		ON 1=1 
		AND B.GOODS_CD = A.GOODS_CD
		AND A.FP_DATE = #{fpDate}
		AND GUBUN ='004'
		
		LEFT OUTER JOIN
		(SELECT EQUIP_CD,GOODS_CD, SUM(PLAN_CNT) DATA_SUM FROM
			TB_MONTH_PRODUCTION_PLAN_DTL B
			WHERE B.FP_DATE >= #{chooseDateFrom}
				AND B.FP_DATE <= #{chooseDateTo}
				AND CPL_GUBUN = '001'
				AND COMPLETE_YN = '001'
			GROUP BY EQUIP_CD,GOODS_CD	) D
				ON 1=1
				AND A.EQUIP_CD = D.EQUIP_CD 
				AND A.GOODS_CD = D.GOODS_CD
		
		,TB_MATRL_CODE_ADM C
		where 1=1
		
		AND B.ALNICU_MATRL_CD = C.MATRL_CD
		AND B.USE_YN_CD = '001'
		AND B.GIJONG_CD != ''
		
		
		group by B.GIJONG_CD,C.QUTY_CD
		
		
		UNION ALL
		
		
		SELECT		
			'002' GUBUN		
			,'생산수량' AS GUBUN_NM
			,B.GIJONG_CD
			,(SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '080' AND B.GIJONG_CD = X.BASE_CD) GIJONG_NM
			,C.QUTY_CD
			,(SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '007' AND C.QUTY_CD = X.BASE_CD) QUTY_NM
			,COUNT(EQUIP_CD) EQUIP_CD
			,(ISNULL(SUM(AA.[01]),0) + ISNULL(SUM(AA.[02]),0) + ISNULL(SUM(AA.[03]),0) + ISNULL(SUM(AA.[04]),0) + ISNULL(SUM(AA.[05]),0) +
			ISNULL(SUM(AA.[06]),0) + ISNULL(SUM(AA.[07]),0) + ISNULL(SUM(AA.[08]),0) + ISNULL(SUM(AA.[09]),0) + ISNULL(SUM(AA.[10]),0) +
			ISNULL(SUM(AA.[11]),0) + ISNULL(SUM(AA.[12]),0) + ISNULL(SUM(AA.[13]),0) + ISNULL(SUM(AA.[14]),0) + ISNULL(SUM(AA.[15]),0) +
			ISNULL(SUM(AA.[16]),0) + ISNULL(SUM(AA.[17]),0) + ISNULL(SUM(AA.[18]),0) + ISNULL(SUM(AA.[19]),0) + ISNULL(SUM(AA.[20]),0) +
			ISNULL(SUM(AA.[21]),0) + ISNULL(SUM(AA.[22]),0) + ISNULL(SUM(AA.[23]),0) + ISNULL(SUM(AA.[24]),0) + ISNULL(SUM(AA.[25]),0) +
			ISNULL(SUM(AA.[26]),0) + ISNULL(SUM(AA.[27]),0) + ISNULL(SUM(AA.[28]),0) + ISNULL(SUM(AA.[29]),0) + ISNULL(SUM(AA.[30]),0) +
			ISNULL(SUM(AA.[31]),0)) COUNT_SUM,
			SUM(AA.[01]) [01], SUM(AA.[02]) [02], SUM(AA.[03]) [03], SUM(AA.[04]) [04], SUM(AA.[05]) [05],
			SUM(AA.[06]) [06], SUM(AA.[07]) [07], SUM(AA.[08]) [08], SUM(AA.[09]) [09], SUM(AA.[10]) [10],
			SUM(AA.[11]) [11], SUM(AA.[12]) [12], SUM(AA.[13]) [13], SUM(AA.[14]) [14], SUM(AA.[15]) [15],
			SUM(AA.[16]) [16], SUM(AA.[17]) [17], SUM(AA.[18]) [18], SUM(AA.[19]) [19], SUM(AA.[20]) [20],
			SUM(AA.[21]) [21], SUM(AA.[22]) [22], SUM(AA.[23]) [23], SUM(AA.[24]) [24], SUM(AA.[25]) [25],
			SUM(AA.[26]) [26], SUM(AA.[27]) [27], SUM(AA.[28]) [28], SUM(AA.[29]) [29], SUM(AA.[30]) [30],
			SUM(AA.[31]) [31]
			FROM 		
						
			TB_GOODS_CODE_ADM B
			LEFT OUTER JOIN
		
				(
				SELECT *
						FROM (
							SELECT 							
							ISNULL(AA.EQUIP_CD,'') EQUIP_CD
							,ISNULL( AA.DAY_,'') DAY_
							,ISNULL(AA.GOODS_CD,'') GOODS_CD								
							,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) + SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 	
                
						FROM
						(
							SELECT
								LEFT(A.EQUIP_CD,10) EQUIP_CD
								, A.WORK_ORD_NO                     
								, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
								, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
								, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
								, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT								
								, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
								, ISNULL(RE_SHIP_FAULTY_CNT, 0 ) AS RE_SHIP_FAULTY_CNT		
								, A.GOODS_CD
								, RIGHT(WORK_ORD_DATE,2) DAY_
							FROM 
							(
								SELECT
								B.EQUIP_CD
								, A.WORK_ORD_NO                      
										                       
								, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								, B.GOODS_CD
								, WORK_ORD_DATE
								FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo} GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A, TB_WORK_ORDER B
								WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
								GROUP BY A.WORK_ORD_NO, B.EQUIP_CD, B.GOODS_CD,WORK_ORD_DATE
							) A 
							LEFT OUTER JOIN
						(SELECT
								X.WORK_ORD_NO
								, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
							FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
							WHERE 1=1 
							AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
							GROUP BY X.WORK_ORD_NO) CC
						ON CC.WORK_ORD_NO = A.WORK_ORD_NO

							LEFT OUTER JOIN 
							(
								SELECT                      
									X.WORK_ORD_NO
								, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
								FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
								WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
								GROUP BY X.WORK_ORD_NO
							) B
							ON A.WORK_ORD_NO = B.WORK_ORD_NO         
				  			LEFT OUTER JOIN
							(	SELECT 									
									 ISNULL(SUM(A.FAULTY_CNT),0) SHIP_FAULTY_CNT
									,GOODS_CD
									,X.WORK_ORD_NO
							
								FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
								WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
								AND E.WORK_ORD_NO = X.WORK_ORD_NO
								AND A.SHIP_INSP_IDX = B.IDX
								AND RE_INSP_STATUS != '002'
								GROUP BY X.WORK_ORD_NO,GOODS_CD
								) HH
			
							ON A.WORK_ORD_NO = HH.WORK_ORD_NO						
			
							LEFT OUTER JOIN
			
							(	SELECT 
								
									 ISNULL(SUM(A.FAULTY_CNT),0) RE_SHIP_FAULTY_CNT
									,GOODS_CD
									,X.WORK_ORD_NO
									FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
									WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
									AND E.WORK_ORD_NO = X.WORK_ORD_NO
									AND A.SHIP_INSP_IDX = B.IDX
									AND RE_INSP_STATUS = '002'
									GROUP BY X.WORK_ORD_NO,GOODS_CD
							) II
			
							ON A.WORK_ORD_NO = II.WORK_ORD_NO
									              
						) AA
						GROUP BY AA.EQUIP_CD, AA.GOODS_CD,DAY_				
						) AA
										
										
														
								
		
						PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
															, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
															, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
															, [31]) ) AS PIVOT_RESULT  
															 
				 	) AA
					ON 1=1
					AND B.GOODS_CD = AA.GOODS_CD
					,TB_MATRL_CODE_ADM C
					where 1=1
		
					AND B.ALNICU_MATRL_CD = C.MATRL_CD
					AND B.USE_YN_CD = '001'
					AND B.GIJONG_CD != ''
					group by B.GIJONG_CD,C.QUTY_CD
		
			ORDER BY GIJONG_NM DESC,GIJONG_CD DESC,QUTY_CD,GUBUN ASC
	
	]]>
	
	</select>
	
	
	
	
	
	<!-- 월별 FP 상세 요약본 조회 -->
	<select id="monthProductionPlanDtlList" resultMap="TestDataVo" fetchSize="1000">		
	
		<![CDATA[		
			SET ANSI_WARNINGS OFF
			SET ARITHIGNORE ON
			SET ARITHABORT OFF	
			SELECT		
				'001' GUBUN			
				,'' EQUIP_CD
				,'' EQUIP_NM
				,'' GOODS_CD
				,'' GOODS_NM
				,'생산 조(주간)' AS  GUBUN_NM
				,0 DATA_SUM						
				,CONVERT(VARCHAR,(AA.[01])) + ('/'+ISNULL(CC.[01],''))  AS FP_DATE1  
				,CONVERT(VARCHAR,(AA.[02])) + ('/'+ISNULL(CC.[02],''))  AS FP_DATE2  
				,CONVERT(VARCHAR,(AA.[03])) + ('/'+ISNULL(CC.[03],''))  AS FP_DATE3  
				,CONVERT(VARCHAR,(AA.[04])) + ('/'+ISNULL(CC.[04],''))  AS FP_DATE4  
				,CONVERT(VARCHAR,(AA.[05])) + ('/'+ISNULL(CC.[05],''))  AS FP_DATE5  
				,CONVERT(VARCHAR,(AA.[06])) + ('/'+ISNULL(CC.[06],''))  AS FP_DATE6  
				,CONVERT(VARCHAR,(AA.[07])) + ('/'+ISNULL(CC.[07],''))  AS FP_DATE7  
				,CONVERT(VARCHAR,(AA.[08])) + ('/'+ISNULL(CC.[08],''))  AS FP_DATE8  
				,CONVERT(VARCHAR,(AA.[09])) + ('/'+ISNULL(CC.[09],''))  AS FP_DATE9  
				,CONVERT(VARCHAR,(AA.[10])) + ('/'+ISNULL(CC.[10],''))  AS FP_DATE10 
				,CONVERT(VARCHAR,(AA.[11])) + ('/'+ISNULL(CC.[11],''))  AS FP_DATE11 
				,CONVERT(VARCHAR,(AA.[12])) + ('/'+ISNULL(CC.[12],''))  AS FP_DATE12 
				,CONVERT(VARCHAR,(AA.[13])) + ('/'+ISNULL(CC.[13],''))  AS FP_DATE13 
				,CONVERT(VARCHAR,(AA.[14])) + ('/'+ISNULL(CC.[14],''))  AS FP_DATE14 
				,CONVERT(VARCHAR,(AA.[15])) + ('/'+ISNULL(CC.[15],''))  AS FP_DATE15 
				,CONVERT(VARCHAR,(AA.[16])) + ('/'+ISNULL(CC.[16],''))  AS FP_DATE16 
				,CONVERT(VARCHAR,(AA.[17])) + ('/'+ISNULL(CC.[17],''))  AS FP_DATE17 
				,CONVERT(VARCHAR,(AA.[18])) + ('/'+ISNULL(CC.[18],''))  AS FP_DATE18 
				,CONVERT(VARCHAR,(AA.[19])) + ('/'+ISNULL(CC.[19],''))  AS FP_DATE19 
				,CONVERT(VARCHAR,(AA.[20])) + ('/'+ISNULL(CC.[20],''))  AS FP_DATE20 
				,CONVERT(VARCHAR,(AA.[21])) + ('/'+ISNULL(CC.[21],''))  AS FP_DATE21 
				,CONVERT(VARCHAR,(AA.[22])) + ('/'+ISNULL(CC.[22],''))  AS FP_DATE22 
				,CONVERT(VARCHAR,(AA.[23])) + ('/'+ISNULL(CC.[23],''))  AS FP_DATE23 
				,CONVERT(VARCHAR,(AA.[24])) + ('/'+ISNULL(CC.[24],''))  AS FP_DATE24 
				,CONVERT(VARCHAR,(AA.[25])) + ('/'+ISNULL(CC.[25],''))  AS FP_DATE25 
				,CONVERT(VARCHAR,(AA.[26])) + ('/'+ISNULL(CC.[26],''))  AS FP_DATE26 
				,CONVERT(VARCHAR,(AA.[27])) + ('/'+ISNULL(CC.[27],''))  AS FP_DATE27 
				,CONVERT(VARCHAR,(AA.[28])) + ('/'+ISNULL(CC.[28],''))  AS FP_DATE28 
				,CONVERT(VARCHAR,(AA.[29])) + ('/'+ISNULL(CC.[29],''))  AS FP_DATE29 
				,CONVERT(VARCHAR,(AA.[30])) + ('/'+ISNULL(CC.[30],''))  AS FP_DATE30 
				,CONVERT(VARCHAR,(AA.[31])) + ('/'+ISNULL(CC.[31],''))  AS FP_DATE31 
			FROM

			
				(
				SELECT * FROM
						(SELECT
							'D' GUBUNJA
							,CPL_GUBUN
							,RIGHT(FP_DATE,2) FP_DATE
							,DAY_NIGHT_GUBUN
							,PRODUCT_MAN									
						FROM TB_MONTH_PRODUCTION_PLAN_MAN				
						WHERE LEFT(FP_DATE,6) = '${fpDate}'	
						AND CPL_GUBUN = '001'
						AND DAY_NIGHT_GUBUN = 'D'
							) A
						PIVOT(MAX(PRODUCT_MAN) FOR FP_DATE IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
												, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
												, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
												, [31]
												)) as pivot_reslut
				) AA
			
			LEFT OUTER JOIN	
				
			(				SELECT *
												FROM (
											
												SELECT 							
													ISNULL(AA.EQUIP_CD,'') EQUIP_CD
													,ISNULL(AA.GOODS_CD,'') GOODS_CD		
													,ISNULL( AA.DAY_,'') DAY_
													, MEMO 
				                
												FROM
												(
													SELECT EQUIP_CD
													,GOODS_CD
													,RIGHT(PLAN_DATE,2) DAY_
													,MEMO 
													 FROM TB_MONTH_PRODUCTION_MEMO 
													 WHERE 1=1        											
													 AND PLAN_DATE >= #{chooseDateFrom}
													 AND PLAN_DATE <= #{chooseDateTo}  
													 AND MEMO_GUBUN = '004'
												) AA
												GROUP BY AA.EQUIP_CD, AA.GOODS_CD,DAY_,MEMO						
											
															
											) AS AA								
													 
							PIVOT ( MAX(MEMO) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																	, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																	, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																	, [31]) ) AS PIVOT_RESULT

			) CC

			ON 1=1

			
			
			UNION ALL
			
			SELECT  
				'002' GUBUN			
				,'' EQUIP_CD
				,'' EQUIP_NM
				,'' GOODS_CD
				,'' GOODS_NM
				,'생산 조(야간)' AS  GUBUN_NM
				,0 DATA_SUM				
				,CONVERT(VARCHAR,(AA.[01])) + ('/'+ISNULL(CC.[01],''))  AS FP_DATE1 
				,CONVERT(VARCHAR,(AA.[02])) + ('/'+ISNULL(CC.[02],''))  AS FP_DATE2 
				,CONVERT(VARCHAR,(AA.[03])) + ('/'+ISNULL(CC.[03],''))  AS FP_DATE3 
				,CONVERT(VARCHAR,(AA.[04])) + ('/'+ISNULL(CC.[04],''))  AS FP_DATE4 
				,CONVERT(VARCHAR,(AA.[05])) + ('/'+ISNULL(CC.[05],''))  AS FP_DATE5 
				,CONVERT(VARCHAR,(AA.[06])) + ('/'+ISNULL(CC.[06],''))  AS FP_DATE6 
				,CONVERT(VARCHAR,(AA.[07])) + ('/'+ISNULL(CC.[07],''))  AS FP_DATE7 
				,CONVERT(VARCHAR,(AA.[08])) + ('/'+ISNULL(CC.[08],''))  AS FP_DATE8 
				,CONVERT(VARCHAR,(AA.[09])) + ('/'+ISNULL(CC.[09],''))  AS FP_DATE9 
				,CONVERT(VARCHAR,(AA.[10])) + ('/'+ISNULL(CC.[10],''))  AS FP_DATE10
				,CONVERT(VARCHAR,(AA.[11])) + ('/'+ISNULL(CC.[11],''))  AS FP_DATE11
				,CONVERT(VARCHAR,(AA.[12])) + ('/'+ISNULL(CC.[12],''))  AS FP_DATE12
				,CONVERT(VARCHAR,(AA.[13])) + ('/'+ISNULL(CC.[13],''))  AS FP_DATE13
				,CONVERT(VARCHAR,(AA.[14])) + ('/'+ISNULL(CC.[14],''))  AS FP_DATE14
				,CONVERT(VARCHAR,(AA.[15])) + ('/'+ISNULL(CC.[15],''))  AS FP_DATE15
				,CONVERT(VARCHAR,(AA.[16])) + ('/'+ISNULL(CC.[16],''))  AS FP_DATE16
				,CONVERT(VARCHAR,(AA.[17])) + ('/'+ISNULL(CC.[17],''))  AS FP_DATE17
				,CONVERT(VARCHAR,(AA.[18])) + ('/'+ISNULL(CC.[18],''))  AS FP_DATE18
				,CONVERT(VARCHAR,(AA.[19])) + ('/'+ISNULL(CC.[19],''))  AS FP_DATE19
				,CONVERT(VARCHAR,(AA.[20])) + ('/'+ISNULL(CC.[20],''))  AS FP_DATE20
				,CONVERT(VARCHAR,(AA.[21])) + ('/'+ISNULL(CC.[21],''))  AS FP_DATE21
				,CONVERT(VARCHAR,(AA.[22])) + ('/'+ISNULL(CC.[22],''))  AS FP_DATE22
				,CONVERT(VARCHAR,(AA.[23])) + ('/'+ISNULL(CC.[23],''))  AS FP_DATE23
				,CONVERT(VARCHAR,(AA.[24])) + ('/'+ISNULL(CC.[24],''))  AS FP_DATE24
				,CONVERT(VARCHAR,(AA.[25])) + ('/'+ISNULL(CC.[25],''))  AS FP_DATE25
				,CONVERT(VARCHAR,(AA.[26])) + ('/'+ISNULL(CC.[26],''))  AS FP_DATE26
				,CONVERT(VARCHAR,(AA.[27])) + ('/'+ISNULL(CC.[27],''))  AS FP_DATE27
				,CONVERT(VARCHAR,(AA.[28])) + ('/'+ISNULL(CC.[28],''))  AS FP_DATE28
				,CONVERT(VARCHAR,(AA.[29])) + ('/'+ISNULL(CC.[29],''))  AS FP_DATE29
				,CONVERT(VARCHAR,(AA.[30])) + ('/'+ISNULL(CC.[30],''))  AS FP_DATE30
				,CONVERT(VARCHAR,(AA.[31])) + ('/'+ISNULL(CC.[31],''))  AS FP_DATE31
				FROM
				
			
				(
				SELECT * FROM
						(SELECT
							'N' GUBUNJA
							,CPL_GUBUN
							,RIGHT(FP_DATE,2) FP_DATE
							,DAY_NIGHT_GUBUN
							,PRODUCT_MAN									
						FROM TB_MONTH_PRODUCTION_PLAN_MAN				
						WHERE LEFT(FP_DATE,6) = '${fpDate}'	
						AND CPL_GUBUN = '001'
						AND DAY_NIGHT_GUBUN = 'N'
							) A
						PIVOT(MAX(PRODUCT_MAN) FOR FP_DATE IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
												, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
												, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
												, [31]
												)) as pivot_reslut
				) AA
				LEFT OUTER JOIN	
				
			(				SELECT *
												FROM (
											
												SELECT 							
													ISNULL(AA.EQUIP_CD,'') EQUIP_CD
													,ISNULL(AA.GOODS_CD,'') GOODS_CD		
													,ISNULL( AA.DAY_,'') DAY_
													, MEMO 
				                
												FROM
												(
													SELECT EQUIP_CD
													,GOODS_CD
													,RIGHT(PLAN_DATE,2) DAY_
													,MEMO 
													 FROM TB_MONTH_PRODUCTION_MEMO 
													 WHERE 1=1        											
													 AND PLAN_DATE >= #{chooseDateFrom}
													 AND PLAN_DATE <= #{chooseDateTo}  
													 AND MEMO_GUBUN = '005'
												) AA
												GROUP BY AA.EQUIP_CD, AA.GOODS_CD,DAY_,MEMO						
											
															
											) AS AA								
													 
							PIVOT ( MAX(MEMO) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																	, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																	, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																	, [31]) ) AS PIVOT_RESULT

			) CC

			ON 1=1
			
						
			UNION ALL		
			]]>	
			<if test="gubun != null and gubun != ''"> 
			
				SELECT DISTINCT 
				'003' GUBUN			
				,LEFT(AA.EQUIP_CD,10) EQUIP_CD
				,LEFT(AA.EQUIP_NM,5) EQUIP_NM
				,A.GOODS_CD
				,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM WHERE GOODS_CD = A.GOODS_CD) GOODS_NM
				,'Dual Capa' AS  GUBUN_NM
				,CONVERT(INT,B.DATA_SUM) DATA_SUM
				, CONVERT(VARCHAR,FP_DATE1) FP_DATE1
				, CONVERT(VARCHAR,FP_DATE2) FP_DATE2
				, CONVERT(VARCHAR,FP_DATE3) FP_DATE3
				, CONVERT(VARCHAR,FP_DATE4) FP_DATE4
				, CONVERT(VARCHAR,FP_DATE5) FP_DATE5
				, CONVERT(VARCHAR,FP_DATE6) FP_DATE6
				, CONVERT(VARCHAR,FP_DATE7) FP_DATE7
				, CONVERT(VARCHAR,FP_DATE8) FP_DATE8
				, CONVERT(VARCHAR,FP_DATE9) FP_DATE9
				, CONVERT(VARCHAR,FP_DATE10) FP_DATE10
				, CONVERT(VARCHAR,FP_DATE11) FP_DATE11
				, CONVERT(VARCHAR,FP_DATE12) FP_DATE12
				, CONVERT(VARCHAR,FP_DATE13) FP_DATE13
				, CONVERT(VARCHAR,FP_DATE14) FP_DATE14
				, CONVERT(VARCHAR,FP_DATE15) FP_DATE15
				, CONVERT(VARCHAR,FP_DATE16) FP_DATE16
				, CONVERT(VARCHAR,FP_DATE17) FP_DATE17
				, CONVERT(VARCHAR,FP_DATE18) FP_DATE18
				, CONVERT(VARCHAR,FP_DATE19) FP_DATE19
				, CONVERT(VARCHAR,FP_DATE20) FP_DATE20
				, CONVERT(VARCHAR,FP_DATE21) FP_DATE21
				, CONVERT(VARCHAR,FP_DATE22) FP_DATE22
				, CONVERT(VARCHAR,FP_DATE23) FP_DATE23
				, CONVERT(VARCHAR,FP_DATE24) FP_DATE24
				, CONVERT(VARCHAR,FP_DATE25) FP_DATE25
				, CONVERT(VARCHAR,FP_DATE26) FP_DATE26
				, CONVERT(VARCHAR,FP_DATE27) FP_DATE27
				, CONVERT(VARCHAR,FP_DATE28) FP_DATE28
				, CONVERT(VARCHAR,FP_DATE29) FP_DATE29
				, CONVERT(VARCHAR,FP_DATE30) FP_DATE30
				, CONVERT(VARCHAR,FP_DATE31) FP_DATE31
			FROM TB_EQUIP_CODE_ADM AA
			LEFT OUTER JOIN
			TB_FP_TOTAL_COMPLETE A
			ON 1=1
			AND LEFT(AA.EQUIP_CD,10) = A.EQUIP_CD
			AND A.FP_DATE = '${fpDate}'
			AND A.GUBUN = '001'
			
			LEFT OUTER JOIN
			(
			select 
			ISNULL(AA.EQUIP_CD,BB.EQUIP_CD)  EQUIP_CD
			,ISNULL(AA.GOODS_CD,BB.GOODS_CD) GOODS_CD
			,ISNULL(AA.DATA_SUM,BB.DATA_SUM) DATA_SUM
			from 
			
				(		
				SELECT EQUIP_CD,GOODS_CD, SUM(PLAN_CNT) /
				  (SELECT TOP(1) YEILD_TOTAL FROM TB_MONTH_PRODUCTION_PLAN_YEILD WHERE FP_DATE = '${fpDate}') DATA_SUM FROM
				TB_MONTH_PRODUCTION_PLAN_DTL B
				WHERE B.FP_DATE >= '${chooseDateFrom}'
					AND '${chooseDateTo}' >= B.FP_DATE
					AND CPL_GUBUN = '001'
					AND COMPLETE_YN = '001'
				GROUP BY EQUIP_CD,GOODS_CD	
				) AA 
				FULL OUTER JOIN
				(
			
				SELECT EQUIP_CD,GOODS_CD, SUM(PLAN_CNT) /
				  (SELECT TOP(1) YEILD_TOTAL FROM TB_MONTH_PRODUCTION_PLAN_YEILD  WHERE FP_DATE = '${fpDate}' ) DATA_SUM FROM
				TB_MONTH_PRODUCTION_PLAN_DTL B
				WHERE B.FP_DATE >= '${chooseDateFrom}'
					AND  '${chooseDateTo}' >= B.FP_DATE
					AND CPL_GUBUN = '002'				
				GROUP BY EQUIP_CD,GOODS_CD	
				) BB			
			ON 1=1
			AND AA.EQUIP_CD = BB.EQUIP_CD
			AND AA.GOODS_CD = BB.GOODS_CD
			) B
			ON 1=1
			AND A.EQUIP_CD = B.EQUIP_CD 
			AND A.GOODS_CD = B.GOODS_CD
			
			UNION ALL
			
			SELECT DISTINCT 
				'004' GUBUN			
				,LEFT(AA.EQUIP_CD,10) EQUIP_CD
				,LEFT(AA.EQUIP_NM,5) EQUIP_NM
				,A.GOODS_CD
				,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM WHERE GOODS_CD = A.GOODS_CD) GOODS_NM
				,'Tac Time' AS  GUBUN_NM
				,CONVERT(INT,DATA_SUM) DATA_SUM
				, CONVERT(VARCHAR,FP_DATE1) FP_DATE1
				, CONVERT(VARCHAR,FP_DATE2) FP_DATE2
				, CONVERT(VARCHAR,FP_DATE3) FP_DATE3
				, CONVERT(VARCHAR,FP_DATE4) FP_DATE4
				, CONVERT(VARCHAR,FP_DATE5) FP_DATE5
				, CONVERT(VARCHAR,FP_DATE6) FP_DATE6
				, CONVERT(VARCHAR,FP_DATE7) FP_DATE7
				, CONVERT(VARCHAR,FP_DATE8) FP_DATE8
				, CONVERT(VARCHAR,FP_DATE9) FP_DATE9
				, CONVERT(VARCHAR,FP_DATE10) FP_DATE10
				, CONVERT(VARCHAR,FP_DATE11) FP_DATE11
				, CONVERT(VARCHAR,FP_DATE12) FP_DATE12
				, CONVERT(VARCHAR,FP_DATE13) FP_DATE13
				, CONVERT(VARCHAR,FP_DATE14) FP_DATE14
				, CONVERT(VARCHAR,FP_DATE15) FP_DATE15
				, CONVERT(VARCHAR,FP_DATE16) FP_DATE16
				, CONVERT(VARCHAR,FP_DATE17) FP_DATE17
				, CONVERT(VARCHAR,FP_DATE18) FP_DATE18
				, CONVERT(VARCHAR,FP_DATE19) FP_DATE19
				, CONVERT(VARCHAR,FP_DATE20) FP_DATE20
				, CONVERT(VARCHAR,FP_DATE21) FP_DATE21
				, CONVERT(VARCHAR,FP_DATE22) FP_DATE22
				, CONVERT(VARCHAR,FP_DATE23) FP_DATE23
				, CONVERT(VARCHAR,FP_DATE24) FP_DATE24
				, CONVERT(VARCHAR,FP_DATE25) FP_DATE25
				, CONVERT(VARCHAR,FP_DATE26) FP_DATE26
				, CONVERT(VARCHAR,FP_DATE27) FP_DATE27
				, CONVERT(VARCHAR,FP_DATE28) FP_DATE28
				, CONVERT(VARCHAR,FP_DATE29) FP_DATE29
				, CONVERT(VARCHAR,FP_DATE30) FP_DATE30
				, CONVERT(VARCHAR,FP_DATE31) FP_DATE31
			
			FROM TB_EQUIP_CODE_ADM AA
			
			LEFT OUTER JOIN
			TB_FP_TOTAL_COMPLETE A
			ON 1=1
			AND LEFT(AA.EQUIP_CD,10) = A.EQUIP_CD
			AND A.FP_DATE = '${fpDate}'
			AND A.GUBUN = '002'
			LEFT OUTER JOIN
			TB_MONTH_PRODUCTION_PLAN_DTL B
			ON 1=1
			AND A.EQUIP_CD = B.EQUIP_CD 
			AND A.GOODS_CD = B.GOODS_CD
			AND A.FP_DATE = LEFT(B.FP_DATE,6)
			
			UNION ALL
			
			SELECT DISTINCT 
				'005' GUBUN			
				,LEFT(AA.EQUIP_CD,10) EQUIP_CD
				,LEFT(AA.EQUIP_NM,5) EQUIP_NM
				,A.GOODS_CD
				,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM WHERE GOODS_CD = A.GOODS_CD) GOODS_NM
				,'Second' AS  GUBUN_NM
				,CONVERT(INT,DATA_SUM) DATA_SUM
				, CONVERT(VARCHAR,FP_DATE1) FP_DATE1
				, CONVERT(VARCHAR,FP_DATE2) FP_DATE2
				, CONVERT(VARCHAR,FP_DATE3) FP_DATE3
				, CONVERT(VARCHAR,FP_DATE4) FP_DATE4
				, CONVERT(VARCHAR,FP_DATE5) FP_DATE5
				, CONVERT(VARCHAR,FP_DATE6) FP_DATE6
				, CONVERT(VARCHAR,FP_DATE7) FP_DATE7
				, CONVERT(VARCHAR,FP_DATE8) FP_DATE8
				, CONVERT(VARCHAR,FP_DATE9) FP_DATE9
				, CONVERT(VARCHAR,FP_DATE10) FP_DATE10
				, CONVERT(VARCHAR,FP_DATE11) FP_DATE11
				, CONVERT(VARCHAR,FP_DATE12) FP_DATE12
				, CONVERT(VARCHAR,FP_DATE13) FP_DATE13
				, CONVERT(VARCHAR,FP_DATE14) FP_DATE14
				, CONVERT(VARCHAR,FP_DATE15) FP_DATE15
				, CONVERT(VARCHAR,FP_DATE16) FP_DATE16
				, CONVERT(VARCHAR,FP_DATE17) FP_DATE17
				, CONVERT(VARCHAR,FP_DATE18) FP_DATE18
				, CONVERT(VARCHAR,FP_DATE19) FP_DATE19
				, CONVERT(VARCHAR,FP_DATE20) FP_DATE20
				, CONVERT(VARCHAR,FP_DATE21) FP_DATE21
				, CONVERT(VARCHAR,FP_DATE22) FP_DATE22
				, CONVERT(VARCHAR,FP_DATE23) FP_DATE23
				, CONVERT(VARCHAR,FP_DATE24) FP_DATE24
				, CONVERT(VARCHAR,FP_DATE25) FP_DATE25
				, CONVERT(VARCHAR,FP_DATE26) FP_DATE26
				, CONVERT(VARCHAR,FP_DATE27) FP_DATE27
				, CONVERT(VARCHAR,FP_DATE28) FP_DATE28
				, CONVERT(VARCHAR,FP_DATE29) FP_DATE29
				, CONVERT(VARCHAR,FP_DATE30) FP_DATE30
				, CONVERT(VARCHAR,FP_DATE31) FP_DATE31
			
			FROM TB_EQUIP_CODE_ADM AA
			
			LEFT OUTER JOIN
			TB_FP_TOTAL_COMPLETE A
			ON 1=1
			AND LEFT(AA.EQUIP_CD,10) = A.EQUIP_CD
			AND A.FP_DATE = '${fpDate}'
			AND A.GUBUN = '003'
			
			LEFT OUTER JOIN
			TB_MONTH_PRODUCTION_PLAN_DTL B
			ON 1=1
			AND A.EQUIP_CD = B.EQUIP_CD 
			AND A.GOODS_CD = B.GOODS_CD
			AND A.FP_DATE = LEFT(B.FP_DATE,6)
			
			UNION ALL
			
			</if>
			
			<![CDATA[		
			SELECT DISTINCT 
				'006' GUBUN			
				,LEFT(AA.EQUIP_CD,10) EQUIP_CD
				,LEFT(AA.EQUIP_NM,5) EQUIP_NM
				,A.GOODS_CD
				,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM WHERE GOODS_CD = A.GOODS_CD) GOODS_NM
				,'계획수량(확정)' AS  GUBUN_NM
				,CONVERT(INT,B.DATA_SUM) DATA_SUM
				, CONVERT(VARCHAR,FP_DATE1) FP_DATE1
				, CONVERT(VARCHAR,FP_DATE2) FP_DATE2
				, CONVERT(VARCHAR,FP_DATE3) FP_DATE3
				, CONVERT(VARCHAR,FP_DATE4) FP_DATE4
				, CONVERT(VARCHAR,FP_DATE5) FP_DATE5
				, CONVERT(VARCHAR,FP_DATE6) FP_DATE6
				, CONVERT(VARCHAR,FP_DATE7) FP_DATE7
				, CONVERT(VARCHAR,FP_DATE8) FP_DATE8
				, CONVERT(VARCHAR,FP_DATE9) FP_DATE9
				, CONVERT(VARCHAR,FP_DATE10) FP_DATE10
				, CONVERT(VARCHAR,FP_DATE11) FP_DATE11
				, CONVERT(VARCHAR,FP_DATE12) FP_DATE12
				, CONVERT(VARCHAR,FP_DATE13) FP_DATE13
				, CONVERT(VARCHAR,FP_DATE14) FP_DATE14
				, CONVERT(VARCHAR,FP_DATE15) FP_DATE15
				, CONVERT(VARCHAR,FP_DATE16) FP_DATE16
				, CONVERT(VARCHAR,FP_DATE17) FP_DATE17
				, CONVERT(VARCHAR,FP_DATE18) FP_DATE18
				, CONVERT(VARCHAR,FP_DATE19) FP_DATE19
				, CONVERT(VARCHAR,FP_DATE20) FP_DATE20
				, CONVERT(VARCHAR,FP_DATE21) FP_DATE21
				, CONVERT(VARCHAR,FP_DATE22) FP_DATE22
				, CONVERT(VARCHAR,FP_DATE23) FP_DATE23
				, CONVERT(VARCHAR,FP_DATE24) FP_DATE24
				, CONVERT(VARCHAR,FP_DATE25) FP_DATE25
				, CONVERT(VARCHAR,FP_DATE26) FP_DATE26
				, CONVERT(VARCHAR,FP_DATE27) FP_DATE27
				, CONVERT(VARCHAR,FP_DATE28) FP_DATE28
				, CONVERT(VARCHAR,FP_DATE29) FP_DATE29
				, CONVERT(VARCHAR,FP_DATE30) FP_DATE30
				, CONVERT(VARCHAR,FP_DATE31) FP_DATE31
			
			FROM TB_EQUIP_CODE_ADM AA
			
			LEFT OUTER JOIN
			TB_FP_TOTAL_COMPLETE A
			ON 1=1
			AND LEFT(AA.EQUIP_CD,10) = A.EQUIP_CD
			AND A.FP_DATE = '${fpDate}'
			AND A.GUBUN = '004'
			AND A.CPL_GUBUN = '001'
			
			LEFT OUTER JOIN
			(SELECT EQUIP_CD,GOODS_CD, SUM(PLAN_CNT) DATA_SUM FROM
			TB_MONTH_PRODUCTION_PLAN_DTL B
			WHERE B.FP_DATE >= '${chooseDateFrom}'
				AND B.FP_DATE <= '${chooseDateTo}'
				AND CPL_GUBUN = '001'
				AND COMPLETE_YN = '001'
			GROUP BY EQUIP_CD,GOODS_CD	) B
			ON 1=1
			AND A.EQUIP_CD = B.EQUIP_CD 
			AND A.GOODS_CD = B.GOODS_CD
		
			
			UNION ALL
			
			SELECT DISTINCT 
				'007' GUBUN			
				,LEFT(AA.EQUIP_CD,10) EQUIP_CD
				,LEFT(AA.EQUIP_NM,5) EQUIP_NM
				,A.GOODS_CD
				,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM WHERE GOODS_CD = A.GOODS_CD) GOODS_NM
				,'계획수량(변경)' AS  GUBUN_NM
				,CONVERT(INT,B.DATA_SUM) DATA_SUM
				, CONVERT(VARCHAR,FP_DATE1) FP_DATE1
				, CONVERT(VARCHAR,FP_DATE2) FP_DATE2
				, CONVERT(VARCHAR,FP_DATE3) FP_DATE3
				, CONVERT(VARCHAR,FP_DATE4) FP_DATE4
				, CONVERT(VARCHAR,FP_DATE5) FP_DATE5
				, CONVERT(VARCHAR,FP_DATE6) FP_DATE6
				, CONVERT(VARCHAR,FP_DATE7) FP_DATE7
				, CONVERT(VARCHAR,FP_DATE8) FP_DATE8
				, CONVERT(VARCHAR,FP_DATE9) FP_DATE9
				, CONVERT(VARCHAR,FP_DATE10) FP_DATE10
				, CONVERT(VARCHAR,FP_DATE11) FP_DATE11
				, CONVERT(VARCHAR,FP_DATE12) FP_DATE12
				, CONVERT(VARCHAR,FP_DATE13) FP_DATE13
				, CONVERT(VARCHAR,FP_DATE14) FP_DATE14
				, CONVERT(VARCHAR,FP_DATE15) FP_DATE15
				, CONVERT(VARCHAR,FP_DATE16) FP_DATE16
				, CONVERT(VARCHAR,FP_DATE17) FP_DATE17
				, CONVERT(VARCHAR,FP_DATE18) FP_DATE18
				, CONVERT(VARCHAR,FP_DATE19) FP_DATE19
				, CONVERT(VARCHAR,FP_DATE20) FP_DATE20
				, CONVERT(VARCHAR,FP_DATE21) FP_DATE21
				, CONVERT(VARCHAR,FP_DATE22) FP_DATE22
				, CONVERT(VARCHAR,FP_DATE23) FP_DATE23
				, CONVERT(VARCHAR,FP_DATE24) FP_DATE24
				, CONVERT(VARCHAR,FP_DATE25) FP_DATE25
				, CONVERT(VARCHAR,FP_DATE26) FP_DATE26
				, CONVERT(VARCHAR,FP_DATE27) FP_DATE27
				, CONVERT(VARCHAR,FP_DATE28) FP_DATE28
				, CONVERT(VARCHAR,FP_DATE29) FP_DATE29
				, CONVERT(VARCHAR,FP_DATE30) FP_DATE30
				, CONVERT(VARCHAR,FP_DATE31) FP_DATE31
			
			FROM TB_EQUIP_CODE_ADM AA
			
			LEFT OUTER JOIN
			TB_FP_TOTAL_COMPLETE A
			ON 1=1
			AND LEFT(AA.EQUIP_CD,10) = A.EQUIP_CD
			AND A.FP_DATE = '${fpDate}'
			AND A.GUBUN = '005'
			AND A.CPL_GUBUN = '002'
			
			LEFT OUTER JOIN
			(SELECT EQUIP_CD,GOODS_CD, SUM(PLAN_CNT) DATA_SUM FROM
			TB_MONTH_PRODUCTION_PLAN_DTL B
			WHERE B.FP_DATE >= '${chooseDateFrom}'
				AND B.FP_DATE <= '${chooseDateTo}'
				AND CPL_GUBUN = '002'
			GROUP BY EQUIP_CD,GOODS_CD	) B
			ON 1=1
			AND A.EQUIP_CD = B.EQUIP_CD 
			AND A.GOODS_CD = B.GOODS_CD
			UNION ALL
			
			
			SELECT		
				'008' AS GUBUN,
				LEFT(XX.EQUIP_CD,10) EQUIP_CD,
				LEFT(XX.EQUIP_NM,5) EQUIP_NM,
				XX.GOODS_CD,			
				(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM WHERE GOODS_CD = XX.GOODS_CD) GOODS_NM,
				'생산수량(주간)' AS GUBUN_NM,
				(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,
				 CONVERT(VARCHAR,[01]) FP_DATE1
				, CONVERT(VARCHAR,[02]) FP_DATE2
				, CONVERT(VARCHAR,[03]) FP_DATE3
				, CONVERT(VARCHAR,[04]) FP_DATE4
				, CONVERT(VARCHAR,[05]) FP_DATE5
				, CONVERT(VARCHAR,[06]) FP_DATE6
				, CONVERT(VARCHAR,[07]) FP_DATE7
				, CONVERT(VARCHAR,[08]) FP_DATE8
				, CONVERT(VARCHAR,[09]) FP_DATE9
				, CONVERT(VARCHAR,[10]) FP_DATE10
				, CONVERT(VARCHAR,[11]) FP_DATE11
				, CONVERT(VARCHAR,[12]) FP_DATE12
				, CONVERT(VARCHAR,[13]) FP_DATE13
				, CONVERT(VARCHAR,[14]) FP_DATE14
				, CONVERT(VARCHAR,[15]) FP_DATE15
				, CONVERT(VARCHAR,[16]) FP_DATE16
				, CONVERT(VARCHAR,[17]) FP_DATE17
				, CONVERT(VARCHAR,[18]) FP_DATE18
				, CONVERT(VARCHAR,[19]) FP_DATE19
				, CONVERT(VARCHAR,[20]) FP_DATE20
				, CONVERT(VARCHAR,[21]) FP_DATE21
				, CONVERT(VARCHAR,[22]) FP_DATE22
				, CONVERT(VARCHAR,[23]) FP_DATE23
				, CONVERT(VARCHAR,[24]) FP_DATE24
				, CONVERT(VARCHAR,[25]) FP_DATE25
				, CONVERT(VARCHAR,[26]) FP_DATE26
				, CONVERT(VARCHAR,[27]) FP_DATE27
				, CONVERT(VARCHAR,[28]) FP_DATE28
				, CONVERT(VARCHAR,[29]) FP_DATE29
				, CONVERT(VARCHAR,[30]) FP_DATE30
				, CONVERT(VARCHAR,[31]) FP_DATE31
				FROM (SELECT DISTINCT
				GOODS_CD,
				 EQUIP_CD,
				(SELECT DISTINCT LEFT(EQUIP_NM,5) EQUIP_NM FROM TB_EQUIP_CODE_ADM WHERE LEFT(EQUIP_CD,10) = A.EQUIP_CD ) EQUIP_NM
				FROM TB_FP_TOTAL_COMPLETE A
				WHERE FP_DATE = '${fpDate}') XX
				LEFT OUTER JOIN 				
				(
					SELECT *
							FROM (
							]]>
								<!-- SELECT 							
								ISNULL(AA.EQUIP_CD,'') EQUIP_CD
								,ISNULL( AA.DAY_,BB.DAY_) DAY_
								,ISNULL(AA.GOODS_CD,BB.GOODS_CD) GOODS_CD
								,ISNULL(AA.GUBUN,BB.GUBUN) GUBUN
								,(ISNULL(AA.SUM_OUPUT_CNT,0) + ISNULL(BB.SUM_OUPUT_CNT,0)) AS SUM_OUPUT_CNT 							
							FROM (
									(
									SELECT 
									LEFT(A.EQUIP_CD,10) EQUIP_CD
									,LEFT(C.EQUIP_NM,5) EQUIP_NM
									,A.GOODS_CD
									, B.GUBUN,
									RIGHT(B.WORK_ORD_DATE, 2) DAY_, 
									(CASE WHEN LEFT(A.GOODS_CD,1) = 'A' THEN (ISNULL(SUM(B.OUTPUT_CNT+B.VISION_EDGE_CNT),0))
										WHEN LEFT(A.GOODS_CD,1) = 'N' THEN (ISNULL(SUM(B.OUTPUT_CNT+B.VISION_EDGE_CNT),0) )  END )
									AS SUM_OUPUT_CNT						
									FROM TB_WORK_ORDER A, TB_WORK_ORDER_OUTPUT_SUB B, TB_EQUIP_CODE_ADM C
									WHERE 1=1
									AND A.WORK_ORD_NO = B.WORK_ORD_NO
									AND A.EQUIP_CD = C.EQUIP_CD
									AND C.USE_YN_CD = '001'
									AND B.GUBUN = 'D'
										AND B.WORK_ORD_DATE >= '${chooseDateFrom}'
									AND B.WORK_ORD_DATE <= '${chooseDateTo}'				
									AND C.ETC1 = ''
										
									GROUP BY LEFT(A.EQUIP_CD,10),LEFT(C.EQUIP_NM,5), A.GOODS_CD, B.GUBUN, B.WORK_ORD_DATE) AS AA 
												
									FULL OUTER JOIN
			
									(
									SELECT
									LEFT(C.ETC1,5) ETC1
									, A.GOODS_CD
									, B.GUBUN
									, RIGHT(B.WORK_ORD_DATE, 2) DAY_,
					                (CASE WHEN LEFT(A.GOODS_CD,1) = 'A' THEN (ISNULL(SUM(B.OUTPUT_CNT+B.VISION_EDGE_CNT),0) )
					                WHEN LEFT(A.GOODS_CD,1) = 'N' THEN (ISNULL(SUM(B.OUTPUT_CNT+B.VISION_EDGE_CNT),0)) END )
					                AS SUM_OUPUT_CNT
					
					                FROM  TB_WORK_ORDER  A,
									TB_WORK_ORDER_OUTPUT_SUB B,
									( SELECT C.* 
									FROM TB_EQUIP_CODE_ADM C, TB_EQUIP_CODE_ADM F
									WHERE C.USE_YN_CD = '001'
									AND C.ETC1 != ''   
									AND C.ETC1 = F.EQUIP_NM
									) C																
									, TB_EQUIP_CODE_ADM F
					                WHERE 1=1
					                AND A.WORK_ORD_NO = B.WORK_ORD_NO                                					
									AND B.GUBUN = 'D'
					                AND B.WORK_ORD_DATE >= '${chooseDateFrom}'
									AND B.WORK_ORD_DATE <= '${chooseDateTo}'	
									AND A.EQUIP_CD = C.EQUIP_CD
									AND F.EQUIP_NM = C.ETC1     
					                    
					                       
					                GROUP BY LEFT(C.ETC1,5),A.GOODS_CD, B.GUBUN,  WORK_ORD_DATE   ) AS BB
			
									ON 1=1 AND AA.EQUIP_NM = BB.ETC1 AND AA.GOODS_CD = BB.GOODS_CD AND AA.DAY_ = BB.DAY_ AND AA.GUBUN = BB.GUBUN
											
								) 	 					 -->
							<![CDATA[
								SELECT 							
									ISNULL(AA.EQUIP_CD,'') EQUIP_CD
									,ISNULL( AA.DAY_,'') DAY_
									,ISNULL(AA.GOODS_CD,'') GOODS_CD
									,ISNULL(AA.GUBUN,'') GUBUN
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) + SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 	
                
								FROM
								(
									SELECT
										LEFT(A.EQUIP_CD,10) EQUIP_CD
										, A.WORK_ORD_NO                     
										, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
										, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
										, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
										, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT	
										, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
										, ISNULL(RE_SHIP_FAULTY_CNT, 0 ) AS RE_SHIP_FAULTY_CNT							
										, GUBUN
										, A.GOODS_CD
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT
										B.EQUIP_CD
										, A.WORK_ORD_NO                      
										, GUBUN                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
										, B.GOODS_CD
										, WORK_ORD_DATE
										FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,GUBUN,WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND '${chooseDateTo}' AND GUBUN ='D' GROUP BY WORK_ORD_NO,GUBUN,WORK_ORD_DATE) A, TB_WORK_ORDER B
										WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
										GROUP BY A.WORK_ORD_NO, B.EQUIP_CD, B.GOODS_CD,GUBUN,WORK_ORD_DATE
									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND '${chooseDateTo}') X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO

									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO
										, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND '${chooseDateTo}') X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO         
				  					
				  					LEFT OUTER JOIN
									(	SELECT 									
											 ISNULL(SUM(A.FAULTY_CNT),0) SHIP_FAULTY_CNT
											,GOODS_CD
											,X.WORK_ORD_NO
									
										FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
										WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
										AND E.WORK_ORD_NO = X.WORK_ORD_NO
										AND A.SHIP_INSP_IDX = B.IDX
										AND RE_INSP_STATUS != '002'
										GROUP BY X.WORK_ORD_NO,GOODS_CD
										) HH
				
									ON A.WORK_ORD_NO = HH.WORK_ORD_NO						
				
									LEFT OUTER JOIN
				
										(	SELECT 
											
												 ISNULL(SUM(A.FAULTY_CNT),0) RE_SHIP_FAULTY_CNT
												,GOODS_CD
												,X.WORK_ORD_NO
												FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
												WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
												AND E.WORK_ORD_NO = X.WORK_ORD_NO
												AND A.SHIP_INSP_IDX = B.IDX
												AND RE_INSP_STATUS = '002'
												GROUP BY X.WORK_ORD_NO,GOODS_CD
										) II
				
									ON A.WORK_ORD_NO = II.WORK_ORD_NO
									              
								) AA
								GROUP BY AA.EQUIP_CD, AA.GUBUN, AA.GOODS_CD,DAY_
						) AS AA
			
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA
				ON 1=1 AND LEFT(XX.EQUIP_CD,10) = LEFT(AA.EQUIP_CD,10)
				AND XX.GOODS_CD = AA.GOODS_CD
			
			
			UNION ALL
			
			 SELECT		
				'009' AS GUBUN,
				LEFT(XX.EQUIP_CD,10) EQUIP_CD,
				LEFT(XX.EQUIP_NM,5) EQUIP_NM,
				XX.GOODS_CD,			
				(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM WHERE GOODS_CD = XX.GOODS_CD) GOODS_NM,
				'생산수량(야간)' AS GUBUN_NM,
				(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,
				 CONVERT(VARCHAR,[01]) FP_DATE1
				, CONVERT(VARCHAR,[02]) FP_DATE2
				, CONVERT(VARCHAR,[03]) FP_DATE3
				, CONVERT(VARCHAR,[04]) FP_DATE4
				, CONVERT(VARCHAR,[05]) FP_DATE5
				, CONVERT(VARCHAR,[06]) FP_DATE6
				, CONVERT(VARCHAR,[07]) FP_DATE7
				, CONVERT(VARCHAR,[08]) FP_DATE8
				, CONVERT(VARCHAR,[09]) FP_DATE9
				, CONVERT(VARCHAR,[10]) FP_DATE10
				, CONVERT(VARCHAR,[11]) FP_DATE11
				, CONVERT(VARCHAR,[12]) FP_DATE12
				, CONVERT(VARCHAR,[13]) FP_DATE13
				, CONVERT(VARCHAR,[14]) FP_DATE14
				, CONVERT(VARCHAR,[15]) FP_DATE15
				, CONVERT(VARCHAR,[16]) FP_DATE16
				, CONVERT(VARCHAR,[17]) FP_DATE17
				, CONVERT(VARCHAR,[18]) FP_DATE18
				, CONVERT(VARCHAR,[19]) FP_DATE19
				, CONVERT(VARCHAR,[20]) FP_DATE20
				, CONVERT(VARCHAR,[21]) FP_DATE21
				, CONVERT(VARCHAR,[22]) FP_DATE22
				, CONVERT(VARCHAR,[23]) FP_DATE23
				, CONVERT(VARCHAR,[24]) FP_DATE24
				, CONVERT(VARCHAR,[25]) FP_DATE25
				, CONVERT(VARCHAR,[26]) FP_DATE26
				, CONVERT(VARCHAR,[27]) FP_DATE27
				, CONVERT(VARCHAR,[28]) FP_DATE28
				, CONVERT(VARCHAR,[29]) FP_DATE29
				, CONVERT(VARCHAR,[30]) FP_DATE30
				, CONVERT(VARCHAR,[31]) FP_DATE31
				FROM (SELECT DISTINCT
				GOODS_CD,
				 EQUIP_CD,
				(SELECT DISTINCT LEFT(EQUIP_NM,5) EQUIP_NM FROM TB_EQUIP_CODE_ADM WHERE LEFT(EQUIP_CD,10) = A.EQUIP_CD ) EQUIP_NM
				FROM TB_FP_TOTAL_COMPLETE A
				WHERE FP_DATE = '${fpDate}') XX
				LEFT OUTER JOIN 				
				(
					SELECT *
							FROM (
							]]>
								<!-- SELECT 							
								ISNULL(AA.EQUIP_CD,'') EQUIP_CD
								,ISNULL( AA.DAY_,BB.DAY_) DAY_
								,ISNULL(AA.GOODS_CD,BB.GOODS_CD) GOODS_CD
								,ISNULL(AA.GUBUN,BB.GUBUN) GUBUN
								,(ISNULL(AA.SUM_OUPUT_CNT,0) + ISNULL(BB.SUM_OUPUT_CNT,0)) AS SUM_OUPUT_CNT 							
							FROM (
			
										
											
									(
									SELECT 
									LEFT(A.EQUIP_CD,10) EQUIP_CD
									,LEFT(C.EQUIP_NM,5) EQUIP_NM
									,A.GOODS_CD
									, B.GUBUN,
									RIGHT(B.WORK_ORD_DATE, 2) DAY_, 
									(CASE WHEN LEFT(A.GOODS_CD,1) = 'A' THEN (ISNULL(SUM(B.OUTPUT_CNT+B.VISION_EDGE_CNT),0))
										WHEN LEFT(A.GOODS_CD,1) = 'N' THEN (ISNULL(SUM(B.OUTPUT_CNT+B.VISION_EDGE_CNT),0) )  END )
									AS SUM_OUPUT_CNT						
									FROM TB_WORK_ORDER A, TB_WORK_ORDER_OUTPUT_SUB B, TB_EQUIP_CODE_ADM C
									WHERE 1=1
									AND A.WORK_ORD_NO = B.WORK_ORD_NO
									AND A.EQUIP_CD = C.EQUIP_CD
									AND C.USE_YN_CD = '001'
									AND B.GUBUN = 'N'
										AND B.WORK_ORD_DATE >= '${chooseDateFrom}'
									AND B.WORK_ORD_DATE <= '${chooseDateTo}'				
									AND C.ETC1 = ''
										
									GROUP BY LEFT(A.EQUIP_CD,10),LEFT(C.EQUIP_NM,5), A.GOODS_CD, B.GUBUN, B.WORK_ORD_DATE) AS AA 
												
									FULL OUTER JOIN
			
									(
									SELECT
									LEFT(C.ETC1,5) ETC1
									, A.GOODS_CD
									, B.GUBUN
									, RIGHT(B.WORK_ORD_DATE, 2) DAY_,
					                (CASE WHEN LEFT(A.GOODS_CD,1) = 'A' THEN (ISNULL(SUM(B.OUTPUT_CNT+B.VISION_EDGE_CNT),0) )
					                WHEN LEFT(A.GOODS_CD,1) = 'N' THEN (ISNULL(SUM(B.OUTPUT_CNT+B.VISION_EDGE_CNT),0)) END )
					                AS SUM_OUPUT_CNT
					
					                FROM  TB_WORK_ORDER  A,
									TB_WORK_ORDER_OUTPUT_SUB B,
									( SELECT C.* 
									FROM TB_EQUIP_CODE_ADM C, TB_EQUIP_CODE_ADM F
									WHERE C.USE_YN_CD = '001'
									AND C.ETC1 != ''   
									AND C.ETC1 = F.EQUIP_NM
									) C																
									, TB_EQUIP_CODE_ADM F
					                WHERE 1=1
					                AND A.WORK_ORD_NO = B.WORK_ORD_NO                                					
									AND B.GUBUN = 'N'
					                AND B.WORK_ORD_DATE >= '${chooseDateFrom}'
									AND B.WORK_ORD_DATE <= '${chooseDateTo}'	
									AND A.EQUIP_CD = C.EQUIP_CD
									AND F.EQUIP_NM = C.ETC1     
					                    
					                       
					                GROUP BY LEFT(C.ETC1,5),A.GOODS_CD, B.GUBUN,  WORK_ORD_DATE   ) AS BB
			
									ON 1=1 AND AA.EQUIP_NM = BB.ETC1 AND AA.GOODS_CD = BB.GOODS_CD AND AA.DAY_ = BB.DAY_ AND AA.GUBUN = BB.GUBUN
											
								) 	 					 -->
							<![CDATA[
								SELECT 							
									ISNULL(AA.EQUIP_CD,'') EQUIP_CD
									,ISNULL( AA.DAY_,'') DAY_
									,ISNULL(AA.GOODS_CD,'') GOODS_CD
									,ISNULL(AA.GUBUN,'') GUBUN
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) + SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT	
                
								FROM
								(
									SELECT
										LEFT(A.EQUIP_CD,10) EQUIP_CD
										, A.WORK_ORD_NO                     
										, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
										, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
										, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
										, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT
										, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
										, ISNULL(RE_SHIP_FAULTY_CNT, 0 ) AS RE_SHIP_FAULTY_CNT								
										, GUBUN
										, A.GOODS_CD
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT
										B.EQUIP_CD
										, A.WORK_ORD_NO                      
										, GUBUN                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
										, B.GOODS_CD
										, WORK_ORD_DATE
										FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,GUBUN,WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND '${chooseDateTo}' AND GUBUN ='N' GROUP BY WORK_ORD_NO,GUBUN,WORK_ORD_DATE) A, TB_WORK_ORDER B
										WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
										GROUP BY A.WORK_ORD_NO, B.EQUIP_CD, B.GOODS_CD,GUBUN,WORK_ORD_DATE
									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND '${chooseDateTo}') X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO

									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO
										, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND '${chooseDateTo}') X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO         
				  					
				  					LEFT OUTER JOIN
									(	SELECT 									
											 ISNULL(SUM(A.FAULTY_CNT),0) SHIP_FAULTY_CNT
											,GOODS_CD
											,X.WORK_ORD_NO
									
										FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
										WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
										AND E.WORK_ORD_NO = X.WORK_ORD_NO
										AND A.SHIP_INSP_IDX = B.IDX
										AND RE_INSP_STATUS != '002'
										GROUP BY X.WORK_ORD_NO,GOODS_CD
										) HH
				
									ON A.WORK_ORD_NO = HH.WORK_ORD_NO						
				
									LEFT OUTER JOIN
				
									(	SELECT 
										
											 ISNULL(SUM(A.FAULTY_CNT),0) RE_SHIP_FAULTY_CNT
											,GOODS_CD
											,X.WORK_ORD_NO
											FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
											WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
											AND E.WORK_ORD_NO = X.WORK_ORD_NO
											AND A.SHIP_INSP_IDX = B.IDX
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO,GOODS_CD
									) II
				
									ON A.WORK_ORD_NO = II.WORK_ORD_NO
									              
								) AA
								GROUP BY AA.EQUIP_CD, AA.GUBUN, AA.GOODS_CD,DAY_							
						) AS AA
			
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA
				ON 1=1 AND LEFT(XX.EQUIP_CD,10) = LEFT(AA.EQUIP_CD,10)
				AND XX.GOODS_CD = AA.GOODS_CD
			UNION ALL
			
			
			SELECT		
				'010' AS GUBUN,
				LEFT(XX.EQUIP_CD,10) EQUIP_CD,
				LEFT(XX.EQUIP_NM,5) EQUIP_NM,
				XX.GOODS_CD,			
				(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM WHERE GOODS_CD = XX.GOODS_CD) GOODS_NM,
				'당일합계(생산)' AS GUBUN_NM,
				(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,
				 CONVERT(VARCHAR,[01]) FP_DATE1
				, CONVERT(VARCHAR,[02]) FP_DATE2
				, CONVERT(VARCHAR,[03]) FP_DATE3
				, CONVERT(VARCHAR,[04]) FP_DATE4
				, CONVERT(VARCHAR,[05]) FP_DATE5
				, CONVERT(VARCHAR,[06]) FP_DATE6
				, CONVERT(VARCHAR,[07]) FP_DATE7
				, CONVERT(VARCHAR,[08]) FP_DATE8
				, CONVERT(VARCHAR,[09]) FP_DATE9
				, CONVERT(VARCHAR,[10]) FP_DATE10
				, CONVERT(VARCHAR,[11]) FP_DATE11
				, CONVERT(VARCHAR,[12]) FP_DATE12
				, CONVERT(VARCHAR,[13]) FP_DATE13
				, CONVERT(VARCHAR,[14]) FP_DATE14
				, CONVERT(VARCHAR,[15]) FP_DATE15
				, CONVERT(VARCHAR,[16]) FP_DATE16
				, CONVERT(VARCHAR,[17]) FP_DATE17
				, CONVERT(VARCHAR,[18]) FP_DATE18
				, CONVERT(VARCHAR,[19]) FP_DATE19
				, CONVERT(VARCHAR,[20]) FP_DATE20
				, CONVERT(VARCHAR,[21]) FP_DATE21
				, CONVERT(VARCHAR,[22]) FP_DATE22
				, CONVERT(VARCHAR,[23]) FP_DATE23
				, CONVERT(VARCHAR,[24]) FP_DATE24
				, CONVERT(VARCHAR,[25]) FP_DATE25
				, CONVERT(VARCHAR,[26]) FP_DATE26
				, CONVERT(VARCHAR,[27]) FP_DATE27
				, CONVERT(VARCHAR,[28]) FP_DATE28
				, CONVERT(VARCHAR,[29]) FP_DATE29
				, CONVERT(VARCHAR,[30]) FP_DATE30
				, CONVERT(VARCHAR,[31]) FP_DATE31
				FROM (SELECT DISTINCT
				GOODS_CD,
				 EQUIP_CD,
				(SELECT DISTINCT LEFT(EQUIP_NM,5) EQUIP_NM FROM TB_EQUIP_CODE_ADM WHERE LEFT(EQUIP_CD,10) = A.EQUIP_CD ) EQUIP_NM
				FROM TB_FP_TOTAL_COMPLETE A
				WHERE FP_DATE = '${fpDate}') XX
				LEFT OUTER JOIN 				
				(
					SELECT *
							FROM (
							
								SELECT 							
									ISNULL(AA.EQUIP_CD,'') EQUIP_CD
									,ISNULL( AA.DAY_,'') DAY_
									,ISNULL(AA.GOODS_CD,'') GOODS_CD								
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) + SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT
                
								FROM
								(
									SELECT
										LEFT(A.EQUIP_CD,10) EQUIP_CD
										, A.WORK_ORD_NO                     
										, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
										, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
										, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
										, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT								
										, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
										, ISNULL(RE_SHIP_FAULTY_CNT, 0 ) AS RE_SHIP_FAULTY_CNT
										, A.GOODS_CD
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT
										B.EQUIP_CD
										, A.WORK_ORD_NO                      
										                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
										, B.GOODS_CD
										, WORK_ORD_DATE
										FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND '${chooseDateTo}' GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A, TB_WORK_ORDER B
										WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
										GROUP BY A.WORK_ORD_NO, B.EQUIP_CD, B.GOODS_CD,WORK_ORD_DATE
									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND '${chooseDateTo}') X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO

									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO
										, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND '${chooseDateTo}') X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO         
				  					
				  					LEFT OUTER JOIN
									(	SELECT 									
											 ISNULL(SUM(A.FAULTY_CNT),0) SHIP_FAULTY_CNT
											,GOODS_CD
											,X.WORK_ORD_NO
									
										FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
										WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
										AND E.WORK_ORD_NO = X.WORK_ORD_NO
										AND A.SHIP_INSP_IDX = B.IDX
										AND RE_INSP_STATUS != '002'
										GROUP BY X.WORK_ORD_NO,GOODS_CD
										) HH
					
									ON A.WORK_ORD_NO = HH.WORK_ORD_NO						
					
									LEFT OUTER JOIN
					
									(	SELECT 
										
											 ISNULL(SUM(A.FAULTY_CNT),0) RE_SHIP_FAULTY_CNT
											,GOODS_CD
											,X.WORK_ORD_NO
											FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
											WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
											AND E.WORK_ORD_NO = X.WORK_ORD_NO
											AND A.SHIP_INSP_IDX = B.IDX
											AND RE_INSP_STATUS = '002'
											GROUP BY X.WORK_ORD_NO,GOODS_CD
									) II
					
									ON A.WORK_ORD_NO = II.WORK_ORD_NO
									              
								) AA
								GROUP BY AA.EQUIP_CD, AA.GOODS_CD,DAY_							
						) AS AA
			
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA
				ON 1=1 AND LEFT(XX.EQUIP_CD,10) = LEFT(AA.EQUIP_CD,10)
				AND XX.GOODS_CD = AA.GOODS_CD
			UNION ALL
			
			SELECT '011' GUBUN
				,BB.EQUIP_CD
				,BB.EQUIP_NM
				,BB.GOODS_CD	
				,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM WHERE GOODS_CD = BB.GOODS_CD) GOODS_NM
				,'가동률' AS GUBUN_NM
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(COUNT_SUM / DATA_SUM * 100))) AS  DATA_SUM
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE1  / AA.FP_DATE1  * 100)))   AS FP_DATE1 
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE2  / AA.FP_DATE2  * 100)))   AS FP_DATE2 
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE3  / AA.FP_DATE3  * 100)))   AS FP_DATE3 
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE4  / AA.FP_DATE4  * 100)))   AS FP_DATE4 
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE5  / AA.FP_DATE5  * 100)))   AS FP_DATE5 
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE6  / AA.FP_DATE6  * 100)))   AS FP_DATE6 
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE7  / AA.FP_DATE7  * 100)))   AS FP_DATE7 
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE8  / AA.FP_DATE8  * 100)))   AS FP_DATE8 
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE9  / AA.FP_DATE9  * 100)))   AS FP_DATE9 
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE10 / AA.FP_DATE10 * 100)))   AS FP_DATE10
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE11 / AA.FP_DATE11 * 100)))   AS FP_DATE11
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE12 / AA.FP_DATE12 * 100)))   AS FP_DATE12
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE13 / AA.FP_DATE13 * 100)))   AS FP_DATE13
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE14 / AA.FP_DATE14 * 100)))   AS FP_DATE14
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE15 / AA.FP_DATE15 * 100)))   AS FP_DATE15
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE16 / AA.FP_DATE16 * 100)))   AS FP_DATE16
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE17 / AA.FP_DATE17 * 100)))   AS FP_DATE17
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE18 / AA.FP_DATE18 * 100)))   AS FP_DATE18
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE19 / AA.FP_DATE19 * 100)))   AS FP_DATE19
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE20 / AA.FP_DATE20 * 100)))   AS FP_DATE20
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE21 / AA.FP_DATE21 * 100)))   AS FP_DATE21
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE22 / AA.FP_DATE22 * 100)))   AS FP_DATE22
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE23 / AA.FP_DATE23 * 100)))   AS FP_DATE23
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE24 / AA.FP_DATE24 * 100)))   AS FP_DATE24
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE25 / AA.FP_DATE25 * 100)))   AS FP_DATE25
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE26 / AA.FP_DATE26 * 100)))   AS FP_DATE26
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE27 / AA.FP_DATE27 * 100)))   AS FP_DATE27
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE28 / AA.FP_DATE28 * 100)))   AS FP_DATE28
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE29 / AA.FP_DATE29 * 100)))   AS FP_DATE29
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE30 / AA.FP_DATE30 * 100)))   AS FP_DATE30
				,CONVERT(VARCHAR,CONVERT(NUMERIC(18,2),(BB.FP_DATE31 / AA.FP_DATE31 * 100)))   AS FP_DATE31
			FROM 
			(
				SELECT DISTINCT 
					'001' GUBUN			
					,LEFT(AA.EQUIP_CD,10) EQUIP_CD
					,LEFT(AA.EQUIP_NM,5) EQUIP_NM
					,A.GOODS_CD
					,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM WHERE GOODS_CD = A.GOODS_CD) GOODS_NM
					,'Dual Capa' AS  GUBUN_NM
					,B.DATA_SUM
					,FP_DATE1
					,FP_DATE2
					,FP_DATE3
					,FP_DATE4
					,FP_DATE5
					,FP_DATE6
					,FP_DATE7
					,FP_DATE8
					,FP_DATE9
					,FP_DATE10
					,FP_DATE11
					,FP_DATE12
					,FP_DATE13
					,FP_DATE14
					,FP_DATE15
					,FP_DATE16
					,FP_DATE17
					,FP_DATE18
					,FP_DATE19
					,FP_DATE20
					,FP_DATE21
					,FP_DATE22
					,FP_DATE23
					,FP_DATE24
					,FP_DATE25
					,FP_DATE26
					,FP_DATE27
					,FP_DATE28
					,FP_DATE29
					,FP_DATE30
					,FP_DATE31
			
				FROM TB_EQUIP_CODE_ADM AA
			
				LEFT OUTER JOIN
				TB_FP_TOTAL_COMPLETE A
				ON 1=1
				AND LEFT(AA.EQUIP_CD,10) = A.EQUIP_CD
				AND A.FP_DATE = '${fpDate}'
				AND A.GUBUN = '001'
			
				LEFT OUTER JOIN
				(SELECT EQUIP_CD,GOODS_CD, SUM(PLAN_CNT) /
			(SELECT TOP(1) YEILD_TOTAL FROM TB_MONTH_PRODUCTION_PLAN_YEILD  WHERE FP_DATE = '${fpDate}' ) DATA_SUM FROM
			TB_MONTH_PRODUCTION_PLAN_DTL B
			WHERE B.FP_DATE >= '${chooseDateFrom}'
				AND B.FP_DATE <= '${chooseDateTo}'
				AND CPL_GUBUN = '001'
				AND COMPLETE_YN = '001'
			GROUP BY EQUIP_CD,GOODS_CD	) B
				ON 1=1
				AND A.EQUIP_CD = B.EQUIP_CD 
				AND A.GOODS_CD = B.GOODS_CD
				
				) AA,
			(	SELECT		
				'010' AS GUBUN,
				LEFT(XX.EQUIP_CD,10) EQUIP_CD,
				LEFT(XX.EQUIP_NM,5) EQUIP_NM,
				XX.GOODS_CD,			
				(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM WHERE GOODS_CD = XX.GOODS_CD) GOODS_NM,
				'당일합계(생산)' AS GUBUN_NM,
				(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,
				 CONVERT(VARCHAR,[01]) FP_DATE1
				, CONVERT(VARCHAR,[02]) FP_DATE2
				, CONVERT(VARCHAR,[03]) FP_DATE3
				, CONVERT(VARCHAR,[04]) FP_DATE4
				, CONVERT(VARCHAR,[05]) FP_DATE5
				, CONVERT(VARCHAR,[06]) FP_DATE6
				, CONVERT(VARCHAR,[07]) FP_DATE7
				, CONVERT(VARCHAR,[08]) FP_DATE8
				, CONVERT(VARCHAR,[09]) FP_DATE9
				, CONVERT(VARCHAR,[10]) FP_DATE10
				, CONVERT(VARCHAR,[11]) FP_DATE11
				, CONVERT(VARCHAR,[12]) FP_DATE12
				, CONVERT(VARCHAR,[13]) FP_DATE13
				, CONVERT(VARCHAR,[14]) FP_DATE14
				, CONVERT(VARCHAR,[15]) FP_DATE15
				, CONVERT(VARCHAR,[16]) FP_DATE16
				, CONVERT(VARCHAR,[17]) FP_DATE17
				, CONVERT(VARCHAR,[18]) FP_DATE18
				, CONVERT(VARCHAR,[19]) FP_DATE19
				, CONVERT(VARCHAR,[20]) FP_DATE20
				, CONVERT(VARCHAR,[21]) FP_DATE21
				, CONVERT(VARCHAR,[22]) FP_DATE22
				, CONVERT(VARCHAR,[23]) FP_DATE23
				, CONVERT(VARCHAR,[24]) FP_DATE24
				, CONVERT(VARCHAR,[25]) FP_DATE25
				, CONVERT(VARCHAR,[26]) FP_DATE26
				, CONVERT(VARCHAR,[27]) FP_DATE27
				, CONVERT(VARCHAR,[28]) FP_DATE28
				, CONVERT(VARCHAR,[29]) FP_DATE29
				, CONVERT(VARCHAR,[30]) FP_DATE30
				, CONVERT(VARCHAR,[31]) FP_DATE31
				FROM (SELECT DISTINCT
				GOODS_CD,
				 EQUIP_CD,
				(SELECT DISTINCT LEFT(EQUIP_NM,5) EQUIP_NM FROM TB_EQUIP_CODE_ADM WHERE LEFT(EQUIP_CD,10) = A.EQUIP_CD ) EQUIP_NM
				FROM TB_FP_TOTAL_COMPLETE A
				WHERE FP_DATE = '${fpDate}') XX
				LEFT OUTER JOIN 				
				(
					SELECT *
							FROM (
							
								SELECT 							
									ISNULL(AA.EQUIP_CD,'') EQUIP_CD
									,ISNULL( AA.DAY_,'') DAY_
									,ISNULL(AA.GOODS_CD,'') GOODS_CD								
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) + SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 	
                
								FROM
								(
									SELECT
										LEFT(A.EQUIP_CD,10) EQUIP_CD
										, A.WORK_ORD_NO                     
										, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
										, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
										, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
										, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT								
										, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
										, ISNULL(RE_SHIP_FAULTY_CNT, 0 ) AS RE_SHIP_FAULTY_CNT
										, A.GOODS_CD
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT
										B.EQUIP_CD
										, A.WORK_ORD_NO                      
										                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
										, B.GOODS_CD
										, WORK_ORD_DATE
										FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND '${chooseDateTo}' GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A, TB_WORK_ORDER B
										WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
										GROUP BY A.WORK_ORD_NO, B.EQUIP_CD, B.GOODS_CD,WORK_ORD_DATE
									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND '${chooseDateTo}') X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO

									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO
										, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND '${chooseDateTo}') X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO  
									
									LEFT OUTER JOIN
									(	SELECT 									
											 ISNULL(SUM(A.FAULTY_CNT),0) SHIP_FAULTY_CNT
											,GOODS_CD
											,X.WORK_ORD_NO
									
										FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
										WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
										AND E.WORK_ORD_NO = X.WORK_ORD_NO
										AND A.SHIP_INSP_IDX = B.IDX
										AND RE_INSP_STATUS != '002'
										GROUP BY X.WORK_ORD_NO,GOODS_CD
										) HH
				
									ON A.WORK_ORD_NO = HH.WORK_ORD_NO						
				
									LEFT OUTER JOIN
				
										(	SELECT 
											
												 ISNULL(SUM(A.FAULTY_CNT),0) RE_SHIP_FAULTY_CNT
												,GOODS_CD
												,X.WORK_ORD_NO
												FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
												WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
												AND E.WORK_ORD_NO = X.WORK_ORD_NO
												AND A.SHIP_INSP_IDX = B.IDX
												AND RE_INSP_STATUS = '002'
												GROUP BY X.WORK_ORD_NO,GOODS_CD
										) II
				
									ON A.WORK_ORD_NO = II.WORK_ORD_NO       
				  
									              
								) AA
								GROUP BY AA.EQUIP_CD, AA.GOODS_CD,DAY_							
						) AS AA
			
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA
				ON 1=1 AND LEFT(XX.EQUIP_CD,10) = LEFT(AA.EQUIP_CD,10)
				AND XX.GOODS_CD = AA.GOODS_CD
			
			
			) BB
			
			WHERE 1=1
			AND AA.EQUIP_CD = BB.EQUIP_CD
			AND AA.GOODS_CD = BB.GOODS_CD
			
			
			UNION ALL
			
			SELECT		
				'012' AS GUBUN,
				LEFT(XX.EQUIP_CD,10) EQUIP_CD,
				LEFT(XX.EQUIP_NM,5) EQUIP_NM,
				XX.GOODS_CD,			
				(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM WHERE GOODS_CD = XX.GOODS_CD) GOODS_NM,
				'검사수량(주간)' AS GUBUN_NM,
				(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM
				, CONVERT(VARCHAR,[01]) FP_DATE1
				, CONVERT(VARCHAR,[02]) FP_DATE2
				, CONVERT(VARCHAR,[03]) FP_DATE3
				, CONVERT(VARCHAR,[04]) FP_DATE4
				, CONVERT(VARCHAR,[05]) FP_DATE5
				, CONVERT(VARCHAR,[06]) FP_DATE6
				, CONVERT(VARCHAR,[07]) FP_DATE7
				, CONVERT(VARCHAR,[08]) FP_DATE8
				, CONVERT(VARCHAR,[09]) FP_DATE9
				, CONVERT(VARCHAR,[10]) FP_DATE10
				, CONVERT(VARCHAR,[11]) FP_DATE11
				, CONVERT(VARCHAR,[12]) FP_DATE12
				, CONVERT(VARCHAR,[13]) FP_DATE13
				, CONVERT(VARCHAR,[14]) FP_DATE14
				, CONVERT(VARCHAR,[15]) FP_DATE15
				, CONVERT(VARCHAR,[16]) FP_DATE16
				, CONVERT(VARCHAR,[17]) FP_DATE17
				, CONVERT(VARCHAR,[18]) FP_DATE18
				, CONVERT(VARCHAR,[19]) FP_DATE19
				, CONVERT(VARCHAR,[20]) FP_DATE20
				, CONVERT(VARCHAR,[21]) FP_DATE21
				, CONVERT(VARCHAR,[22]) FP_DATE22
				, CONVERT(VARCHAR,[23]) FP_DATE23
				, CONVERT(VARCHAR,[24]) FP_DATE24
				, CONVERT(VARCHAR,[25]) FP_DATE25
				, CONVERT(VARCHAR,[26]) FP_DATE26
				, CONVERT(VARCHAR,[27]) FP_DATE27
				, CONVERT(VARCHAR,[28]) FP_DATE28
				, CONVERT(VARCHAR,[29]) FP_DATE29
				, CONVERT(VARCHAR,[30]) FP_DATE30
				, CONVERT(VARCHAR,[31]) FP_DATE31
				FROM (SELECT DISTINCT
				GOODS_CD,
					EQUIP_CD,
				(SELECT DISTINCT LEFT(EQUIP_NM,5) EQUIP_NM FROM TB_EQUIP_CODE_ADM WHERE LEFT(EQUIP_CD,10) = A.EQUIP_CD ) EQUIP_NM
				FROM TB_FP_TOTAL_COMPLETE A
				WHERE FP_DATE = '${fpDate}') XX
				LEFT OUTER JOIN 				
				(
					SELECT *
							FROM (
							]]>
								<!-- SELECT 							
								ISNULL(AA.EQUIP_CD,'') EQUIP_CD
								,ISNULL( AA.DAY_,'') DAY_
								,ISNULL(AA.GOODS_CD,'') GOODS_CD
								,ISNULL(AA.GUBUN,'') GUBUN
								,(ISNULL(AA.SUM_OUPUT_CNT,0)) AS SUM_OUPUT_CNT 							
							FROM 
										
									(
									SELECT GOODS_CD,
									SUM(PRODUCT_QTY) SUM_OUPUT_CNT ,
									RIGHT(B.INSP_DATE, 2) DAY_,
									LEFT(A.EQUIP_CD,10) EQUIP_CD,
									B.DAY_NIGHT_CD GUBUN
									FROM TB_PRODUCTION_PERF_TRAY A
									,(SELECT DISTINCT 
									TRAY_NO,INSP_DATE,DAY_NIGHT_CD 
									FROM 
									TB_SHIP_INSPECT_ADM 
									WHERE 1=1			
									AND RE_INSP_STATUS = '001'
									AND INSP_DATE >= '${chooseDateFrom}'
									AND INSP_DATE <= '${chooseDateTo}'
									AND DAY_NIGHT_CD = 'D'
									) B
									WHERE A.LABEL_LOT_NO = B.TRAY_NO
													
									GROUP BY GOODS_CD,INSP_DATE,LEFT(A.EQUIP_CD,10),B.DAY_NIGHT_CD) AS AA 									
											 -->
								<![CDATA[
								SELECT 							
									ISNULL(AA.EQUIP_CD,'') EQUIP_CD
									,ISNULL( AA.DAY_,'') DAY_
									,ISNULL(AA.GOODS_CD,'') GOODS_CD
									,ISNULL(AA.GUBUN,'') GUBUN
									, SUM(APPEAR_OUTPUT_CNT) AS SUM_OUPUT_CNT 	
                
								FROM
								(
									SELECT
										LEFT(A.EQUIP_CD,10) EQUIP_CD
										, A.WORK_ORD_NO  
										, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
										, GUBUN
										, A.GOODS_CD
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT
										B.EQUIP_CD
										, A.WORK_ORD_NO                      
										, GUBUN                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
										, B.GOODS_CD
										, WORK_ORD_DATE
										FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,GUBUN,WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND '${chooseDateTo}' AND GUBUN ='D' GROUP BY WORK_ORD_NO,GUBUN,WORK_ORD_DATE) A, TB_WORK_ORDER B
										WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
										GROUP BY A.WORK_ORD_NO, B.EQUIP_CD, B.GOODS_CD,GUBUN,WORK_ORD_DATE
									) A 									
									              
								) AA
								GROUP BY AA.EQUIP_CD, AA.GUBUN, AA.GOODS_CD,DAY_
															
							) AS AA
			
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA
				ON 1=1 AND LEFT(XX.EQUIP_CD,10) = LEFT(AA.EQUIP_CD,10)
				AND XX.GOODS_CD = AA.GOODS_CD
			
			
			UNION ALL
			
				SELECT		
					'013' AS GUBUN,
					LEFT(XX.EQUIP_CD,10) EQUIP_CD,
					LEFT(XX.EQUIP_NM,5) EQUIP_NM,
					XX.GOODS_CD,			
					(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM WHERE GOODS_CD = XX.GOODS_CD) GOODS_NM,
					'검사수량(야간)' AS GUBUN_NM,
					(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
					ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
					ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
					ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
					ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
					ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
					ISNULL(AA.[31],0)) COUNT_SUM
					, CONVERT(VARCHAR,[01]) FP_DATE1
					, CONVERT(VARCHAR,[02]) FP_DATE2
					, CONVERT(VARCHAR,[03]) FP_DATE3
					, CONVERT(VARCHAR,[04]) FP_DATE4
					, CONVERT(VARCHAR,[05]) FP_DATE5
					, CONVERT(VARCHAR,[06]) FP_DATE6
					, CONVERT(VARCHAR,[07]) FP_DATE7
					, CONVERT(VARCHAR,[08]) FP_DATE8
					, CONVERT(VARCHAR,[09]) FP_DATE9
					, CONVERT(VARCHAR,[10]) FP_DATE10
					, CONVERT(VARCHAR,[11]) FP_DATE11
					, CONVERT(VARCHAR,[12]) FP_DATE12
					, CONVERT(VARCHAR,[13]) FP_DATE13
					, CONVERT(VARCHAR,[14]) FP_DATE14
					, CONVERT(VARCHAR,[15]) FP_DATE15
					, CONVERT(VARCHAR,[16]) FP_DATE16
					, CONVERT(VARCHAR,[17]) FP_DATE17
					, CONVERT(VARCHAR,[18]) FP_DATE18
					, CONVERT(VARCHAR,[19]) FP_DATE19
					, CONVERT(VARCHAR,[20]) FP_DATE20
					, CONVERT(VARCHAR,[21]) FP_DATE21
					, CONVERT(VARCHAR,[22]) FP_DATE22
					, CONVERT(VARCHAR,[23]) FP_DATE23
					, CONVERT(VARCHAR,[24]) FP_DATE24
					, CONVERT(VARCHAR,[25]) FP_DATE25
					, CONVERT(VARCHAR,[26]) FP_DATE26
					, CONVERT(VARCHAR,[27]) FP_DATE27
					, CONVERT(VARCHAR,[28]) FP_DATE28
					, CONVERT(VARCHAR,[29]) FP_DATE29
					, CONVERT(VARCHAR,[30]) FP_DATE30
					, CONVERT(VARCHAR,[31]) FP_DATE31
				FROM 
				(SELECT DISTINCT
				GOODS_CD,
					EQUIP_CD,
				(SELECT DISTINCT LEFT(EQUIP_NM,5) EQUIP_NM FROM TB_EQUIP_CODE_ADM WHERE LEFT(EQUIP_CD,10) = A.EQUIP_CD ) EQUIP_NM
				FROM TB_FP_TOTAL_COMPLETE A
				WHERE FP_DATE = '${fpDate}') XX
				LEFT OUTER JOIN 				
				(
					SELECT *
						FROM (
						]]>
							<!-- SELECT 							
							ISNULL(AA.EQUIP_CD,'') EQUIP_CD
							,ISNULL( AA.DAY_,'') DAY_
							,ISNULL(AA.GOODS_CD,'') GOODS_CD
							,ISNULL(AA.GUBUN,'') GUBUN
							,(ISNULL(AA.SUM_OUPUT_CNT,0)) AS SUM_OUPUT_CNT 							
						FROM 		
							(
							SELECT GOODS_CD,
							SUM(PRODUCT_QTY) SUM_OUPUT_CNT ,
							RIGHT(B.INSP_DATE, 2) DAY_,
							LEFT(A.EQUIP_CD,10) EQUIP_CD,
							B.DAY_NIGHT_CD GUBUN
							FROM TB_PRODUCTION_PERF_TRAY A
							,(SELECT DISTINCT 
							TRAY_NO,INSP_DATE,DAY_NIGHT_CD 
							FROM 
							TB_SHIP_INSPECT_ADM 
							WHERE 1=1			
							AND RE_INSP_STATUS = '001'
							AND INSP_DATE >= '${chooseDateFrom}'
							AND INSP_DATE <= '${chooseDateTo}'
							AND DAY_NIGHT_CD = 'N'
							) B
							WHERE A.LABEL_LOT_NO = B.TRAY_NO
											
							GROUP BY GOODS_CD,INSP_DATE,LEFT(A.EQUIP_CD,10),B.DAY_NIGHT_CD) AS AA  -->
						<![CDATA[
							SELECT 							
								ISNULL(AA.EQUIP_CD,'') EQUIP_CD
								,ISNULL( AA.DAY_,'') DAY_
								,ISNULL(AA.GOODS_CD,'') GOODS_CD
								,ISNULL(AA.GUBUN,'') GUBUN
								, SUM(APPEAR_OUTPUT_CNT) AS SUM_OUPUT_CNT 	
               
							FROM
							(
								SELECT
									LEFT(A.EQUIP_CD,10) EQUIP_CD
									, A.WORK_ORD_NO  
									, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
									, GUBUN
									, A.GOODS_CD
									, RIGHT(WORK_ORD_DATE,2) DAY_
								FROM 
								(
									SELECT
									B.EQUIP_CD
									, A.WORK_ORD_NO                      
									, GUBUN                       
									, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
									, B.GOODS_CD
									, WORK_ORD_DATE
									FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,GUBUN,WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND '${chooseDateTo}' AND GUBUN ='N' GROUP BY WORK_ORD_NO,GUBUN,WORK_ORD_DATE) A, TB_WORK_ORDER B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY A.WORK_ORD_NO, B.EQUIP_CD, B.GOODS_CD,GUBUN,WORK_ORD_DATE
								) A 									
								              
							) AA
							GROUP BY AA.EQUIP_CD, AA.GUBUN, AA.GOODS_CD,DAY_
															
						) AS AA
			
						PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA
				ON 1=1 AND LEFT(XX.EQUIP_CD,10) = LEFT(AA.EQUIP_CD,10)
				AND XX.GOODS_CD = AA.GOODS_CD
								
			UNION ALL
				SELECT    
					'014' AS GUBUN
					,XX.EQUIP_CD
					,XX.EQUIP_NM
					,XX.GOODS_CD	
					,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM WHERE GOODS_CD = XX.GOODS_CD) GOODS_NM
					,'당일합계(검사)' AS GUBUN_NM
						, SUM((ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
								ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
								ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
								ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
								ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
								ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
								ISNULL([31],0))) AS COUNT_SUM
						    , CONVERT(VARCHAR,SUM([01])) FP_DATE1
							, CONVERT(VARCHAR,SUM([02])) FP_DATE2
							, CONVERT(VARCHAR,SUM([03])) FP_DATE3
							, CONVERT(VARCHAR,SUM([04])) FP_DATE4
							, CONVERT(VARCHAR,SUM([05])) FP_DATE5
							, CONVERT(VARCHAR,SUM([06])) FP_DATE6
							, CONVERT(VARCHAR,SUM([07])) FP_DATE7
							, CONVERT(VARCHAR,SUM([08])) FP_DATE8
							, CONVERT(VARCHAR,SUM([09])) FP_DATE9
							, CONVERT(VARCHAR,SUM([10])) FP_DATE10
							, CONVERT(VARCHAR,SUM([11])) FP_DATE11
							, CONVERT(VARCHAR,SUM([12])) FP_DATE12
							, CONVERT(VARCHAR,SUM([13])) FP_DATE13
							, CONVERT(VARCHAR,SUM([14])) FP_DATE14
							, CONVERT(VARCHAR,SUM([15])) FP_DATE15
							, CONVERT(VARCHAR,SUM([16])) FP_DATE16
							, CONVERT(VARCHAR,SUM([17])) FP_DATE17
							, CONVERT(VARCHAR,SUM([18])) FP_DATE18
							, CONVERT(VARCHAR,SUM([19])) FP_DATE19
							, CONVERT(VARCHAR,SUM([20])) FP_DATE20
							, CONVERT(VARCHAR,SUM([21])) FP_DATE21
							, CONVERT(VARCHAR,SUM([22])) FP_DATE22
							, CONVERT(VARCHAR,SUM([23])) FP_DATE23
							, CONVERT(VARCHAR,SUM([24])) FP_DATE24
							, CONVERT(VARCHAR,SUM([25])) FP_DATE25
							, CONVERT(VARCHAR,SUM([26])) FP_DATE26
							, CONVERT(VARCHAR,SUM([27])) FP_DATE27
							, CONVERT(VARCHAR,SUM([28])) FP_DATE28
							, CONVERT(VARCHAR,SUM([29])) FP_DATE29
							, CONVERT(VARCHAR,SUM([30])) FP_DATE30
							, CONVERT(VARCHAR,SUM([31])) FP_DATE31
						FROM (				
										
										
									(SELECT DISTINCT
									GOODS_CD,
									 EQUIP_CD,
									(SELECT DISTINCT LEFT(EQUIP_NM,5) EQUIP_NM FROM TB_EQUIP_CODE_ADM WHERE LEFT(EQUIP_CD,10) = A.EQUIP_CD ) EQUIP_NM
									FROM TB_FP_TOTAL_COMPLETE A
									WHERE FP_DATE = '${fpDate}') XX
			
									LEFT OUTER JOIN 
									(
										SELECT *
												FROM (
												]]>
													<!-- SELECT 							
													ISNULL(AA.EQUIP_CD,'') EQUIP_CD
													,ISNULL( AA.DAY_,'') DAY_
													,ISNULL(AA.GOODS_CD,'') GOODS_CD						
													,(ISNULL(AA.SUM_OUPUT_CNT,0)) AS SUM_OUPUT_CNT 							
												FROM 
										
														(
														SELECT GOODS_CD,
														SUM(PRODUCT_QTY) SUM_OUPUT_CNT ,
														RIGHT(B.INSP_DATE, 2) DAY_,
														LEFT(A.EQUIP_CD,10) EQUIP_CD
												
														FROM TB_PRODUCTION_PERF_TRAY A
														,(SELECT DISTINCT 
														TRAY_NO,INSP_DATE
														FROM 
														TB_SHIP_INSPECT_ADM 
														WHERE 1=1			
														AND RE_INSP_STATUS = '001'
														AND INSP_DATE >= '${chooseDateFrom}'
														AND INSP_DATE <= '${chooseDateTo}'
														
														) B
														WHERE A.LABEL_LOT_NO = B.TRAY_NO
																		
														GROUP BY GOODS_CD,INSP_DATE,LEFT(A.EQUIP_CD,10)) AS AA 	 -->	
												<![CDATA[
												SELECT 							
													ISNULL(AA.EQUIP_CD,'') EQUIP_CD
													,ISNULL( AA.DAY_,'') DAY_
													,ISNULL(AA.GOODS_CD,'') GOODS_CD											
													, SUM(APPEAR_OUTPUT_CNT) AS SUM_OUPUT_CNT 	
				                
												FROM
												(
													SELECT
														LEFT(A.EQUIP_CD,10) EQUIP_CD
														, A.WORK_ORD_NO  
														, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT														
														, A.GOODS_CD
														, RIGHT(WORK_ORD_DATE,2) DAY_
													FROM 
													(
														SELECT
														B.EQUIP_CD
														, A.WORK_ORD_NO    
														, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
														, B.GOODS_CD
														, WORK_ORD_DATE
														FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND '${chooseDateTo}' GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A, TB_WORK_ORDER B
														WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
														GROUP BY A.WORK_ORD_NO, B.EQUIP_CD, B.GOODS_CD,WORK_ORD_DATE
													) A 									
													              
												) AA
												GROUP BY AA.EQUIP_CD, AA.GOODS_CD,DAY_
												
											) AS AA								
													 
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																	, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																	, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																	, [31]) ) AS PIVOT_RESULT
							) AA
							ON 1=1 
							AND LEFT(XX.EQUIP_CD,10) = LEFT(AA.EQUIP_CD,10)
							AND XX.GOODS_CD = AA.GOODS_CD
							)
					GROUP BY XX.EQUIP_CD
					,XX.EQUIP_NM
					,XX.GOODS_CD	
					
		UNION ALL
		SELECT
	
		'015' AS GUBUN,
		LEFT(AA.EQUIP_CD,10) EQUIP_CD,
		LEFT(AA.EQUIP_NM,5) EQUIP_NM,
		AA.GOODS_CD,			
		(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM WHERE GOODS_CD = AA.GOODS_CD) GOODS_NM,
		'수율' AS GUBUN_NM
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,BB.COUNT_SUM / AA.COUNT_SUM * 100))	AS COUNT_SUM
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE1/ AA.FP_DATE1*100))) FP_DATE1
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE2/ AA.FP_DATE2*100))) FP_DATE2
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE3/ AA.FP_DATE3*100))) FP_DATE3
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE4/ AA.FP_DATE4*100))) FP_DATE4
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE5/ AA.FP_DATE5*100))) FP_DATE5
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE6/ AA.FP_DATE6*100))) FP_DATE6
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE7/ AA.FP_DATE7*100))) FP_DATE7
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE8/ AA.FP_DATE8*100))) FP_DATE8
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE9/ AA.FP_DATE9*100))) FP_DATE9
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE10/AA.FP_DATE10*100))) FP_DATE10
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE11/AA.FP_DATE11*100))) FP_DATE11
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE12/AA.FP_DATE12*100))) FP_DATE12
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE13/AA.FP_DATE13*100))) FP_DATE13
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE14/AA.FP_DATE14*100))) FP_DATE14
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE15/AA.FP_DATE15*100))) FP_DATE15
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE16/AA.FP_DATE16*100))) FP_DATE16
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE17/AA.FP_DATE17*100))) FP_DATE17
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE18/AA.FP_DATE18*100))) FP_DATE18
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE19/AA.FP_DATE19*100))) FP_DATE19
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE20/AA.FP_DATE20*100))) FP_DATE20
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE21/AA.FP_DATE21*100))) FP_DATE21
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE22/AA.FP_DATE22*100))) FP_DATE22
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE23/AA.FP_DATE23*100))) FP_DATE23
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE24/AA.FP_DATE24*100))) FP_DATE24
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE25/AA.FP_DATE25*100))) FP_DATE25
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE26/AA.FP_DATE26*100))) FP_DATE26
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE27/AA.FP_DATE27*100))) FP_DATE27
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE28/AA.FP_DATE28*100))) FP_DATE28
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE29/AA.FP_DATE29*100))) FP_DATE29
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE30/AA.FP_DATE30*100))) FP_DATE30
		, CONVERT(VARCHAR,CONVERT(NUMERIC(18,2) ,(BB.FP_DATE31/AA.FP_DATE31*100))) FP_DATE31
	FROM 
			(SELECT		
				'010' AS GUBUN,
				LEFT(XX.EQUIP_CD,10) EQUIP_CD,
				LEFT(XX.EQUIP_NM,5) EQUIP_NM,
				XX.GOODS_CD,			
				(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM WHERE GOODS_CD = XX.GOODS_CD) GOODS_NM,
				'당일합계(생산)' AS GUBUN_NM,
				(ISNULL(AA.[01],0) + ISNULL(AA.[02],0) + ISNULL(AA.[03],0) + ISNULL(AA.[04],0) + ISNULL(AA.[05],0) +
				ISNULL(AA.[06],0) + ISNULL(AA.[07],0) + ISNULL(AA.[08],0) + ISNULL(AA.[09],0) + ISNULL(AA.[10],0) +
				ISNULL(AA.[11],0) + ISNULL(AA.[12],0) + ISNULL(AA.[13],0) + ISNULL(AA.[14],0) + ISNULL(AA.[15],0) +
				ISNULL(AA.[16],0) + ISNULL(AA.[17],0) + ISNULL(AA.[18],0) + ISNULL(AA.[19],0) + ISNULL(AA.[20],0) +
				ISNULL(AA.[21],0) + ISNULL(AA.[22],0) + ISNULL(AA.[23],0) + ISNULL(AA.[24],0) + ISNULL(AA.[25],0) +
				ISNULL(AA.[26],0) + ISNULL(AA.[27],0) + ISNULL(AA.[28],0) + ISNULL(AA.[29],0) + ISNULL(AA.[30],0) +
				ISNULL(AA.[31],0)) COUNT_SUM,				
				  [01] FP_DATE1
				, [02] FP_DATE2
				, [03] FP_DATE3
				, [04] FP_DATE4
				, [05] FP_DATE5
				, [06] FP_DATE6
				, [07] FP_DATE7
				, [08] FP_DATE8
				, [09] FP_DATE9
				, [10] FP_DATE10
				, [11] FP_DATE11
				, [12] FP_DATE12
				, [13] FP_DATE13
				, [14] FP_DATE14
				, [15] FP_DATE15
				, [16] FP_DATE16
				, [17] FP_DATE17
				, [18] FP_DATE18
				, [19] FP_DATE19
				, [20] FP_DATE20
				, [21] FP_DATE21
				, [22] FP_DATE22
				, [23] FP_DATE23
				, [24] FP_DATE24
				, [25] FP_DATE25
				, [26] FP_DATE26
				, [27] FP_DATE27
				, [28] FP_DATE28
				, [29] FP_DATE29
				, [30] FP_DATE30
				, [31] FP_DATE31
				FROM (SELECT DISTINCT
				GOODS_CD,
				 EQUIP_CD,
				(SELECT DISTINCT LEFT(EQUIP_NM,5) EQUIP_NM FROM TB_EQUIP_CODE_ADM WHERE LEFT(EQUIP_CD,10) = A.EQUIP_CD ) EQUIP_NM
				FROM TB_FP_TOTAL_COMPLETE A
				WHERE FP_DATE = '${fpDate}') XX
				LEFT OUTER JOIN 				
				(
					SELECT *
							FROM (
							
								SELECT 							
									ISNULL(AA.EQUIP_CD,'') EQUIP_CD
									,ISNULL( AA.DAY_,'') DAY_
									,ISNULL(AA.GOODS_CD,'') GOODS_CD								
									,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) + SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT	
                
								FROM
								(
									SELECT
										LEFT(A.EQUIP_CD,10) EQUIP_CD
										, A.WORK_ORD_NO                     
										, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
										, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
										, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
										, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT								
										, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
										, ISNULL(RE_SHIP_FAULTY_CNT, 0 ) AS RE_SHIP_FAULTY_CNT
										, A.GOODS_CD
										, RIGHT(WORK_ORD_DATE,2) DAY_
									FROM 
									(
										SELECT
										B.EQUIP_CD
										, A.WORK_ORD_NO                      
										                       
										, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
										, B.GOODS_CD
										, WORK_ORD_DATE
										FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND '${chooseDateTo}' GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A, TB_WORK_ORDER B
										WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
										GROUP BY A.WORK_ORD_NO, B.EQUIP_CD, B.GOODS_CD,WORK_ORD_DATE
									) A 
									LEFT OUTER JOIN
								(SELECT
										X.WORK_ORD_NO
										, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
				
									FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND  '${chooseDateTo}') X
									WHERE 1=1 
									AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
			
									GROUP BY X.WORK_ORD_NO) CC
								ON CC.WORK_ORD_NO = A.WORK_ORD_NO

									LEFT OUTER JOIN 
									(
										SELECT                      
											X.WORK_ORD_NO
										, SUM(A.FAULTY_CNT) E_FAULTY_CNT
                        
										FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND '${chooseDateTo}') X
										WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
										GROUP BY X.WORK_ORD_NO
									) B
									ON A.WORK_ORD_NO = B.WORK_ORD_NO         
				  					
				  					LEFT OUTER JOIN
									(	SELECT 									
											 ISNULL(SUM(A.FAULTY_CNT),0) SHIP_FAULTY_CNT
											,GOODS_CD
											,X.WORK_ORD_NO
									
										FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
										WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
										AND E.WORK_ORD_NO = X.WORK_ORD_NO
										AND A.SHIP_INSP_IDX = B.IDX
										AND RE_INSP_STATUS != '002'
										GROUP BY X.WORK_ORD_NO,GOODS_CD
										) HH
				
									ON A.WORK_ORD_NO = HH.WORK_ORD_NO						
				
									LEFT OUTER JOIN
				
										(	SELECT 
											
												 ISNULL(SUM(A.FAULTY_CNT),0) RE_SHIP_FAULTY_CNT
												,GOODS_CD
												,X.WORK_ORD_NO
												FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
												WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
												AND E.WORK_ORD_NO = X.WORK_ORD_NO
												AND A.SHIP_INSP_IDX = B.IDX
												AND RE_INSP_STATUS = '002'
												GROUP BY X.WORK_ORD_NO,GOODS_CD
										) II
				
									ON A.WORK_ORD_NO = II.WORK_ORD_NO
									              
								) AA
								GROUP BY AA.EQUIP_CD, AA.GOODS_CD,DAY_							
						) AS AA
			
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																, [31]) ) AS PIVOT_RESULT  
																 
				) AA
				ON 1=1 AND LEFT(XX.EQUIP_CD,10) = LEFT(AA.EQUIP_CD,10)
				AND XX.GOODS_CD = AA.GOODS_CD
				)AA




				,(
				SELECT    
					'013' AS GUBUN
					,XX.EQUIP_CD
					,XX.EQUIP_NM
					,XX.GOODS_CD	
					,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM WHERE GOODS_CD = XX.GOODS_CD) GOODS_NM
					,'당일합계(검사)' AS GUBUN_NM
						, SUM((ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
								ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
								ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
								ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
								ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
								ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
								ISNULL([31],0))) AS COUNT_SUM
						    , CONVERT(VARCHAR,SUM([01])) FP_DATE1
							, CONVERT(VARCHAR,SUM([02])) FP_DATE2
							, CONVERT(VARCHAR,SUM([03])) FP_DATE3
							, CONVERT(VARCHAR,SUM([04])) FP_DATE4
							, CONVERT(VARCHAR,SUM([05])) FP_DATE5
							, CONVERT(VARCHAR,SUM([06])) FP_DATE6
							, CONVERT(VARCHAR,SUM([07])) FP_DATE7
							, CONVERT(VARCHAR,SUM([08])) FP_DATE8
							, CONVERT(VARCHAR,SUM([09])) FP_DATE9
							, CONVERT(VARCHAR,SUM([10])) FP_DATE10
							, CONVERT(VARCHAR,SUM([11])) FP_DATE11
							, CONVERT(VARCHAR,SUM([12])) FP_DATE12
							, CONVERT(VARCHAR,SUM([13])) FP_DATE13
							, CONVERT(VARCHAR,SUM([14])) FP_DATE14
							, CONVERT(VARCHAR,SUM([15])) FP_DATE15
							, CONVERT(VARCHAR,SUM([16])) FP_DATE16
							, CONVERT(VARCHAR,SUM([17])) FP_DATE17
							, CONVERT(VARCHAR,SUM([18])) FP_DATE18
							, CONVERT(VARCHAR,SUM([19])) FP_DATE19
							, CONVERT(VARCHAR,SUM([20])) FP_DATE20
							, CONVERT(VARCHAR,SUM([21])) FP_DATE21
							, CONVERT(VARCHAR,SUM([22])) FP_DATE22
							, CONVERT(VARCHAR,SUM([23])) FP_DATE23
							, CONVERT(VARCHAR,SUM([24])) FP_DATE24
							, CONVERT(VARCHAR,SUM([25])) FP_DATE25
							, CONVERT(VARCHAR,SUM([26])) FP_DATE26
							, CONVERT(VARCHAR,SUM([27])) FP_DATE27
							, CONVERT(VARCHAR,SUM([28])) FP_DATE28
							, CONVERT(VARCHAR,SUM([29])) FP_DATE29
							, CONVERT(VARCHAR,SUM([30])) FP_DATE30
							, CONVERT(VARCHAR,SUM([31])) FP_DATE31
						FROM (				
										
										
									(SELECT DISTINCT
									GOODS_CD,
									 EQUIP_CD,
									(SELECT DISTINCT LEFT(EQUIP_NM,5) EQUIP_NM FROM TB_EQUIP_CODE_ADM WHERE LEFT(EQUIP_CD,10) = A.EQUIP_CD ) EQUIP_NM
									FROM TB_FP_TOTAL_COMPLETE A
									WHERE FP_DATE = '${fpDate}') XX
			
									LEFT OUTER JOIN 
									(
										SELECT *
												FROM (											
												SELECT 							
													ISNULL(AA.EQUIP_CD,'') EQUIP_CD
													,ISNULL( AA.DAY_,'') DAY_
													,ISNULL(AA.GOODS_CD,'') GOODS_CD											
													, SUM(APPEAR_OUTPUT_CNT) AS SUM_OUPUT_CNT 	
				                
												FROM
												(
													SELECT
														LEFT(A.EQUIP_CD,10) EQUIP_CD
														, A.WORK_ORD_NO  
														, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT														
														, A.GOODS_CD
														, RIGHT(WORK_ORD_DATE,2) DAY_
													FROM 
													(
														SELECT
														B.EQUIP_CD
														, A.WORK_ORD_NO    
														, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
														, B.GOODS_CD
														, WORK_ORD_DATE
														FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND '${chooseDateTo}' GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A, TB_WORK_ORDER B
														WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
														GROUP BY A.WORK_ORD_NO, B.EQUIP_CD, B.GOODS_CD,WORK_ORD_DATE
													) A 									
													              
												) AA
												GROUP BY AA.EQUIP_CD, AA.GOODS_CD,DAY_
												
											) AS AA								
													 
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																	, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																	, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																	, [31]) ) AS PIVOT_RESULT
							) AA
							ON 1=1 
							AND LEFT(XX.EQUIP_CD,10) = LEFT(AA.EQUIP_CD,10)
							AND XX.GOODS_CD = AA.GOODS_CD
							)
					GROUP BY XX.EQUIP_CD
					,XX.EQUIP_NM
					,XX.GOODS_CD	
					) BB

					WHERE 1=1
					AND AA.EQUIP_CD = BB.EQUIP_CD
					AND AA.GOODS_CD = BB.GOODS_CD		
			UNION ALL
				SELECT 
					'016' AS GUBUN,
					LEFT(XX.EQUIP_CD,10) EQUIP_CD,
					LEFT(XX.EQUIP_NM,5) EQUIP_NM,
					XX.GOODS_CD,			
					(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM WHERE GOODS_CD = XX.GOODS_CD) GOODS_NM,
					'누계' AS GUBUN_NM
						, SUM([NUGYE]) AS COUNT_SUM
						    , CONVERT(VARCHAR,SUM([01])) FP_DATE1
							, CONVERT(VARCHAR,SUM([02])) FP_DATE2
							, CONVERT(VARCHAR,SUM([03])) FP_DATE3
							, CONVERT(VARCHAR,SUM([04])) FP_DATE4
							, CONVERT(VARCHAR,SUM([05])) FP_DATE5
							, CONVERT(VARCHAR,SUM([06])) FP_DATE6
							, CONVERT(VARCHAR,SUM([07])) FP_DATE7
							, CONVERT(VARCHAR,SUM([08])) FP_DATE8
							, CONVERT(VARCHAR,SUM([09])) FP_DATE9
							, CONVERT(VARCHAR,SUM([10])) FP_DATE10
							, CONVERT(VARCHAR,SUM([11])) FP_DATE11
							, CONVERT(VARCHAR,SUM([12])) FP_DATE12
							, CONVERT(VARCHAR,SUM([13])) FP_DATE13
							, CONVERT(VARCHAR,SUM([14])) FP_DATE14
							, CONVERT(VARCHAR,SUM([15])) FP_DATE15
							, CONVERT(VARCHAR,SUM([16])) FP_DATE16
							, CONVERT(VARCHAR,SUM([17])) FP_DATE17
							, CONVERT(VARCHAR,SUM([18])) FP_DATE18
							, CONVERT(VARCHAR,SUM([19])) FP_DATE19
							, CONVERT(VARCHAR,SUM([20])) FP_DATE20
							, CONVERT(VARCHAR,SUM([21])) FP_DATE21
							, CONVERT(VARCHAR,SUM([22])) FP_DATE22
							, CONVERT(VARCHAR,SUM([23])) FP_DATE23
							, CONVERT(VARCHAR,SUM([24])) FP_DATE24
							, CONVERT(VARCHAR,SUM([25])) FP_DATE25
							, CONVERT(VARCHAR,SUM([26])) FP_DATE26
							, CONVERT(VARCHAR,SUM([27])) FP_DATE27
							, CONVERT(VARCHAR,SUM([28])) FP_DATE28
							, CONVERT(VARCHAR,SUM([29])) FP_DATE29
							, CONVERT(VARCHAR,SUM([30])) FP_DATE30
							, CONVERT(VARCHAR,SUM([31])) FP_DATE31
						FROM (				
										
										
								(SELECT DISTINCT
								GOODS_CD,
								 EQUIP_CD,
								(SELECT DISTINCT LEFT(EQUIP_NM,5) EQUIP_NM FROM TB_EQUIP_CODE_ADM WHERE LEFT(EQUIP_CD,10) = A.EQUIP_CD ) EQUIP_NM
								FROM TB_FP_TOTAL_COMPLETE A
								WHERE FP_DATE = '${fpDate}') XX
			
									LEFT OUTER JOIN 
									(
										SELECT *
												FROM (
												]]>
													<!-- SELECT 							
													ISNULL(AA.EQUIP_CD,'') EQUIP_CD
													,ISNULL( AA.DAY_,'') DAY_
													,ISNULL(AA.GOODS_CD,'') GOODS_CD						
													,(ISNULL(SUM(AA.SUM_OUPUT_CNT) OVER(PARTITION BY AA.EQUIP_CD,AA.GOODS_CD ORDER BY AA.EQUIP_CD,AA.GOODS_CD,AA.DAY_),0)) AS SUM_OUPUT_CNT 	
													,NUGYE
													
												FROM 
										
														(
														SELECT
														LEFT(A.EQUIP_CD,10) EQUIP_CD
														,A.GOODS_CD									
														, RIGHT(B.WORK_ORD_DATE, 2) DAY_
														, ISNULL(SUM(B.OUTPUT_CNT+B.VISION_EDGE_CNT),0) AS SUM_OUPUT_CNT		
														
														FROM TB_WORK_ORDER A, TB_WORK_ORDER_OUTPUT_SUB B
														, (SELECT DISTINCT 
														WORK_ORD_NO 
														FROM 
														TB_SHIP_INSPECT_ADM 
														WHERE 1=1
														AND INSP_DATE >= '${chooseDateFrom}'
														AND INSP_DATE <= '${chooseDateTo}'
														AND RE_INSP_STATUS = '001'								
														)C
														WHERE 1=1
														AND A.WORK_ORD_NO = B.WORK_ORD_NO
														ANd A.WORK_ORD_NO = C.WORK_ORD_NO
											
																	
														GROUP BY LEFT(A.EQUIP_CD,10),A.GOODS_CD, B.WORK_ORD_DATE) AS AA 	
														,
														(
														SELECT
														LEFT(A.EQUIP_CD,10) EQUIP_CD
														,A.GOODS_CD	
														, ISNULL(SUM(B.OUTPUT_CNT+B.VISION_EDGE_CNT),0) AS NUGYE		
												
														FROM TB_WORK_ORDER A, TB_WORK_ORDER_OUTPUT_SUB B
														, (SELECT DISTINCT 
														WORK_ORD_NO 
														FROM 
														TB_SHIP_INSPECT_ADM 
														WHERE 1=1
														AND INSP_DATE >= '${chooseDateFrom}'
														AND INSP_DATE <= '${chooseDateTo}'
														AND RE_INSP_STATUS = '001'								
														)C
														WHERE 1=1
														AND A.WORK_ORD_NO = B.WORK_ORD_NO
														ANd A.WORK_ORD_NO = C.WORK_ORD_NO											
																	
														GROUP BY LEFT(A.EQUIP_CD,10),A.GOODS_CD) AS BB
												
												where aa.EQUIP_CD = bb.EQUIP_CD and aa.GOODS_CD = bb.GOODS_CD
												 -->
												 
										 <![CDATA[
											SELECT 							
													ISNULL(AA.EQUIP_CD,'') EQUIP_CD
													,ISNULL( AA.DAY_,'') DAY_
													,ISNULL(AA.GOODS_CD,'') GOODS_CD						
													,(ISNULL(SUM(AA.SUM_OUPUT_CNT) OVER(PARTITION BY AA.EQUIP_CD,AA.GOODS_CD ORDER BY AA.EQUIP_CD,AA.GOODS_CD,AA.DAY_),0)) AS SUM_OUPUT_CNT 	
													,NUGYE
													
												FROM 
										
														(
														SELECT 							
												ISNULL(AA.EQUIP_CD,'') EQUIP_CD
												,ISNULL( AA.DAY_,'') DAY_
												,ISNULL(AA.GOODS_CD,'') GOODS_CD									
												,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) + SUM(RE_SHIP_FAULTY_CNT) AS SUM_OUPUT_CNT 	
			                
											FROM
											(
												SELECT
													LEFT(A.EQUIP_CD,10) EQUIP_CD
													, A.WORK_ORD_NO                     
													, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
													, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
													, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT
													, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT								
													, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
													, ISNULL(RE_SHIP_FAULTY_CNT, 0 ) AS RE_SHIP_FAULTY_CNT
													, A.GOODS_CD
													, RIGHT(WORK_ORD_DATE,2) DAY_
												FROM 
												(
													SELECT
													B.EQUIP_CD
													, A.WORK_ORD_NO                     
													                 
													, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
													, B.GOODS_CD
													, WORK_ORD_DATE
													FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND '${chooseDateTo}'  GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A, TB_WORK_ORDER B
													WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
													GROUP BY A.WORK_ORD_NO, B.EQUIP_CD, B.GOODS_CD,WORK_ORD_DATE
												) A 
												LEFT OUTER JOIN
											(SELECT
													X.WORK_ORD_NO
													, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
							
												FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND '${chooseDateTo}') X
												WHERE 1=1 
												AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
						
												GROUP BY X.WORK_ORD_NO) CC
											ON CC.WORK_ORD_NO = A.WORK_ORD_NO
			
												LEFT OUTER JOIN 
												(
													SELECT                      
														X.WORK_ORD_NO
													, SUM(A.FAULTY_CNT) E_FAULTY_CNT
			                        
													FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND '${chooseDateTo}') X
													WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
													GROUP BY X.WORK_ORD_NO
												) B
												ON A.WORK_ORD_NO = B.WORK_ORD_NO       
												
												LEFT OUTER JOIN
												(	SELECT 									
														 ISNULL(SUM(A.FAULTY_CNT),0) SHIP_FAULTY_CNT
														,GOODS_CD
														,X.WORK_ORD_NO
												
													FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
													WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
													AND E.WORK_ORD_NO = X.WORK_ORD_NO
													AND A.SHIP_INSP_IDX = B.IDX
													AND RE_INSP_STATUS != '002'
													GROUP BY X.WORK_ORD_NO,GOODS_CD
													) HH
							
												ON A.WORK_ORD_NO = HH.WORK_ORD_NO						
							
												LEFT OUTER JOIN
							
													(	SELECT 
														
															 ISNULL(SUM(A.FAULTY_CNT),0) RE_SHIP_FAULTY_CNT
															,GOODS_CD
															,X.WORK_ORD_NO
															FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
															WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
															AND E.WORK_ORD_NO = X.WORK_ORD_NO
															AND A.SHIP_INSP_IDX = B.IDX
															AND RE_INSP_STATUS = '002'
															GROUP BY X.WORK_ORD_NO,GOODS_CD
													) II
							
												ON A.WORK_ORD_NO = II.WORK_ORD_NO  
							  
												              
											) AA
											GROUP BY AA.EQUIP_CD, AA.GOODS_CD,DAY_) AS AA 	
														,
														(
														SELECT 							
												ISNULL(AA.EQUIP_CD,'') EQUIP_CD										
												,ISNULL(AA.GOODS_CD,'') GOODS_CD									
												,SUM(AA.APPEAR_FAULTY_CNT) + SUM(E_FAULTY_CNT) + SUM(APPEAR_OUTPUT_CNT) + SUM(SHIP_FAULTY_CNT) + SUM(RE_SHIP_FAULTY_CNT) AS NUGYE 	
			                
											FROM
											(
												SELECT
													LEFT(A.EQUIP_CD,10) EQUIP_CD
													, A.WORK_ORD_NO                     
													, ISNULL(CC.FAULTY_CNT,0) AS APPEAR_FAULTY_CNT
													, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
													, ISNULL(CC.FAULTY_CNT,0) + ISNULL(A.APPEAR_OUTPUT_CNT,0) AS USER_INPUT_INSPCT_CNT													
													, ISNULL(B.E_FAULTY_CNT,0) AS E_FAULTY_CNT
													, ISNULL(SHIP_FAULTY_CNT,0) AS SHIP_FAULTY_CNT
													, ISNULL(RE_SHIP_FAULTY_CNT, 0 ) AS RE_SHIP_FAULTY_CNT
													, A.GOODS_CD
											
												FROM 
												(
													SELECT
													B.EQUIP_CD
													, A.WORK_ORD_NO
													, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
													, B.GOODS_CD
													FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND '${chooseDateTo}'  GROUP BY WORK_ORD_NO) A, TB_WORK_ORDER B
													WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
													GROUP BY A.WORK_ORD_NO, B.EQUIP_CD, B.GOODS_CD
												) A 
												LEFT OUTER JOIN
												(SELECT
														X.WORK_ORD_NO
														, SUM(ISNULL(FAULTY_CNT,0)) FAULTY_CNT						
							
													FROM TB_GOODS_FAULTY_ADM_CODE Z, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND '${chooseDateTo}') X
													WHERE 1=1 
													AND X.WORK_ORD_NO = Z.WORK_ORD_NO				
						
													GROUP BY X.WORK_ORD_NO) CC
												ON CC.WORK_ORD_NO = A.WORK_ORD_NO
			
												LEFT OUTER JOIN 
												(
													SELECT                      
														X.WORK_ORD_NO
													, SUM(A.FAULTY_CNT) E_FAULTY_CNT
			                        
													FROM TB_EDGE_GOODS_FAULTY_ADM_CODE A, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND '${chooseDateTo}') X
													WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
													GROUP BY X.WORK_ORD_NO
												) B
												ON A.WORK_ORD_NO = B.WORK_ORD_NO 
												
												LEFT OUTER JOIN
												(	SELECT 									
														 ISNULL(SUM(A.FAULTY_CNT),0) SHIP_FAULTY_CNT
														,GOODS_CD
														,X.WORK_ORD_NO
												
													FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
													WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
													AND E.WORK_ORD_NO = X.WORK_ORD_NO
													AND A.SHIP_INSP_IDX = B.IDX
													AND RE_INSP_STATUS != '002'
													GROUP BY X.WORK_ORD_NO,GOODS_CD
													) HH
							
												ON A.WORK_ORD_NO = HH.WORK_ORD_NO						
							
												LEFT OUTER JOIN
							
													(	SELECT 
														
															 ISNULL(SUM(A.FAULTY_CNT),0) RE_SHIP_FAULTY_CNT
															,GOODS_CD
															,X.WORK_ORD_NO
															FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo}) X
															WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
															AND E.WORK_ORD_NO = X.WORK_ORD_NO
															AND A.SHIP_INSP_IDX = B.IDX
															AND RE_INSP_STATUS = '002'
															GROUP BY X.WORK_ORD_NO,GOODS_CD
													) II
							
												ON A.WORK_ORD_NO = II.WORK_ORD_NO        
							  
												              
											) AA
											GROUP BY AA.EQUIP_CD, AA.GOODS_CD) AS BB
												
											where aa.EQUIP_CD = bb.EQUIP_CD and aa.GOODS_CD = bb.GOODS_CD
															
								) AS AA								
													 
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																	, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																	, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																	, [31]) ) AS PIVOT_RESULT
							) AA
							ON 1=1 
							AND LEFT(XX.EQUIP_CD,10) = LEFT(AA.EQUIP_CD,10)
							AND XX.GOODS_CD = AA.GOODS_CD
							)
					GROUP BY XX.EQUIP_CD
							,XX.EQUIP_NM
							,XX.GOODS_CD	
			
			UNION ALL
			
			SELECT '017' GUBUN
				,BB.EQUIP_CD
				,BB.EQUIP_NM
				,BB.GOODS_CD GOODS_CD	 
				,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM WHERE GOODS_CD = BB.GOODS_CD) GOODS_NM
				,'차이량' AS GUBUN_NM
				,COUNT_SUM - ((DATA_SUM)) AS  DATA_SUM
				,CONVERT(VARCHAR,(BB.[01] - FP_DATE1 )) + ('/'+ISNULL(CC.[01],''))  AS FP_DATE1 
				,CONVERT(VARCHAR,(BB.[02] - FP_DATE2 )) + ('/'+ISNULL(CC.[02],''))  AS FP_DATE2 
				,CONVERT(VARCHAR,(BB.[03] - FP_DATE3 )) + ('/'+ISNULL(CC.[03],''))  AS FP_DATE3 
				,CONVERT(VARCHAR,(BB.[04] - FP_DATE4 )) + ('/'+ISNULL(CC.[04],''))  AS FP_DATE4 
				,CONVERT(VARCHAR,(BB.[05] - FP_DATE5 )) + ('/'+ISNULL(CC.[05],''))  AS FP_DATE5 
				,CONVERT(VARCHAR,(BB.[06] - FP_DATE6 )) + ('/'+ISNULL(CC.[06],''))  AS FP_DATE6 
				,CONVERT(VARCHAR,(BB.[07] - FP_DATE7 )) + ('/'+ISNULL(CC.[07],''))  AS FP_DATE7 
				,CONVERT(VARCHAR,(BB.[08] - FP_DATE8 )) + ('/'+ISNULL(CC.[08],''))  AS FP_DATE8 
				,CONVERT(VARCHAR,(BB.[09] - FP_DATE9 )) + ('/'+ISNULL(CC.[09],''))  AS FP_DATE9 
				,CONVERT(VARCHAR,(BB.[10] - FP_DATE10)) + ('/'+ISNULL(CC.[10],''))  AS FP_DATE10
				,CONVERT(VARCHAR,(BB.[11] - FP_DATE11)) + ('/'+ISNULL(CC.[11],''))  AS FP_DATE11
				,CONVERT(VARCHAR,(BB.[12] - FP_DATE12)) + ('/'+ISNULL(CC.[12],''))  AS FP_DATE12
				,CONVERT(VARCHAR,(BB.[13] - FP_DATE13)) + ('/'+ISNULL(CC.[13],''))  AS FP_DATE13
				,CONVERT(VARCHAR,(BB.[14] - FP_DATE14)) + ('/'+ISNULL(CC.[14],''))  AS FP_DATE14
				,CONVERT(VARCHAR,(BB.[15] - FP_DATE15)) + ('/'+ISNULL(CC.[15],''))  AS FP_DATE15
				,CONVERT(VARCHAR,(BB.[16] - FP_DATE16)) + ('/'+ISNULL(CC.[16],''))  AS FP_DATE16
				,CONVERT(VARCHAR,(BB.[17] - FP_DATE17)) + ('/'+ISNULL(CC.[17],''))  AS FP_DATE17
				,CONVERT(VARCHAR,(BB.[18] - FP_DATE18)) + ('/'+ISNULL(CC.[18],''))  AS FP_DATE18
				,CONVERT(VARCHAR,(BB.[19] - FP_DATE19)) + ('/'+ISNULL(CC.[19],''))  AS FP_DATE19
				,CONVERT(VARCHAR,(BB.[20] - FP_DATE20)) + ('/'+ISNULL(CC.[20],''))  AS FP_DATE20
				,CONVERT(VARCHAR,(BB.[21] - FP_DATE21)) + ('/'+ISNULL(CC.[21],''))  AS FP_DATE21
				,CONVERT(VARCHAR,(BB.[22] - FP_DATE22)) + ('/'+ISNULL(CC.[22],''))  AS FP_DATE22
				,CONVERT(VARCHAR,(BB.[23] - FP_DATE23)) + ('/'+ISNULL(CC.[23],''))  AS FP_DATE23
				,CONVERT(VARCHAR,(BB.[24] - FP_DATE24)) + ('/'+ISNULL(CC.[24],''))  AS FP_DATE24
				,CONVERT(VARCHAR,(BB.[25] - FP_DATE25)) + ('/'+ISNULL(CC.[25],''))  AS FP_DATE25
				,CONVERT(VARCHAR,(BB.[26] - FP_DATE26)) + ('/'+ISNULL(CC.[26],''))  AS FP_DATE26
				,CONVERT(VARCHAR,(BB.[27] - FP_DATE27)) + ('/'+ISNULL(CC.[27],''))  AS FP_DATE27
				,CONVERT(VARCHAR,(BB.[28] - FP_DATE28)) + ('/'+ISNULL(CC.[28],''))  AS FP_DATE28
				,CONVERT(VARCHAR,(BB.[29] - FP_DATE29)) + ('/'+ISNULL(CC.[29],''))  AS FP_DATE29
				,CONVERT(VARCHAR,(BB.[30] - FP_DATE30)) + ('/'+ISNULL(CC.[30],''))  AS FP_DATE30
				,CONVERT(VARCHAR,(BB.[31] - FP_DATE31)) + ('/'+ISNULL(CC.[31],''))  AS FP_DATE31
			FROM 
			(
				SELECT DISTINCT 
					'005' GUBUN			
					,LEFT(AA.EQUIP_CD,10) EQUIP_CD
					,LEFT(AA.EQUIP_NM,5) EQUIP_NM
					,A.GOODS_CD
					,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM WHERE GOODS_CD = A.GOODS_CD) GOODS_NM
					,'계획수량(변경)' AS  GUBUN_NM
					,B.DATA_SUM
					,FP_DATE1
					,FP_DATE2
					,FP_DATE3
					,FP_DATE4
					,FP_DATE5
					,FP_DATE6
					,FP_DATE7
					,FP_DATE8
					,FP_DATE9
					,FP_DATE10
					,FP_DATE11
					,FP_DATE12
					,FP_DATE13
					,FP_DATE14
					,FP_DATE15
					,FP_DATE16
					,FP_DATE17
					,FP_DATE18
					,FP_DATE19
					,FP_DATE20
					,FP_DATE21
					,FP_DATE22
					,FP_DATE23
					,FP_DATE24
					,FP_DATE25
					,FP_DATE26
					,FP_DATE27
					,FP_DATE28
					,FP_DATE29
					,FP_DATE30
					,FP_DATE31
			
				FROM TB_EQUIP_CODE_ADM AA
			
				LEFT OUTER JOIN
				TB_FP_TOTAL_COMPLETE A
				ON 1=1
				AND LEFT(AA.EQUIP_CD,10) = A.EQUIP_CD
				AND A.FP_DATE = '${fpDate}'
				AND A.GUBUN = '005'
			
				LEFT OUTER JOIN
				(SELECT EQUIP_CD,GOODS_CD, SUM(PLAN_CNT) DATA_SUM FROM
				TB_MONTH_PRODUCTION_PLAN_DTL B
				WHERE B.FP_DATE >= '${chooseDateFrom}'
					AND B.FP_DATE <= '${chooseDateTo}'
					AND CPL_GUBUN = '002'					
				GROUP BY EQUIP_CD,GOODS_CD	) B
				ON 1=1
				AND A.EQUIP_CD = B.EQUIP_CD 
				AND A.GOODS_CD = B.GOODS_CD
			
			) AA,
			(	SELECT   
					'011' AS GUBUN,
					LEFT(XX.EQUIP_CD,10) EQUIP_CD,
					LEFT(XX.EQUIP_NM,5) EQUIP_NM,
					XX.GOODS_CD,			
					(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM WHERE GOODS_CD = XX.GOODS_CD) GOODS_NM,
					'당일합계(검사)' AS GUBUN_NM
						, SUM((ISNULL([01],0) + ISNULL([02],0) + ISNULL([03],0) + ISNULL([04],0) + ISNULL([05],0) +
								ISNULL([06],0) + ISNULL([07],0) + ISNULL([08],0) + ISNULL([09],0) + ISNULL([10],0) +
								ISNULL([11],0) + ISNULL([12],0) + ISNULL([13],0) + ISNULL([14],0) + ISNULL([15],0) +
								ISNULL([16],0) + ISNULL([17],0) + ISNULL([18],0) + ISNULL([19],0) + ISNULL([20],0) +
								ISNULL([21],0) + ISNULL([22],0) + ISNULL([23],0) + ISNULL([24],0) + ISNULL([25],0) +
								ISNULL([26],0) + ISNULL([27],0) + ISNULL([28],0) + ISNULL([29],0) + ISNULL([30],0) +
								ISNULL([31],0))) AS COUNT_SUM
						, SUM([01]) '01', SUM([02]) '02', SUM([03]) '03', SUM([04]) '04', SUM([05]) '05', SUM([06]) '06', SUM([07]) '07', SUM([08]) '08', SUM([09]) '09', SUM([10]) '10'
						, SUM([11]) '11', SUM([12]) '12', SUM([13]) '13', SUM([14]) '14', SUM([15]) '15', SUM([16]) '16', SUM([17]) '17', SUM([18]) '18', SUM([19]) '19', SUM([20]) '20'
						, SUM([21]) '21', SUM([22]) '22', SUM([23]) '23', SUM([24]) '24', SUM([25]) '25', SUM([26]) '26', SUM([27]) '27', SUM([28]) '28', SUM([29]) '29', SUM([30]) '30'
						, SUM([31]) '31'
						FROM (				
										
										
									(SELECT DISTINCT
									GOODS_CD,
									 EQUIP_CD,
									(SELECT DISTINCT LEFT(EQUIP_NM,5) EQUIP_NM FROM TB_EQUIP_CODE_ADM WHERE LEFT(EQUIP_CD,10) = A.EQUIP_CD ) EQUIP_NM
									FROM TB_FP_TOTAL_COMPLETE A
									WHERE FP_DATE = '${fpDate}') XX
			
									LEFT OUTER JOIN 
									(
										SELECT *
												FROM (
												
												]]>
													<!-- SELECT 							
													ISNULL(AA.EQUIP_CD,'') EQUIP_CD
													,ISNULL( AA.DAY_,'') DAY_
													,ISNULL(AA.GOODS_CD,'') GOODS_CD						
													,(ISNULL(AA.SUM_OUPUT_CNT,0)) AS SUM_OUPUT_CNT 							
												FROM 
										
														(
														SELECT GOODS_CD,
														SUM(PRODUCT_QTY) SUM_OUPUT_CNT ,
														RIGHT(B.INSP_DATE, 2) DAY_,
														LEFT(A.EQUIP_CD,10) EQUIP_CD
												
														FROM TB_PRODUCTION_PERF_TRAY A
														,(SELECT DISTINCT 
														TRAY_NO,INSP_DATE,DAY_NIGHT_CD 
														FROM 
														TB_SHIP_INSPECT_ADM 
														WHERE 1=1			
														AND RE_INSP_STATUS = '001'
														AND INSP_DATE >= {chooseDateFrom}
														AND INSP_DATE <= {chooseDateTo}
												
														) B
														WHERE A.LABEL_LOT_NO = B.TRAY_NO
																		
														GROUP BY GOODS_CD,INSP_DATE,LEFT(A.EQUIP_CD,10)) AS AA 			 -->
														<![CDATA[
												SELECT 							
													ISNULL(AA.EQUIP_CD,'') EQUIP_CD
													,ISNULL( AA.DAY_,'') DAY_
													,ISNULL(AA.GOODS_CD,'') GOODS_CD											
													, SUM(APPEAR_OUTPUT_CNT) AS SUM_OUPUT_CNT 	
				                
												FROM
												(
													SELECT
														LEFT(A.EQUIP_CD,10) EQUIP_CD
														, A.WORK_ORD_NO  
														, ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT														
														, A.GOODS_CD
														, RIGHT(WORK_ORD_DATE,2) DAY_
													FROM 
													(
														SELECT
														B.EQUIP_CD
														, A.WORK_ORD_NO    
														, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
														, B.GOODS_CD
														, WORK_ORD_DATE
														FROM  (SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN '${chooseDateFrom}' AND '${chooseDateTo}' GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A, TB_WORK_ORDER B
														WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
														GROUP BY A.WORK_ORD_NO, B.EQUIP_CD, B.GOODS_CD,WORK_ORD_DATE
													) A 									
													              
												) AA
												GROUP BY AA.EQUIP_CD, AA.GOODS_CD,DAY_						
											
															
											) AS AA								
													 
							PIVOT ( SUM(SUM_OUPUT_CNT) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																	, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																	, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																	, [31]) ) AS PIVOT_RESULT
							) AA
							ON 1=1 
							AND LEFT(XX.EQUIP_CD,10) = LEFT(AA.EQUIP_CD,10)
							AND XX.GOODS_CD = AA.GOODS_CD
							)
					GROUP BY XX.EQUIP_CD
					,XX.EQUIP_NM
					,XX.GOODS_CD	
			
			) BB
			
			LEFT OUTER JOIN

			
			(				SELECT *
												FROM (
											
												SELECT 							
													ISNULL(AA.EQUIP_CD,'') EQUIP_CD
													,ISNULL(AA.GOODS_CD,'') GOODS_CD		
													,ISNULL( AA.DAY_,'') DAY_
													, MEMO 
				                
												FROM
												(
													SELECT EQUIP_CD
													,GOODS_CD
													,RIGHT(PLAN_DATE,2) DAY_
													,MEMO 
													 FROM TB_MONTH_PRODUCTION_MEMO 
													 WHERE 1=1        											
													 AND PLAN_DATE >= #{chooseDateFrom}
													 AND PLAN_DATE <= #{chooseDateTo}  
													 AND MEMO_GUBUN = '001'
												) AA
												GROUP BY AA.EQUIP_CD, AA.GOODS_CD,DAY_,MEMO						
											
															
											) AS AA								
													 
							PIVOT ( MAX(MEMO) FOR DAY_ IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																	, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																	, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																	, [31]) ) AS PIVOT_RESULT

			) CC

			ON 1=1
			AND CC.EQUIP_CD = BB.EQUIP_CD
			AND CC.GOODS_CD = BB.GOODS_CD
			

			WHERE 1=1
			AND AA.EQUIP_CD = BB.EQUIP_CD
			AND AA.GOODS_CD = BB.GOODS_CD
			
			
			ORDER BY EQUIP_CD,GOODS_CD DESC,GUBUN
		]]>
	
	
	</select>
	
	<!-- 월별 목표 조회 -->
	<select id="monthSumData" resultMap="MonthProductionPlanVo" >
		SELECT * FROM TB_MONTH_SUM_DATA
		WHERE 1=1
		AND FP_DATE = #{fpDate}
	</select>
	
	<!-- 월별 목표 등록 -->
	<insert id="createTheory" >
	
		INSERT INTO TB_MONTH_SUM_DATA
        (  FP_DATE
           ,THEORY_CAPA           
           ,THEORY_EQUIP_CNT
           ,THEORY_PLAN_CNT
           ,DUAL_CAPA
           ,EQUIP_CNT
           ,PLAN_CNT
           ,REG_ID
           ,REG_DATE
        )
    	VALUES     	
    	(    	
    		#{fpDate}
    		,#{theoryCapa}    	
			,#{theoryEquipCnt}
			,#{theoryPlanCnt}		
			,#{dualCapa}		
			,#{equipCnt}	
			,#{planCnt}
			,#{regId}
			,getDate()
		
    	)		
	</insert >
	
	<!-- 월별 목표 수정 -->
	<update id="updateTheory">
			
		UPDATE TB_MONTH_SUM_DATA
		SET 
			UPD_ID = #{updId}		
		   ,UPD_DATE = getDate() 	
			<if test="theoryCapa != null and theoryCapa != ''"> 
				,THEORY_CAPA     = #{theoryCapa}      
			</if>
			<if test="theoryEquipCnt != null and theoryEquipCnt != ''">     
           		,THEORY_EQUIP_CNT = #{theoryEquipCnt}
           </if>
           <if test="theoryPlanCnt != null and theoryPlanCnt != ''"> 
           		,THEORY_PLAN_CNT  = #{theoryPlanCnt}
           </if>
           <if test="dualCapa != null and dualCapa != ''"> 
          		,DUAL_CAPA        = #{dualCapa}		
           </if>
           <if test="equipCnt != null and equipCnt != ''"> 
           		,EQUIP_CNT        = #{equipCnt}	
           </if>
           <if test="planCnt != null and planCnt != ''">           
           		,PLAN_CNT         =  #{planCnt}
           </if>          
		  	
		WHERE 
		FP_DATE = #{fpDate}	

	</update >
	
	<!-- 월별 목표  삭제-->
	<delete id="deleteTheory">
		DELETE TB_MONTH_SUM_DATA
		WHERE 1=1			
		AND FP_DATE = #{fpDate}	
	</delete >	
	
	
	<!-- 월별 FP 수율 조회 -->
	<select id="readYeild" resultMap="MonthProductionPlanVo" >
			
		SELECT CPL_GUBUN
				,FP_DATE
				,YEILD1
				,YEILD2
				,YEILD_TOTAL
				,REG_ID
				,REG_DATE
				,UPD_ID
				,UPD_DATE			
		FROM TB_MONTH_PRODUCTION_PLAN_YEILD
		WHERE 1=1			
		AND CPL_GUBUN = #{cplGubun}		
		AND FP_DATE = #{fpDate}
					
	</select >
	
	
	<!-- 월별 FP 수율 등록 -->
	<insert id="createYeild">
	
		INSERT INTO TB_MONTH_PRODUCTION_PLAN_YEILD
        (  CPL_GUBUN                      
           ,FP_DATE
           ,YEILD1
           ,YEILD2
           ,YEILD_TOTAL          
           ,REG_ID
           ,REG_DATE
        )
    	VALUES     	
    	(    	
    		 #{cplGubun}    		
			,#{fpDate}
			,#{yeild1}
			,#{yeild2}
			,#{yeildTotal}
			,#{regId}
			,getDate()
		
    	)
		
	</insert >
	
		<!-- 월별 수율 수정 -->
	<update id="updateYeild">
			
		UPDATE TB_MONTH_PRODUCTION_PLAN_YEILD
		SET 
			UPD_ID = #{updId}		
		   ,UPD_DATE = getDate()
		   ,YEILD1 = #{yeild1}
           ,YEILD2 = #{yeild2}
           ,YEILD_TOTAL = #{yeildTotal}

		WHERE 1=1
		AND	CPL_GUBUN = #{cplGubun}
		AND FP_DATE = #{fpDate}	

	</update >
	
	<!-- 월별 수율 삭제-->
	<delete id="deleteYeild">
		DELETE TB_MONTH_PRODUCTION_PLAN_YEILD
		WHERE 1=1		
		AND CPL_GUBUN = #{cplGubun}		
		AND FP_DATE = #{fpDate}	
	</delete >	

	<!-- 월별 FP 잡체인지 목록 모달 조회 -->
	<select id="jcModalList" resultMap="MonthProductionPlanVo" >
			
		SELECT CPL_GUBUN
		      ,EQUIP_CD
			   ,LEFT((SELECT TOP(1) EQUIP_NM FROM TB_EQUIP_CODE_ADM X WHERE LEFT(X.EQUIP_CD,10) = LEFT(A.EQUIP_CD,10) ),5) EQUIP_NM
		      ,A.GOODS_CD
		      ,GOODS_NM		     
			  ,(SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '007' AND C.QUTY_CD = X.BASE_CD) QUTY_NM
		      ,FP_DATE
		      ,OP_TIME
		      ,A.TEC_TIME
		      ,PLAN_CNT
		      ,JOB_CHANGE_DATE
		      ,JOB_CHANGE_START_DATE
		      ,JOB_CHANGE_END_DATE
		      ,COMPLETE_YN

			
		FROM TB_MONTH_PRODUCTION_PLAN_DTL A,
			TB_GOODS_CODE_ADM B,
			TB_MATRL_CODE_ADM C		
			
		WHERE 1=1
			AND A.GOODS_CD = B.GOODS_CD
			AND C.MATRL_CD = B.ALNICU_MATRL_CD
			AND CPL_GUBUN = #{cplGubun}
			AND LEFT(FP_DATE,6) = #{fpDate}
			<if test="equipCd != null and equipCd != ''"> 
				AND EQUIP_CD = #{equipCd}
			</if>
			<if test="goodsCd != null and goodsCd != ''"> 
				AND GOODS_CD = #{goodsCd}
			</if>
			AND JOB_CHANGE_DATE IS NOT NULL
		ORDER BY EQUIP_CD ASC
			
		
		
	</select >
	
	<!-- 기종별 일일재고 목록 -->
	<select id="dailyInvenList" resultMap="MonthProductionPlanVo" >	
		SELECT		
			OUT_GUBUN
			,FP_DATE
			,GOODS_CD			
			,DEAL_CORP_CD			
			,OUTPUT_CNT
			,REG_ID
			,REG_DATE
			,UPD_ID
			,UPD_DATE
		FROM TB_DAILY_INVEN_DTL
		WHERE 1=1
		AND LEFT(FP_DATE,6) = #{fpDate}
		<if test="dealCorpCd != null and dealCorpCd != ''"> 
			AND DEAL_CORP_CD = #{dealCorpCd}
		</if>
		<if test="goodsCd != null and goodsCd != ''"> 
			AND GOODS_CD = #{goodsCd}
		</if>
		<if test="gubun != null and gubun != ''"> 
			AND GUBUN = #{gubun}
		</if>
	
	</select >
	
		<!-- 기종별 일일재고 목록 -->
	<select id="dailyInvenRead" resultMap="MonthProductionPlanVo" >	
		SELECT			
			FP_DATE
			,GUBUN
			,GOODS_CD
			,LAST_MONTH_STOCK				
			,REG_ID
			,REG_DATE
			,UPD_ID
			,UPD_DATE
		FROM TB_DAILY_INVEN_ADM
		WHERE 1=1
		AND FP_DATE = #{fpDate}		
		AND GOODS_CD = #{goodsCd}
		AND GUBUN = #{gubun}
		
	</select >
	
	<!-- 기종별 일일재고 목록 -->
	<select id="dailyInvenAdmList" resultMap="MonthProductionPlanVo" >	
		SELECT			
			FP_DATE
			,GUBUN
			,GOODS_CD
			,LAST_MONTH_STOCK				
			,REG_ID
			,REG_DATE
			,UPD_ID
			,UPD_DATE
		FROM TB_DAILY_INVEN_ADM
		WHERE 1=1
		AND FP_DATE = #{fpDate}		
		AND GUBUN = #{gubun}
		
	</select >
	
		<!-- 기종별 일일재고 목록 -->
	<select id="dailyInvenDtlList" resultMap="MonthProductionPlanVo" >	
		SELECT * FROM
		(
		SELECT  
				 '' GOODS_CD
				,'' GOODS_NM
				,'' DEAL_CORP_CD
				,'' DEAL_CORP_NM
				,0 FP_DATE1
				,0 FP_DATE2
				,0 FP_DATE3
				,0 FP_DATE4
				,0 FP_DATE5
				,0 FP_DATE6
				,0 FP_DATE7
				,0 FP_DATE8
				,0 FP_DATE9
				,0 FP_DATE10
				,0 FP_DATE11
				,0 FP_DATE12
				,0 FP_DATE13
				,0 FP_DATE14
				,0 FP_DATE15
				,0 FP_DATE16
				,0 FP_DATE17
				,0 FP_DATE18
				,0 FP_DATE19
				,0 FP_DATE20
				,0 FP_DATE21
				,0 FP_DATE22
				,0 FP_DATE23
				,0 FP_DATE24
				,0 FP_DATE25
				,0 FP_DATE26
				,0 FP_DATE27
				,0 FP_DATE28
				,0 FP_DATE29
				,0 FP_DATE30
				,0 FP_DATE31	
	
		UNION ALL
	
		SELECT  
				 AA.GOODS_CD
				,CC.GOODS_NM
				,AA.DEAL_CORP_CD
				,BB.DEAL_CORP_NM
				,[01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
														, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
														, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
														, [31]
			FROM			
				
				(
				SELECT * FROM
					   (SELECT
							GOODS_CD
							,RIGHT(FP_DATE,2) FP_DATE
							,DEAL_CORP_CD
							,CONVERT(NUMERIC(18,2),OUTPUT_CNT) OUTPUT_CNT									
						FROM tb_daily_inven_dtl				
						WHERE LEFT(FP_DATE,6) = #{fpDate}
						AND OUT_GUBUN = '001'
							) A
						PIVOT(SUM(OUTPUT_CNT) FOR FP_DATE IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
														, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
														, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
														, [31])) as pivot_reslut
				) AA
				, TB_DEAL_CORP_ADM BB
				, TB_GOODS_CODE_ADM CC
				WHERE BB.DEAL_CORP_CD = AA.DEAL_CORP_CD
				AND AA.GOODS_CD = CC.GOODS_CD				
		) AA WHERE AA.GOODS_CD != '' 
			ORDER BY GOODS_NM,DEAL_CORP_CD
		
		
	</select >
	
	<!-- 기종별 일일재고 등록 -->
	<insert id="dailyInvenAdmCreate">
	
		INSERT INTO TB_DAILY_INVEN_ADM
        (  
        	GUBUN
           ,GOODS_CD                    
           ,FP_DATE
           ,LAST_MONTH_STOCK    
           ,REG_ID
           ,REG_DATE
        )
    	VALUES     	
    	(    	
    		#{gubun}
    		,#{goodsCd}    		
			,#{fpDate}
			,#{lastMonthStock}
			,#{regId}
			,getDate()
		
    	)
		
	</insert >
	
	<!-- 기종별 일일재고 삭제-->
	<delete id="dailyInvenAdmDelete">
		DELETE TB_DAILY_INVEN_ADM
		WHERE 1=1
		AND FP_DATE = #{fpDate}	
		AND GOODS_CD = #{goodsCd}
		AND GUBUN = #{gubun}
	
	</delete >	
	
	<!-- 기종별 일일재고 등록 -->
	<insert id="dailyInvenCreate">
	
		INSERT INTO TB_DAILY_INVEN_DTL
        (  OUT_GUBUN                    
           ,FP_DATE
           ,GOODS_CD
           ,DEAL_CORP_CD          
           ,OUTPUT_CNT
           ,REG_ID
           ,REG_DATE
        )
    	VALUES     	
    	<foreach collection="list" item="item" separator=",">
	    	(    	
    		 #{item.outGubun}    		
			,#{item.fpDate}
			,#{item.goodsCd}
			,#{item.dealCorpCd}		
			,#{item.outputCnt}
			,#{item.regId}
			,getDate()
		
    	)
		</foreach>
    	
		
	</insert >
	
	<!-- 기종별 일일재고 수정 -->
	<update id="dailyInvenUpdate">
			
		UPDATE TB_DAILY_INVEN_DTL
		SET 
			UPD_ID = #{updId}		
		   ,UPD_DATE = getDate()		              
           ,OUTPUT_CNT = #{outputCnt}
   
		WHERE 1=1
		AND	OUT_GUBUN = #{outGubun}
		AND FP_DATE = #{fpDate}	
		<if test="dealCorpCd != null and dealCorpCd != ''"> 
			AND DEAL_CORP_CD = #{dealCorpCd}
		</if>
		<if test="goodsCd != null and goodsCd != ''"> 
			AND GOODS_CD = #{goodsCd}
		</if>

	</update >
	
	<!-- 기종별 일일재고 삭제-->
	<delete id="dailyInvenDelete">
		DELETE TB_DAILY_INVEN_DTL
		WHERE 1=1		
		AND	OUT_GUBUN = #{outGubun}
		AND LEFT(FP_DATE,6) = #{fpDate}	
		<if test="dealCorpCd != null and dealCorpCd != ''"> 
			AND DEAL_CORP_CD = #{dealCorpCd}
		</if>
		<if test="goodsCd != null and goodsCd != ''"> 
			AND GOODS_CD = #{goodsCd}
		</if>
	</delete >	
	
		<!-- 월별 FP 메모 조회 -->
	<select id="memoList" resultMap="MonthProductionPlanVo">
		
			SELECT MEMO_GUBUN
				  ,EQUIP_CD
				  , GOODS_CD
			      ,PLAN_DATE			
			      ,MEMO			    
			FROM TB_MONTH_PRODUCTION_MEMO
			WHERE 1=1
			<if test="equipCd != null and equipCd != ''"> 
				AND EQUIP_CD = #{equipCd}
			</if>
			<if test="goodsCd != null and goodsCd != ''"> 
				AND GOODS_CD = #{goodsCd}
			</if>		
			AND PLAN_DATE = #{planDate}
			AND MEMO_GUBUN = #{memoGubun}
	
	</select>
	
	<!-- 메모 수정 -->
	<update id="memoUpdate">
		
			UPDATE TB_MONTH_PRODUCTION_MEMO		 
			SET
				MEMO = #{memo}		
				,UPD_ID = #{updId}
				,UPD_DATE = getDate()	
			WHERE 1=1
				 AND PLAN_DATE = #{planDate}
				 AND MEMO_GUBUN = #{memoGubun}
				<if test="equipCd != null and equipCd != ''"> 
					AND EQUIP_CD = #{equipCd}
				</if>
				<if test="goodsCd != null and goodsCd != ''"> 
					AND GOODS_CD = #{goodsCd}
				</if>	
			
	
	</update>
	
	<!-- 메모 등록 -->
	<insert id="memoCreate">
		<![CDATA[
			INSERT INTO TB_MONTH_PRODUCTION_MEMO (
			    MEMO_GUBUN
				,PLAN_DATE
				, EQUIP_CD
				, GOODS_CD
				, MEMO				
				, REG_ID
				, REG_DATE
				
				) 
			VALUES(
				#{memoGubun}
				, #{planDate}
				, #{equipCd}
				, #{goodsCd}
				, #{memo}
				, #{regId}
				, getDate()				
			)
			
		]]>
	</insert>
	
	<!-- 메모 삭제-->
	<delete id="memoDelete">
		
			DELETE	TB_MONTH_PRODUCTION_MEMO
			WHERE 1=1
				AND MEMO_GUBUN = #{memoGubun}
				AND PLAN_DATE = #{planDate}
				<if test="equipCd != null and equipCd != ''"> 
					AND EQUIP_CD = #{equipCd}
				</if>
				<if test="goodsCd != null and goodsCd != ''"> 
					AND GOODS_CD = #{goodsCd}
				</if>		
	
	</delete>

	<!-- 기종별일일재고 실데이터 -->
	<select id="gijongDailyPlan1" resultMap="MonthProductionPlanVo" >		
	
		<![CDATA[
				WITH MAIN AS (
				SELECT 
					B.MODEL
					, B.GIJONG_NM
					,'99999' DEAL_CORP_CD
					,'' DEAL_CORP_NM
					,B.GOODS_CD
					,B.GOODS_NM
					,B.QUTY_NM
					,'3' GUBUN
					,ISNULL(LAST_MONTH_STOCK,0) LAST_MONTH_STOCK
					,RIGHT(B.DATE ,2) PO_DATE
					, ISNULL(SUM(ISNULL(SUM_OUPUT_CNT,0) - ISNULL(OUTPUT_CNT,0) ) OVER(PARTITION BY B.GOODS_CD ORDER BY B.GOODS_CD,RIGHT(B.DATE ,2)),0)  + ISNULL(LAST_MONTH_STOCK,0) OUTPUT_CNT				
				FROM (
						SELECT 
							GOODS_CD
							,GOODS_NM
							,GIJONG_CD					
							,GIJONG_NM		
							,QUTY_NM	
							,MODEL
							,DATE 				
						FROM ( 
							SELECT DISTINCT
							B.GOODS_CD
							,GOODS_NM
							,GIJONG_CD				
							,QUTY_CD
							,MODEL
							,(SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '007' AND C.QUTY_CD = X.BASE_CD) QUTY_NM
							,(SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '080' AND B.GIJONG_CD = X.BASE_CD) GIJONG_NM								
						FROM 
							TB_MATRL_CODE_ADM C,
							TB_GOODS_CODE_ADM B
							LEFT OUTER JOIN
							TB_PURCHASE_ORDER_ADM X
							ON 1=1
							AND B.GOODS_CD = X.GOODS_CD
							AND LEFT(DELIVERY_DATE,6) = #{fpDate}
						WHERE 
							B.GIJONG_CD != ''
							AND B.GIJONG_CD IS NOT NULL
							AND B.USE_YN_CD = '001'
							AND C.USE_YN_CD = '001'
							AND C.MATRL_CD = B.ALNICU_MATRL_CD
							AND B.GOODS_SAMPLE_YN = '001'
							AND B.GIJONG_CD != '012'
								
						) A
						FULL OUTER JOIN
						(
							SELECT 
								DATE 		
							FROM 
								CALENDAR
							WHERE 
								LEFT(CALENDAR.DATE,6) = #{fpDate}
					
						) B
						ON 1=1
				) B
				LEFT OUTER JOIN
				(	
					SELECT 
						B.GOODS_CD,
						SUM(A.PACK_CNT) OUTPUT_CNT,
						RIGHT(A.GOODS_OUT_DATE ,2) PO_DATE
					FROM 
							TB_GOODS_PRODUCT_INFO_ADM A,
							TB_PURCHASE_ORDER_DTL C
							, TB_PURCHASE_ORDER_ADM B
						WHERE 
							B.PO_SEQ = C.PO_SEQ				
							AND C.BOX_NO = A.BOX_NO
							AND LEFT(A.GOODS_OUT_DATE,6) = #{fpDate}
					GROUP BY 
						B.GOODS_CD,RIGHT(A.GOODS_OUT_DATE ,2) 
				) A
				ON 1=1
				AND A.PO_DATE = RIGHT(B.DATE ,2)
				AND B.GOODS_CD = A.GOODS_CD
		
				LEFT OUTER JOIN
				(
					SELECT 	
						ISNULL( AA.DAY_,'') DAY_
						,ISNULL(AA.GOODS_CD,'') GOODS_CD								
						,SUM(APPEAR_OUTPUT_CNT) AS SUM_OUPUT_CNT              
					FROM
					(
						SELECT				                  
						
							ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT			
				
							, A.GOODS_CD
							, RIGHT(A.WORK_ORD_DATE,2) DAY_
							, EQUIP_CD
						FROM 
						(
							SELECT
								EQUIP_CD
								, A.WORK_ORD_NO 		                       
								, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								, B.GOODS_CD
								, WORK_ORD_DATE
							FROM  
								(SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo} GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A
								, TB_WORK_ORDER B
							WHERE 
								A.WORK_ORD_NO = B.WORK_ORD_NO
							GROUP BY 
								A.WORK_ORD_NO, B.GOODS_CD,WORK_ORD_DATE,EQUIP_CD
						) A 
						         
											              
					) AA
					GROUP BY 
						AA.GOODS_CD,DAY_	
				) D
				ON 1=1
				AND D.DAY_ = RIGHT(DATE ,2)
				AND D.GOODS_CD = B.GOODS_CD
		
		
				LEFT OUTER JOIN
		
				TB_DAILY_INVEN_ADM C
				ON 1=1
				AND C.FP_DATE = LEFT(B.DATE,6)
				AND C.GOODS_CD = B.GOODS_CD
				AND GUBUN = '001'				
			) 
		
			SELECT 
				'' MODEL	 
				, GIJONG_NM
				,AA.DEAL_CORP_CD
				,(SELECT DEAL_CORP_NM FROM TB_DEAL_CORP_ADM WHERE DEAL_CORP_CD = AA.DEAL_CORP_CD) DEAL_CORP_NM
				,'' GOODS_CD
				,'' GOODS_NM
				,'' QUTY_NM
				,'1' GUBUN
				,0 LAST_MONTH_STOCK
				,[01] FP_DATE1,
				[02] FP_DATE2,
				[03] FP_DATE3,
				[04] FP_DATE4,
				[05] FP_DATE5,
				[06] FP_DATE6,
				[07] FP_DATE7,
				[08] FP_DATE8,
				[09] FP_DATE9,
				[10] FP_DATE10,
				[11] FP_DATE11,
				[12] FP_DATE12,
				[13] FP_DATE13,
				[14] FP_DATE14,
				[15] FP_DATE15,
				[16] FP_DATE16,
				[17] FP_DATE17,
				[18] FP_DATE18,
				[19] FP_DATE19,
				[20] FP_DATE20,
				[21] FP_DATE21,
				[22] FP_DATE22,
				[23] FP_DATE23,
				[24] FP_DATE24,
				[25] FP_DATE25,
				[26] FP_DATE26,
				[27] FP_DATE27,
				[28] FP_DATE28,
				[29] FP_DATE29,
				[30] FP_DATE30,
				[31] FP_DATE31, 
				0 SUM_OUPUT_CNT
				,0 DATA_SUM
				,0 DATA_SUM_SUB
				,0 PLAN_CNT2
				,0 PLAN_CNT
				,0 EQUIP_CD
			FROM 
				(
					SELECT 	*			
					FROM (
						SELECT DISTINCT
							
								GIJONG_CD				
								,(SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '080' AND B.GIJONG_CD = X.BASE_CD) GIJONG_NM
								,COUNT(X.DEAL_CORP_CD) OVER(PARTITION BY GIJONG_CD) CNT			
								,X.DEAL_CORP_CD
							FROM 
								TB_GOODS_CODE_ADM B
								LEFT OUTER JOIN
								TB_PURCHASE_ORDER_ADM X
								ON 1=1
								AND B.GOODS_CD = X.GOODS_CD
								AND LEFT(DELIVERY_DATE,6) = #{fpDate}
							WHERE 
								B.GIJONG_CD != ''
								AND B.GIJONG_CD IS NOT NULL
								AND B.USE_YN_CD = '001'
					) AA					
					WHERE ((AA.CNT > 0 AND DEAL_CORP_CD IS NOT NULL)  OR ( CNT = 0 AND DEAL_CORP_CD IS NULL))
					
				) AA
			
				LEFT OUTER JOIN
			
				(
					SELECT * 
					FROM	(
							SELECT 
								
								(SELECT GIJONG_CD FROM TB_GOODS_CODE_ADM WHERE GOODS_CD = X.GOODS_CD) GIJONG_CD,
								PO_QTY,					
								DEAL_CORP_CD ,
								RIGHT(DELIVERY_DATE,2) DELIVERY_DATE 
							FROM 
								TB_PURCHASE_ORDER_ADM X
							WHERE 
								LEFT(DELIVERY_DATE,6) = #{fpDate}
			
						) A
					PIVOT(SUM(PO_QTY) FOR DELIVERY_DATE IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																	, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																	, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																	, [31]
					)) AS PVIOT
				) BB
			
				ON 1=1
				AND AA.GIJONG_CD = BB.GIJONG_CD
				AND AA.DEAL_CORP_CD = BB.DEAL_CORP_CD
			
			
			UNION ALL
			
			SELECT 
				'' MODEL	 
				, GIJONG_NM
				,AA.DEAL_CORP_CD
				,(SELECT DEAL_CORP_NM FROM TB_DEAL_CORP_ADM WHERE DEAL_CORP_CD = AA.DEAL_CORP_CD) DEAL_CORP_NM
				,'' GOODS_CD
				,'' GOODS_NM
				,'' QUTY_NM
				,'2' GUBUN
				,0 LAST_MONTH_STOCK
				,[01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
				, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
				, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
				, [31]
				, 0 DATA_SUM
				, ( 
					ISNULL([01],0) +
					ISNULL([02],0) +
					ISNULL([03],0) +
					ISNULL([04],0) +
					ISNULL([05],0) +
					ISNULL([06],0) +
					ISNULL([07],0) +
					ISNULL([08],0) +
					ISNULL([09],0) +
					ISNULL([10],0) +
					ISNULL([11],0) +
					ISNULL([12],0) +
					ISNULL([13],0) +
					ISNULL([14],0) +
					ISNULL([15],0) +
					ISNULL([16],0) +
					ISNULL([17],0) +
					ISNULL([18],0) +
					ISNULL([19],0) +
					ISNULL([20],0) +
					ISNULL([21],0) +
					ISNULL([22],0) +
					ISNULL([23],0) +
					ISNULL([24],0) +
					ISNULL([25],0) +
					ISNULL([26],0) +
					ISNULL([27],0) +
					ISNULL([28],0) +
					ISNULL([29],0) +
					ISNULL([30],0) +
					ISNULL([31],0)  
				) DATA_SUM
				,0 DATA_SUM_SUB
				,0 PLAN_CNT2
				,0 PLAN_CNT
				,0 EQUIP_CD
			FROM 
				(
					SELECT 	*			
					FROM ( 
						SELECT DISTINCT
						
							GIJONG_CD				
							,(SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '080' AND B.GIJONG_CD = X.BASE_CD) GIJONG_NM	
							,COUNT(X.DEAL_CORP_CD) OVER(PARTITION BY GIJONG_CD) CNT		
							,X.DEAL_CORP_CD
						FROM 
							TB_GOODS_CODE_ADM B
							LEFT OUTER JOIN
							TB_PURCHASE_ORDER_ADM X
							ON 1=1
							AND B.GOODS_CD = X.GOODS_CD
							AND LEFT(DELIVERY_DATE,6) = #{fpDate}
						WHERE 
							B.GIJONG_CD != ''
							AND B.GIJONG_CD IS NOT NULL
							AND B.USE_YN_CD = '001'
					) AA
					WHERE ((AA.CNT > 0 AND DEAL_CORP_CD IS NOT NULL)  OR ( CNT = 0 AND DEAL_CORP_CD IS NULL))
				) AA		
			
				
				LEFT OUTER JOIN
				(
					SELECT * 
					FROM (
						SELECT 				
							(SELECT GIJONG_CD FROM TB_GOODS_CODE_ADM WHERE GOODS_CD = B.GOODS_CD) GIJONG_CD,
							A.PACK_CNT OUTPUT_CNT,				
							DEAL_CORP_CD,
							RIGHT(A.GOODS_OUT_DATE,2) PO_DATE 
						FROM 
							TB_GOODS_PRODUCT_INFO_ADM A,
							TB_PURCHASE_ORDER_DTL C
							, TB_PURCHASE_ORDER_ADM B
						WHERE 
							B.PO_SEQ = C.PO_SEQ				
							AND C.BOX_NO = A.BOX_NO
							AND LEFT(A.GOODS_OUT_DATE,6) = #{fpDate}
					) A
					PIVOT(SUM(OUTPUT_CNT) FOR PO_DATE IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																	, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																	, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																	, [31]				
					)) AS PVIOT
				) BB
				ON 1=1
				AND AA.GIJONG_CD = BB.GIJONG_CD
				AND AA.DEAL_CORP_CD = BB.DEAL_CORP_CD
			
				
			UNION ALL
			
		
			SELECT PVIOT.*
				,[${lastDate}] SUM_OUTPUT_CNT
				,0 SUM_CNT
				,(SELECT TOP(1) MAX(PLAN_CNT)
					FROM TB_MONTH_PRODUCTION_PLAN_DTL
					WHERE LEFT(FP_DATE,6) = #{fpDate}
					AND GOODS_CD = PVIOT.GOODS_CD
					AND CPL_GUBUN = '002'
					AND OP_TIME = '24') DATA_SUM_SUB
				,[${yesterDayF}] / (SELECT TOP(1) MAX(PLAN_CNT)
					FROM TB_MONTH_PRODUCTION_PLAN_DTL
					WHERE LEFT(FP_DATE,6) = #{fpDate}
					AND GOODS_CD = PVIOT.GOODS_CD
					AND CPL_GUBUN = '002'
					AND OP_TIME = '24') PLAN_CNT2
				
				,[${lastDate}] / (SELECT TOP(1) MAX(PLAN_CNT)
					FROM TB_MONTH_PRODUCTION_PLAN_DTL
					WHERE LEFT(FP_DATE,6) = #{fpDate}
					AND GOODS_CD = PVIOT.GOODS_CD
					AND CPL_GUBUN = '002'
					AND OP_TIME = '24') PLAN_CNT
				,		
					
				(
				SELECT 
					COUNT(EQUIP_CD) EQUIP_CD 		
				FROM (
					SELECT
						DISTINCT
							B.GOODS_CD
							,LEFT(EQUIP_CD,10) EQUIP_CD			
					FROM  
						(SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo} GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A
						, TB_WORK_ORDER B
					WHERE 
						A.WORK_ORD_NO = B.WORK_ORD_NO
						AND GOODS_CD = PVIOT.GOODS_CD
			
					GROUP BY 
							B.GOODS_CD,LEFT(EQUIP_CD,10)
				) A	
				GROUP BY
					GOODS_CD
				) EQUIP_CD
			
			FROM (
			
				SELECT X.* 
				FROM MAIN X
			
			) AA
			PIVOT(MAX(OUTPUT_CNT) FOR PO_DATE IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
															, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
															, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
															, [31]
			)) AS PVIOT

			ORDER BY 				
				GIJONG_NM,GOODS_CD,DEAL_CORP_CD,GUBUN
		
	
		]]>
	
	</select>
	
		<!-- 기종별일일재고 실데이터 -->
	<select id="gijongDailyPlan2" resultMap="MonthProductionPlanVo" >		
	
		
<!--			WITH MAIN AS (
 				SELECT 
					B.MODEL
					, B.GIJONG_NM
					,'99999' DEAL_CORP_CD
					,'' DEAL_CORP_NM
					,B.GOODS_CD
					,B.GOODS_NM
					,B.QUTY_NM
					,'3' GUBUN
					,ISNULL(LAST_MONTH_STOCK,0) LAST_MONTH_STOCK
					,RIGHT(B.DATE ,2) PO_DATE
					, ISNULL(SUM(ISNULL(SUM_OUPUT_CNT,0)  - ISNULL(OUTPUT_CNT,0)) OVER(PARTITION BY B.GOODS_CD ORDER BY B.GOODS_CD,RIGHT(B.DATE ,2)),0) + ISNULL(LAST_MONTH_STOCK,0) OUTPUT_CNT				
				FROM (
						SELECT 
							GOODS_CD
							,GOODS_NM
							,GIJONG_CD
							,MODEL
							,GIJONG_NM
							,QUTY_CD
							,QUTY_NM
							,DATE 
				
						FROM ( 
							SELECT DISTINCT
								B.GOODS_CD 
								,GOODS_NM
								,GIJONG_CD
								,MODEL
								,(SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '080' AND B.GIJONG_CD = X.BASE_CD) GIJONG_NM
								,C.QUTY_CD
								,(SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '007' AND C.QUTY_CD = X.BASE_CD) QUTY_NM
							FROM 
								TB_GOODS_CODE_ADM B
								,TB_MATRL_CODE_ADM C
								,TB_PURCHASE_ORDER_ADM X
							WHERE 
								B.GIJONG_CD != ''
								AND B.GIJONG_CD IS NOT NULL
								AND B.USE_YN_CD = '001'
								AND B.ALNICU_MATRL_CD = C.MATRL_CD	
								AND B.GOODS_CD = X.GOODS_CD
								AND LEFT(DELIVERY_DATE,6) = #{fpDate}
						) A
						FULL OUTER JOIN
						(
							SELECT 
								DATE 		
							FROM 
								CALENDAR
							WHERE 
								LEFT(CALENDAR.DATE,6) = #{fpDate}
					
						) B
						ON 1=1
				) B
				LEFT OUTER JOIN
				(	
					SELECT 
						B.GOODS_CD,
						SUM(A.PACK_CNT) OUTPUT_CNT,
						RIGHT(A.GOODS_OUT_DATE ,2) PO_DATE
					FROM 
							TB_GOODS_PRODUCT_INFO_ADM A,
							TB_PURCHASE_ORDER_DTL C
							, TB_PURCHASE_ORDER_ADM B
						WHERE 
							B.PO_SEQ = C.PO_SEQ				
							AND C.BOX_NO = A.BOX_NO
							AND LEFT(A.GOODS_OUT_DATE,6) = #{fpDate}
					GROUP BY 
						B.GOODS_CD,RIGHT(A.GOODS_OUT_DATE ,2) 
				) A
				ON 1=1
				AND A.PO_DATE = RIGHT(B.DATE ,2)
				AND B.GOODS_CD = A.GOODS_CD
		
				LEFT OUTER JOIN
				(
					SELECT 	
						ISNULL( AA.DAY_,'') DAY_
						,ISNULL(AA.GOODS_CD,'') GOODS_CD								
						,SUM(APPEAR_OUTPUT_CNT) AS SUM_OUPUT_CNT              
					FROM
					(
						SELECT				                  
						
							ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT			
				
							, A.GOODS_CD
							, RIGHT(A.WORK_ORD_DATE,2) DAY_
							, EQUIP_CD
						FROM 
						(
							SELECT
								EQUIP_CD
								, A.WORK_ORD_NO 		                       
								, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								, B.GOODS_CD
								, WORK_ORD_DATE
							FROM  
								(SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo} GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A
								, TB_WORK_ORDER B
							WHERE 
								A.WORK_ORD_NO = B.WORK_ORD_NO
							GROUP BY 
								A.WORK_ORD_NO, B.GOODS_CD,WORK_ORD_DATE,EQUIP_CD
						) A 
						         
											              
					) AA
					GROUP BY 
						AA.GOODS_CD,DAY_	
				) D
				ON 1=1
				AND D.DAY_ = RIGHT(DATE ,2)
				AND D.GOODS_CD = B.GOODS_CD
		
		
				LEFT OUTER JOIN
		
				TB_DAILY_INVEN_ADM C
				ON 1=1
				AND C.FP_DATE = LEFT(B.DATE,6)
				AND C.GOODS_CD = B.GOODS_CD
				AND GUBUN = '001'				
			) 
		 -->
			<![CDATA[
			WITH MAIN AS (
			
				SELECT 
					B.MODEL
					, B.GIJONG_NM
					,'99999' DEAL_CORP_CD
					,'' DEAL_CORP_NM
					,B.GOODS_CD
					,B.GOODS_NM
					,B.QUTY_NM
					,'3' GUBUN
					,ISNULL(LAST_MONTH_STOCK,0) LAST_MONTH_STOCK
					,RIGHT(B.DATE ,2) PO_DATE
					, ISNULL(SUM(ISNULL(ISNULL(E.SUM_OUPUT_CNT,D.SUM_OUPUT_CNT),0) - ISNULL(ISNULL(A.OUTPUT_CNT,C.OUTPUT_CNT),0) ) OVER(PARTITION BY B.GOODS_CD ORDER BY B.GOODS_CD,RIGHT(B.DATE ,2)),0)   + ISNULL(LAST_MONTH_STOCK,0) OUTPUT_CNT				
				FROM (
						SELECT 
							GOODS_CD
							,GOODS_NM
							,GIJONG_CD
							,MODEL
							,GIJONG_NM
							,QUTY_CD
							,QUTY_NM
							,DATE 
				
						FROM ( 
							SELECT DISTINCT
								B.GOODS_CD 
								,GOODS_NM
								,GIJONG_CD
								,MODEL
								,(SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '080' AND B.GIJONG_CD = X.BASE_CD) GIJONG_NM
								,C.QUTY_CD
								,(SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '007' AND C.QUTY_CD = X.BASE_CD) QUTY_NM
							FROM 
								TB_MATRL_CODE_ADM C,
								TB_GOODS_CODE_ADM B							
								LEFT OUTER JOIN
								TB_PURCHASE_ORDER_ADM X
								ON 1=1
								AND B.GOODS_CD = X.GOODS_CD
								AND LEFT(DELIVERY_DATE,6) = #{fpDate}
							WHERE 
								B.GIJONG_CD != ''
								AND B.GIJONG_CD IS NOT NULL
								AND B.USE_YN_CD = '001'
								AND C.USE_YN_CD = '001'
								AND B.GOODS_SAMPLE_YN = '001'
								AND B.GIJONG_CD != '012'
								AND C.MATRL_CD = B.ALNICU_MATRL_CD
						) A
						FULL OUTER JOIN
						(
							SELECT 
								DATE 		
							FROM 
								CALENDAR
							WHERE 
								LEFT(CALENDAR.DATE,6) = #{fpDate}
					
						) B
						ON 1=1
				) B
				LEFT OUTER JOIN
				(	
					SELECT 
						B.GOODS_CD,
						SUM(CAST(A.PACK_CNT AS BIGINT)) OUTPUT_CNT,
						RIGHT(A.GOODS_OUT_DATE ,2) PO_DATE
					FROM 
							TB_GOODS_PRODUCT_INFO_ADM A,
							TB_PURCHASE_ORDER_DTL C
							, TB_PURCHASE_ORDER_ADM B
						WHERE 
							B.PO_SEQ = C.PO_SEQ				
							AND C.BOX_NO = A.BOX_NO
							AND LEFT(A.GOODS_OUT_DATE,6) = #{fpDate}
					GROUP BY 
						B.GOODS_CD,RIGHT(A.GOODS_OUT_DATE ,2) 
				) A
				ON 1=1
				AND A.PO_DATE = RIGHT(B.DATE ,2)
				AND B.GOODS_CD = A.GOODS_CD

				LEFT OUTER JOIN
				(	
					SELECT 
						A.GOODS_CD,
						SUM(CONVERT(NUMERIC(18,2),A.OUTPUT_CNT)) OUTPUT_CNT,
						RIGHT(A.FP_DATE ,2) PO_DATE
					FROM 
							TB_DAILY_INVEN_DTL A							
						WHERE 							
							LEFT(A.FP_DATE,6) = #{fpDate}
					GROUP BY 
						A.GOODS_CD,RIGHT(A.FP_DATE ,2) 
				) C
				ON 1=1
				AND C.PO_DATE = RIGHT(B.DATE ,2)
				AND B.GOODS_CD = C.GOODS_CD
		
				LEFT OUTER JOIN
				(
					SELECT 	
						ISNULL( AA.DAY_,'') DAY_
						,ISNULL(AA.GOODS_CD,'') GOODS_CD								
						,SUM(APPEAR_OUTPUT_CNT) AS SUM_OUPUT_CNT              
					FROM
					(
						SELECT				                  
						
							ISNULL(A.PLAN_CNT,0) AS APPEAR_OUTPUT_CNT
							, A.GOODS_CD
							, RIGHT(A.FP_DATE,2) DAY_
							
						FROM 
						(
							SELECT								
								SUM(PLAN_CNT) AS PLAN_CNT						 
								, GOODS_CD
								, FP_DATE
							FROM  
								TB_MONTH_PRODUCTION_PLAN_DTL
							WHERE 
								LEFT(FP_DATE,6) = #{fpDate}
								AND CPL_GUBUN = '002'
							GROUP BY 
								GOODS_CD,FP_DATE
						) A 
						         
											              
					) AA
					GROUP BY 
						AA.GOODS_CD,DAY_	
				) D
				ON 1=1
				AND D.DAY_ = RIGHT(DATE ,2)
				AND D.GOODS_CD = B.GOODS_CD

				LEFT OUTER JOIN
				(
					SELECT 	
						ISNULL( AA.DAY_,'') DAY_
						,ISNULL(AA.GOODS_CD,'') GOODS_CD								
						,SUM(APPEAR_OUTPUT_CNT) AS SUM_OUPUT_CNT              
					FROM
					(
						SELECT				                  
						
							ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT			
				
							, A.GOODS_CD
							, RIGHT(A.WORK_ORD_DATE,2) DAY_
							, EQUIP_CD
						FROM 
						(
							SELECT
								EQUIP_CD
								, A.WORK_ORD_NO 		                       
								, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								, B.GOODS_CD
								, WORK_ORD_DATE
							FROM  
								(SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo} GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A
								, TB_WORK_ORDER B
							WHERE 
								A.WORK_ORD_NO = B.WORK_ORD_NO
							GROUP BY 
								A.WORK_ORD_NO, B.GOODS_CD,WORK_ORD_DATE,EQUIP_CD
						) A 
						         
											              
					) AA
					GROUP BY 
						AA.GOODS_CD,DAY_	
				) E
				ON 1=1
				AND E.DAY_ = RIGHT(DATE ,2)
				AND E.GOODS_CD = B.GOODS_CD
		
		
				LEFT OUTER JOIN
		
				TB_DAILY_INVEN_ADM F
				ON 1=1
				AND F.FP_DATE = LEFT(B.DATE,6)
				AND F.GOODS_CD = B.GOODS_CD
				AND GUBUN = '001'
			
			
			)
			
			SELECT 
				'' MODEL	 
				, GIJONG_NM
				,AA.DEAL_CORP_CD
				,(SELECT DEAL_CORP_NM FROM TB_DEAL_CORP_ADM WHERE DEAL_CORP_CD = AA.DEAL_CORP_CD) DEAL_CORP_NM
				,'' GOODS_CD
				,'' GOODS_NM
				,'' QUTY_NM
				,'1' GUBUN
				,0 LAST_MONTH_STOCK
				,[01] FP_DATE1,
				[02] FP_DATE2,
				[03] FP_DATE3,
				[04] FP_DATE4,
				[05] FP_DATE5,
				[06] FP_DATE6,
				[07] FP_DATE7,
				[08] FP_DATE8,
				[09] FP_DATE9,
				[10] FP_DATE10,
				[11] FP_DATE11,
				[12] FP_DATE12,
				[13] FP_DATE13,
				[14] FP_DATE14,
				[15] FP_DATE15,
				[16] FP_DATE16,
				[17] FP_DATE17,
				[18] FP_DATE18,
				[19] FP_DATE19,
				[20] FP_DATE20,
				[21] FP_DATE21,
				[22] FP_DATE22,
				[23] FP_DATE23,
				[24] FP_DATE24,
				[25] FP_DATE25,
				[26] FP_DATE26,
				[27] FP_DATE27,
				[28] FP_DATE28,
				[29] FP_DATE29,
				[30] FP_DATE30,
				[31] FP_DATE31, 
				0 SUM_OUPUT_CNT
				,0 DATA_SUM
				,0 DATA_SUM_SUB
				,0 PLAN_CNT2
				,0 PLAN_CNT
				,0 EQUIP_CD
			FROM 
				(
					SELECT 	*			
					FROM ( 
						SELECT DISTINCT
							GIJONG_CD			
							,(SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '080' AND B.GIJONG_CD = X.BASE_CD) GIJONG_NM	
							,COUNT(X.DEAL_CORP_CD) OVER(PARTITION BY GIJONG_CD) CNT		
							,X.DEAL_CORP_CD
						FROM 
							TB_MATRL_CODE_ADM C,
							TB_GOODS_CODE_ADM B							
							LEFT OUTER JOIN
							TB_DAILY_INVEN_DTL X
							ON 1=1
							AND X.GOODS_CD = B.GOODS_CD
							AND LEFT(FP_DATE,6) = #{fpDate}
						WHERE 
							B.GIJONG_CD != ''
							AND B.GIJONG_CD IS NOT NULL
							AND B.USE_YN_CD = '001'
							AND B.ALNICU_MATRL_CD = C.MATRL_CD
						

					) AA
					WHERE ((AA.CNT > 0 AND DEAL_CORP_CD IS NOT NULL)  OR ( CNT = 0 AND DEAL_CORP_CD IS NULL))
				) AA
			
				LEFT OUTER JOIN
			
				(
					SELECT * 
					FROM	(
								SELECT 
									 GIJONG_CD
									, SUM(CONVERT(NUMERIC(18,2),OUTPUT_CNT)) OUTPUT_CNT
									, A.DEAL_CORP_CD
									, RIGHT(FP_DATE,2) FP_DATE
								FROM 
									TB_DAILY_INVEN_DTL A, TB_GOODS_CODE_ADM B
								WHERE 
									LEFT(A.FP_DATE,6) = #{fpDate}
									AND OUT_GUBUN = '001'		
									AND A.GOODS_CD = B.GOODS_CD
								GROUP BY GIJONG_CD,A.DEAL_CORP_CD,RIGHT(FP_DATE,2)							
			
						) A
					PIVOT(SUM(OUTPUT_CNT) FOR FP_DATE IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																	, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																	, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																	, [31]
					)) AS PVIOT
				) BB
			
				ON 1=1
				AND AA.GIJONG_CD = BB.GIJONG_CD
				AND AA.DEAL_CORP_CD = BB.DEAL_CORP_CD
			
			UNION ALL
			
			SELECT 
				'' MODEL	 
				, GIJONG_NM
				, ISNULL(AA.DEAL_CORP_CD,'99998') DEAL_CORP_CD
				,(SELECT DEAL_CORP_NM FROM TB_DEAL_CORP_ADM WHERE DEAL_CORP_CD = AA.DEAL_CORP_CD) DEAL_CORP_NM
				,'' GOODS_CD
				,'' GOODS_NM
				,'' QUTY_NM
				,'2' GUBUN
				,0 LAST_MONTH_STOCK
				,[01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
				, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
				, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
				, [31]
				, 0 DATA_SUM
				, ( 
					ISNULL([01],0) +
					ISNULL([02],0) +
					ISNULL([03],0) +
					ISNULL([04],0) +
					ISNULL([05],0) +
					ISNULL([06],0) +
					ISNULL([07],0) +
					ISNULL([08],0) +
					ISNULL([09],0) +
					ISNULL([10],0) +
					ISNULL([11],0) +
					ISNULL([12],0) +
					ISNULL([13],0) +
					ISNULL([14],0) +
					ISNULL([15],0) +
					ISNULL([16],0) +
					ISNULL([17],0) +
					ISNULL([18],0) +
					ISNULL([19],0) +
					ISNULL([20],0) +
					ISNULL([21],0) +
					ISNULL([22],0) +
					ISNULL([23],0) +
					ISNULL([24],0) +
					ISNULL([25],0) +
					ISNULL([26],0) +
					ISNULL([27],0) +
					ISNULL([28],0) +
					ISNULL([29],0) +
					ISNULL([30],0) +
					ISNULL([31],0)  
				) DATA_SUM
				,0 DATA_SUM_SUB
				,0 PLAN_CNT2
				,0 PLAN_CNT
				,0 EQUIP_CD
			FROM 
				(
					SELECT 	*			
					FROM ( 
						SELECT DISTINCT
						
							GIJONG_CD				
							,(SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '080' AND B.GIJONG_CD = X.BASE_CD) GIJONG_NM	
							,COUNT(X.DEAL_CORP_CD) OVER(PARTITION BY GIJONG_CD) CNT		
							,X.DEAL_CORP_CD
						FROM 
							TB_GOODS_CODE_ADM B
							LEFT OUTER JOIN
							TB_PURCHASE_ORDER_ADM X
							ON 1=1
							AND B.GOODS_CD = X.GOODS_CD
							AND LEFT(DELIVERY_DATE,6) = #{fpDate}
						WHERE 
							B.GIJONG_CD != ''
							AND B.GIJONG_CD IS NOT NULL
							AND B.USE_YN_CD = '001'
							
					) AA
					WHERE ((AA.CNT > 0 AND DEAL_CORP_CD IS NOT NULL)  OR ( CNT = 0 AND DEAL_CORP_CD IS NULL))
				) AA		
			
				
				LEFT OUTER JOIN
				(
					SELECT * 
					FROM (
						SELECT 				
							(SELECT GIJONG_CD FROM TB_GOODS_CODE_ADM WHERE GOODS_CD = B.GOODS_CD) GIJONG_CD,
							A.PACK_CNT OUTPUT_CNT,				
							DEAL_CORP_CD,
							RIGHT(A.GOODS_OUT_DATE,2) PO_DATE 
						FROM 
							TB_GOODS_PRODUCT_INFO_ADM A,
							TB_PURCHASE_ORDER_DTL C
							, TB_PURCHASE_ORDER_ADM B
						WHERE 
							B.PO_SEQ = C.PO_SEQ				
							AND C.BOX_NO = A.BOX_NO
							AND LEFT(A.GOODS_OUT_DATE,6) = #{fpDate}
					) A
					PIVOT(SUM(OUTPUT_CNT) FOR PO_DATE IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																	, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																	, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																	, [31]				
					)) AS PVIOT
				) BB
				ON 1=1
				AND AA.GIJONG_CD = BB.GIJONG_CD
				AND AA.DEAL_CORP_CD = BB.DEAL_CORP_CD
			
			UNION ALL
			
		
			SELECT PVIOT.*
				,[${lastDate}] SUM_OUTPUT_CNT
				,0 SUM_CNT
				,(SELECT TOP(1) MAX(PLAN_CNT)
					FROM TB_MONTH_PRODUCTION_PLAN_DTL
					WHERE LEFT(FP_DATE,6) = #{fpDate}
					AND GOODS_CD = PVIOT.GOODS_CD
					AND CPL_GUBUN = '002'
					AND OP_TIME = '24') DATA_SUM_SUB
				,[${yesterDayF}] / (SELECT TOP(1) MAX(PLAN_CNT)
					FROM TB_MONTH_PRODUCTION_PLAN_DTL
					WHERE LEFT(FP_DATE,6) = #{fpDate}
					AND GOODS_CD = PVIOT.GOODS_CD
					AND CPL_GUBUN = '002'
					AND OP_TIME = '24') PLAN_CNT2
				
				,[${lastDate}] / (SELECT TOP(1) MAX(PLAN_CNT)
					FROM TB_MONTH_PRODUCTION_PLAN_DTL
					WHERE LEFT(FP_DATE,6) = #{fpDate}
					AND GOODS_CD = PVIOT.GOODS_CD
					AND CPL_GUBUN = '002'
					AND OP_TIME = '24') PLAN_CNT
				,		
					
				(
				SELECT 
					COUNT(EQUIP_CD) EQUIP_CD 		
				FROM (
					SELECT
						DISTINCT
							B.GOODS_CD
							,LEFT(EQUIP_CD,10) EQUIP_CD			
					FROM  
						(SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo} GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A
						, TB_WORK_ORDER B
					WHERE 
						A.WORK_ORD_NO = B.WORK_ORD_NO
						AND GOODS_CD = PVIOT.GOODS_CD
			
					GROUP BY 
							B.GOODS_CD,LEFT(EQUIP_CD,10)
				) A	
				GROUP BY
					GOODS_CD
				) EQUIP_CD
			
			FROM (
			
				SELECT X.* 
				FROM MAIN X
			
			) AA
			PIVOT(MAX(OUTPUT_CNT) FOR PO_DATE IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
															, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
															, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
															, [31]
			)) AS PVIOT

			ORDER BY 				
				GIJONG_NM,GOODS_CD,DEAL_CORP_CD,GUBUN
		
		
		
	
		]]>
	
	</select>
	
	<!-- 다음달 재고 예상 등록 (입력)-->
	<insert id="createNextMonthStock">
		INSERT INTO TB_DAILY_INVEN_ADM
			(	
				GUBUN
				,GOODS_CD
				,FP_DATE
				,LAST_MONTH_STOCK
				,REG_ID
				,REG_DATE
			)			

			SELECT
				'002' GUBUN
				,GOODS_CD
				,#{nextMonth} FP_DATE
				,[${lastDate}] SUM_OUTPUT_CNT		
				,'admin' REG_ID
				,GETDATE() REG_DATE
			
			FROM (
			
				SELECT 
					B.MODEL
					, B.GIJONG_NM
					,'99999' DEAL_CORP_CD
					,'' DEAL_CORP_NM
					,B.GOODS_CD
					,B.GOODS_NM
					,B.QUTY_NM
					,'3' GUBUN
					,ISNULL(LAST_MONTH_STOCK,0) LAST_MONTH_STOCK
					,RIGHT(B.DATE ,2) PO_DATE
					, ISNULL(SUM(ISNULL(SUM_OUPUT_CNT,0)  - ISNULL(OUTPUT_CNT,0)) OVER(PARTITION BY B.GOODS_CD ORDER BY B.GOODS_CD,RIGHT(B.DATE ,2)),0) + ISNULL(LAST_MONTH_STOCK,0) OUTPUT_CNT			
				FROM (
						SELECT 
							GOODS_CD
							,GOODS_NM
							,GIJONG_CD
							,MODEL
							,GIJONG_NM
							,QUTY_CD
							,QUTY_NM
							,DATE 
				
						FROM ( 
							SELECT 
								GOODS_CD 
								,GOODS_NM
								,GIJONG_CD
								,MODEL
								,(SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '080' AND B.GIJONG_CD = X.BASE_CD) GIJONG_NM
								,C.QUTY_CD
								,(SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '007' AND C.QUTY_CD = X.BASE_CD) QUTY_NM
							FROM 
								TB_GOODS_CODE_ADM B
								,TB_MATRL_CODE_ADM C
							WHERE 
								B.GIJONG_CD != ''
								AND B.GIJONG_CD IS NOT NULL
								AND B.USE_YN_CD = '001'
								AND B.ALNICU_MATRL_CD = C.MATRL_CD
						) A
						FULL OUTER JOIN
						(
							SELECT 
								DATE 		
							FROM 
								CALENDAR
							WHERE 
								LEFT(CALENDAR.DATE,6) = #{fpDate}
					
						) B
						ON 1=1
				) B
				LEFT OUTER JOIN
				(	
					SELECT 
						GOODS_CD,
						SUM(CONVERT(INT,A.OUTPUT_CNT)) OUTPUT_CNT,
						RIGHT(A.FP_DATE ,2) FP_DATE
					FROM 
						TB_DAILY_INVEN_DTL A	
					WHERE LEFT(A.FP_DATE,6) = #{fpDate}
					AND OUT_GUBUN = '002'
					GROUP BY 
						GOODS_CD,RIGHT(A.FP_DATE ,2) 
				) A
				ON 1=1
				AND A.FP_DATE = RIGHT(B.DATE ,2)
				AND B.GOODS_CD = A.GOODS_CD
		
				LEFT OUTER JOIN
				(
					SELECT 	
						ISNULL( AA.FP_DATE,'') DAY_
						,ISNULL(AA.GOODS_CD,'') GOODS_CD								
						,SUM(PLAN_CNT) AS SUM_OUPUT_CNT                 
					FROM
					(
					SELECT PLAN_CNT,RIGHT(FP_DATE,2) FP_DATE,GOODS_CD
					FROM TB_MONTH_PRODUCTION_PLAN_DTL
					WHERE  LEFT(FP_DATE,6) = #{fpDate}
					AND CPL_GUBUN = '002'
									              
				) AA
				GROUP BY FP_DATE,GOODS_CD
				) D
				ON 1=1
				AND D.DAY_ = RIGHT(DATE ,2)
				AND D.GOODS_CD = B.GOODS_CD
		
		
				LEFT OUTER JOIN
		
				TB_DAILY_INVEN_ADM C
				ON 1=1
				AND C.FP_DATE = LEFT(B.DATE,6)
				AND C.GOODS_CD = B.GOODS_CD
				AND GUBUN = '002'
			
			
			) AA
			PIVOT(MAX(OUTPUT_CNT) FOR PO_DATE IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
															, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
															, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
															, [31]
			)) AS PVIOT
	</insert >
	
		<!-- 다음달 재고 예상 등록 (실데이터)-->
	<insert id="createNextMonthStockReal">
		INSERT INTO TB_DAILY_INVEN_ADM
			(	
				GUBUN
				,GOODS_CD
				,FP_DATE
				,LAST_MONTH_STOCK
				,REG_ID
				,REG_DATE
			)			

			SELECT
				'001' GUBUN
				,GOODS_CD
				,#{nextMonth} FP_DATE
				,[${lastDate}] SUM_OUTPUT_CNT		
				,'admin' REG_ID
				,GETDATE() REG_DATE
				FROM
				(
				SELECT 
					B.MODEL
					, B.GIJONG_NM
					,'99999' DEAL_CORP_CD
					,'' DEAL_CORP_NM
					,B.GOODS_CD
					,B.GOODS_NM
					,B.QUTY_NM
					,'3' GUBUN
					,ISNULL(LAST_MONTH_STOCK,0) LAST_MONTH_STOCK
					,RIGHT(B.DATE ,2) PO_DATE
					, ISNULL(SUM(ISNULL(SUM_OUPUT_CNT,0)  - ISNULL(OUTPUT_CNT,0)) OVER(PARTITION BY B.GOODS_CD ORDER BY B.GOODS_CD,RIGHT(B.DATE ,2)),0) + ISNULL(LAST_MONTH_STOCK,0) OUTPUT_CNT	
					
				FROM (
						SELECT 
							GOODS_CD
							,GOODS_NM
							,GIJONG_CD
							,MODEL
							,GIJONG_NM
							,QUTY_CD
							,QUTY_NM
							,DATE 
				
						FROM ( 
							SELECT 
								GOODS_CD 
								,GOODS_NM
								,GIJONG_CD
								,MODEL
								,(SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '080' AND B.GIJONG_CD = X.BASE_CD) GIJONG_NM
								,C.QUTY_CD
								,(SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE X WHERE  X.BASE_GROUP_CD = '007' AND C.QUTY_CD = X.BASE_CD) QUTY_NM
							FROM 
								TB_GOODS_CODE_ADM B
								,TB_MATRL_CODE_ADM C
							WHERE 
								B.GIJONG_CD != ''
								AND B.GIJONG_CD IS NOT NULL
								AND B.USE_YN_CD = '001'
								AND B.ALNICU_MATRL_CD = C.MATRL_CD
						) A
						FULL OUTER JOIN
						(
							SELECT 
								DATE 		
							FROM 
								CALENDAR
							WHERE 
								LEFT(CALENDAR.DATE,6) = #{fpDate}
					
						) B
						ON 1=1
				) B
				LEFT OUTER JOIN
				(	
					SELECT 
						B.GOODS_CD,
						SUM(A.PACK_CNT) OUTPUT_CNT,
						RIGHT(A.GOODS_OUT_DATE ,2) PO_DATE
					FROM 
							TB_GOODS_PRODUCT_INFO_ADM A,
							TB_PURCHASE_ORDER_DTL C
							, TB_PURCHASE_ORDER_ADM B
						WHERE 
							B.PO_SEQ = C.PO_SEQ				
							AND C.BOX_NO = A.BOX_NO
							AND LEFT(A.GOODS_OUT_DATE,6) = #{fpDate}
					GROUP BY 
						B.GOODS_CD,RIGHT(A.GOODS_OUT_DATE ,2)
				) A
				ON 1=1
				AND A.PO_DATE = RIGHT(B.DATE ,2)
				AND B.GOODS_CD = A.GOODS_CD
		
				LEFT OUTER JOIN
				(
					SELECT 	
						ISNULL( AA.DAY_,'') DAY_
						,ISNULL(AA.GOODS_CD,'') GOODS_CD								
						,SUM(APPEAR_OUTPUT_CNT) AS SUM_OUPUT_CNT                 
					FROM
					(
						SELECT				                  
							
							 ISNULL(A.APPEAR_OUTPUT_CNT,0) AS APPEAR_OUTPUT_CNT
							, A.GOODS_CD
							, RIGHT(A.WORK_ORD_DATE,2) DAY_
							, EQUIP_CD
						FROM 
						(
							SELECT
								EQUIP_CD
								, A.WORK_ORD_NO 		                       
								, SUM(A.OUTPUT_CNT) AS APPEAR_OUTPUT_CNT						 
								, B.GOODS_CD
								, WORK_ORD_DATE
							FROM  
								(SELECT DISTINCT SUM(OUTPUT_CNT) OUTPUT_CNT,WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDateFrom} AND #{chooseDateTo} GROUP BY WORK_ORD_NO,WORK_ORD_DATE) A
								, TB_WORK_ORDER B
							WHERE 
								A.WORK_ORD_NO = B.WORK_ORD_NO
							GROUP BY 
								A.WORK_ORD_NO, B.GOODS_CD,WORK_ORD_DATE,EQUIP_CD
						) A 						      
											              
					) AA
					GROUP BY 
						AA.GOODS_CD,DAY_	
				) D
				ON 1=1
				AND D.DAY_ = RIGHT(DATE ,2)
				AND D.GOODS_CD = B.GOODS_CD
		
		
				LEFT OUTER JOIN
		
				TB_DAILY_INVEN_ADM C
				ON 1=1
				AND C.FP_DATE = LEFT(B.DATE,6)
				AND C.GOODS_CD = B.GOODS_CD
				AND GUBUN = '001'
				) A
		

				PIVOT(SUM(OUTPUT_CNT) FOR PO_DATE IN ([01], [02], [03], [04], [05], [06], [07], [08], [09], [10]
																	, [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]
																	, [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]
																	, [31]				
				)) AS PVIOT	
	</insert >
</mapper>