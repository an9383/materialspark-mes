<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  	
<mapper namespace="mes.mappers.po.equipFaultyAdmMapper">

	<!-- 설비공정불량 -->
	<resultMap id="EquipPrcssFaultyAdmVo" type="mes.domain.po.EquipPrcssFaultyAdmVo">
		<result property="equipCd"				column="EQUIP_CD"				/>
		<result property="faultyRegDate"		column="FAULTY_REG_DATE"		/>
		<result property="dayNightCd"			column="DAY_NIGHT_CD"			/>
		<result property="prcsCnt"				column="PRCS_CNT"				/>
		<result property="prcsTotal"			column="PRCS_TOTAL"				/>
		<result property="prcsPms"				column="PRCS_PMS"				/>
		<result property="prcsPfs"				column="PRCS_PFS"				/>
		<result property="prcsPstab"			column="PRCS_PSTAB"				/>
		<result property="prcsPaliensbst"		column="PRCS_PALIENSBST"		/>
		<result property="prcsPpolutn"			column="PRCS_PPOLUTN"			/>
		<result property="prcsGilt"				column="PRCS_GILT"				/>
		<result property="prcsFbreak"			column="PRCS_FBREAK"			/>
		<result property="prcsFagglomt"			column="PRCS_FAGGLOMT"			/>
		<result property="prcsFpress"			column="PRCS_FPRESS"			/>
		<result property="prcsFtornout"			column="PRCS_FTORNOUT"			/>
		<result property="prcsTeflon"			column="PRCS_TEFLON"			/>
		<result property="prcsMargnDvat"		column="PRCS_MARGN_DVAT"		/>
		<result property="prcsThickness"		column="PRCS_THICKNESS"			/>
		<result property="prcsSurfceBb"			column="PRCS_SURFCE_BB"			/>
		<result property="prcsEdgeBb"			column="PRCS_EDGE_BB"			/>
		<result property="prcsMburr"			column="PRCS_MBURR"				/>
		<result property="prcsRburr"			column="PRCS_RBURR"				/>
		<result property="prcsSize"				column="PRCS_SIZE"				/>
		<result property="prcsLayer"			column="PRCS_LAYER"				/>
		<result property="prcsUnjinjeop"		column="PRCS_UNJINJEOP"			/>
		<result property="prcsUnattch"			column="PRCS_UNATTCH"			/>
		<result property="prcsFilmDepth"		column="PRCS_FILM_DEPTH"		/>
		<result property="regId"				column="REG_ID"					/>
		<result property="regDate"				column="REG_DATE"				/>
		<result property="updId"				column="UPD_ID"					/>
		<result property="updDate"				column="UPD_DATE"				/>
		<result property="gravity"				column="GRAVITY"				/>	
				
		<!-- 
		<result property="dayTotalPrcssSum"		column="DAY_TOTAL_PRCSS_SUM"	/>
		<result property="nightTotalPrcssSum"	column="NIGHT_TOTAL_PRCSS_SUM"	/>
		<result property="totalPrcssSum"		column="TOTAL_PRCSS_SUM"		/>
		 -->
		<!-- 불량내역조회(상세_wmsc0080) -->
		<result property="workOrdNo"			column="WORK_ORD_NO"			/>
		<result property="ordDate"				column="ORD_DATE"				/>
		<result property="equipNm"				column="EQUIP_NM"				/>
		<result property="dayNightNm"			column="DAY_NIGHT_NM"			/>
		<result property="goodsCd"				column="GOODS_CD"				/>
		<result property="goodsNm"				column="GOODS_NM"				/>
		<result property="qutyCd"				column="QUTY_CD"				/>
		<result property="alnicuMatrlNm"		column="ALNICU_MATRL_NM"		/>
		<result property="prcsPmsEa"			column="PRCS_PMS_EA"			/>
		<result property="prcsPfsEa"			column="PRCS_PFS_EA"			/>
		<result property="prcsPmsEa"			column="PRCS_PMS_EA"			/>
		<result property="prcsPfsEa"			column="PRCS_PFS_EA"			/>
		<result property="prcsPstabEa"			column="PRCS_PSTAB_EA"			/>
		<result property="prcsPaliensbstEa"		column="PRCS_PALIENSBST_EA"		/>
		<result property="prcsPpolutnEa"		column="PRCS_PPOLUTN_EA"		/>
		<result property="prcsGiltEa"			column="PRCS_GILT_EA"			/>
		<result property="prcsFbreakEa"			column="PRCS_FBREAK_EA"			/>
		<result property="prcsFagglomtEa"		column="PRCS_FAGGLOMT_EA"		/>
		<result property="prcsFpressEa"			column="PRCS_FPRESS_EA"			/>
		<result property="prcsFtornoutEa"		column="PRCS_FTORNOUT_EA"		/>
		<result property="prcsTeflonEa"			column="PRCS_TEFLON_EA"			/>
		<result property="prcsMargnDvatEa"		column="PRCS_MARGN_DVAT_EA"		/>
		<result property="prcsThicknessEa"		column="PRCS_THICKNESS_EA"		/>
		<result property="prcsSurfceBbEa"		column="PRCS_SURFCE_BB_EA"		/>
		<result property="prcsEdgeBbEa"			column="PRCS_EDGE_BB_EA"		/>
		<result property="prcsMburrEa"			column="PRCS_MBURR_EA"			/>
		<result property="prcsRburrEa"			column="PRCS_RBURR_EA"			/>
		<result property="prcsSizeEa"			column="PRCS_SIZE_EA"			/>
		<result property="prcsLayerEa"			column="PRCS_LAYER_EA"			/>
		<result property="prcsUnjinjeopEa"		column="PRCS_UNJINJEOP_EA"		/>
		<result property="prcsUnattchEa"		column="PRCS_UNATTCH_EA"		/>
		<result property="prcsFilmDepthEa"		column="PRCS_FILM_DEPTH_EA"		/>
		<result property="workTeamCd"			column="WORK_TEAM_CD"			/>
		<result property="workTeamNm"			column="WORK_TEAM_NM"			/>
		<result property="mainWorkChargr"		column="MAIN_WORK_CHARGR"		/>
		<result property="userNm"				column="USER_NM"				/>
		<result property="faulty"				column="FAULTY"					/>
	</resultMap>
	
	<!-- 원자재불량 -->
	<resultMap id="EquipMatrlFaultyAdmVo" type="mes.domain.po.EquipMatrlFaultyAdmVo">
		<result property="workOrdNo"			column="WORK_ORD_NO"			/>
		<result property="ordDate"				column="ORD_DATE"				/>
		<result property="equipCd"				column="EQUIP_CD"				/>
		<result property="faultyRegDate"		column="FAULTY_REG_DATE"		/>
		<result property="dayNightCd"			column="DAY_NIGHT_CD"			/>
		<result property="matrlCnt"				column="MATRL_CNT"				/>
		<result property="matrlTotal"			column="MATRL_TOTAL"			/>
		<result property="matrlMmb"				column="MATRL_MMB"				/>
		<result property="matrlMms"				column="MATRL_MMS"				/>
		<result property="matrlMaliensbst"		column="MATRL_MALIENSBST"		/>
		<result property="matrlMflex"			column="MATRL_MFLEX"			/>
		<result property="matrlMpolutn"			column="MATRL_MPOLUTN"			/>
		<result property="matrlGilt"			column="MATRL_GILT"				/>
		<result property="matrlMstab"			column="MATRL_MSTAB"			/>
		<result property="matrlFagglomt"		column="MATRL_FAGGLOMT"			/>
		<result property="matrlSpot"			column="MATRL_SPOT"				/>
		<result property="regId"				column="REG_ID"					/>
		<result property="regDate"				column="REG_DATE"				/>
		<result property="updId"				column="UPD_ID"					/>
		<result property="updDate"				column="UPD_DATE"				/>
		<!-- 
		<result property="dayTotalMatrlSum"		column="DAY_TOTAL_MATRL_SUM"	/>
		<result property="nightTotalMatrlSum"	column="NIGHT_TOTAL_MATRL_SUM"	/>
		<result property="totalMatrlSum"		column="TOTAL_MATRL_SUM"		/>
		 -->
		<!-- 불량내역조회(상세_wmsc0080) -->
		<result property="equipNm"				column="EQUIP_NM"				/>
		<result property="dayNightNm"			column="DAY_NIGHT_NM"			/>
		<result property="goodsCd"				column="GOODS_CD"				/>
		<result property="goodsNm"				column="GOODS_NM"				/>
		<result property="qutyCd"				column="QUTY_CD"				/>
		<result property="alnicuMatrlNm"		column="ALNICU_MATRL_NM"		/>
		<result property="matrlMmbEa"			column="MATRL_MMB_EA"			/>
		<result property="matrlMmsEa"			column="MATRL_MMS_EA"			/>
		<result property="matrlMaliensbstEa"	column="MATRL_MALIENSBST_EA"	/>
		<result property="matrlMflexEa"			column="MATRL_MFLEX_EA"			/>
		<result property="matrlMpolutnEa"		column="MATRL_MPOLUTN_EA"		/>
		<result property="matrlGiltEa"			column="MATRL_GILT_EA"			/>
		<result property="matrlMstabEa"			column="MATRL_MSTAB_EA"			/>
		<result property="matrlFagglomtEa"		column="MATRL_FAGGLOMT_EA"		/>
		<result property="matrlSpotEa"			column="MATRL_SPOT_EA"			/>
		<result property="workTeamCd"			column="WORK_TEAM_CD"			/>
		<result property="workTeamNm"			column="WORK_TEAM_NM"			/>
		<result property="mainWorkChargr"		column="MAIN_WORK_CHARGR"		/>
		<result property="userNm"				column="USER_NM"				/>
		<result property="faulty"				column="FAULTY"					/>
		<result property="gravity"				column="GRAVITY"				/>
	</resultMap>
	
	<!-- 교체불량 -->
	<resultMap id="EquipReplaceFaultyAdmVo" type="mes.domain.po.EquipReplaceFaultyAdmVo">
		<result property="workOrdNo"			column="WORK_ORD_NO"			/>
		<result property="ordDate"				column="ORD_DATE"				/>
		<result property="equipCd"				column="EQUIP_CD"			/>
		<result property="faultyRegDate"		column="FAULTY_REG_DATE"	/>
		<result property="dayNightCd"			column="DAY_NIGHT_CD"		/>
		<result property="rpcCnt"				column="RPC_CNT"			/>
		<result property="rpcTotal"				column="Rpc_TOTAL"			/>
		<result property="rpcMetal1"			column="RPC_METAL1"			/>
		<result property="rpcMetal2"			column="RPC_METAL2"			/>
		<result property="rpcMetal3"			column="RPC_METAL3"			/>
		<result property="rpcMetal4"			column="RPC_METAL4"			/>
		<result property="rpcMetal5"			column="RPC_METAL5"			/>
		<result property="rpcFilm1"				column="RPC_FILM1"			/>
		<result property="rpcFilm2"				column="RPC_FILM2"			/>
		<result property="rpcFilm3"				column="RPC_FILM3"			/>
		<result property="rpcFilm4"				column="RPC_FILM4"			/>
		<result property="rpcFilm5"				column="RPC_FILM5"			/>
		<result property="rpcSilicon1"			column="RPC_SILICON1"		/>
		<result property="rpcSilicon2"			column="RPC_SILICON2"		/>
		<result property="rpcSilicon3"			column="RPC_SILICON3"		/>
		<result property="rpcSilicon4"			column="RPC_SILICON4"		/>
		<result property="rpcSilicon5"			column="RPC_SILICON5"		/>
		<result property="rpcTeflon1"			column="RPC_TEFLON1"		/>
		<result property="rpcTeflon2"			column="RPC_TEFLON2"		/>
		<result property="rpcTeflon3"			column="RPC_TEFLON3"		/>
		<result property="rpcTeflon4"			column="RPC_TEFLON4"		/>
		<result property="rpcTeflon5"			column="RPC_TEFLON5"		/>
		<result property="rpcJc1"				column="RPC_JC1"			/>
		<result property="rpcJc2"				column="RPC_JC2"			/>
		<result property="rpcJc3"				column="RPC_JC3"			/>
		<result property="rpcJc4"				column="RPC_JC4"			/>
		<result property="rpcJc5"				column="RPC_JC5"			/>
		<result property="regId"				column="REG_ID"				/>
		<result property="regDate"				column="REG_DATE"			/>
		<result property="updId"				column="UPD_ID"				/>
		<result property="updDate"				column="UPD_DATE"			/>
		<result property="faulty"				column="FAULTY"					/>
		<result property="gravity"				column="GRAVITY"				/>	
		<!-- 
		<result property="dayTotalReplaceCount"		column="DAY_TOTAL_REPLACE_COUNT"/>
		<result property="nightTotalReplaceCount"	column="NIGHT_TOTAL_REPLACE_COUNT"/>
		<result property="totalReplaceCount"		column="TOTAL_REPLACE_COUNT"	/>
		<result property="dayTotalReplaceSum"		column="DAY_TOTAL_REPLACE_SUM"/>
		<result property="nightTotalReplaceSum"		column="NIGHT_TOTAL_REPLACE_SUM"/>
		<result property="totalReplaceSum"			column="TOTAL_REPLACE_SUM"	/>
		 -->
		<!-- 불량내역조회(상세_wmsc0080) -->
		<result property="equipNm"				column="EQUIP_NM"				/>
		<result property="dayNightNm"			column="DAY_NIGHT_NM"			/>
		<result property="goodsCd"				column="GOODS_CD"				/>
		<result property="goodsNm"				column="GOODS_NM"				/>
		<result property="qutyCd"				column="QUTY_CD"				/>
		<result property="alnicuMatrlNm"		column="ALNICU_MATRL_NM"		/>
		
		<result property="metalCnt"				column="METAL_CNT"				/>
		<result property="metalSum"				column="METAL_SUM"				/>
		<result property="metalSumEa"			column="METAL_SUM_EA"			/>
		<result property="filmCnt"				column="FILM_CNT"				/>
		<result property="filmSum"				column="FILM_SUM"				/>
		<result property="filmSumEa"			column="FILM_SUM_EA"			/>
		<result property="siliconCnt"			column="SILICON_CNT"			/>
		<result property="siliconSum"			column="SILICON_SUM"			/>
		<result property="siliconSumEa"			column="SILICON_SUM_EA"			/>
		<result property="teflonCnt"			column="TEFLON_CNT"				/>
		<result property="teflonSum"			column="TEFLON_SUM"			/>
		<result property="teflonSumEa"			column="TEFLON_SUM_EA"			/>
		
		<result property="workTeamCd"			column="WORK_TEAM_CD"			/>
		<result property="workTeamNm"			column="WORK_TEAM_NM"			/>
		<result property="mainWorkChargr"		column="MAIN_WORK_CHARGR"		/>
		<result property="userNm"				column="USER_NM"				/>
	</resultMap>
	
	<!-- 설비 트러블 불량 -->
	<resultMap id="EquipTroubleFaultyAdmVo" type="mes.domain.po.EquipTroubleFaultyAdmVo">
		<result property="workOrdNo"			column="WORK_ORD_NO"			/>
		<result property="ordDate"				column="ORD_DATE"				/>
		<result property="equipCd"				column="EQUIP_CD"				/>
		<result property="faultyRegDate"		column="FAULTY_REG_DATE"		/>
		<result property="dayNightCd"			column="DAY_NIGHT_CD"			/>
		<result property="trbCnt"				column="TRB_CNT"				/>
		<result property="trbTotal"				column="TRB_TOTAL"				/>
		<result property="trbServo1"			column="TRB_SERVO1"				/>
		<result property="trbServo2"			column="TRB_SERVO2"				/>
		<result property="trbServoContent"		column="TRB_SERVO_CONTENT"		/>
		<result property="trbFuse1"				column="TRB_FUSE1"				/>
		<result property="trbFuse2"				column="TRB_FUSE2"				/>
		<result property="trbFuseContent"		column="TRB_FUSE_CONTENT"		/>
		<result property="trbGearmotor1"		column="TRB_GEARMOTOR1"			/>
		<result property="trbGearmotor2"		column="TRB_GEARMOTOR2"			/>
		<result property="trbGearmotorContent"	column="TRB_GEARMOTOR_CONTENT"	/>
		<result property="trbTempatur1"			column="TRB_TEMPATUR1"			/>
		<result property="trbTempatur2"			column="TRB_TEMPATUR2"			/>
		<result property="trbTempaturContent"	column="TRB_TEMPATUR_CONTENT"	/>
		<result property="trbPnumt1"			column="TRB_PNUMT1"				/>
		<result property="trbPnumt2"			column="TRB_PNUMT2"				/>
		<result property="trbPnumtContent"		column="TRB_PNUMT_CONTENT"		/>
		<result property="trbCutting1"			column="TRB_CUTTING1"			/>
		<result property="trbCutting2"			column="TRB_CUTTING2"			/>
		<result property="trbCuttingContent"	column="TRB_CUTTING_CONTENT"	/>
		<result property="trbSensor1"			column="TRB_SENSOR1"			/>
		<result property="trbSensor2"			column="TRB_SENSOR2"			/>
		<result property="trbSensorContent"		column="TRB_SENSOR_CONTENT"		/>
		<result property="trbCylinder1"			column="TRB_CYLINDER1"			/>
		<result property="trbCylinder2"			column="TRB_CYLINDER2"			/>
		<result property="trbCylinderContent"	column="TRB_CYLINDER_CONTENT"	/>
		<result property="trbVision1"			column="TRB_VISION1"			/>
		<result property="trbVision2"			column="TRB_VISION2"			/>
		<result property="trbVisionContent"		column="TRB_VISION_CONTENT"		/>
		<result property="trbEtc1"				column="TRB_ETC1"				/>
		<result property="trbEtc2"				column="TRB_ETC2"				/>
		<result property="trbEtcContent"		column="TRB_ETC_CONTENT"		/>
		<result property="regId"				column="REG_ID"					/>
		<result property="regDate"				column="REG_DATE"				/>
		<result property="updId"				column="UPD_ID"					/>
		<result property="updDate"				column="UPD_DATE"				/>
		<result property="faulty"				column="FAULTY"					/>
		<result property="gravity"				column="GRAVITY"				/>	
		<!-- 
		<result property="dayTotalTroubleCount"		column="DAY_TOTAL_TROUBLE_COUNT"/>
		<result property="nightTotalTroubleCount"	column="NIGHT_TOTAL_TROUBLE_COUNT"/>
		<result property="totalTroubleCount"		column="TOTAL_TROUBLE_COUNT"	/>
		<result property="dayTotalTroubleSum"		column="DAY_TOTAL_TROUBLE_SUM"/>
		<result property="nightTotalTroubleSum"		column="NIGHT_TOTAL_TROUBLE_SUM"/>
		<result property="totalTroubleSum"			column="TOTAL_TROUBLE_SUM"	/>
		 -->
		<!-- 불량내역조회(상세_wmsc0080) -->
		<result property="equipNm"				column="EQUIP_NM"				/>
		<result property="dayNightNm"			column="DAY_NIGHT_NM"			/>
		<result property="goodsCd"				column="GOODS_CD"				/>
		<result property="goodsNm"				column="GOODS_NM"				/>
		<result property="qutyCd"				column="QUTY_CD"				/>
		<result property="alnicuMatrlNm"		column="ALNICU_MATRL_NM"		/>
		
		<result property="servolCnt"			column="SERVOL_CNT"				/>
		<result property="servoSum"				column="SERVO_SUM"				/>
		<result property="servolSumEa"			column="SERVOL_SUM_EA"			/>
		<result property="fuseCnt"				column="FUSE_CNT"				/>
		<result property="fuseSum"				column="FUSE_SUM"				/>
		<result property="fuselSumEa"			column="FUSEL_SUM_EA"			/>
		<result property="gearmotorCnt"			column="GEARMOTOR_CNT"			/>
		<result property="gearmotorSum"			column="GEARMOTOR_SUM"			/>
		<result property="gearmotorSumEa"		column="GEARMOTOR_SUM_EA"		/>
		<result property="tempaturCnt"			column="TEMPATUR_CNT"			/>
		<result property="tempaturSum"			column="TEMPATUR_SUM"			/>
		<result property="tempaturSumEa"		column="TEMPATUR_SUM_EA"		/>
		<result property="pnumtCnt"				column="PNUMT_CNT"				/>
		<result property="pnumtSum"				column="PNUMT_SUM"				/>
		<result property="pnumtSumEa"			column="PNUMT_SUM_EA"			/>
		<result property="cuttingCnt"			column="CUTTING_CNT"			/>
		<result property="cuttingSum"			column="CUTTING_SUM"			/>
		<result property="cuttingSumEa"			column="CUTTING_SUM_EA"			/>
		<result property="sensorCnt"			column="SENSOR_CNT"				/>
		<result property="sensorSum"			column="SENSOR_SUM"				/>
		<result property="sensorSumEa"			column="SENSOR_SUM_EA"			/>
		<result property="cyliderCnt"			column="CYLINDER_CNT"			/>
		<result property="cyliderSum"			column="CYLINDER_SUM"			/>
		<result property="cylinderSumEa"		column="CYLINDER_SUM_EA"		/>
		<result property="visionCnt"			column="VISION_CNT"				/>
		<result property="visionSum"			column="VISION_SUM"				/>
		<result property="visionSumEa"			column="VISION_SUM_EA"			/>
		<result property="etcCnt"				column="ETC_CNT"				/>
		<result property="etcSum"				column="ETC_SUM"				/>
		<result property="etcSumEa"				column="ETC_SUM_EA"				/>
		
		<result property="workTeamCd"			column="WORK_TEAM_CD"			/>
		<result property="workTeamNm"			column="WORK_TEAM_NM"			/>
		<result property="mainWorkChargr"		column="MAIN_WORK_CHARGR"		/>
		<result property="userNm"				column="USER_NM"				/>
	</resultMap>
	
	<!-- 불량내역 조회(전체) -->
	<resultMap id="FaultyHistoryVo"		type="mes.domain.wm.FaultyHistoryVo">
		<result property="equipCd"				column="EQUIP_CD"				/>
		<result property="equipNm"				column="EQUIP_NM"				/>
		<result property="goodsCd"				column="GOODS_CD"				/>
		<result property="goodsNm"				column="GOODS_NM"				/>
		
		<result property="gravity"				column="GRAVITY"				/>
		<result property="model"				column="MODEL"					/>
		<result property="sumTargetCnt"			column="SUM_TARGET_CNT"			/>
		<result property="sumOutputCnt"			column="SUM_OUTPUT_CNT"			/>
		<result property="qutyNm"				column="QUTY_NM"				/>
		
		<result property="teamCd"				column="TEAM_CD"				/>
		<result property="teamNm"				column="TEAM_NM"				/>
		<result property="mainWorkChargr"		column="MAIN_WORK_CHARGR"		/>
		<result property="userNm"				column="USER_NM"				/>
		
		<result property="ordGubun"				column="ORD_GUBUN"				/>
		<result property="dayNightCd"			column="DAY_NIGHT_CD"			/>
		<result property="dayNightNm"			column="DAY_NIGHT_NM"			/>
		<result property="qutyCd"				column="QUTY_CD"				/>
		<result property="alnicuMatrlCd"		column="ALNICU_MATRL_CD"		/>
		<result property="alnicuMatrlNm"		column="ALNICU_MATRL_NM"		/>
		<result property="ordDate"				column="ORD_DATE"				/>
		<result property="prcsCnt"				column="PRCS_CNT"				/>
		<result property="prcsTotal"			column="PRCS_TOTAL"				/>
		<result property="prcsEa"				column="PRCS_EA"				/>
		<result property="matrlCnt"				column="MATRL_CNT"				/>
		<result property="matrlTotal"			column="MATRL_TOTAL"			/>
		<result property="matrlEa"				column="MATRL_EA"				/>
		<result property="rpcCnt"				column="RPC_CNT"				/>
		<result property="rpcTotal"				column="RPC_TOTAL"				/>
		<result property="rpcEa"				column="RPC_EA"					/>
		<result property="trbCnt"				column="TRB_CNT"				/>
		<result property="trbTotal"				column="TRB_TOTAL"				/>
		<result property="trbEa"				column="TRB_EA"					/>
		
		<result property="cnt5"					column="CNT_5"					/>
		<result property="total5"				column="TOTAL_5"				/>
		<result property="ea5"					column="EA_5"					/>
		<result property="cnt6"					column="CNT_6"					/>
		<result property="total6"				column="TOTAL_6"				/>
		<result property="ea6"					column="EA_6"					/>
		<result property="cnt7"					column="CNT_7"					/>
		<result property="total7"				column="TOTAL_7"				/>
		<result property="ea7"					column="EA_7"					/>
		
		<result property="workTeamCd"			column="WORK_TEAM_CD"			/>
		<result property="workTeamNm"			column="WORK_TEAM_NM"			/>
		<result property="mainWorkChargr"		column="MAIN_WORK_CHARGR"		/>
		<result property="subWorkChargr"		column="SUB_WORK_CHARGR"		/>
		<result property="mainWorkChargrNm"		column="MAIN_WORK_CHARGR_NM"	/>
		<result property="subWorkChargrNm"		column="SUB_WORK_CHARGR_NM"		/>
		<result property="workOrdNo"			column="WORK_ORD_NO"			/>		
		
		<result property="appearFaultyCnt"		column="APPEAR_FAULTY_CNT"			/>
		<result property="edgeFaultyCnt"		column="EDGE_FAULTY_CNT"			/>
		<result property="shipFaultyCnt"		column="SHIP_FAULTY_CNT"			/>
		<result property="reShipFaultyCnt"		column="RE_SHIP_FAULTY_CNT"			/>
		<result property="outputFaultyCnt"		column="OUTPUT_FAULTY_CNT"			/>
		
		
		<result property="metalEa"				column="METAL_EA"				/>
		<result property="filmEa"				column="FILM_EA"				/>
		<result property="siliconEa"			column="SILICON_EA"				/>
		<result property="teflonEa"				column="TEFLON_EA"				/>
	</resultMap>
	

	<!-- 불량 통계 -->
	<resultMap id="TotalFaultyAdmVo" type="mes.domain.po.TotalFaultyAdmVo">
		<result property="equipCd"					column="EQUIP_CD"				/>
		<result property="faultyRegDate"			column="FAULTY_REG_DATE"		/>
		<result property="dayNightCd"				column="DAY_NIGHT_CD"			/>

		<result property="dayTotalPrcssCount"		column="DAY_TOTAL_PRCSS_COUNT"	/>
		<result property="nightTotalPrcssCount"		column="NIGHT_TOTAL_PRCSS_COUNT"/>
		<result property="dayTotalMatrlCount"		column="DAY_TOTAL_MATRL_COUNT"	/>
		<result property="nightTotalMatrlCount"		column="NIGHT_TOTAL_MATRL_COUNT"/>
		<result property="dayTotalReplaceCount"		column="DAY_TOTAL_REPLACE_COUNT"/>
		<result property="nightTotalReplaceCount"	column="NIGHT_TOTAL_REPLACE_COUNT"/>
		<result property="dayTotalTroubleCount"		column="DAY_TOTAL_TROUBLE_COUNT"/>
		<result property="nightTotalTroubleCount"	column="NIGHT_TOTAL_TROUBLE_COUNT"/>
		
		<result property="totalPrcssCount"			column="TOTAL_PRCSS_COUNT"		/>
		<result property="totalMatrlCount"			column="TOTAL_MATRL_COUNT"		/>
		<result property="totalReplaceCount"		column="TOTAL_REPLACE_COUNT"	/>
		<result property="totalTroubleCount"		column="TOTAL_TROUBLE_COUNT"	/>
		
		<result property="dayTotalPrcssSum"			column="DAY_TOTAL_PRCSS_SUM"	/>
		<result property="nightTotalPrcssSum"		column="NIGHT_TOTAL_PRCSS_SUM"	/>
		<result property="dayTotalMatrlSum"			column="DAY_TOTAL_MATRL_SUM"	/>
		<result property="nightTotalMatrlSum"		column="NIGHT_TOTAL_MATRL_SUM"	/>
		<result property="dayTotalReplaceSum"		column="DAY_TOTAL_REPLACE_SUM"	/>
		<result property="nightTotalReplaceSum"		column="NIGHT_TOTAL_REPLACE_SUM"/>
		<result property="dayTotalTroubleSum"		column="DAY_TOTAL_TROUBLE_SUM"	/>
		<result property="nightTotalTroubleSum"		column="NIGHT_TOTAL_TROUBLE_SUM"/>
				
		<result property="totalPrcssSum"			column="TOTAL_PRCSS_SUM"		/>
		<result property="totalMatrlSum"			column="TOTAL_MATRL_SUM"		/>
		<result property="totalReplaceSum"			column="TOTAL_REPLACE_SUM"		/>
		<result property="totalTroubleSum"			column="TOTAL_TROUBLE_SUM"		/>


		<result property="dayTotal114Count"			column="DAY_TOTAL_114_COUNT"	/>
		<result property="nightTotal114Count"		column="NIGHT_TOTAL_114_COUNT"	/>
		<result property="total114_count"			column="TOTAL_114_COUNT"		/>
		
		<result property="dayTotal115Count"			column="DAY_TOTAL_115_COUNT"	/>
		<result property="nightTotal115Count"		column="NIGHT_TOTAL_115_COUNT"	/>
		<result property="total115Count"			column="TOTAL_115_COUNT"		/>
		
		<result property="dayTotal116Count"			column="DAY_TOTAL_116_COUNT"	/>
		<result property="nightTotal116Count"		column="NIGHT_TOTAL_116_COUNT"	/>
		<result property="total116Count"			column="TOTAL_116_COUNT"		/>
		
		<result property="dayTotal114Sum"			column="DAY_TOTAL_114_SUM"		/>
		<result property="nightTotal114Sum"			column="NIGHT_TOTAL_114_SUM"	/>
		<result property="total114Sum"				column="TOTAL_114_SUM"			/>
		
		<result property="dayTotal115Sum"			column="DAY_TOTAL_115_SUM"		/>
		<result property="nightTotal115Sum"			column="NIGHT_TOTAL_115_SUM"	/>
		<result property="total115Sum"				column="TOTAL_115_SUM"			/>
		
		<result property="dayTotal116Sum"			column="DAY_TOTAL_116_SUM"		/>
		<result property="nightTotal116Sum"			column="NIGHT_TOTAL_116_SUM"	/>
		<result property="total116Sum"				column="TOTAL_116_SUM"			/>
		
	</resultMap>
	
	
	<!-- 원자재불량 -->
	<resultMap id="FaultyQtyVo" type="mes.domain.po.FaultyQtyVo">
		<result property="equipCd"				column="EQUIP_CD"			/>
		<result property="equipNm"				column="EQUIP_NM"			/>
		<result property="ordDate"				column="ORD_DATE"			/>
		<result property="ordGubun"				column="ORD_GUBUN"			/>
		<result property="goodsCd"				column="GOODS_CD"			/>
		<result property="goodsNm"				column="GOODS_NM"			/>
		<result property="qutyCd"				column="QUTY_CD"			/>
		<result property="qutyNm"				column="QUTY_NM"			/>
		<result property="mainFaultyQty"		column="MAIN_FAULTY_QTY"	/>
		<result property="subFaultyQty"			column="SUB_FAULTY_QTY"		/>
		<result property="workTeamCd"			column="WORK_TEAM_CD"		/>
		<result property="workTeamNm"			column="WORK_TEAM_NM"		/>
		<result property="mainWorkChargr"		column="MAIN_WORK_CHARGR"	/>
		<result property="userNumber"			column="USER_NUMBER"		/>
		<result property="userNm"				column="USER_NM"			/>
		<result property="regDate"				column="REG_DATE"			/>
		<result property="regId"				column="REG_ID"				/>
		<result property="updDate"				column="UPD_DATE"			/>
		<result property="updId"				column="UPD_ID"				/>
	</resultMap>
	
	
	<!-- __________________________________________공정불량 시작__________________________________________ -->
	<!-- 공정불량 조회 --> 
	<select id="readPrcssFaulty" resultMap="EquipPrcssFaultyAdmVo">
		<![CDATA[
			SELECT
				EQUIP_CD
				, FAULTY_REG_DATE
				, DAY_NIGHT_CD
				, PRCS_PMS
				, PRCS_PFS
				, PRCS_PSTAB
				, PRCS_PALIENSBST
				, PRCS_PPOLUTN
				, PRCS_GILT
				, PRCS_FBREAK
				, PRCS_FAGGLOMT
				, PRCS_FPRESS
				, PRCS_FTORNOUT
				, PRCS_TEFLON
				, PRCS_MARGN_DVAT
				, PRCS_THICKNESS
				, PRCS_SURFCE_BB
				, PRCS_EDGE_BB
				, PRCS_MBURR
				, PRCS_RBURR
				, PRCS_SIZE
				, PRCS_LAYER
				, PRCS_UNJINJEOP
				, PRCS_UNATTCH
				, PRCS_FILM_DEPTH
				, REG_ID
				, REG_DATE
				, UPD_ID
				, UPD_DATE
			FROM	TB_EQUIP_PRCSS_FAULTY_ADM 
			WHERE
				EQUIP_CD = #{equipCd}
				AND	FAULTY_REG_DATE = #{faultyRegDate}
				AND	DAY_NIGHT_CD = #{dayNightCd}
 		]]>
	</select>
	
	<!-- 공정불량 등록 -->
	<insert id="createPrcssFaulty" parameterType="mes.domain.po.EquipPrcssFaultyAdmVo">
			INSERT INTO TB_EQUIP_PRCSS_FAULTY_ADM(
			EQUIP_CD
			, FAULTY_REG_DATE
			, DAY_NIGHT_CD
			, PRCS_CNT
			, PRCS_TOTAL
			, PRCS_PMS
			, PRCS_PFS
			, PRCS_PSTAB
			, PRCS_PALIENSBST
			, PRCS_PPOLUTN
			, PRCS_GILT
			, PRCS_FBREAK
			, PRCS_FAGGLOMT
			, PRCS_FPRESS
			, PRCS_FTORNOUT
			, PRCS_TEFLON
			, PRCS_MARGN_DVAT
			, PRCS_THICKNESS
			, PRCS_SURFCE_BB
			, PRCS_EDGE_BB
			, PRCS_MBURR
			, PRCS_RBURR
			, PRCS_SIZE
			, PRCS_LAYER
			, PRCS_UNJINJEOP
			, PRCS_UNATTCH
			, PRCS_FILM_DEPTH
			, REG_ID
			, REG_DATE
		) 
		VALUES(
			#{equipCd},
			#{faultyRegDate},
			#{dayNightCd},
			(	CASE  WHEN  #{prcsPms} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsPfs} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsPstab} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsPaliensbst} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsPpolutn} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsGilt} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsFbreak} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsFagglomt} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsFpress} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsTeflon} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsMargnDvat} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsThickness} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsSurfceBb} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsEdgeBb} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsMburr} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsRburr} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsSize} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsLayer} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsUnjinjeop} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsUnattch} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsFilmDepth} > 0 THEN 1 ELSE 0 END )	,
			#{prcsPms} + #{prcsPfs} + #{prcsPstab} + #{prcsPaliensbst} + #{prcsPpolutn} + #{prcsGilt} + #{prcsFbreak} + #{prcsFagglomt} + #{prcsFpress}
			+ #{prcsTeflon} + #{prcsMargnDvat} + #{prcsThickness} + #{prcsSurfceBb} + #{prcsEdgeBb} + #{prcsMburr} + #{prcsRburr} + #{prcsSize} + #{prcsLayer}
			+ #{prcsUnjinjeop} + #{prcsUnattch} + #{prcsFilmDepth},
			#{prcsPms},
			#{prcsPfs},
			#{prcsPstab},
			#{prcsPaliensbst},
			#{prcsPpolutn},
			#{prcsGilt},
			#{prcsFbreak},
			#{prcsFagglomt},
			#{prcsFpress},
			#{prcsFtornout},
			#{prcsTeflon},
			#{prcsMargnDvat},
			#{prcsThickness},
			#{prcsSurfceBb},
			#{prcsEdgeBb},
			#{prcsMburr},
			#{prcsRburr},
			#{prcsSize},
			#{prcsLayer},
			#{prcsUnjinjeop},
			#{prcsUnattch},
			#{prcsFilmDepth},
			#{regId},
			getDate()
		)
	</insert>
	
	<!-- 공정불량  수정  -->
	<update id="updatePrcssFaulty" parameterType="mes.domain.po.EquipPrcssFaultyAdmVo">
		UPDATE	TB_EQUIP_PRCSS_FAULTY_ADM 
		SET	
			PRCS_CNT =
			(	CASE  WHEN  #{prcsPms} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsPfs} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsPstab} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsPaliensbst} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsPpolutn} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsGilt} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsFbreak} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsFagglomt} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsFpress} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsTeflon} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsMargnDvat} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsThickness} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsSurfceBb} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsEdgeBb} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsMburr} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsRburr} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsSize} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsLayer} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsUnjinjeop} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsUnattch} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{prcsFilmDepth} > 0 THEN 1 ELSE 0 END )
			, PRCS_TOTAL = ( #{prcsPms} + #{prcsPfs} + #{prcsPstab} + #{prcsPaliensbst} + #{prcsPpolutn} + #{prcsGilt} + #{prcsFbreak} + #{prcsFagglomt} + #{prcsFpress}
							+ #{prcsTeflon} + #{prcsMargnDvat} + #{prcsThickness} + #{prcsSurfceBb} + #{prcsEdgeBb} + #{prcsMburr} + #{prcsRburr} + #{prcsSize} + #{prcsLayer}
							+ #{prcsUnjinjeop} + #{prcsUnattch} + #{prcsFilmDepth} )
			, PRCS_PMS = #{prcsPms}
			, PRCS_PFS = #{prcsPfs}
			, PRCS_PSTAB = #{prcsPstab}
			, PRCS_PALIENSBST = #{prcsPaliensbst}
			, PRCS_PPOLUTN = #{prcsPpolutn}
			, PRCS_GILT = #{prcsGilt}
			, PRCS_FBREAK = #{prcsFbreak}
			, PRCS_FAGGLOMT = #{prcsFagglomt}
			, PRCS_FPRESS = #{prcsFpress}
			, PRCS_FTORNOUT = #{prcsFtornout}
			, PRCS_TEFLON = #{prcsTeflon}
			, PRCS_MARGN_DVAT = #{prcsMargnDvat}
			, PRCS_THICKNESS = #{prcsThickness}
			, PRCS_SURFCE_BB = #{prcsSurfceBb}
			, PRCS_EDGE_BB = #{prcsEdgeBb}
			, PRCS_MBURR = #{prcsMburr}
			, PRCS_RBURR = #{prcsRburr}
			, PRCS_SIZE = #{prcsSize}
			, PRCS_LAYER = #{prcsLayer}
			, PRCS_UNJINJEOP = #{prcsUnjinjeop}
			, PRCS_UNATTCH = #{prcsUnattch}
			, PRCS_FILM_DEPTH = #{prcsFilmDepth}
			, UPD_ID = #{updId}
			, UPD_DATE = getDate()
		WHERE
			EQUIP_CD = #{equipCd}
			AND	FAULTY_REG_DATE = #{faultyRegDate}
			AND	DAY_NIGHT_CD = #{dayNightCd}
	</update>
	<!-- __________________________________________공정불량 끝__________________________________________ -->
	
	<!-- __________________________________________원자재불량 시작__________________________________________ -->
	<!-- 원자재불량 조회 --> 
	<select id="readMatrlFaulty" resultMap="EquipMatrlFaultyAdmVo">
		<![CDATA[
			SELECT
				EQUIP_CD
				, FAULTY_REG_DATE
				, DAY_NIGHT_CD
				, MATRL_MMB
				, MATRL_MMS
				, MATRL_MALIENSBST
				, MATRL_MFLEX
				, MATRL_MPOLUTN
				, MATRL_GILT
				, MATRL_MSTAB
				, MATRL_FAGGLOMT
				, MATRL_SPOT
				, REG_ID
				, REG_DATE
				, UPD_ID
				, UPD_DATE
			FROM
				TB_EQUIP_MATRL_FAULTY_ADM 
			WHERE
				EQUIP_CD = #{equipCd}
			AND
				FAULTY_REG_DATE = #{faultyRegDate}
			AND
				DAY_NIGHT_CD = #{dayNightCd}
 		]]>
	</select>
	
	<!-- 원자재불량 등록 -->
	<insert id="createMatrlFaulty" parameterType="mes.domain.po.EquipMatrlFaultyAdmVo">
		INSERT INTO TB_EQUIP_MATRL_FAULTY_ADM(
			EQUIP_CD
			, FAULTY_REG_DATE
			, DAY_NIGHT_CD
			, MATRL_CNT
			, MATRL_TOTAL
			, MATRL_MMB
			, MATRL_MMS
			, MATRL_MALIENSBST
			, MATRL_MFLEX
			, MATRL_MPOLUTN
			, MATRL_GILT
			, MATRL_MSTAB
			, MATRL_FAGGLOMT
			, MATRL_SPOT
			, REG_ID
			, REG_DATE
			)
		VALUES(
			#{equipCd},
			#{faultyRegDate},
			#{dayNightCd},
			(	CASE  WHEN  #{matrlMmb} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{matrlMms} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{matrlMaliensbst} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{matrlMflex} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{matrlMpolutn} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{matrlGilt} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{matrlMstab} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{matrlFagglomt} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{matrlSpot} > 0 THEN 1 ELSE 0 END )	,
			#{matrlMmb} + #{matrlMms} + #{matrlMaliensbst} + #{matrlMflex} + #{matrlMpolutn} + #{matrlGilt} + #{matrlMstab} + #{matrlFagglomt} + #{matrlSpot} ,
			#{matrlMmb},
			#{matrlMms},
			#{matrlMaliensbst},
			#{matrlMflex},
			#{matrlMpolutn},
			#{matrlGilt},
			#{matrlMstab},
			#{matrlFagglomt},
			#{matrlSpot},
			#{regId},
			getDate()
		)
	</insert>
		
	<!-- 원자재불량  수정  -->
	<update id="updateMatrlFaulty" parameterType="mes.domain.po.EquipMatrlFaultyAdmVo">
		UPDATE	TB_EQUIP_MATRL_FAULTY_ADM 
			SET
			EQUIP_CD = #{equipCd}
			, FAULTY_REG_DATE = #{faultyRegDate}
			, DAY_NIGHT_CD = #{dayNightCd}
			, MATRL_CNT = 
				(	CASE  WHEN  #{matrlMmb} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{matrlMms} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{matrlMaliensbst} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{matrlMflex} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{matrlMpolutn} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{matrlGilt} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{matrlMstab} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{matrlFagglomt} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{matrlSpot} > 0 THEN 1 ELSE 0 END )
			, MATRL_TOTAL = #{matrlMmb} + #{matrlMms} + #{matrlMaliensbst} + #{matrlMflex} + #{matrlMpolutn} + #{matrlGilt} + #{matrlMstab} + #{matrlFagglomt} + #{matrlSpot}
			, MATRL_MMB = #{matrlMmb}
			, MATRL_MMS = #{matrlMms}
			, MATRL_MALIENSBST = #{matrlMaliensbst}
			, MATRL_MFLEX = #{matrlMflex}
			, MATRL_MPOLUTN = #{matrlMpolutn}
			, MATRL_GILT = #{matrlGilt}
			, MATRL_MSTAB = #{matrlMstab}
			, MATRL_FAGGLOMT = #{matrlFagglomt}
			, MATRL_SPOT = #{matrlSpot}
			, UPD_ID = #{updId}
			, UPD_DATE = getDate()
		WHERE
			EQUIP_CD = #{equipCd}
		AND
			FAULTY_REG_DATE = #{faultyRegDate}
		AND
			DAY_NIGHT_CD = #{dayNightCd}
	</update>	
	<!-- __________________________________________원자재불량 끝__________________________________________ -->
	
	<!-- __________________________________________교체불량 시작__________________________________________ -->
	<!-- 교체불량 조회 --> 
	<select id="readReplaceFaulty" resultMap="EquipReplaceFaultyAdmVo">
		<![CDATA[
			SELECT
				EQUIP_CD
				, FAULTY_REG_DATE
				, DAY_NIGHT_CD
				, RPC_METAL1
				, RPC_METAL2
				, RPC_METAL3
				, RPC_METAL4
				, RPC_METAL5
				, RPC_FILM1
				, RPC_FILM2
				, RPC_FILM3
				, RPC_FILM4
				, RPC_FILM5
				, RPC_SILICON1
				, RPC_SILICON2
				, RPC_SILICON3
				, RPC_SILICON4
				, RPC_SILICON5
				, RPC_TEFLON1
				, RPC_TEFLON2
				, RPC_TEFLON3
				, RPC_TEFLON4
				, RPC_TEFLON5
				, RPC_JC1
				, RPC_JC2
				, RPC_JC3
				, RPC_JC4
				, RPC_JC5
				, REG_ID
				, REG_DATE
				, UPD_ID
				, UPD_DATE
			FROM
				TB_EQUIP_REPLACE_FAULTY_ADM 
			WHERE
				EQUIP_CD = #{equipCd}
			AND
				FAULTY_REG_DATE = #{faultyRegDate}
			AND
				DAY_NIGHT_CD = #{dayNightCd}
 		]]>
	</select>
	
	<!-- 교체불량 등록 -->
	<insert id="createReplaceFaulty" parameterType="mes.domain.po.EquipReplaceFaultyAdmVo">
		INSERT INTO TB_EQUIP_REPLACE_FAULTY_ADM(
			EQUIP_CD
			, FAULTY_REG_DATE
			, DAY_NIGHT_CD
			, RPC_CNT
			, RPC_TOTAL
			, RPC_METAL1
			, RPC_METAL2
			, RPC_METAL3
			, RPC_METAL4
			, RPC_METAL5
			, RPC_FILM1
			, RPC_FILM2
			, RPC_FILM3
			, RPC_FILM4
			, RPC_FILM5
			, RPC_SILICON1
			, RPC_SILICON2
			, RPC_SILICON3
			, RPC_SILICON4
			, RPC_SILICON5
			, RPC_TEFLON1
			, RPC_TEFLON2
			, RPC_TEFLON3
			, RPC_TEFLON4
			, RPC_TEFLON5
			, RPC_JC1
			, RPC_JC2
			, RPC_JC3
			, RPC_JC4
			, RPC_JC5
			, REG_ID
			, REG_DATE
		)
		VALUES(
			#{equipCd},
			#{faultyRegDate},
			#{dayNightCd},
			(	CASE  WHEN  #{rpcMetal1} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcMetal2} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcMetal3} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcMetal4} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcMetal5} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcFilm1} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcFilm2} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcFilm3} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcFilm4} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcFilm5} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcSilicon1} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcSilicon2} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcSilicon3} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcSilicon4} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcSilicon5} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcTeflon1} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcTeflon2} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcTeflon3} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcTeflon4} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcTeflon5} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcJc1} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcJc2} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcJc3} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcJc4} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcJc5} > 0 THEN 1 ELSE 0 END )	,
			( #{rpcMetal1} + #{rpcMetal2} + #{rpcMetal3} + #{rpcMetal4} + #{rpcMetal5}
			 + #{rpcFilm1} + #{rpcFilm2} + #{rpcFilm3} + #{rpcFilm4} + #{rpcFilm5}
			 + #{rpcSilicon1} + #{rpcSilicon2} + #{rpcSilicon3} + #{rpcSilicon4} + #{rpcSilicon5}
			 + #{rpcTeflon1} + #{rpcTeflon2} + #{rpcTeflon3} + #{rpcTeflon4} + #{rpcTeflon5}
			 + #{rpcJc1} + #{rpcJc2} + #{rpcJc3} + #{rpcJc4} + #{rpcJc5} )	,
			#{rpcMetal1},
			#{rpcMetal2},
			#{rpcMetal3},
			#{rpcMetal4},
			#{rpcMetal5},
			#{rpcFilm1},
			#{rpcFilm2},
			#{rpcFilm3},
			#{rpcFilm4},
			#{rpcFilm5},
			#{rpcSilicon1},
			#{rpcSilicon2},
			#{rpcSilicon3},
			#{rpcSilicon4},
			#{rpcSilicon5},
			#{rpcTeflon1},
			#{rpcTeflon2},
			#{rpcTeflon3},
			#{rpcTeflon4},
			#{rpcTeflon5},
			#{rpcJc1},
			#{rpcJc2},
			#{rpcJc3},
			#{rpcJc4},
			#{rpcJc5},
			#{regId},
			getDate()
		)
	</insert>
		
	<!-- 교체불량  수정  -->
	<update id="updateReplaceFaulty" parameterType="mes.domain.po.EquipReplaceFaultyAdmVo">
		UPDATE	TB_EQUIP_REPLACE_FAULTY_ADM 
		SET
			EQUIP_CD = #{equipCd}
			, FAULTY_REG_DATE = #{faultyRegDate}
			, DAY_NIGHT_CD = #{dayNightCd}
			, RPC_CNT = (
				CASE  WHEN  #{rpcMetal1} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcMetal2} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcMetal3} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcMetal4} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcMetal5} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcFilm1} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcFilm2} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcFilm3} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcFilm4} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcFilm5} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcSilicon1} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcSilicon2} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcSilicon3} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcSilicon4} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcSilicon5} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcTeflon1} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcTeflon2} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcTeflon3} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcTeflon4} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcTeflon5} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcJc1} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcJc2} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcJc3} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcJc4} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{rpcJc5} > 0 THEN 1 ELSE 0 END )
			, RPC_TOTAL = #{rpcMetal1} + #{rpcMetal2} + #{rpcMetal3} + #{rpcMetal4} + #{rpcMetal5}
						 + #{rpcFilm1} + #{rpcFilm2} + #{rpcFilm3} + #{rpcFilm4} + #{rpcFilm5}
						 + #{rpcSilicon1} + #{rpcSilicon2} + #{rpcSilicon3} + #{rpcSilicon4} + #{rpcSilicon5}
						 + #{rpcTeflon1} + #{rpcTeflon2} + #{rpcTeflon3} + #{rpcTeflon4} + #{rpcTeflon5}
						 + #{rpcJc1} + #{rpcJc2} + #{rpcJc3} + #{rpcJc4} + #{rpcJc5}
			, RPC_METAL1 = #{rpcMetal1}
			, RPC_METAL2 = #{rpcMetal2}
			, RPC_METAL3 = #{rpcMetal3}
			, RPC_METAL4 = #{rpcMetal4}
			, RPC_METAL5 = #{rpcMetal5}
			, RPC_FILM1 = #{rpcFilm1}
			, RPC_FILM2 = #{rpcFilm2}
			, RPC_FILM3 = #{rpcFilm3}
			, RPC_FILM4 = #{rpcFilm4}
			, RPC_FILM5 = #{rpcFilm5}
			, RPC_SILICON1 = #{rpcSilicon1}
			, RPC_SILICON2 = #{rpcSilicon2}
			, RPC_SILICON3 = #{rpcSilicon3}
			, RPC_SILICON4 = #{rpcSilicon4}
			, RPC_SILICON5 = #{rpcSilicon5}
			, RPC_TEFLON1 = #{rpcTeflon1}
			, RPC_TEFLON2 = #{rpcTeflon2}
			, RPC_TEFLON3 = #{rpcTeflon3}
			, RPC_TEFLON4 = #{rpcTeflon4}
			, RPC_TEFLON5 = #{rpcTeflon5}
			, RPC_JC1 = #{rpcJc1}
			, RPC_JC2 = #{rpcJc2}
			, RPC_JC3 = #{rpcJc3}
			, RPC_JC4 = #{rpcJc4}
			, RPC_JC5 = #{rpcJc5}
			, UPD_ID = #{updId}
			, UPD_DATE = getDate()
		WHERE
			EQUIP_CD = #{equipCd}
		AND
			FAULTY_REG_DATE = #{faultyRegDate}
		AND
			DAY_NIGHT_CD = #{dayNightCd}
	</update>	
	<!-- __________________________________________교체불량 끝__________________________________________ -->
	
	<!-- __________________________________________설비 트러블 불량 시작__________________________________________ -->
	<!-- 설비트러블 불량 조회 --> 
	<select id="readTroubleFaulty" resultMap="EquipTroubleFaultyAdmVo">
		<![CDATA[
			SELECT
			EQUIP_CD
			, FAULTY_REG_DATE
			, DAY_NIGHT_CD
			, TRB_SERVO1
			, TRB_SERVO2
			, TRB_SERVO_CONTENT
			, TRB_FUSE1
			, TRB_FUSE2
			, TRB_FUSE_CONTENT
			, TRB_GEARMOTOR1
			, TRB_GEARMOTOR2
			, TRB_GEARMOTOR_CONTENT
			, TRB_TEMPATUR1
			, TRB_TEMPATUR2
			, TRB_TEMPATUR_CONTENT
			, TRB_PNUMT1
			, TRB_PNUMT2
			, TRB_PNUMT_CONTENT
			, TRB_CUTTING1
			, TRB_CUTTING2
			, TRB_CUTTING_CONTENT
			, TRB_SENSOR1
			, TRB_SENSOR2
			, TRB_SENSOR_CONTENT
			, TRB_CYLINDER1
			, TRB_CYLINDER2
			, TRB_CYLINDER_CONTENT
			, TRB_VISION1
			, TRB_VISION2
			, TRB_VISION_CONTENT
			, TRB_ETC1
			, TRB_ETC2
			, TRB_ETC_CONTENT
			, REG_ID
			, REG_DATE
			, UPD_ID
			, UPD_DATE
			FROM
				TB_EQUIP_TROUBLE_FAULTY_ADM 
			WHERE
				EQUIP_CD = #{equipCd}
			AND
				FAULTY_REG_DATE = #{faultyRegDate}
			AND
				DAY_NIGHT_CD = #{dayNightCd}
 		]]>
	</select>
	
	<!-- 설비트러블 불량 등록 -->
	<insert id="createTroubleFaulty" parameterType="mes.domain.po.EquipTroubleFaultyAdmVo">
		INSERT INTO	TB_EQUIP_TROUBLE_FAULTY_ADM(
			EQUIP_CD
			, FAULTY_REG_DATE
			, DAY_NIGHT_CD
			, TRB_CNT
			, TRB_TOTAL
			, TRB_SERVO1
			, TRB_SERVO2
			, TRB_SERVO_CONTENT
			, TRB_FUSE1
			, TRB_FUSE2
			, TRB_FUSE_CONTENT
			, TRB_GEARMOTOR1
			, TRB_GEARMOTOR2
			, TRB_GEARMOTOR_CONTENT
			, TRB_TEMPATUR1
			, TRB_TEMPATUR2
			, TRB_TEMPATUR_CONTENT
			, TRB_PNUMT1
			, TRB_PNUMT2
			, TRB_PNUMT_CONTENT
			, TRB_CUTTING1
			, TRB_CUTTING2
			, TRB_CUTTING_CONTENT
			, TRB_SENSOR1
			, TRB_SENSOR2
			, TRB_SENSOR_CONTENT
			, TRB_CYLINDER1
			, TRB_CYLINDER2
			, TRB_CYLINDER_CONTENT
			, TRB_VISION1
			, TRB_VISION2
			, TRB_VISION_CONTENT
			, TRB_ETC1
			, TRB_ETC2
			, TRB_ETC_CONTENT
			, REG_ID
			, REG_DATE
			) 
			VALUES(
				#{equipCd},
				#{faultyRegDate},
				#{dayNightCd},
			 	( CASE  WHEN  #{trbServo1} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{trbServo2} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{trbFuse1} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{trbFuse2} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{trbGearmotor1} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{trbGearmotor2} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{trbTempatur1} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{trbTempatur2} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{trbPnumt1} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{trbPnumt2} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{trbCutting1} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{trbCutting2} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{trbSensor1} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{trbSensor2} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{trbCylinder1} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{trbCylinder2} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{trbVision1} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{trbVision2} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{trbEtc1} > 0 THEN 1 ELSE 0 END +
				CASE  WHEN  #{trbEtc2} > 0 THEN 1 ELSE 0 END )	,
				( #{trbServo1} + #{trbServo2} + #{trbFuse1} + #{trbFuse2} + #{trbGearmotor1} + #{trbGearmotor2}
				+ #{trbTempatur1} + #{trbTempatur2} + #{trbPnumt1} + #{trbPnumt2} + #{trbCutting1} + #{trbCutting2}
				+ #{trbSensor1} + #{trbSensor2} + #{trbCylinder1} + #{trbCylinder2} + #{trbVision1} + #{trbVision2}
				+ #{trbEtc1} + #{trbEtc2} ) ,
				#{trbServo1},
				#{trbServo2},
				#{trbServoContent},
				#{trbFuse1},
				#{trbFuse2},
				#{trbFuseContent},
				#{trbGearmotor1},
				#{trbGearmotor2},
				#{trbGearmotorContent},
				#{trbTempatur1},
				#{trbTempatur2},
				#{trbTempaturContent},
				#{trbPnumt1},
				#{trbPnumt2},
				#{trbPnumtContent},
				#{trbCutting1},
				#{trbCutting2},
				#{trbCuttingContent},
				#{trbSensor1},
				#{trbSensor2},
				#{trbSensorContent},
				#{trbCylinder1},
				#{trbCylinder2},
				#{trbCylinderContent},
				#{trbVision1},
				#{trbVision2},
				#{trbVisionContent},
				#{trbEtc1},
				#{trbEtc2},
				#{trbEtcContent},
				#{regId},
				getDate()
			)
	</insert>
		
	<!-- 설비트러블 불량  수정  -->
	<update id="updateTroubleFaulty" parameterType="mes.domain.po.EquipTroubleFaultyAdmVo">
		UPDATE	TB_EQUIP_TROUBLE_FAULTY_ADM 
			SET
				EQUIP_CD = #{equipCd}
				, FAULTY_REG_DATE = #{faultyRegDate}
				, DAY_NIGHT_CD = #{dayNightCd}
				, TRB_CNT = 
					( CASE  WHEN  #{trbServo1} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{trbServo2} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{trbFuse1} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{trbFuse2} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{trbGearmotor1} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{trbGearmotor2} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{trbTempatur1} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{trbTempatur2} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{trbPnumt1} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{trbPnumt2} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{trbCutting1} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{trbCutting2} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{trbSensor1} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{trbSensor2} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{trbCylinder1} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{trbCylinder2} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{trbVision1} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{trbVision2} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{trbEtc1} > 0 THEN 1 ELSE 0 END +
					CASE  WHEN  #{trbEtc2} > 0 THEN 1 ELSE 0 END )
				, TRB_TOTAL = 
					( #{trbServo1} + #{trbServo2} + #{trbFuse1} + #{trbFuse2} + #{trbGearmotor1} + #{trbGearmotor2}
					+ #{trbTempatur1} + #{trbTempatur2} + #{trbPnumt1} + #{trbPnumt2} + #{trbCutting1} + #{trbCutting2}
					+ #{trbSensor1} + #{trbSensor2} + #{trbCylinder1} + #{trbCylinder2} + #{trbVision1} + #{trbVision2}
					+ #{trbEtc1} + #{trbEtc2} )				
				, TRB_SERVO1 = #{trbServo1}
				, TRB_SERVO2 = #{trbServo2}
				, TRB_SERVO_CONTENT = #{trbServoContent}
				, TRB_FUSE1 = #{trbFuse1}
				, TRB_FUSE2 = #{trbFuse2}
				, TRB_FUSE_CONTENT = #{trbFuseContent}
				, TRB_GEARMOTOR1 = #{trbGearmotor1}
				, TRB_GEARMOTOR2 = #{trbGearmotor2}
				, TRB_GEARMOTOR_CONTENT = #{trbGearmotorContent}
				, TRB_TEMPATUR1 = #{trbTempatur1}
				, TRB_TEMPATUR2 = #{trbTempatur2}
				, TRB_TEMPATUR_CONTENT = #{trbTempaturContent}
				, TRB_PNUMT1 = #{trbPnumt1}
				, TRB_PNUMT2 = #{trbPnumt2}
				, TRB_PNUMT_CONTENT = #{trbPnumtContent}
				, TRB_CUTTING1 = #{trbCutting1}
				, TRB_CUTTING2 = #{trbCutting2}
				, TRB_CUTTING_CONTENT = #{trbCuttingContent}
				, TRB_SENSOR1 = #{trbSensor1}
				, TRB_SENSOR2 = #{trbSensor2}
				, TRB_SENSOR_CONTENT = #{trbSensorContent}
				, TRB_CYLINDER1 = #{trbCylinder1}
				, TRB_CYLINDER2 = #{trbCylinder2}
				, TRB_CYLINDER_CONTENT = #{trbCylinderContent}
				, TRB_VISION1 = #{trbVision1}
				, TRB_VISION2 = #{trbVision2}
				, TRB_VISION_CONTENT = #{trbVisionContent}
				, TRB_ETC1 = #{trbEtc1}
				, TRB_ETC2 = #{trbEtc2}
				, TRB_ETC_CONTENT = #{trbEtcContent}
				, UPD_ID = #{updId}
				, UPD_DATE = getDate()
		WHERE
			EQUIP_CD = #{equipCd}
		AND
			FAULTY_REG_DATE = #{faultyRegDate}
		AND
			DAY_NIGHT_CD = #{dayNightCd}
	</update>
	<!-- __________________________________________설비 트러블 불량 끝__________________________________________ -->
	
	
	
	
	
	
	
	<!-- __________________________________________불량 총합 시작__________________________________________ -->
	<select id="totalPrcssFaulty" resultMap="EquipPrcssFaultyAdmVo">
		<![CDATA[
			SELECT
				A.DAY_TOTAL_PRCSS_SUM, B.NIGHT_TOTAL_PRCSS_SUM, A.DAY_TOTAL_PRCSS_SUM + B.NIGHT_TOTAL_PRCSS_SUM AS TOTAL_PRCSS_SUM
			FROM (
				SELECT
					PRCS_TOTAL AS 'DAY_TOTAL_PRCSS_SUM'
				FROM
					TB_EQUIP_PRCSS_FAULTY_ADM
				WHERE
					EQUIP_CD = #{equipCd}
				AND
					FAULTY_REG_DATE = #{faultyRegDate}
				AND
					DAY_NIGHT_CD = 'D'	) A ,
				(SELECT
					PRCS_TOTAL AS 'NIGHT_TOTAL_PRCSS_SUM' FROM TB_EQUIP_PRCSS_FAULTY_ADM
				WHERE
					EQUIP_CD = #{equipCd}
				AND
					FAULTY_REG_DATE = #{faultyRegDate}
				AND
					DAY_NIGHT_CD = 'N'	) B
 		]]>
	</select>
	
	<select id="totalMatrlFaulty" resultMap="EquipMatrlFaultyAdmVo">
		<![CDATA[
			SELECT
				A.DAY_TOTAL_MATRL_SUM, B.NIGHT_TOTAL_MATRL_SUM, A.DAY_TOTAL_MATRL_SUM + B.NIGHT_TOTAL_MATRL_SUM AS TOTAL_MATRL_SUM
			FROM (
				SELECT
					MATRL_TOTAL AS 'DAY_TOTAL_MATRL_SUM'
				FROM
					TB_EQUIP_MATRL_FAULTY_ADM
				WHERE
					EQUIP_CD = #{equipCd}
				AND
					FAULTY_REG_DATE = #{faultyRegDate}
				AND
					DAY_NIGHT_CD = 'D'	) A ,
				(SELECT
					MATRL_TOTAL	AS 'NIGHT_TOTAL_MATRL_SUM'
				FROM
					TB_EQUIP_MATRL_FAULTY_ADM
				WHERE
					EQUIP_CD = #{equipCd}
				AND
					FAULTY_REG_DATE = #{faultyRegDate}
				AND
					DAY_NIGHT_CD = 'N'	) B
 		]]>
	</select>
	
	<select id="totalReplaceFaulty" resultMap="EquipReplaceFaultyAdmVo">
		<![CDATA[
			SELECT A.DAY_TOTAL_REPLACE_COUNT, A.DAY_TOTAL_REPLACE_SUM, B.NIGHT_TOTAL_REPLACE_COUNT, B.NIGHT_TOTAL_REPLACE_SUM
					, (A.DAY_TOTAL_REPLACE_COUNT + B.NIGHT_TOTAL_REPLACE_COUNT) AS TOTAL_REPLACE_COUNT, (A.DAY_TOTAL_REPLACE_SUM + B.NIGHT_TOTAL_REPLACE_SUM) AS TOTAL_REPLACE_SUM FROM
				(SELECT 
					RPC_CNT AS 'DAY_TOTAL_REPLACE_COUNT' ,
			 		RPC_TOTAL AS 'DAY_TOTAL_REPLACE_SUM'
				FROM
					TB_EQUIP_REPLACE_FAULTY_ADM
				WHERE
					EQUIP_CD = #{equipCd}
				AND
					FAULTY_REG_DATE = #{faultyRegDate}
				AND DAY_NIGHT_CD = 'D') A,
				(SELECT 
					RPC_CNT AS 'NIGHT_TOTAL_REPLACE_COUNT' ,
			 		RPC_TOTAL AS 'NIGHT_TOTAL_REPLACE_SUM'
				FROM
					TB_EQUIP_REPLACE_FAULTY_ADM
				WHERE
					EQUIP_CD = #{equipCd}
				AND
					FAULTY_REG_DATE = #{faultyRegDate}
				AND DAY_NIGHT_CD = 'N'	) B
 		]]>
	</select>
	
	<select id="totalTroubleFaulty" resultMap="EquipTroubleFaultyAdmVo">
		<![CDATA[
			SELECT A.DAY_TOTAL_TROUBLE_COUNT, A.DAY_TOTAL_TROUBLE_SUM, B.NIGHT_TOTAL_TROUBLE_COUNT, B.NIGHT_TOTAL_TROUBLE_SUM
					, (A.DAY_TOTAL_TROUBLE_COUNT + B.NIGHT_TOTAL_TROUBLE_COUNT) AS TOTAL_TROUBLE_COUNT , (A.DAY_TOTAL_TROUBLE_SUM + B.NIGHT_TOTAL_TROUBLE_SUM) AS TOTAL_TROUBLE_SUM FROM
				(SELECT 
					TRB_CNT AS 'DAY_TOTAL_TROUBLE_COUNT',
			 		TRB_TOTAL AS 'DAY_TOTAL_TROUBLE_SUM'
				FROM
					TB_EQUIP_TROUBLE_FAULTY_ADM
			WHERE
				EQUIP_CD = #{equipCd}
			AND
				FAULTY_REG_DATE = #{faultyRegDate}
				AND DAY_NIGHT_CD = 'D') A,
				(SELECT 
					TRB_CNT AS 'NIGHT_TOTAL_TROUBLE_COUNT',
			 		TRB_TOTAL AS 'NIGHT_TOTAL_TROUBLE_SUM'
				FROM
					TB_EQUIP_TROUBLE_FAULTY_ADM
			WHERE
				EQUIP_CD = #{equipCd}
			AND
				FAULTY_REG_DATE = #{faultyRegDate}
				AND DAY_NIGHT_CD = 'N'	) B
 		]]>
	</select>
	
	<!-- 불량 통계 -->
	<select id="totalFaulty" resultMap="TotalFaultyAdmVo">
		<![CDATA[
			SELECT
				DISTINCT EQUIP_CD
				
				, ISNULL((SELECT COUNT(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE	EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '001' AND DAY_NIGHT_CD = 'D'), 0) DAY_TOTAL_PRCSS_COUNT
				, ISNULL((SELECT COUNT(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '001' AND DAY_NIGHT_CD = 'N'), 0) NIGHT_TOTAL_PRCSS_COUNT
				, ISNULL((SELECT COUNT(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE	EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '002' AND DAY_NIGHT_CD = 'D'), 0) DAY_TOTAL_MATRL_COUNT
				, ISNULL((SELECT COUNT(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '002' AND DAY_NIGHT_CD = 'N'), 0) NIGHT_TOTAL_MATRL_COUNT
				, ISNULL((SELECT COUNT(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE	EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '003' AND DAY_NIGHT_CD = 'D'), 0) DAY_TOTAL_REPLACE_COUNT
				, ISNULL((SELECT COUNT(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '003' AND DAY_NIGHT_CD = 'N'), 0) NIGHT_TOTAL_REPLACE_COUNT
				, ISNULL((SELECT COUNT(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '004' AND DAY_NIGHT_CD = 'D'), 0) DAY_TOTAL_TROUBLE_COUNT
				, ISNULL((SELECT COUNT(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '004' AND DAY_NIGHT_CD = 'N'), 0) NIGHT_TOTAL_TROUBLE_COUNT

				, ISNULL((SELECT COUNT(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '001' GROUP BY EQUIP_CD,FAULTY_REG_DATE,GUBUN), 0) TOTAL_PRCSS_COUNT
				, ISNULL((SELECT COUNT(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '002' GROUP BY EQUIP_CD,FAULTY_REG_DATE,GUBUN), 0) TOTAL_MATRL_COUNT
				, ISNULL((SELECT COUNT(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '003' GROUP BY EQUIP_CD,FAULTY_REG_DATE,GUBUN), 0) TOTAL_REPLACE_COUNT
				, ISNULL((SELECT COUNT(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '004' GROUP BY EQUIP_CD,FAULTY_REG_DATE,GUBUN), 0) TOTAL_TROUBLE_COUNT
				
				, ISNULL((SELECT SUM(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '001' AND DAY_NIGHT_CD = 'D' GROUP BY EQUIP_CD, FAULTY_REG_DATE, GUBUN), 0) DAY_TOTAL_PRCSS_SUM
				, ISNULL((SELECT SUM(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '001' AND DAY_NIGHT_CD = 'N' GROUP BY EQUIP_CD,FAULTY_REG_DATE,GUBUN),0) NIGHT_TOTAL_PRCSS_SUM
				, ISNULL((SELECT SUM(FAULTY) FROM TB_ALL_FAULTY_ADM	WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '002' AND DAY_NIGHT_CD = 'D' GROUP BY EQUIP_CD,FAULTY_REG_DATE,GUBUN), 0) DAY_TOTAL_MATRL_SUM
				, ISNULL((SELECT SUM(FAULTY) FROM TB_ALL_FAULTY_ADM	WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '002' AND DAY_NIGHT_CD = 'N' GROUP BY EQUIP_CD,FAULTY_REG_DATE,GUBUN), 0) NIGHT_TOTAL_MATRL_SUM
				, ISNULL((SELECT SUM(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '003' AND DAY_NIGHT_CD = 'D' GROUP BY EQUIP_CD,FAULTY_REG_DATE,GUBUN,DAY_NIGHT_CD), 0) DAY_TOTAL_REPLACE_SUM
				, ISNULL((SELECT SUM(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '003' AND DAY_NIGHT_CD = 'N' GROUP BY EQUIP_CD,FAULTY_REG_DATE,GUBUN,DAY_NIGHT_CD), 0) NIGHT_TOTAL_REPLACE_SUM
				, ISNULL((SELECT SUM(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '004' AND DAY_NIGHT_CD = 'D' GROUP BY EQUIP_CD,FAULTY_REG_DATE,GUBUN,DAY_NIGHT_CD), 0) DAY_TOTAL_TROUBLE_SUM
				, ISNULL((SELECT SUM(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '004' AND DAY_NIGHT_CD = 'N' GROUP BY EQUIP_CD,FAULTY_REG_DATE,GUBUN,DAY_NIGHT_CD), 0) NIGHT_TOTAL_TROUBLE_SUM

				, ISNULL((SELECT SUM(FAULTY) FROM TB_ALL_FAULTY_ADM	WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '001' GROUP BY EQUIP_CD,FAULTY_REG_DATE,GUBUN), 0) TOTAL_PRCSS_SUM
				, ISNULL((SELECT SUM(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '002' GROUP BY EQUIP_CD,FAULTY_REG_DATE,GUBUN), 0) TOTAL_MATRL_SUM
				, ISNULL((SELECT SUM(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '003' GROUP BY EQUIP_CD,FAULTY_REG_DATE,GUBUN), 0) TOTAL_REPLACE_SUM
				, ISNULL((SELECT SUM(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '004' GROUP BY EQUIP_CD,FAULTY_REG_DATE,GUBUN), 0) TOTAL_TROUBLE_SUM
				
				
				
				, ISNULL((SELECT COUNT(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE	EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '005' AND DAY_NIGHT_CD = 'D'), 0) DAY_TOTAL_114_COUNT
				, ISNULL((SELECT COUNT(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '005' AND DAY_NIGHT_CD = 'N'), 0) NIGHT_TOTAL_114_COUNT
				, ISNULL((SELECT COUNT(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '005' GROUP BY EQUIP_CD,FAULTY_REG_DATE,GUBUN), 0) TOTAL_114_COUNT
				
				, ISNULL((SELECT COUNT(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE	EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '006' AND DAY_NIGHT_CD = 'D'), 0) DAY_TOTAL_115_COUNT
				, ISNULL((SELECT COUNT(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '006' AND DAY_NIGHT_CD = 'N'), 0) NIGHT_TOTAL_115_COUNT
				, ISNULL((SELECT COUNT(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '006' GROUP BY EQUIP_CD,FAULTY_REG_DATE,GUBUN), 0) TOTAL_115_COUNT
				
				, ISNULL((SELECT COUNT(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE	EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '007' AND DAY_NIGHT_CD = 'D'), 0) DAY_TOTAL_116_COUNT
				, ISNULL((SELECT COUNT(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '007' AND DAY_NIGHT_CD = 'N'), 0) NIGHT_TOTAL_116_COUNT
				, ISNULL((SELECT COUNT(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '007' GROUP BY EQUIP_CD,FAULTY_REG_DATE,GUBUN), 0) TOTAL_116_COUNT
				
				
				, ISNULL((SELECT SUM(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '005' AND DAY_NIGHT_CD = 'D' GROUP BY EQUIP_CD, FAULTY_REG_DATE, GUBUN), 0) DAY_TOTAL_114_SUM
				, ISNULL((SELECT SUM(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '005' AND DAY_NIGHT_CD = 'N' GROUP BY EQUIP_CD,FAULTY_REG_DATE,GUBUN),0) NIGHT_TOTAL_114_SUM
				, ISNULL((SELECT SUM(FAULTY) FROM TB_ALL_FAULTY_ADM	WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '005' GROUP BY EQUIP_CD,FAULTY_REG_DATE,GUBUN), 0) TOTAL_114_SUM
				
				, ISNULL((SELECT SUM(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '006' AND DAY_NIGHT_CD = 'D' GROUP BY EQUIP_CD, FAULTY_REG_DATE, GUBUN), 0) DAY_TOTAL_115_SUM
				, ISNULL((SELECT SUM(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '006' AND DAY_NIGHT_CD = 'N' GROUP BY EQUIP_CD,FAULTY_REG_DATE,GUBUN),0) NIGHT_TOTAL_115_SUM
				, ISNULL((SELECT SUM(FAULTY) FROM TB_ALL_FAULTY_ADM	WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '006' GROUP BY EQUIP_CD,FAULTY_REG_DATE,GUBUN), 0) TOTAL_115_SUM
				
				, ISNULL((SELECT SUM(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '007' AND DAY_NIGHT_CD = 'D' GROUP BY EQUIP_CD, FAULTY_REG_DATE, GUBUN), 0) DAY_TOTAL_116_SUM
				, ISNULL((SELECT SUM(FAULTY) FROM TB_ALL_FAULTY_ADM WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '007' AND DAY_NIGHT_CD = 'N' GROUP BY EQUIP_CD,FAULTY_REG_DATE,GUBUN),0) NIGHT_TOTAL_116_SUM
				, ISNULL((SELECT SUM(FAULTY) FROM TB_ALL_FAULTY_ADM	WHERE EQUIP_CD = #{equipCd} AND FAULTY_REG_DATE = #{faultyRegDate} AND WORK_ORD_NO = #{workOrdNo} AND LOT_NO = #{lotNo} AND GUBUN = '007' GROUP BY EQUIP_CD,FAULTY_REG_DATE,GUBUN), 0) TOTAL_116_SUM
				
			FROM TB_ALL_FAULTY_ADM A
			WHERE EQUIP_CD = #{equipCd}
			AND	FAULTY_REG_DATE = #{faultyRegDate}
 		]]>
	</select>
	<!-- __________________________________________불량 총합 끝__________________________________________ -->
	
	<!-- __________________________________________불량내역조회(전체) wmsc0070__________________________________________ -->
	<select id="readFaultyHistoryList" resultMap="FaultyHistoryVo">
		<![CDATA[
			SELECT 
				AA.EQUIP_CD
				, AA.EQUIP_NM
				, AA.ORD_DATE
				, AA.GOODS_CD
				, AA.GOODS_NM
				, AA.QUTY_CD
				, AA.ALNICU_MATRL_NM
				, AA.GRAVITY
				, AA.DAY_NIGHT_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = AA.DAY_NIGHT_CD) DAY_NIGHT_NM
				, AA.PRCS_TOTAL
				, AA.MATRL_TOTAL
				, AA.RPC_TOTAL
				, AA.TRB_TOTAL
				, BB.PRCS_CNT
				, BB.MATRL_CNT
				, BB.RPC_CNT
				, BB.TRB_CNT
				, CAST(AA.PRCS_TOTAL / AA.GRAVITY * 1000 AS INT) PRCS_EA
				, CAST(AA.MATRL_TOTAL / AA.GRAVITY * 1000 AS INT) MATRL_EA
				, CAST(AA.RPC_TOTAL / AA.GRAVITY * 1000 AS INT) RPC_EA
				, CAST(AA.TRB_TOTAL / AA.GRAVITY * 1000 AS INT) TRB_EA
			FROM
				(SELECT
					TT.EQUIP_CD
					, TT.EQUIP_NM
					, TT.ORD_DATE
					, TT.GOODS_CD
					, TT.GOODS_NM
					, TT.QUTY_CD
					, TT.ALNICU_MATRL_NM
					, TT.GRAVITY
					, TT.DAY_NIGHT_CD
					, ISNULL(TT.[001], 0) PRCS_TOTAL
					, ISNULL(TT.[002], 0) MATRL_TOTAL
					, ISNULL(TT.[003], 0) RPC_TOTAL
					, ISNULL(TT.[004], 0) TRB_TOTAL
				FROM (
					SELECT
						A.EQUIP_CD
						, A.EQUIP_NM
						, ISNULL(C.ORD_DATE, #{chooseDate2}) ORD_DATE
						, D.GOODS_CD
						, D.GOODS_NM
						, E.QUTY_CD
						, ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = E.QUTY_CD), '') ALNICU_MATRL_NM
						, ISNULL(D.GRAVITY, 1) GRAVITY
						, ISNULL(B.DAY_NIGHT_CD, 'D') DAY_NIGHT_CD
						--, B.PRCS_CNT
						, B.PRCS_TOTAL
						, B.GUBUN 
					FROM TB_EQUIP_CODE_ADM A
					LEFT OUTER JOIN TB_ALL_FAULTY_ADM B ON A.EQUIP_CD = B.EQUIP_CD AND B.DAY_NIGHT_CD = 'D' AND B.FAULTY_REG_DATE = #{chooseDate2}
					LEFT OUTER JOIN TB_WORK_ORDER C ON A.EQUIP_CD = C.EQUIP_CD AND B.FAULTY_REG_DATE = C.ORD_DATE AND C.ORD_DATE = #{chooseDate2}
					LEFT OUTER JOIN TB_GOODS_CODE_ADM D ON D.GOODS_CD = C.GOODS_CD
					LEFT OUTER JOIN TB_MATRL_CODE_ADM E ON E.MATRL_CD = D.ALNICU_MATRL_CD
					GROUP BY A.EQUIP_CD, A.EQUIP_NM, C.ORD_DATE, D.GOODS_CD, D.GOODS_NM, E.QUTY_CD, ALNICU_MATRL_CD, D.GRAVITY, B.DAY_NIGHT_CD, PRCS_CNT, B.PRCS_TOTAL, B.GUBUN
			
					UNION ALL
			
						SELECT
						A.EQUIP_CD
						, A.EQUIP_NM
						, ISNULL(C.ORD_DATE, #{chooseDate2}) ORD_DATE
						, D.GOODS_CD
						, D.GOODS_NM
						, E.QUTY_CD
						, ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = E.QUTY_CD), '') ALNICU_MATRL_NM
						, ISNULL(D.GRAVITY, 1) GRAVITY
						, ISNULL(B.DAY_NIGHT_CD, 'N') DAY_NIGHT_CD
						--, B.PRCS_CNT
						, B.PRCS_TOTAL
						, B.GUBUN 
					FROM TB_EQUIP_CODE_ADM A
					LEFT OUTER JOIN TB_ALL_FAULTY_ADM B ON A.EQUIP_CD = B.EQUIP_CD AND B.DAY_NIGHT_CD = 'N' AND B.FAULTY_REG_DATE = #{chooseDate2}
					LEFT OUTER JOIN TB_WORK_ORDER C ON A.EQUIP_CD = C.EQUIP_CD AND B.FAULTY_REG_DATE = C.ORD_DATE AND C.ORD_DATE = #{chooseDate2}
					LEFT OUTER JOIN TB_GOODS_CODE_ADM D ON D.GOODS_CD = C.GOODS_CD
					LEFT OUTER JOIN TB_MATRL_CODE_ADM E ON E.MATRL_CD = D.ALNICU_MATRL_CD
					GROUP BY A.EQUIP_CD, A.EQUIP_NM, C.ORD_DATE, D.GOODS_CD, D.GOODS_NM, E.QUTY_CD, ALNICU_MATRL_CD, D.GRAVITY, B.DAY_NIGHT_CD, PRCS_CNT, B.PRCS_TOTAL, B.GUBUN
				) AS t
				PIVOT ( SUM(t.PRCS_TOTAL) FOR t.GUBUN IN ([001], [002], [003], [004])) AS TT
				) AA,
			
				(SELECT
					TT.EQUIP_CD
					, TT.EQUIP_NM
					, TT.ORD_DATE
					, TT.GOODS_CD
					, TT.GOODS_NM
					, TT.QUTY_CD
					, TT.ALNICU_MATRL_NM
					, TT.GRAVITY
					, TT.DAY_NIGHT_CD
					, ISNULL(TT.[001], 0) PRCS_CNT
					, ISNULL(TT.[002], 0) MATRL_CNT
					, ISNULL(TT.[003], 0) RPC_CNT
					, ISNULL(TT.[004], 0) TRB_CNT
				FROM (
					SELECT
						A.EQUIP_CD
						, A.EQUIP_NM
						, ISNULL(C.ORD_DATE, #{chooseDate2}) ORD_DATE
						, D.GOODS_CD
						, D.GOODS_NM
						, E.QUTY_CD
						, ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = E.QUTY_CD), '') ALNICU_MATRL_NM
						, ISNULL(D.GRAVITY, 1) GRAVITY
						, ISNULL(B.DAY_NIGHT_CD, 'D') DAY_NIGHT_CD
						, B.PRCS_CNT
						--, B.PRCS_TOTAL
						, B.GUBUN 
					FROM TB_EQUIP_CODE_ADM A
					LEFT OUTER JOIN TB_ALL_FAULTY_ADM B ON A.EQUIP_CD = B.EQUIP_CD AND B.DAY_NIGHT_CD = 'D' AND B.FAULTY_REG_DATE = #{chooseDate2}
					LEFT OUTER JOIN TB_WORK_ORDER C ON A.EQUIP_CD = C.EQUIP_CD AND B.FAULTY_REG_DATE = C.ORD_DATE AND C.ORD_DATE = #{chooseDate2}
					LEFT OUTER JOIN TB_GOODS_CODE_ADM D ON D.GOODS_CD = C.GOODS_CD
					LEFT OUTER JOIN TB_MATRL_CODE_ADM E ON E.MATRL_CD = D.ALNICU_MATRL_CD
					GROUP BY A.EQUIP_CD, A.EQUIP_NM, C.ORD_DATE, D.GOODS_CD, D.GOODS_NM, E.QUTY_CD, ALNICU_MATRL_CD, D.GRAVITY, B.DAY_NIGHT_CD, PRCS_CNT, B.PRCS_TOTAL, B.GUBUN
			
					UNION ALL
			
					SELECT
						A.EQUIP_CD
						, A.EQUIP_NM
						, ISNULL(C.ORD_DATE, #{chooseDate2}) ORD_DATE
						, D.GOODS_CD
						, D.GOODS_NM
						, E.QUTY_CD
						, ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = E.QUTY_CD), '') ALNICU_MATRL_NM
						, ISNULL(D.GRAVITY, 1) GRAVITY
						, ISNULL(B.DAY_NIGHT_CD, 'N') DAY_NIGHT_CD
						, B.PRCS_CNT
						--, B.PRCS_TOTAL
						, B.GUBUN 
					FROM TB_EQUIP_CODE_ADM A
					LEFT OUTER JOIN TB_ALL_FAULTY_ADM B ON A.EQUIP_CD = B.EQUIP_CD AND B.DAY_NIGHT_CD = 'N' AND B.FAULTY_REG_DATE = #{chooseDate2}
					LEFT OUTER JOIN TB_WORK_ORDER C ON A.EQUIP_CD = C.EQUIP_CD AND B.FAULTY_REG_DATE = C.ORD_DATE AND C.ORD_DATE = #{chooseDate2}
					LEFT OUTER JOIN TB_GOODS_CODE_ADM D ON D.GOODS_CD = C.GOODS_CD
					LEFT OUTER JOIN TB_MATRL_CODE_ADM E ON E.MATRL_CD = D.ALNICU_MATRL_CD
					GROUP BY A.EQUIP_CD, A.EQUIP_NM, C.ORD_DATE, D.GOODS_CD, D.GOODS_NM, E.QUTY_CD, ALNICU_MATRL_CD, D.GRAVITY, B.DAY_NIGHT_CD, PRCS_CNT, B.PRCS_TOTAL, B.GUBUN
				) AS t
				PIVOT ( SUM(t.PRCS_CNT) FOR t.GUBUN IN ([001], [002], [003], [004])) AS TT
				) BB
			WHERE AA.EQUIP_CD = BB.EQUIP_CD
			AND AA.ORD_DATE= BB.ORD_DATE
			AND AA.DAY_NIGHT_CD = BB.DAY_NIGHT_CD
			ORDER BY AA.DAY_NIGHT_CD, AA.EQUIP_NM
		]]>
	</select>
	
	
	<!-- 생산실적 기종별(불량내역전체 포함) -->
	<select id="readActualOutputGoodsList" resultMap="FaultyHistoryVo">
		
		<!-- 	SELECT
				DD.GOODS_CD
				, DD.GOODS_NM
				, DD.GRAVITY
				, DD.MODEL
				, EE.QUTY_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = EE.QUTY_CD) QUTY_NM
				, ISNULL(CC.SUM_TARGET_CNT, 0) SUM_TARGET_CNT
				, ISNULL(CC.SUM_OUTPUT_CNT, 0) SUM_OUTPUT_CNT
				, ISNULL(BB.PRCS_CNT, 0) PRCS_CNT
				, ISNULL(BB.MATRL_CNT, 0) MATRL_CNT
				, ISNULL(BB.RPC_CNT, 0) RPC_CNT
				, ISNULL(BB.TRB_CNT, 0) TRB_CNT
				, ISNULL(AA.PRCS_TOTAL, 0) PRCS_TOTAL
				, ISNULL(AA.MATRL_TOTAL, 0) MATRL_TOTAL
				, ISNULL(AA.RPC_TOTAL, 0) RPC_TOTAL
				, ISNULL(AA.TRB_TOTAL, 0) TRB_TOTAL
				
				, ISNULL( CAST( CAST(AA.PRCS_TOTAL AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS INT), 0 ) AS PRCS_EA
				, ISNULL( CAST( CAST(AA.MATRL_TOTAL AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS INT), 0 ) AS MATRL_EA
				, ISNULL( CAST( CAST(AA.RPC_TOTAL AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS INT), 0 ) AS RPC_EA
				, ISNULL( CAST( CAST(AA.TRB_TOTAL AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS INT), 0 ) AS TRB_EA
				
				,ISNULL(FF.APPEAR_FAULTY_CNT,0)  APPEAR_FAULTY_CNT
				,ISNULL(GG.EDGE_FAULTY_CNT,0)  EDGE_FAULTY_CNT
				,ISNULL(HH.SHIP_FAULTY_CNT,0)  SHIP_FAULTY_CNT
				,ISNULL(II.RE_SHIP_FAULTY_CNT,0)  RE_SHIP_FAULTY_CNT

				,(ISNULL(FF.APPEAR_FAULTY_CNT,0) + ISNULL(GG.EDGE_FAULTY_CNT,0) + ISNULL(HH.SHIP_FAULTY_CNT,0) + ISNULL(II.RE_SHIP_FAULTY_CNT,0)) OUTPUT_FAULTY_CNT
				
			FROM
				TB_MATRL_CODE_ADM EE, TB_GOODS_CODE_ADM DD LEFT JOIN
				(SELECT
					A.GOODS_CD
					, SUM(A.TARGET_CNT) SUM_TARGET_CNT
					, SUM(B.SUM_OUTPUT_CNT) SUM_OUTPUT_CNT
				FROM TB_WORK_ORDER A
					, (SELECT
						WORK_ORD_NO
						, SUM(OUTPUT_CNT + VISION_EDGE_CNT) SUM_OUTPUT_CNT
						FROM TB_WORK_ORDER_OUTPUT_SUB
						WHERE WORK_ORD_DATE >= #{chooseDate1}
						AND WORK_ORD_DATE <= #{chooseDate2}
						GROUP BY WORK_ORD_NO) B
				WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
				GROUP BY GOODS_CD) CC ON DD.GOODS_CD = CC.GOODS_CD
				LEFT JOIN
				(SELECT
					TT.GOODS_CD
					, ISNULL(TT.[001], 0) PRCS_TOTAL
					, ISNULL(TT.[002], 0) MATRL_TOTAL
					, ISNULL(TT.[003], 0) RPC_TOTAL
					, ISNULL(TT.[004], 0) TRB_TOTAL
				FROM (
					SELECT
						C.GOODS_CD
						, SUM(A.FAULTY) FAULTY
						, A.GUBUN
					FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B, TB_GOODS_CODE_ADM C
					WHERE A.FAULTY_REG_DATE >= #{chooseDate1}
					AND A.FAULTY_REG_DATE <= #{chooseDate2}
					AND A.WORK_ORD_NO = B.WORK_ORD_NO
					AND B.GOODS_CD = C.GOODS_CD
					GROUP BY C.GOODS_CD, A.GUBUN
				) AS t PIVOT (SUM(t.FAULTY) FOR t.GUBUN IN ([001], [002], [003], [004])) AS TT) AA ON DD.GOODS_CD = AA.GOODS_CD
				LEFT JOIN 
				(SELECT
					TT.GOODS_CD
					, ISNULL(TT.[001], 0) PRCS_CNT
					, ISNULL(TT.[002], 0) MATRL_CNT
					, ISNULL(TT.[003], 0) RPC_CNT
					, ISNULL(TT.[004], 0) TRB_CNT
				FROM (
					SELECT
						C.GOODS_CD
						, COUNT(FAULTY) PRCS_CNT 
						
						, A.GUBUN
					FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B, TB_GOODS_CODE_ADM C
					WHERE A.FAULTY_REG_DATE >= #{chooseDate1}
					AND A.FAULTY_REG_DATE <= #{chooseDate2}
					AND A.WORK_ORD_NO = B.WORK_ORD_NO
					AND B.GOODS_CD = C.GOODS_CD
					GROUP BY C.GOODS_CD, A.GUBUN
				) AS t PIVOT ( SUM(t.PRCS_CNT) FOR t.GUBUN IN ([001], [002], [003], [004])) AS TT) BB ON DD.GOODS_CD = BB.GOODS_CD
								LEFT JOIN				
				(
				SELECT
					A.GOODS_CD					
					, SUM(B.APPEAR_FAULTY_CNT) APPEAR_FAULTY_CNT					
				FROM TB_WORK_ORDER A
					, (SELECT
						WORK_ORD_NO
						, SUM(APPEAR_FAULTY_CNT) APPEAR_FAULTY_CNT					
						FROM TB_WORK_ORDER_OUTPUT_SUB
						WHERE APPEAR_INSPCT_DATE >= #{chooseDate1}
						AND APPEAR_INSPCT_DATE <= #{chooseDate2}
						GROUP BY WORK_ORD_NO) B
				WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
				GROUP BY GOODS_CD
				) FF
				ON DD.GOODS_CD = FF.GOODS_CD

				LEFT JOIN			
								(
				SELECT
					A.GOODS_CD					
					, SUM(B.EDGE_FAULTY_CNT) EDGE_FAULTY_CNT					
				FROM TB_WORK_ORDER A
					, (SELECT
						WORK_ORD_NO
						, SUM(EDGE_FAULTY_CNT) EDGE_FAULTY_CNT					
						FROM TB_WORK_ORDER_OUTPUT_SUB
						WHERE EDGE_INSPCT_DATE >= #{chooseDate1}
						AND EDGE_INSPCT_DATE <= #{chooseDate2}
						GROUP BY WORK_ORD_NO) B
				WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
				GROUP BY GOODS_CD
				) GG
				ON DD.GOODS_CD = GG.GOODS_CD

				LEFT JOIN
				(
				SELECT
					A.GOODS_CD					
					, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT					
				FROM TB_WORK_ORDER A
					, (SELECT
						WORK_ORD_NO
						, SUM(FAULTY_CNT) FAULTY_CNT					
						FROM TB_SHIP_INSPECT_ADM
						WHERE INSP_DATE >= #{chooseDate1}
						AND INSP_DATE <= #{chooseDate2}
						AND RE_INSP_STATUS = '001'
						GROUP BY WORK_ORD_NO) B
				WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
				GROUP BY GOODS_CD
				) HH
				ON DD.GOODS_CD = HH.GOODS_CD

				LEFT JOIN
				(
				SELECT
					A.GOODS_CD					
					, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
				FROM TB_WORK_ORDER A
					, (SELECT
						WORK_ORD_NO
						, SUM(FAULTY_CNT) FAULTY_CNT					
						FROM TB_SHIP_INSPECT_ADM
						WHERE INSP_DATE >= #{chooseDate1}
						AND INSP_DATE <= #{chooseDate2}
						AND RE_INSP_STATUS = '002'
						GROUP BY WORK_ORD_NO) B
				WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
				GROUP BY GOODS_CD
				) II
				ON DD.GOODS_CD = II.GOODS_CD
				WHERE DD.USE_YN_CD = '001'
			AND EE.MATRL_CD = DD.ALNICU_MATRL_CD
			ORDER BY DD.GOODS_NM -->
			
		<![CDATA[	
		SELECT
				DD.GOODS_CD
				, DD.GOODS_NM
				, DD.GRAVITY
				, DD.MODEL
				, EE.QUTY_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = EE.QUTY_CD) QUTY_NM
				, ISNULL(CC.SUM_TARGET_CNT, 0) SUM_TARGET_CNT
				, ISNULL(CC.SUM_OUTPUT_CNT, 0) SUM_OUTPUT_CNT
				, ISNULL(BB.PRCS_CNT, 0) PRCS_CNT
				, ISNULL(BB.MATRL_CNT, 0) MATRL_CNT
				, ISNULL(BB.RPC_CNT, 0) RPC_CNT
				, ISNULL(BB.TRB_CNT, 0) TRB_CNT
				
				, ISNULL(BB.CNT_5, 0) CNT_5
				, ISNULL(BB.CNT_6, 0) CNT_6
				, ISNULL(BB.CNT_7, 0) CNT_7
				
				, ISNULL(AA.PRCS_TOTAL, 0) PRCS_TOTAL
				, ISNULL(AA.MATRL_TOTAL, 0) MATRL_TOTAL
				, ISNULL(AA.RPC_TOTAL, 0) RPC_TOTAL
				, ISNULL(AA.TRB_TOTAL, 0) TRB_TOTAL
				
				, ISNULL(AA.TOTAL_5, 0) TOTAL_5
				, ISNULL(AA.TOTAL_6, 0) TOTAL_6
				, ISNULL(AA.TOTAL_7, 0) TOTAL_7
				
				, ISNULL( CAST( CAST(AA.PRCS_TOTAL AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS PRCS_EA
				, ISNULL( CAST( CAST(AA.MATRL_TOTAL AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS MATRL_EA
				, ISNULL( CAST( CAST(AA.RPC_TOTAL AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS RPC_EA
				, ISNULL( CAST( CAST(AA.TRB_TOTAL AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS TRB_EA
				
				, ISNULL( CAST( CAST(AA.METAL_TOTAL AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS METAL_EA
				, ISNULL( CAST( CAST(AA.FILM_TOTAL AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS FILM_EA
				, ISNULL( CAST( CAST(AA.SILICON_TOTAL AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS SILICON_EA
				, ISNULL( CAST( CAST(AA.TEFLON_TOTAL AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS TEFLON_EA
				
				
				, ISNULL( CAST( CAST(AA.TOTAL_5 AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS EA_5
				, ISNULL( CAST( CAST(AA.TOTAL_6 AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS EA_6
				, ISNULL( CAST( CAST(AA.TOTAL_7 AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS EA_7
				
				,ISNULL(FF.APPEAR_FAULTY_CNT,0)  APPEAR_FAULTY_CNT
				,ISNULL(GG.EDGE_FAULTY_CNT,0)  EDGE_FAULTY_CNT
				,ISNULL(HH.SHIP_FAULTY_CNT,0)  SHIP_FAULTY_CNT
				,ISNULL(II.RE_SHIP_FAULTY_CNT,0)  RE_SHIP_FAULTY_CNT

				,(ISNULL(FF.APPEAR_FAULTY_CNT,0) + ISNULL(GG.EDGE_FAULTY_CNT,0) + ISNULL(HH.SHIP_FAULTY_CNT,0) + ISNULL(II.RE_SHIP_FAULTY_CNT,0)) OUTPUT_FAULTY_CNT
				
			FROM
				TB_MATRL_CODE_ADM EE, TB_GOODS_CODE_ADM DD LEFT JOIN
				(SELECT
					A.GOODS_CD
					, SUM(A.TARGET_CNT) SUM_TARGET_CNT
					, SUM(B.SUM_OUTPUT_CNT) SUM_OUTPUT_CNT
				FROM TB_WORK_ORDER A
					, (SELECT
						WORK_ORD_NO
						, SUM(OUTPUT_CNT + VISION_EDGE_CNT) SUM_OUTPUT_CNT
						FROM TB_WORK_ORDER_OUTPUT_SUB
						WHERE WORK_ORD_DATE >= #{chooseDate1}
						AND WORK_ORD_DATE <= #{chooseDate2}
						GROUP BY WORK_ORD_NO) B
				WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
				GROUP BY GOODS_CD) CC ON DD.GOODS_CD = CC.GOODS_CD
				LEFT JOIN
				(
					SELECT
						TT.GOODS_CD
						, SUM(ISNULL(TT.[001], 0)) PRCS_TOTAL
						, SUM(ISNULL(TT.[002], 0)) MATRL_TOTAL
						, SUM(ISNULL(TT.[003], 0)) RPC_TOTAL
						, SUM(ISNULL(TT.[004], 0)) TRB_TOTAL
										
						, SUM(ISNULL(TT.[005], 0)) TOTAL_5
						, SUM(ISNULL(TT.[006], 0)) TOTAL_6
						, SUM(ISNULL(TT.[007], 0)) TOTAL_7
	

						, SUM(ISNULL(TT.[메탈], 0)) AS METAL_TOTAL						
						, SUM(ISNULL(TT.[필름], 0)) AS FILM_TOTAL
						, SUM(ISNULL(TT.[실리콘], 0)) AS SILICON_TOTAL
						, SUM(ISNULL(TT.[테프론], 0)) AS TEFLON_TOTAL
					FROM (
						SELECT
							C.GOODS_CD
							, SUM(A.FAULTY) FAULTY
							, A.GUBUN
							
							, ( CASE WHEN SYSTEM_CODE = '001' THEN SUM(FAULTY) END ) AS '메탈'
							, ( CASE WHEN SYSTEM_CODE = '002' THEN SUM(FAULTY) END ) AS '필름'
							, ( CASE WHEN SYSTEM_CODE = '003' OR SYSTEM_CODE = '007' THEN SUM(FAULTY) END ) AS '실리콘'
							, ( CASE WHEN SYSTEM_CODE = '004' OR SYSTEM_CODE = '008' THEN SUM(FAULTY) END ) AS '테프론'
			
						FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B
						,(
							SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}
						) X
						, TB_GOODS_CODE_ADM C
						WHERE X.WORK_ORD_NO = B.WORK_ORD_NO  
						AND A.WORK_ORD_NO = B.WORK_ORD_NO
						AND B.GOODS_CD = C.GOODS_CD
						
						GROUP BY C.GOODS_CD, A.GUBUN, A.SYSTEM_CODE
					
					) AS t PIVOT
					(
						SUM(t.FAULTY) FOR t.GUBUN IN ([001], [002], [003], [004], [005], [006], [007])
					) AS TT
					GROUP BY TT.GOODS_CD
				) AA
				ON DD.GOODS_CD = AA.GOODS_CD
				LEFT JOIN 
				(SELECT
					TT.GOODS_CD
					, ISNULL(TT.[001], 0) PRCS_CNT
					, ISNULL(TT.[002], 0) MATRL_CNT
					, ISNULL(TT.[003], 0) RPC_CNT
					, ISNULL(TT.[004], 0) TRB_CNT
					
					, ISNULL(TT.[005], 0) CNT_5
					, ISNULL(TT.[006], 0) CNT_6
					, ISNULL(TT.[007], 0) CNT_7
					
				FROM (
					SELECT
						C.GOODS_CD
						, COUNT(FAULTY) PRCS_CNT 
						--, SUM(A.FAULTY) FAULTY
						, A.GUBUN
					FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X, TB_GOODS_CODE_ADM C
					WHERE  X.WORK_ORD_NO = B.WORK_ORD_NO  
					AND A.WORK_ORD_NO = B.WORK_ORD_NO
					AND B.GOODS_CD = C.GOODS_CD
					GROUP BY C.GOODS_CD, A.GUBUN
				) AS t PIVOT ( SUM(t.PRCS_CNT) FOR t.GUBUN IN ([001], [002], [003], [004], [005], [006], [007])) AS TT) BB ON DD.GOODS_CD = BB.GOODS_CD
				LEFT JOIN
				(
				SELECT 
							
							
							 ISNULL(SUM(FAULTY_CNT),0) APPEAR_FAULTY_CNT
							,GOODS_CD
						FROM TB_GOODS_FAULTY_ADM_CODE B,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X
						WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
						AND E.WORK_ORD_NO = X.WORK_ORD_NO
						GROUP BY GOODS_CD
				) FF
				ON DD.GOODS_CD = FF.GOODS_CD

				LEFT JOIN			
								(
				SELECT  ISNULL(SUM(FAULTY_CNT),0) EDGE_FAULTY_CNT
					,GOODS_CD
				FROM TB_EDGE_GOODS_FAULTY_ADM_CODE B,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X
				WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
				AND E.WORK_ORD_NO = X.WORK_ORD_NO
				GROUP BY GOODS_CD
				) GG
				ON DD.GOODS_CD = GG.GOODS_CD

				LEFT JOIN
				(
				SELECT
					A.GOODS_CD					
					, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT					
				FROM TB_WORK_ORDER A
					, (SELECT
						X.WORK_ORD_NO
						, SUM(FAULTY_CNT) FAULTY_CNT					
						FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X
						WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
						AND RE_INSP_STATUS != '002'
						GROUP BY X.WORK_ORD_NO) B
				WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
				GROUP BY GOODS_CD
				) HH
				ON DD.GOODS_CD = HH.GOODS_CD

				LEFT JOIN
				(
				SELECT
					A.GOODS_CD					
					, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
				FROM TB_WORK_ORDER A
					, (SELECT
						X.WORK_ORD_NO
						, SUM(FAULTY_CNT) FAULTY_CNT					
						FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X
						WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
						AND RE_INSP_STATUS = '002'
						GROUP BY X.WORK_ORD_NO) B
				WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
				GROUP BY GOODS_CD
				) II
				ON DD.GOODS_CD = II.GOODS_CD
				WHERE DD.USE_YN_CD = '001'
			AND EE.MATRL_CD = DD.ALNICU_MATRL_CD
			ORDER BY DD.GOODS_NM
		]]>
	</select>
	
	
	
	<!-- 생산실적 기종별(불량내역전체 포함) -->
	<select id="readActualOutputGoodsList_F3" resultMap="FaultyHistoryVo">
		<![CDATA[
			SELECT
				DD.GOODS_CD
				, DD.GOODS_NM
				, DD.GRAVITY
				, DD.MODEL
				, EE.QUTY_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = EE.QUTY_CD) QUTY_NM
				, ISNULL(CC.SUM_TARGET_CNT, 0) SUM_TARGET_CNT
				, ISNULL(CC.SUM_OUTPUT_CNT, 0) SUM_OUTPUT_CNT
				
				, ISNULL(BB.PRCS_CNT, 0) PRCS_CNT
				, ISNULL(BB.MATRL_CNT, 0) MATRL_CNT
				, ISNULL(BB.RPC_CNT, 0) RPC_CNT
				, ISNULL(BB.TRB_CNT, 0) TRB_CNT
				, ISNULL(BB.CNT_5, 0) CNT_5
				, ISNULL(BB.CNT_6, 0) CNT_6
				, ISNULL(BB.CNT_7, 0) CNT_7
				
				, (CASE WHEN ISNULL(AA.PRCS_TOTAL, 0) = 0 THEN 0 ELSE AA.PRCS_TOTAL - BASKET_WEIGHT.ETC1 END ) PRCS_TOTAL
				, (CASE WHEN ISNULL(AA.MATRL_TOTAL, 0) = 0 THEN 0 ELSE AA.MATRL_TOTAL - BASKET_WEIGHT.ETC1 END ) MATRL_TOTAL
				, (CASE WHEN ISNULL(AA.RPC_TOTAL, 0) = 0 THEN 0 ELSE AA.RPC_TOTAL - BASKET_WEIGHT.ETC1 END ) RPC_TOTAL
				, (CASE WHEN ISNULL(AA.TRB_TOTAL, 0) = 0 THEN 0 ELSE AA.TRB_TOTAL - BASKET_WEIGHT.ETC1 END ) TRB_TOTAL
				, ISNULL(AA.TOTAL_5, 0) TOTAL_5
				, (CASE WHEN ISNULL(AA.TOTAL_6, 0) = 0 THEN 0 ELSE AA.TOTAL_6 - BASKET_WEIGHT.ETC1 END ) TOTAL_6
				, (CASE WHEN ISNULL(AA.TOTAL_7, 0) = 0 THEN 0 ELSE AA.TOTAL_7 - BASKET_WEIGHT.ETC1 END ) TOTAL_7
				
				, (CASE WHEN ISNULL(AA.PRCS_TOTAL, 0) = 0 THEN 0 ELSE ISNULL( CAST( ( CAST(AA.PRCS_TOTAL AS FLOAT) - BASKET_WEIGHT.ETC1) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) END ) PRCS_EA
				, (CASE WHEN ISNULL(AA.MATRL_TOTAL, 0) = 0 THEN 0 ELSE ISNULL( CAST( ( CAST(AA.MATRL_TOTAL AS FLOAT) - BASKET_WEIGHT.ETC1) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) END ) MATRL_EA
				, (CASE WHEN ISNULL(AA.RPC_TOTAL, 0) = 0 THEN 0 ELSE ISNULL( CAST( ( CAST(AA.RPC_TOTAL AS FLOAT) - BASKET_WEIGHT.ETC1) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) END ) RPC_EA
				, (CASE WHEN ISNULL(AA.TRB_TOTAL, 0) = 0 THEN 0 ELSE ISNULL( CAST( ( CAST(AA.TRB_TOTAL AS FLOAT) - BASKET_WEIGHT.ETC1) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) END ) TRB_EA
				, ISNULL( CAST( CAST(AA.TOTAL_5 AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS EA_5
				, (CASE WHEN ISNULL(AA.TOTAL_6, 0) = 0 THEN 0 ELSE ISNULL( CAST( ( CAST(AA.TOTAL_6 AS FLOAT) - BASKET_WEIGHT.ETC1) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) END ) EA_6
				, (CASE WHEN ISNULL(AA.TOTAL_7, 0) = 0 THEN 0 ELSE ISNULL( CAST( ( CAST(AA.TOTAL_7 AS FLOAT) - BASKET_WEIGHT.ETC1) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) END ) EA_7
				
				, ISNULL(FF.APPEAR_FAULTY_CNT,0)  APPEAR_FAULTY_CNT
				, ISNULL(GG.EDGE_FAULTY_CNT,0)  EDGE_FAULTY_CNT
				, ISNULL(HH.SHIP_FAULTY_CNT,0)  SHIP_FAULTY_CNT
				, ISNULL(II.RE_SHIP_FAULTY_CNT,0)  RE_SHIP_FAULTY_CNT

				, (ISNULL(FF.APPEAR_FAULTY_CNT,0) + ISNULL(GG.EDGE_FAULTY_CNT,0) + ISNULL(HH.SHIP_FAULTY_CNT,0) + ISNULL(II.RE_SHIP_FAULTY_CNT,0)) OUTPUT_FAULTY_CNT
			FROM
				TB_MATRL_CODE_ADM EE, TB_GOODS_CODE_ADM DD
				LEFT JOIN
				(
					SELECT
						A.GOODS_CD
						, SUM(A.TARGET_CNT) SUM_TARGET_CNT
						, SUM(B.SUM_OUTPUT_CNT) SUM_OUTPUT_CNT
					FROM TB_WORK_ORDER A
					, (
						SELECT
							WORK_ORD_NO
							, SUM(OUTPUT_CNT + VISION_EDGE_CNT) SUM_OUTPUT_CNT
						FROM TB_WORK_ORDER_OUTPUT_SUB
						WHERE WORK_ORD_DATE >= #{chooseDate1}
						AND WORK_ORD_DATE <= #{chooseDate2}
						GROUP BY WORK_ORD_NO
					) B
					WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
					GROUP BY GOODS_CD
				) CC
				ON DD.GOODS_CD = CC.GOODS_CD
				LEFT JOIN
				(
					SELECT
						TT.GOODS_CD
						, ISNULL(TT.[001], 0) PRCS_TOTAL
						, ISNULL(TT.[002], 0) MATRL_TOTAL
						, ISNULL(TT.[003], 0) RPC_TOTAL
						, ISNULL(TT.[004], 0) TRB_TOTAL
						
						, ISNULL(TT.[005], 0) TOTAL_5
						, ISNULL(TT.[006], 0) TOTAL_6
						, ISNULL(TT.[007], 0) TOTAL_7
					FROM
					(
						SELECT
							C.GOODS_CD
							, SUM(A.FAULTY) FAULTY
							, A.GUBUN
						FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X, TB_GOODS_CODE_ADM C
						WHERE X.WORK_ORD_NO = B.WORK_ORD_NO  
						AND A.WORK_ORD_NO = B.WORK_ORD_NO
						AND B.GOODS_CD = C.GOODS_CD
						GROUP BY C.GOODS_CD, A.GUBUN
					) AS t PIVOT (SUM(t.FAULTY) FOR t.GUBUN IN ([001], [002], [003], [004], [005], [006], [007])) AS TT
				) AA ON DD.GOODS_CD = AA.GOODS_CD
				LEFT JOIN 
				(SELECT
					TT.GOODS_CD
					, ISNULL(TT.[001], 0) PRCS_CNT
					, ISNULL(TT.[002], 0) MATRL_CNT
					, ISNULL(TT.[003], 0) RPC_CNT
					, ISNULL(TT.[004], 0) TRB_CNT
					
					, ISNULL(TT.[005], 0) CNT_5
					, ISNULL(TT.[006], 0) CNT_6
					, ISNULL(TT.[007], 0) CNT_7
					
				FROM (
					SELECT
						C.GOODS_CD
						, COUNT(FAULTY) PRCS_CNT 
						--, SUM(A.FAULTY) FAULTY
						, A.GUBUN
					FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X, TB_GOODS_CODE_ADM C
					WHERE  X.WORK_ORD_NO = B.WORK_ORD_NO  
					AND A.WORK_ORD_NO = B.WORK_ORD_NO
					AND B.GOODS_CD = C.GOODS_CD
					GROUP BY C.GOODS_CD, A.GUBUN
				) AS t PIVOT ( SUM(t.PRCS_CNT) FOR t.GUBUN IN ([001], [002], [003], [004], [005], [006], [007])) AS TT) BB ON DD.GOODS_CD = BB.GOODS_CD
				LEFT JOIN
				(
				SELECT 
							
							
							 ISNULL(SUM(FAULTY_CNT),0) APPEAR_FAULTY_CNT
							,GOODS_CD
						FROM TB_GOODS_FAULTY_ADM_CODE B,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X
						WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
						AND E.WORK_ORD_NO = X.WORK_ORD_NO
						GROUP BY GOODS_CD
				) FF
				ON DD.GOODS_CD = FF.GOODS_CD

				LEFT JOIN			
								(
				SELECT  ISNULL(SUM(FAULTY_CNT),0) EDGE_FAULTY_CNT
					,GOODS_CD
				FROM TB_EDGE_GOODS_FAULTY_ADM_CODE B,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X
				WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
				AND E.WORK_ORD_NO = X.WORK_ORD_NO
				GROUP BY GOODS_CD
				) GG
				ON DD.GOODS_CD = GG.GOODS_CD

				LEFT JOIN
				(
				SELECT
					A.GOODS_CD					
					, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT					
				FROM TB_WORK_ORDER A
					, (SELECT
						X.WORK_ORD_NO
						, SUM(FAULTY_CNT) FAULTY_CNT					
						FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X
						WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
						AND RE_INSP_STATUS != '002'
						GROUP BY X.WORK_ORD_NO) B
				WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
				GROUP BY GOODS_CD
				) HH
				ON DD.GOODS_CD = HH.GOODS_CD

				LEFT JOIN
				(
				SELECT
					A.GOODS_CD					
					, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
				FROM TB_WORK_ORDER A
					, (SELECT
						X.WORK_ORD_NO
						, SUM(FAULTY_CNT) FAULTY_CNT					
						FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X
						WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
						AND RE_INSP_STATUS = '002'
						GROUP BY X.WORK_ORD_NO) B
				WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
				GROUP BY GOODS_CD
				) II
				ON DD.GOODS_CD = II.GOODS_CD
				, ( SELECT ETC1 FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD = '117' AND BASE_CD = '001' ) AS BASKET_WEIGHT
				WHERE DD.USE_YN_CD = '001'
			AND EE.MATRL_CD = DD.ALNICU_MATRL_CD
			ORDER BY DD.GOODS_NM
		]]>
	</select>
	
	
	
	<!-- 생산실적 설비별(불량내역전체 포함) -->
	<select id="readActualOutputEquipsList" resultMap="FaultyHistoryVo">
	
	
	<!-- SELECT 
		DD.EQUIP_CD
		, DD.EQUIP_NM
		, DD.DAY_NIGHT_CD
		, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = DD.DAY_NIGHT_CD) AS DAY_NIGHT_NM
		, CC.GOODS_CD
		, CC.GOODS_NM
		, CC.QUTY_CD
		, CC.QUTY_NM
		, CC.MODEL
		
		, ISNULL( CC.GRAVITY, 0 ) AS GRAVITY
		, ISNULL( CC.SUM_TARGET_CNT, 0 ) AS SUM_TARGET_CNT
		, ISNULL( CC.SUM_OUTPUT_CNT, 0 ) AS SUM_OUTPUT_CNT
		
		, ISNULL( CC.PRCS_CNT, 0 ) AS PRCS_CNT
		, ISNULL( CC.MATRL_CNT, 0 ) AS MATRL_CNT
		, ISNULL( CC.RPC_CNT, 0 ) AS RPC_CNT
		, ISNULL( CC.TRB_CNT, 0 ) AS TRB_CNT
		, ISNULL( CC.PRCS_TOTAL, 0 ) AS PRCS_TOTAL
		, ISNULL( CC.MATRL_TOTAL, 0 ) AS MATRL_TOTAL
		, ISNULL( CC.RPC_TOTAL, 0 ) AS RPC_TOTAL
		, ISNULL( CC.TRB_TOTAL, 0 ) AS TRB_TOTAL
		
		, ISNULL ( CAST( CAST(CC.PRCS_TOTAL AS float)  / CAST(CC.GRAVITY AS float) * 1000 AS INT), 0 ) AS PRCS_EA
		, ISNULL ( CAST( CAST(CC.MATRL_TOTAL AS float)  / CAST(CC.GRAVITY AS float) * 1000 AS INT), 0 ) AS MATRL_EA
		, ISNULL ( CAST( CAST(CC.RPC_TOTAL AS float)  / CAST(CC.GRAVITY AS float) * 1000 AS INT), 0 ) AS RPC_EA
		, ISNULL ( CAST( CAST(CC.TRB_TOTAL AS float)  / CAST(CC.GRAVITY AS float) * 1000 AS INT), 0 ) AS TRB_EA
		
		, ISNULL(CC.APPEAR_FAULTY_CNT,0) APPEAR_FAULTY_CNT  
		, ISNULL(CC.EDGE_FAULTY_CNT,0) EDGE_FAULTY_CNT
		, ISNULL(CC.SHIP_FAULTY_CNT,0) SHIP_FAULTY_CNT 
		, ISNULL(CC.RE_SHIP_FAULTY_CNT,0) RE_SHIP_FAULTY_CNT 
		, ISNULL(CC.OUTPUT_FAULTY_CNT,0) OUTPUT_FAULTY_CNT
		
	FROM
		(
			SELECT A.EQUIP_CD
				, A.EQUIP_NM
				, A.ETC1
				, B.DAY_NIGHT_CD
			FROM TB_EQUIP_CODE_ADM A
			, (
				SELECT
					'D' DAY_NIGHT_CD
				UNION
				SELECT
					'N' DAY_NIGHT_CD
					) B
			WHERE USE_YN_CD = '001'
			AND ETC1 = ''
		)DD

		FULL OUTER JOIN

			(
	
			SELECT
				COALESCE(AA.EQUIP_CD, ( SELECT X.EQUIP_CD FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_CD
				, COALESCE(AA.EQUIP_NM, ( SELECT X.EQUIP_NM FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_NM
				, ISNULL(AA.DAY_NIGHT_CD, BB.DAY_NIGHT_CD) AS DAY_NIGHT_CD
				, ISNULL( (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = AA.DAY_NIGHT_CD)
						, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = BB.DAY_NIGHT_CD) ) AS DAY_NIGHT_NM
				, ISNULL(AA.GOODS_CD, BB.GOODS_CD) AS GOODS_CD
				, ISNULL(AA.GOODS_NM, BB.GOODS_NM) AS GOODS_NM
				, ISNULL(AA.GRAVITY, BB.GRAVITY) AS GRAVITY
				, ISNULL(AA.MODEL, BB.MODEL) AS MODEL
				, ISNULL(AA.QUTY_CD, BB.QUTY_CD) AS QUTY_CD
				, ISNULL( (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = AA.QUTY_CD)
						, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = BB.QUTY_CD) ) AS QUTY_NM
				, ISNULL(AA.SUM_TARGET_CNT, ISNULL(BB.SUM_TARGET_CNT, 0)) AS SUM_TARGET_CNT
				, ( ISNULL(AA.SUM_OUTPUT_CNT, 0) + ISNULL(BB.SUM_OUTPUT_CNT, 0) ) AS SUM_OUTPUT_CNT
				
				, ( ISNULL(AA.PRCS_CNT, 0) + ISNULL(BB.PRCS_CNT, 0) ) AS PRCS_CNT
				, ( ISNULL(AA.MATRL_CNT, 0) + ISNULL(BB.MATRL_CNT, 0) ) AS MATRL_CNT
				, ( ISNULL(AA.RPC_CNT, 0) + ISNULL(BB.RPC_CNT, 0) ) AS RPC_CNT
				, ( ISNULL(AA.TRB_CNT, 0) + ISNULL(BB.TRB_CNT, 0) ) AS TRB_CNT
				, ( ISNULL(AA.PRCS_TOTAL, 0) + ISNULL(BB.PRCS_TOTAL, 0) ) AS PRCS_TOTAL
				, ( ISNULL(AA.MATRL_TOTAL, 0) + ISNULL(BB.MATRL_TOTAL, 0) ) AS MATRL_TOTAL
				, ( ISNULL(AA.RPC_TOTAL, 0) + ISNULL(BB.RPC_TOTAL, 0) ) AS RPC_TOTAL
				, ( ISNULL(AA.TRB_TOTAL, 0) + ISNULL(BB.TRB_TOTAL, 0) ) AS TRB_TOTAL
				, ISNULL( CAST( ISNULL(AA.PRCS_TOTAL, 0) + ISNULL(BB.PRCS_TOTAL, 0) / ISNULL(AA.GRAVITY, BB.GRAVITY) * 1000 AS INT ), 0 ) PRCS_EA
				, ISNULL( CAST( ISNULL(AA.MATRL_TOTAL, 0) + ISNULL(BB.MATRL_TOTAL, 0) / ISNULL(AA.GRAVITY, BB.GRAVITY) * 1000 AS INT ), 0) MATRL_EA
				, ISNULL( CAST( ISNULL(AA.RPC_TOTAL, 0) + ISNULL(BB.RPC_TOTAL, 0) / ISNULL(AA.GRAVITY, BB.GRAVITY) * 1000 AS INT ), 0) RPC_EA
				, ISNULL( CAST( ISNULL(AA.TRB_TOTAL, 0) + ISNULL(BB.TRB_TOTAL, 0) / ISNULL(AA.GRAVITY, BB.GRAVITY) * 1000 AS INT ), 0) TRB_EA
				
				, ISNULL(AA.APPEAR_FAULTY_CNT,0) + ISNULL(BB.APPEAR_FAULTY_CNT,0) APPEAR_FAULTY_CNT  
				, ISNULL(AA.EDGE_FAULTY_CNT,0) + ISNULL(BB.EDGE_FAULTY_CNT,0)EDGE_FAULTY_CNT
				, ISNULL(AA.SHIP_FAULTY_CNT,0) + ISNULL(BB.SHIP_FAULTY_CNT,0) SHIP_FAULTY_CNT 
				, ISNULL(AA.RE_SHIP_FAULTY_CNT,0) + ISNULL(BB.RE_SHIP_FAULTY_CNT,0) RE_SHIP_FAULTY_CNT 
				, ISNULL(AA.OUTPUT_FAULTY_CNT,0) + ISNULL(BB.OUTPUT_FAULTY_CNT,0) OUTPUT_FAULTY_CNT 
			FROM
			(	
				SELECT
					A.EQUIP_CD
					, A.EQUIP_NM
					, A.ETC1
					, A.DAY_NIGHT_CD
					, B.GUBUN
					, B.SUM_OUTPUT_CNT
					, B.SUM_TARGET_CNT
					, C.GOODS_CD
					, C.GOODS_NM
					, C.GRAVITY
					, C.MODEL
					, D.QUTY_CD
		
					, ISNULL( E.PRCS_CNT, 0) PRCS_CNT
					, ISNULL( E.MATRL_CNT, 0) MATRL_CNT
					, ISNULL( E.RPC_CNT, 0) RPC_CNT
					, ISNULL( E.TRB_CNT, 0) TRB_CNT
		
					, ISNULL( F.PRCS_TOTAL, 0) PRCS_TOTAL
					, ISNULL( F.MATRL_TOTAL, 0) MATRL_TOTAL
					, ISNULL( F.RPC_TOTAL, 0) RPC_TOTAL
					, ISNULL( F.TRB_TOTAL, 0) TRB_TOTAL
		
					, ISNULL(CAST( F.PRCS_TOTAL / C.GRAVITY * 1000 AS INT ), 0) PRCS_EA
					, ISNULL(CAST( F.MATRL_TOTAL / C.GRAVITY * 1000 AS INT ), 0) MATRL_EA
					, ISNULL(CAST( F.RPC_TOTAL	/ C.GRAVITY * 1000 AS INT ), 0) RPC_EA
					, ISNULL(CAST( F.TRB_TOTAL	/ C.GRAVITY * 1000 AS INT ), 0) TRB_EA
					
					, ISNULL(FF.APPEAR_FAULTY_CNT,0) APPEAR_FAULTY_CNT  
					, ISNULL(GG.EDGE_FAULTY_CNT,0) EDGE_FAULTY_CNT
					, ISNULL(HH.SHIP_FAULTY_CNT,0) SHIP_FAULTY_CNT 
					, ISNULL(II.RE_SHIP_FAULTY_CNT,0) RE_SHIP_FAULTY_CNT 
					, ISNULL(FF.APPEAR_FAULTY_CNT,0)   
					+ ISNULL(GG.EDGE_FAULTY_CNT,0) 
					+ ISNULL(HH.SHIP_FAULTY_CNT,0)  
					+ ISNULL(II.RE_SHIP_FAULTY_CNT,0)  OUTPUT_FAULTY_CNT
				FROM
				(
					(
						SELECT
							BB.EQUIP_CD
							, BB.EQUIP_NM
							, BB.ETC1
							, BB.USE_YN_CD
							, AA.DAY_NIGHT_CD 
						FROM (
								SELECT 'D' DAY_NIGHT_CD
								UNION
								SELECT 'N' DAY_NIGHT_CD
						) AA
						FULL OUTER JOIN
							TB_EQUIP_CODE_ADM BB
						ON 1=1
						AND BB.USE_YN_CD = '001'
						AND BB.ETC1 = ''
					) A
					LEFT JOIN

						(	SELECT
								A.EQUIP_CD			
								,A.GOODS_CD
								,B.GUBUN
								, SUM(B.APPEAR_FAULTY_CNT) APPEAR_FAULTY_CNT					
							FROM TB_WORK_ORDER A
								, (SELECT
									WORK_ORD_NO
									,GUBUN
									, SUM(APPEAR_FAULTY_CNT) APPEAR_FAULTY_CNT					
									FROM TB_WORK_ORDER_OUTPUT_SUB
									WHERE APPEAR_INSPCT_DATE >= #{chooseDate1}
									AND APPEAR_INSPCT_DATE <= #{chooseDate2}
									GROUP BY WORK_ORD_NO,GUBUN) B
							WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
							GROUP BY EQUIP_CD,GOODS_CD,B.GUBUN
						) FF

					ON A.EQUIP_CD = FF.EQUIP_CD
					AND A.DAY_NIGHT_CD = FF.GUBUN

					LEFT JOIN

						(	SELECT
								A.EQUIP_CD			
								,A.GOODS_CD
								,B.GUBUN
								, SUM(B.EDGE_FAULTY_CNT) EDGE_FAULTY_CNT					
							FROM TB_WORK_ORDER A
								, (SELECT
									WORK_ORD_NO
									,GUBUN
									, SUM(EDGE_FAULTY_CNT) EDGE_FAULTY_CNT					
									FROM TB_WORK_ORDER_OUTPUT_SUB
									WHERE EDGE_INSPCT_DATE >= #{chooseDate1}
									AND EDGE_INSPCT_DATE <= #{chooseDate2}
									GROUP BY WORK_ORD_NO,GUBUN) B
							WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
							GROUP BY EQUIP_CD,GOODS_CD,B.GUBUN
						) GG

					ON A.EQUIP_CD = GG.EQUIP_CD
					AND A.DAY_NIGHT_CD = GG.GUBUN

					LEFT JOIN

						(	SELECT
								A.EQUIP_CD			
								,A.GOODS_CD
								,B.DAY_NIGHT_CD
								, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT					
							FROM TB_WORK_ORDER A
								, (SELECT
									WORK_ORD_NO
									,DAY_NIGHT_CD
									, SUM(FAULTY_CNT) FAULTY_CNT					
									FROM TB_SHIP_INSPECT_ADM
									WHERE INSP_DATE >= #{chooseDate1}
									AND INSP_DATE <= #{chooseDate2}
									AND RE_INSP_STATUS = '001'
									GROUP BY WORK_ORD_NO,DAY_NIGHT_CD) B
							WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
							GROUP BY EQUIP_CD,GOODS_CD,B.DAY_NIGHT_CD
						) HH

					ON A.EQUIP_CD = HH.EQUIP_CD
					AND A.DAY_NIGHT_CD = HH.DAY_NIGHT_CD

					LEFT JOIN

						(	SELECT
								A.EQUIP_CD			
								,A.GOODS_CD
								,B.DAY_NIGHT_CD
								, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
							FROM TB_WORK_ORDER A
								, (SELECT
									WORK_ORD_NO
									,DAY_NIGHT_CD
									, SUM(FAULTY_CNT) FAULTY_CNT					
									FROM TB_SHIP_INSPECT_ADM
									WHERE INSP_DATE >= #{chooseDate1}
									AND INSP_DATE <= #{chooseDate2}
									AND RE_INSP_STATUS = '002'
									GROUP BY WORK_ORD_NO,DAY_NIGHT_CD) B
							WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
							GROUP BY EQUIP_CD,GOODS_CD,B.DAY_NIGHT_CD
						) II

					ON A.EQUIP_CD = II.EQUIP_CD
					AND A.DAY_NIGHT_CD = II.DAY_NIGHT_CD
					LEFT JOIN
						(	SELECT
								A.EQUIP_CD
								, A.GOODS_CD
								, B.GUBUN
								, A.TARGET_CNT AS SUM_TARGET_CNT
								, SUM(B.SUM_OUTPUT_CNT) SUM_OUTPUT_CNT
							FROM TB_WORK_ORDER A
							, (	SELECT
									A.WORK_ORD_NO
									, A.GUBUN
									, SUM(A.OUTPUT_CNT + A.VISION_EDGE_CNT) SUM_OUTPUT_CNT
								FROM TB_WORK_ORDER_OUTPUT_SUB A, TB_WORK_ORDER B, TB_EQUIP_CODE_ADM C
								WHERE 1=1
								AND A.WORK_ORD_NO = B.WORK_ORD_NO
								AND B.EQUIP_CD = C.EQUIP_CD
								AND C.ETC1 = ''
								AND WORK_ORD_DATE >= #{chooseDate1}
								AND WORK_ORD_DATE <= #{chooseDate2}
	
								GROUP BY
									A.WORK_ORD_NO
									, A.GUBUN
							) B
							WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
							GROUP BY A.EQUIP_CD
								, A.GOODS_CD
								, B.GUBUN
								, A.TARGET_CNT
						) B
					ON A.EQUIP_CD = B.EQUIP_CD
					AND A.DAY_NIGHT_CD = B.GUBUN
	
					LEFT OUTER JOIN
						(	SELECT
								TT.GOODS_CD
								, TT.EQUIP_CD
								, TT.DAY_NIGHT_CD
								, ISNULL(TT.[001], 0) PRCS_CNT
								, ISNULL(TT.[002], 0) MATRL_CNT
								, ISNULL(TT.[003], 0) RPC_CNT
								, ISNULL(TT.[004], 0) TRB_CNT
							FROM (
									SELECT
										C.GOODS_CD
										, D.EQUIP_CD
										, A.DAY_NIGHT_CD
										, COUNT(FAULTY) PRCS_CNT 
										, A.GUBUN
									FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B, TB_GOODS_CODE_ADM C, TB_EQUIP_CODE_ADM D
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									AND B.GOODS_CD = C.GOODS_CD
									AND B.EQUIP_CD = D.EQUIP_CD
									AND D.USE_YN_CD = '001'
									AND A.FAULTY_REG_DATE >= #{chooseDate1}
									AND A.FAULTY_REG_DATE <= #{chooseDate2}
									GROUP BY C.GOODS_CD, D.EQUIP_CD, A.DAY_NIGHT_CD, A.GUBUN
								) AS t
							PIVOT (
								SUM(t.PRCS_CNT)
								FOR t.GUBUN IN ([001], [002], [003], [004])
							) AS TT
						) E
					ON A.EQUIP_CD = E.EQUIP_CD
					AND A.DAY_NIGHT_CD = E.DAY_NIGHT_CD
					AND B.GOODS_CD = E.GOODS_CD
	
					LEFT OUTER JOIN
						(	SELECT
									TT.GOODS_CD
									, TT.EQUIP_CD
									, TT.DAY_NIGHT_CD
									, ISNULL(TT.[001], 0) PRCS_TOTAL
									, ISNULL(TT.[002], 0) MATRL_TOTAL
									, ISNULL(TT.[003], 0) RPC_TOTAL
									, ISNULL(TT.[004], 0) TRB_TOTAL
								FROM (
									SELECT
										C.GOODS_CD
										, D.EQUIP_CD
										, A.DAY_NIGHT_CD
										, SUM(A.FAULTY) FAULTY
										, A.GUBUN
									FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B, TB_GOODS_CODE_ADM C, TB_EQUIP_CODE_ADM D
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									AND B.GOODS_CD = C.GOODS_CD
									AND B.EQUIP_CD = D.EQUIP_CD
									AND A.FAULTY_REG_DATE >= #{chooseDate1}
									AND A.FAULTY_REG_DATE <= #{chooseDate2}
									GROUP BY C.GOODS_CD
										, D.EQUIP_CD
										, A.DAY_NIGHT_CD
										, A.GUBUN
								) AS t 
							PIVOT (
								SUM(t.FAULTY)
								FOR t.GUBUN IN ([001], [002], [003], [004]) 
							) AS TT
						) F
					ON A.EQUIP_CD = F.EQUIP_CD
					AND A.DAY_NIGHT_CD = F.DAY_NIGHT_CD
					AND B.GOODS_CD = F.GOODS_CD
	
					LEFT JOIN
						TB_GOODS_CODE_ADM AS C
					ON B.GOODS_CD = C.GOODS_CD
					LEFT JOIN
						TB_MATRL_CODE_ADM AS D
					ON C.ALNICU_MATRL_CD = D.MATRL_CD
				)
				WHERE 1=1
				AND A.USE_YN_CD = '001'
				AND A.ETC1 = ''
				AND C.GOODS_CD IS NOT NULL
			) AA
				
			FULL OUTER JOIN
			
			(
				SELECT
					A.ETC1
					, A.DAY_NIGHT_CD
					, C.GOODS_CD
					, C.GOODS_NM
					, C.GRAVITY
					, C.MODEL
					, D.QUTY_CD
					, B.SUM_TARGET_CNT
					, SUM(B.SUM_OUTPUT_CNT) SUM_OUTPUT_CNT
					
					, ISNULL( SUM(E.PRCS_CNT), 0) PRCS_CNT
					, ISNULL( SUM(E.MATRL_CNT), 0) MATRL_CNT
					, ISNULL( SUM(E.RPC_CNT), 0) RPC_CNT
					, ISNULL( SUM(E.TRB_CNT), 0) TRB_CNT
		
					, ISNULL( SUM(F.PRCS_TOTAL), 0) PRCS_TOTAL
					, ISNULL( SUM(F.MATRL_TOTAL), 0) MATRL_TOTAL
					, ISNULL( SUM(F.RPC_TOTAL), 0) RPC_TOTAL
					, ISNULL( SUM(F.TRB_TOTAL), 0) TRB_TOTAL
		
					, ISNULL(CAST( SUM(F.PRCS_TOTAL) / C.GRAVITY * 1000 AS INT ), 0) PRCS_EA
					, ISNULL(CAST( SUM(F.MATRL_TOTAL) / C.GRAVITY * 1000 AS INT ), 0) MATRL_EA
					, ISNULL(CAST( SUM(F.RPC_TOTAL)	/ C.GRAVITY * 1000 AS INT ), 0) RPC_EA
					, ISNULL(CAST( SUM(F.TRB_TOTAL)	/ C.GRAVITY * 1000 AS INT ), 0) TRB_EA
					
					, ISNULL(SUM(FF.APPEAR_FAULTY_CNT),0) APPEAR_FAULTY_CNT  
					, ISNULL(SUM(GG.EDGE_FAULTY_CNT),0) EDGE_FAULTY_CNT
					, ISNULL(SUM(HH.SHIP_FAULTY_CNT),0) SHIP_FAULTY_CNT 
					, ISNULL(SUM(II.RE_SHIP_FAULTY_CNT),0) RE_SHIP_FAULTY_CNT 
					, ISNULL(SUM(FF.APPEAR_FAULTY_CNT),0)   
					+ ISNULL(SUM(GG.EDGE_FAULTY_CNT),0) 
					+ ISNULL(SUM(HH.SHIP_FAULTY_CNT),0)  
					+ ISNULL(SUM(II.RE_SHIP_FAULTY_CNT),0) OUTPUT_FAULTY_CNT 
				FROM (
						(
							SELECT
								B.EQUIP_CD
								, B.EQUIP_NM
								, B.ETC1
								, AA.DAY_NIGHT_CD
							FROM TB_EQUIP_CODE_ADM B									
							LEFT OUTER JOIN
								TB_EQUIP_CODE_ADM D
							ON 1=1
							AND B.EQUIP_NM = D.ETC1
							FULL OUTER JOIN
								(	
									SELECT 'D' DAY_NIGHT_CD
									UNION
									SELECT 'N' DAY_NIGHT_CD
								) AA
							ON 1=1
							WHERE 1=1
							AND B.USE_YN_CD = '001'
							AND B.ETC1 != ''
							GROUP BY
								B.EQUIP_CD
								, B.EQUIP_NM
								, B.ETC1
								, AA.DAY_NIGHT_CD
						) A
						
						LEFT JOIN

						(	SELECT
								A.EQUIP_CD			
								,A.GOODS_CD
								,B.GUBUN
								, SUM(B.APPEAR_FAULTY_CNT) APPEAR_FAULTY_CNT					
							FROM TB_WORK_ORDER A
								, (SELECT
									WORK_ORD_NO
									,GUBUN
									, SUM(APPEAR_FAULTY_CNT) APPEAR_FAULTY_CNT					
									FROM TB_WORK_ORDER_OUTPUT_SUB
									WHERE APPEAR_INSPCT_DATE >=  #{chooseDate1}
									AND APPEAR_INSPCT_DATE <=  #{chooseDate2}
									GROUP BY WORK_ORD_NO,GUBUN) B
							WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
							GROUP BY EQUIP_CD,GOODS_CD,B.GUBUN
						) FF

					ON A.EQUIP_CD = FF.EQUIP_CD
					AND A.DAY_NIGHT_CD = FF.GUBUN

					LEFT JOIN

						(	SELECT
								A.EQUIP_CD			
								,A.GOODS_CD
								,B.GUBUN
								, SUM(B.EDGE_FAULTY_CNT) EDGE_FAULTY_CNT					
							FROM TB_WORK_ORDER A
								, (SELECT
									WORK_ORD_NO
									,GUBUN
									, SUM(EDGE_FAULTY_CNT) EDGE_FAULTY_CNT					
									FROM TB_WORK_ORDER_OUTPUT_SUB
									WHERE EDGE_INSPCT_DATE >=  #{chooseDate1}
									AND EDGE_INSPCT_DATE <=  #{chooseDate2}
									GROUP BY WORK_ORD_NO,GUBUN) B
							WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
							GROUP BY EQUIP_CD,GOODS_CD,B.GUBUN
						) GG

					ON A.EQUIP_CD = GG.EQUIP_CD
					AND A.DAY_NIGHT_CD = GG.GUBUN

					LEFT JOIN

						(	SELECT
								A.EQUIP_CD			
								,A.GOODS_CD
								,B.DAY_NIGHT_CD
								, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT					
							FROM TB_WORK_ORDER A
								, (SELECT
									WORK_ORD_NO
									,DAY_NIGHT_CD
									, SUM(FAULTY_CNT) FAULTY_CNT					
									FROM TB_SHIP_INSPECT_ADM
									WHERE INSP_DATE >=  #{chooseDate1}
									AND INSP_DATE <=  #{chooseDate2}
									AND RE_INSP_STATUS = '001'
									GROUP BY WORK_ORD_NO,DAY_NIGHT_CD) B
							WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
							GROUP BY EQUIP_CD,GOODS_CD,B.DAY_NIGHT_CD
						) HH

					ON A.EQUIP_CD = HH.EQUIP_CD
					AND A.DAY_NIGHT_CD = HH.DAY_NIGHT_CD

					LEFT JOIN

						(	SELECT
								A.EQUIP_CD			
								,A.GOODS_CD
								,B.DAY_NIGHT_CD
								, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT					
							FROM TB_WORK_ORDER A
								, (SELECT
									WORK_ORD_NO
									,DAY_NIGHT_CD
									, SUM(FAULTY_CNT) FAULTY_CNT					
									FROM TB_SHIP_INSPECT_ADM
									WHERE INSP_DATE >=  #{chooseDate1}
									AND INSP_DATE <=  #{chooseDate2}
									AND RE_INSP_STATUS = '002'
									GROUP BY WORK_ORD_NO,DAY_NIGHT_CD) B
							WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
							GROUP BY EQUIP_CD,GOODS_CD,B.DAY_NIGHT_CD
						) II

					ON A.EQUIP_CD = II.EQUIP_CD
					AND A.DAY_NIGHT_CD = II.DAY_NIGHT_CD
						LEFT OUTER JOIN
							(
								SELECT
									A.EQUIP_CD
									, A.GOODS_CD
									, B.GUBUN
									, A.TARGET_CNT AS SUM_TARGET_CNT
									, SUM(B.SUM_OUTPUT_CNT) SUM_OUTPUT_CNT
								FROM TB_WORK_ORDER A
									, (	SELECT
											MAX(A.WORK_ORD_NO) AS WORK_ORD_NO
											, A.GUBUN
											, SUM(A.OUTPUT_CNT + A.VISION_EDGE_CNT) SUM_OUTPUT_CNT
											, B.EQUIP_CD
											, B.GOODS_CD
										FROM TB_WORK_ORDER_OUTPUT_SUB A, TB_WORK_ORDER B, TB_EQUIP_CODE_ADM C
										WHERE 1=1
										AND A.WORK_ORD_NO = B.WORK_ORD_NO
										AND B.EQUIP_CD = C.EQUIP_CD
										AND C.ETC1 != ''
										AND WORK_ORD_DATE >= #{chooseDate1}
										AND WORK_ORD_DATE <= #{chooseDate2}
					
										GROUP BY
											 A.GUBUN
											, B.EQUIP_CD
											, B.GOODS_CD
									) B
								WHERE 1=1
								AND A.WORK_ORD_NO = B.WORK_ORD_NO
								GROUP BY
									A.EQUIP_CD
									, A.GOODS_CD
									, B.GUBUN
									, A.TARGET_CNT
							) B
						ON 1=1
						AND A.EQUIP_CD = B.EQUIP_CD
						AND A.DAY_NIGHT_CD = B.GUBUN
		
						LEFT OUTER JOIN
							(
								SELECT
									TT.GOODS_CD
									, TT.EQUIP_CD
									, TT.DAY_NIGHT_CD
									, ISNULL(TT.[001], 0) PRCS_CNT
									, ISNULL(TT.[002], 0) MATRL_CNT
									, ISNULL(TT.[003], 0) RPC_CNT
									, ISNULL(TT.[004], 0) TRB_CNT
								FROM (
									SELECT
										C.GOODS_CD
										, D.EQUIP_CD
										, A.DAY_NIGHT_CD
										, COUNT(FAULTY) PRCS_CNT 
										, A.GUBUN
									FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B, TB_GOODS_CODE_ADM C, TB_EQUIP_CODE_ADM D
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									AND B.GOODS_CD = C.GOODS_CD
									AND B.EQUIP_CD = D.EQUIP_CD
									AND D.USE_YN_CD = '001'
									AND A.FAULTY_REG_DATE >= #{chooseDate1}
									AND A.FAULTY_REG_DATE <= #{chooseDate2}
									AND D.ETC1 != ''
									GROUP BY
										C.GOODS_CD
										, D.EQUIP_CD
										, A.DAY_NIGHT_CD
										, A.GUBUN
								) AS t
								PIVOT (
									SUM(t.PRCS_CNT)
									FOR t.GUBUN IN ([001], [002], [003], [004])
								) AS TT
							) E
						ON A.EQUIP_CD = E.EQUIP_CD
						AND A.DAY_NIGHT_CD = E.DAY_NIGHT_CD
						AND B.GOODS_CD = E.GOODS_CD
		
						LEFT OUTER JOIN
							(	
								SELECT
									TT.GOODS_CD
									, TT.EQUIP_CD
									, TT.DAY_NIGHT_CD
									, ISNULL(TT.[001], 0) PRCS_TOTAL
									, ISNULL(TT.[002], 0) MATRL_TOTAL
									, ISNULL(TT.[003], 0) RPC_TOTAL
									, ISNULL(TT.[004], 0) TRB_TOTAL
								FROM (
									SELECT
										C.GOODS_CD
										, D.EQUIP_CD
										, A.DAY_NIGHT_CD
										, SUM(A.FAULTY) FAULTY
										, A.GUBUN
									FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B, TB_GOODS_CODE_ADM C, TB_EQUIP_CODE_ADM D
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									AND B.GOODS_CD = C.GOODS_CD
									AND B.EQUIP_CD = D.EQUIP_CD
									AND A.FAULTY_REG_DATE >= #{chooseDate1}
									AND A.FAULTY_REG_DATE <= #{chooseDate2}
									AND D.ETC1 != ''
									GROUP BY C.GOODS_CD
										, D.EQUIP_CD
										, A.DAY_NIGHT_CD
										, A.GUBUN
								) AS t 
								PIVOT (
									SUM(t.FAULTY)
									FOR t.GUBUN IN ([001], [002], [003], [004]) 
								) AS TT
							) F
						ON A.EQUIP_CD = F.EQUIP_CD
						AND A.DAY_NIGHT_CD = F.DAY_NIGHT_CD
						AND B.GOODS_CD = F.GOODS_CD
		
						LEFT JOIN
							TB_GOODS_CODE_ADM AS C
						ON B.GOODS_CD = C.GOODS_CD
						LEFT JOIN
							TB_MATRL_CODE_ADM AS D
						ON C.ALNICU_MATRL_CD = D.MATRL_CD
					)
					
				WHERE 1=1
				AND C.GOODS_CD IS NOT NULL
					
				GROUP BY
					 A.ETC1
					, A.DAY_NIGHT_CD
					, C.GOODS_CD
					, C.GOODS_NM
					, C.GRAVITY
					, C.MODEL
					, D.QUTY_CD
					, B.SUM_TARGET_CNT
			) BB
			
			ON 1=1
			AND AA.EQUIP_NM = BB.ETC1
			AND AA.DAY_NIGHT_CD = BB.DAY_NIGHT_CD
			AND AA.GOODS_CD = BB.GOODS_CD
		) CC
		ON 1=1
		AND CC.EQUIP_CD =  DD.EQUIP_CD
		AND CC.DAY_NIGHT_CD =  DD.DAY_NIGHT_CD
	
		ORDER BY DAY_NIGHT_CD, EQUIP_NM ASC -->
		
		<![CDATA[
			SELECT 
				DD.EQUIP_CD
				, DD.EQUIP_NM
				, DD.DAY_NIGHT_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = DD.DAY_NIGHT_CD) AS DAY_NIGHT_NM
				, CC.GOODS_CD
				, CC.GOODS_NM
				, CC.QUTY_CD
				, CC.QUTY_NM
				, CC.MODEL
				
				, ISNULL( CC.GRAVITY, 0 ) AS GRAVITY
				, ISNULL( CC.SUM_TARGET_CNT, 0 ) AS SUM_TARGET_CNT
				, ISNULL( CC.SUM_OUTPUT_CNT, 0 ) AS SUM_OUTPUT_CNT
				
				, ISNULL( CC.PRCS_CNT, 0 ) AS PRCS_CNT
				, ISNULL( CC.MATRL_CNT, 0 ) AS MATRL_CNT
				, ISNULL( CC.RPC_CNT, 0 ) AS RPC_CNT
				, ISNULL( CC.TRB_CNT, 0 ) AS TRB_CNT
				
				, ISNULL(CC.CNT_5, 0) CNT_5
				, ISNULL(CC.CNT_6, 0) CNT_6
				, ISNULL(CC.CNT_7, 0) CNT_7
				
				, ISNULL( CC.PRCS_TOTAL, 0 ) AS PRCS_TOTAL
				, ISNULL( CC.MATRL_TOTAL, 0 ) AS MATRL_TOTAL
				, ISNULL( CC.RPC_TOTAL, 0 ) AS RPC_TOTAL
				, ISNULL( CC.TRB_TOTAL, 0 ) AS TRB_TOTAL
				
				, ISNULL(CC.TOTAL_5, 0) TOTAL_5
				, ISNULL(CC.TOTAL_6, 0) TOTAL_6
				, ISNULL(CC.TOTAL_7, 0) TOTAL_7
				
				, ISNULL ( CAST( CAST(CC.PRCS_TOTAL AS float)  / CAST(CC.GRAVITY AS FLOAT) * 1000 AS float), 0 ) AS PRCS_EA
				, ISNULL ( CAST( CAST(CC.MATRL_TOTAL AS float)  / CAST(CC.GRAVITY AS FLOAT) * 1000 AS float), 0 ) AS MATRL_EA
				, ISNULL ( CAST( CAST(CC.RPC_TOTAL AS float)  / CAST(CC.GRAVITY AS FLOAT) * 1000 AS float), 0 ) AS RPC_EA
				, ISNULL ( CAST( CAST(CC.TRB_TOTAL AS float)  / CAST(CC.GRAVITY AS FLOAT) * 1000 AS float), 0 ) AS TRB_EA
				
				, ISNULL( CAST( CAST(CC.TOTAL_5 AS FLOAT) / CAST(CC.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS EA_5
				, ISNULL( CAST( CAST(CC.TOTAL_6 AS FLOAT) / CAST(CC.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS EA_6
				, ISNULL( CAST( CAST(CC.TOTAL_7 AS FLOAT) / CAST(CC.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS EA_7
				
				, ISNULL(CC.APPEAR_FAULTY_CNT,0) APPEAR_FAULTY_CNT  
				, ISNULL(CC.EDGE_FAULTY_CNT,0) EDGE_FAULTY_CNT
				, ISNULL(CC.SHIP_FAULTY_CNT,0) SHIP_FAULTY_CNT 
				, ISNULL(CC.RE_SHIP_FAULTY_CNT,0) RE_SHIP_FAULTY_CNT 
				, ISNULL(CC.OUTPUT_FAULTY_CNT,0) OUTPUT_FAULTY_CNT
				
			FROM
				(
					SELECT A.EQUIP_CD
						, A.EQUIP_NM
						, A.ETC1
						, B.DAY_NIGHT_CD
					FROM TB_EQUIP_CODE_ADM A
					, (
						SELECT
							'D' DAY_NIGHT_CD
						UNION
						SELECT
							'N' DAY_NIGHT_CD
							) B
					WHERE USE_YN_CD = '001'
					AND ETC1 = ''
				)DD
		
				FULL OUTER JOIN
		
					(
			
					SELECT
						COALESCE(AA.EQUIP_CD, ( SELECT X.EQUIP_CD FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_CD
						, COALESCE(AA.EQUIP_NM, ( SELECT X.EQUIP_NM FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_NM
						, ISNULL(AA.DAY_NIGHT_CD, BB.DAY_NIGHT_CD) AS DAY_NIGHT_CD
						, ISNULL( (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = AA.DAY_NIGHT_CD)
								, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = BB.DAY_NIGHT_CD) ) AS DAY_NIGHT_NM
						, ISNULL(AA.GOODS_CD, BB.GOODS_CD) AS GOODS_CD
						, ISNULL(AA.GOODS_NM, BB.GOODS_NM) AS GOODS_NM
						, ISNULL(AA.GRAVITY, BB.GRAVITY) AS GRAVITY
						, ISNULL(AA.MODEL, BB.MODEL) AS MODEL
						, ISNULL(AA.QUTY_CD, BB.QUTY_CD) AS QUTY_CD
						, ISNULL( (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = AA.QUTY_CD)
								, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = BB.QUTY_CD) ) AS QUTY_NM
						, ISNULL(AA.SUM_TARGET_CNT, ISNULL(BB.SUM_TARGET_CNT, 0)) AS SUM_TARGET_CNT
						, ( ISNULL(AA.SUM_OUTPUT_CNT, 0) + ISNULL(BB.SUM_OUTPUT_CNT, 0) ) AS SUM_OUTPUT_CNT
						
						, ( ISNULL(AA.PRCS_CNT, 0) + ISNULL(BB.PRCS_CNT, 0) ) AS PRCS_CNT
						, ( ISNULL(AA.MATRL_CNT, 0) + ISNULL(BB.MATRL_CNT, 0) ) AS MATRL_CNT
						, ( ISNULL(AA.RPC_CNT, 0) + ISNULL(BB.RPC_CNT, 0) ) AS RPC_CNT
						, ( ISNULL(AA.TRB_CNT, 0) + ISNULL(BB.TRB_CNT, 0) ) AS TRB_CNT
						
						, ( ISNULL(AA.CNT_5, 0) + ISNULL(BB.CNT_5, 0) ) AS CNT_5
						, ( ISNULL(AA.CNT_6, 0) + ISNULL(BB.CNT_6, 0) ) AS CNT_6
						, ( ISNULL(AA.CNT_7, 0) + ISNULL(BB.CNT_7, 0) ) AS CNT_7
						
						, ( ISNULL(AA.PRCS_TOTAL, 0) + ISNULL(BB.PRCS_TOTAL, 0) ) AS PRCS_TOTAL
						, ( ISNULL(AA.MATRL_TOTAL, 0) + ISNULL(BB.MATRL_TOTAL, 0) ) AS MATRL_TOTAL
						, ( ISNULL(AA.RPC_TOTAL, 0) + ISNULL(BB.RPC_TOTAL, 0) ) AS RPC_TOTAL
						, ( ISNULL(AA.TRB_TOTAL, 0) + ISNULL(BB.TRB_TOTAL, 0) ) AS TRB_TOTAL
						
						, ( ISNULL(AA.TOTAL_5, 0) + ISNULL(BB.TOTAL_5, 0) ) AS TOTAL_5
						, ( ISNULL(AA.TOTAL_6, 0) + ISNULL(BB.TOTAL_6, 0) ) AS TOTAL_6
						, ( ISNULL(AA.TOTAL_7, 0) + ISNULL(BB.TOTAL_7, 0) ) AS TOTAL_7
						
						, ISNULL( CAST( ISNULL(AA.PRCS_TOTAL, 0) + ISNULL(BB.PRCS_TOTAL, 0) / ISNULL(AA.GRAVITY, BB.GRAVITY) * 1000 AS FLOAT ), 0 ) PRCS_EA
						, ISNULL( CAST( ISNULL(AA.MATRL_TOTAL, 0) + ISNULL(BB.MATRL_TOTAL, 0) / ISNULL(AA.GRAVITY, BB.GRAVITY) * 1000 AS FLOAT ), 0) MATRL_EA
						, ISNULL( CAST( ISNULL(AA.RPC_TOTAL, 0) + ISNULL(BB.RPC_TOTAL, 0) / ISNULL(AA.GRAVITY, BB.GRAVITY) * 1000 AS FLOAT ), 0) RPC_EA
						, ISNULL( CAST( ISNULL(AA.TRB_TOTAL, 0) + ISNULL(BB.TRB_TOTAL, 0) / ISNULL(AA.GRAVITY, BB.GRAVITY) * 1000 AS FLOAT ), 0) TRB_EA
						
						, ISNULL( CAST( ISNULL(AA.TOTAL_5, 0) + ISNULL(BB.TOTAL_5, 0) / ISNULL(AA.GRAVITY, BB.GRAVITY) * 1000 AS FLOAT ), 0) EA_5
						, ISNULL( CAST( ISNULL(AA.TOTAL_6, 0) + ISNULL(BB.TOTAL_6, 0) / ISNULL(AA.GRAVITY, BB.GRAVITY) * 1000 AS FLOAT ), 0) EA_6
						, ISNULL( CAST( ISNULL(AA.TOTAL_7, 0) + ISNULL(BB.TOTAL_7, 0) / ISNULL(AA.GRAVITY, BB.GRAVITY) * 1000 AS FLOAT ), 0) EA_7
						
						, ISNULL(AA.APPEAR_FAULTY_CNT,0) + ISNULL(BB.APPEAR_FAULTY_CNT,0) APPEAR_FAULTY_CNT  
						, ISNULL(AA.EDGE_FAULTY_CNT,0) + ISNULL(BB.EDGE_FAULTY_CNT,0)EDGE_FAULTY_CNT
						, ISNULL(AA.SHIP_FAULTY_CNT,0) + ISNULL(BB.SHIP_FAULTY_CNT,0) SHIP_FAULTY_CNT 
						, ISNULL(AA.RE_SHIP_FAULTY_CNT,0) + ISNULL(BB.RE_SHIP_FAULTY_CNT,0) RE_SHIP_FAULTY_CNT 
						, ISNULL(AA.OUTPUT_FAULTY_CNT,0) + ISNULL(BB.OUTPUT_FAULTY_CNT,0) OUTPUT_FAULTY_CNT 
					FROM
					(	
						SELECT
							A.EQUIP_CD
							, A.EQUIP_NM
							, A.ETC1
							, A.DAY_NIGHT_CD
							, B.GUBUN
							, B.SUM_OUTPUT_CNT
							, B.SUM_TARGET_CNT
							, C.GOODS_CD
							, C.GOODS_NM
							, C.GRAVITY
							, C.MODEL
							, D.QUTY_CD
				
							, ISNULL( E.PRCS_CNT, 0) PRCS_CNT
							, ISNULL( E.MATRL_CNT, 0) MATRL_CNT
							, ISNULL( E.RPC_CNT, 0) RPC_CNT
							, ISNULL( E.TRB_CNT, 0) TRB_CNT
							
							, ISNULL(E.CNT_5, 0) CNT_5
							, ISNULL(E.CNT_6, 0) CNT_6
							, ISNULL(E.CNT_7, 0) CNT_7
				
							, ISNULL( F.PRCS_TOTAL, 0) PRCS_TOTAL
							, ISNULL( F.MATRL_TOTAL, 0) MATRL_TOTAL
							, ISNULL( F.RPC_TOTAL, 0) RPC_TOTAL
							, ISNULL( F.TRB_TOTAL, 0) TRB_TOTAL
							
							, ISNULL(F.TOTAL_5, 0) TOTAL_5
							, ISNULL(F.TOTAL_6, 0) TOTAL_6
							, ISNULL(F.TOTAL_7, 0) TOTAL_7
				
							, ISNULL(CAST( F.PRCS_TOTAL / C.GRAVITY * 1000 AS FLOAT ), 0) PRCS_EA
							, ISNULL(CAST( F.MATRL_TOTAL / C.GRAVITY * 1000 AS FLOAT ), 0) MATRL_EA
							, ISNULL(CAST( F.RPC_TOTAL	/ C.GRAVITY * 1000 AS FLOAT ), 0) RPC_EA
							, ISNULL(CAST( F.TRB_TOTAL	/ C.GRAVITY * 1000 AS FLOAT ), 0) TRB_EA
							
							, ISNULL(CAST( F.TOTAL_5	/ C.GRAVITY * 1000 AS FLOAT ), 0) EA_5
							, ISNULL(CAST( F.TOTAL_6	/ C.GRAVITY * 1000 AS FLOAT ), 0) EA_6
							, ISNULL(CAST( F.TOTAL_7	/ C.GRAVITY * 1000 AS FLOAT ), 0) EA_7
							
							, ISNULL(FF.APPEAR_FAULTY_CNT,0) APPEAR_FAULTY_CNT  
							, ISNULL(GG.EDGE_FAULTY_CNT,0) EDGE_FAULTY_CNT
							, ISNULL(HH.SHIP_FAULTY_CNT,0) SHIP_FAULTY_CNT 
							, ISNULL(II.RE_SHIP_FAULTY_CNT,0) RE_SHIP_FAULTY_CNT 
							, ISNULL(FF.APPEAR_FAULTY_CNT,0)   
							+ ISNULL(GG.EDGE_FAULTY_CNT,0) 
							+ ISNULL(HH.SHIP_FAULTY_CNT,0)  
							+ ISNULL(II.RE_SHIP_FAULTY_CNT,0)  OUTPUT_FAULTY_CNT
						FROM
						(
							(
								SELECT
									BB.EQUIP_CD
									, BB.EQUIP_NM
									, BB.ETC1
									, BB.USE_YN_CD
									, AA.DAY_NIGHT_CD 
								FROM (
										SELECT 'D' DAY_NIGHT_CD
										UNION
										SELECT 'N' DAY_NIGHT_CD
								) AA
								FULL OUTER JOIN
									TB_EQUIP_CODE_ADM BB
								ON 1=1
								AND BB.USE_YN_CD = '001'
								AND BB.ETC1 = ''
							) A
							
							LEFT JOIN
								(	SELECT
										A.EQUIP_CD
										, A.GOODS_CD
										, B.GUBUN
										, A.TARGET_CNT AS SUM_TARGET_CNT
										, SUM(B.SUM_OUTPUT_CNT) SUM_OUTPUT_CNT
									FROM TB_WORK_ORDER A
									, (	SELECT
											A.WORK_ORD_NO
											, A.GUBUN
											, SUM(A.OUTPUT_CNT + A.VISION_EDGE_CNT) SUM_OUTPUT_CNT
										FROM TB_WORK_ORDER_OUTPUT_SUB A, TB_WORK_ORDER B, TB_EQUIP_CODE_ADM C
										WHERE 1=1
										AND A.WORK_ORD_NO = B.WORK_ORD_NO
										AND B.EQUIP_CD = C.EQUIP_CD
										AND C.ETC1 = ''
										AND WORK_ORD_DATE >= #{chooseDate1}
										AND WORK_ORD_DATE <= #{chooseDate2}
			
										GROUP BY
											A.WORK_ORD_NO
											, A.GUBUN
									) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY A.EQUIP_CD
										, A.GOODS_CD
										, B.GUBUN
										, A.TARGET_CNT
								) B
							ON A.EQUIP_CD = B.EQUIP_CD
							AND A.DAY_NIGHT_CD = B.GUBUN							
							
							LEFT OUTER JOIN
		
								(	SELECT 
								
									 ISNULL(SUM(FAULTY_CNT),0) APPEAR_FAULTY_CNT
									,GOODS_CD
									,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM  WHERE GOODS_CD = E.GOODS_CD) GOODS_NM
									,EQUIP_CD
									,(SELECT EQUIP_NM FROM TB_EQUIP_CODE_ADM  WHERE EQUIP_CD = E.EQUIP_CD) EQUIP_NM
									,E.ORD_GUBUN GUBUN
								FROM TB_GOODS_FAULTY_ADM_CODE B,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X
								WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
								AND E.WORK_ORD_NO = X.WORK_ORD_NO
								GROUP BY GOODS_CD,EQUIP_CD,E.ORD_GUBUN
								) FF
		
							ON A.EQUIP_CD = FF.EQUIP_CD
							AND A.DAY_NIGHT_CD = FF.GUBUN							
							AND FF.GOODS_CD = B.GOODS_CD
							
							LEFT OUTER JOIN
		
								(	SELECT 						
									 ISNULL(SUM(FAULTY_CNT),0) EDGE_FAULTY_CNT
									,GOODS_CD
									,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM  WHERE GOODS_CD = E.GOODS_CD) GOODS_NM
									,EQUIP_CD
									,(SELECT EQUIP_NM FROM TB_EQUIP_CODE_ADM  WHERE EQUIP_CD = E.EQUIP_CD) EQUIP_NM
									,E.ORD_GUBUN GUBUN
								FROM TB_EDGE_GOODS_FAULTY_ADM_CODE B,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X
								WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
								AND E.WORK_ORD_NO = X.WORK_ORD_NO
								GROUP BY GOODS_CD,EQUIP_CD,E.ORD_GUBUN
								) GG
		
							ON A.EQUIP_CD = GG.EQUIP_CD
							AND A.DAY_NIGHT_CD = GG.GUBUN
							AND GG.GOODS_CD = B.GOODS_CD
		
							LEFT OUTER JOIN
		
								(	SELECT 
									
									 ISNULL(SUM(A.FAULTY_CNT),0) SHIP_FAULTY_CNT
									,GOODS_CD
									,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM  WHERE GOODS_CD = E.GOODS_CD) GOODS_NM
									,EQUIP_CD
									,(SELECT EQUIP_NM FROM TB_EQUIP_CODE_ADM  WHERE EQUIP_CD = E.EQUIP_CD) EQUIP_NM
									,E.ORD_GUBUN GUBUN
								FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X
								WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
								AND E.WORK_ORD_NO = X.WORK_ORD_NO
								AND A.SHIP_INSP_IDX = B.IDX
								AND RE_INSP_STATUS != '002'
								GROUP BY GOODS_CD,EQUIP_CD,E.ORD_GUBUN
								) HH
		
							ON A.EQUIP_CD = HH.EQUIP_CD
							AND A.DAY_NIGHT_CD = HH.GUBUN
							AND HH.GOODS_CD = B.GOODS_CD
		
							LEFT OUTER JOIN
		
								(	SELECT 
									
										 ISNULL(SUM(A.FAULTY_CNT),0) RE_SHIP_FAULTY_CNT
										,GOODS_CD
										,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM  WHERE GOODS_CD = E.GOODS_CD) GOODS_NM
										,EQUIP_CD
										,(SELECT EQUIP_NM FROM TB_EQUIP_CODE_ADM  WHERE EQUIP_CD = E.EQUIP_CD) EQUIP_NM
										,E.ORD_GUBUN GUBUN
										FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X
										WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
										AND E.WORK_ORD_NO = X.WORK_ORD_NO
										AND A.SHIP_INSP_IDX = B.IDX
										AND RE_INSP_STATUS = '002'
										GROUP BY GOODS_CD,EQUIP_CD,E.ORD_GUBUN
								) II
		
							ON A.EQUIP_CD = II.EQUIP_CD
							AND A.DAY_NIGHT_CD = II.GUBUN
							AND B.GOODS_CD = II.GOODS_CD
							
			
							LEFT OUTER JOIN
								(	SELECT
										TT.GOODS_CD
										, TT.EQUIP_CD
										, TT.DAY_NIGHT_CD
										, ISNULL(TT.[001], 0) PRCS_CNT
										, ISNULL(TT.[002], 0) MATRL_CNT
										, ISNULL(TT.[003], 0) RPC_CNT
										, ISNULL(TT.[004], 0) TRB_CNT
										
										, ISNULL(TT.[005], 0) CNT_5
										, ISNULL(TT.[006], 0) CNT_6
										, ISNULL(TT.[007], 0) CNT_7
									FROM (
											SELECT
												C.GOODS_CD
												, D.EQUIP_CD
												, A.DAY_NIGHT_CD
												, COUNT(FAULTY) PRCS_CNT 
												, A.GUBUN
											FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X, TB_GOODS_CODE_ADM C, TB_EQUIP_CODE_ADM D
											WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
											AND A.WORK_ORD_NO = X.WORK_ORD_NO									
											AND B.GOODS_CD = C.GOODS_CD
											AND B.EQUIP_CD = D.EQUIP_CD
											AND D.USE_YN_CD = '001'
										
											GROUP BY C.GOODS_CD, D.EQUIP_CD, A.DAY_NIGHT_CD, A.GUBUN
										) AS t
									PIVOT (
										SUM(t.PRCS_CNT)
										FOR t.GUBUN IN ([001], [002], [003], [004], [005], [006], [007])
									) AS TT
								) E
							ON A.EQUIP_CD = E.EQUIP_CD
							AND A.DAY_NIGHT_CD = E.DAY_NIGHT_CD
							AND B.GOODS_CD = E.GOODS_CD						
			
							LEFT OUTER JOIN
								(	SELECT
											TT.GOODS_CD
											, TT.EQUIP_CD
											, TT.DAY_NIGHT_CD
											, ISNULL(TT.[001], 0) PRCS_TOTAL
											, ISNULL(TT.[002], 0) MATRL_TOTAL
											, ISNULL(TT.[003], 0) RPC_TOTAL
											, ISNULL(TT.[004], 0) TRB_TOTAL
											
											, ISNULL(TT.[005], 0) TOTAL_5
											, ISNULL(TT.[006], 0) TOTAL_6
											, ISNULL(TT.[007], 0) TOTAL_7
										FROM (
											SELECT
												C.GOODS_CD
												, D.EQUIP_CD
												, A.DAY_NIGHT_CD
												, SUM(A.FAULTY) FAULTY
												, A.GUBUN
											FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X, TB_GOODS_CODE_ADM C, TB_EQUIP_CODE_ADM D
											WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
											AND B.GOODS_CD = C.GOODS_CD
											AND B.EQUIP_CD = D.EQUIP_CD
											AND A.WORK_ORD_NO = X.WORK_ORD_NO
											GROUP BY C.GOODS_CD
												, D.EQUIP_CD
												, A.DAY_NIGHT_CD
												, A.GUBUN
										) AS t 
									PIVOT (
										SUM(t.FAULTY)
										FOR t.GUBUN IN ([001], [002], [003], [004], [005], [006], [007]) 
									) AS TT
								) F
							ON A.EQUIP_CD = F.EQUIP_CD
							AND A.DAY_NIGHT_CD = F.DAY_NIGHT_CD
							AND B.GOODS_CD = F.GOODS_CD
			
							LEFT JOIN
								TB_GOODS_CODE_ADM AS C
							ON B.GOODS_CD = C.GOODS_CD
							LEFT JOIN
								TB_MATRL_CODE_ADM AS D
							ON C.ALNICU_MATRL_CD = D.MATRL_CD
						)
						WHERE 1=1
						AND A.USE_YN_CD = '001'
						AND A.ETC1 = ''
						AND C.GOODS_CD IS NOT NULL
					) AA
						
					FULL OUTER JOIN
					
					(
						SELECT
							A.ETC1
							, A.DAY_NIGHT_CD
							, C.GOODS_CD
							, C.GOODS_NM
							, C.GRAVITY
							, C.MODEL
							, D.QUTY_CD
							, B.SUM_TARGET_CNT
							, SUM(B.SUM_OUTPUT_CNT) SUM_OUTPUT_CNT
							
							, ISNULL( SUM(E.PRCS_CNT), 0) PRCS_CNT
							, ISNULL( SUM(E.MATRL_CNT), 0) MATRL_CNT
							, ISNULL( SUM(E.RPC_CNT), 0) RPC_CNT
							, ISNULL( SUM(E.TRB_CNT), 0) TRB_CNT
							
							, ISNULL( SUM(E.CNT_5), 0) CNT_5
							, ISNULL( SUM(E.CNT_6), 0) CNT_6
							, ISNULL( SUM(E.CNT_7), 0) CNT_7
				
							, ISNULL( SUM(F.PRCS_TOTAL), 0) PRCS_TOTAL
							, ISNULL( SUM(F.MATRL_TOTAL), 0) MATRL_TOTAL
							, ISNULL( SUM(F.RPC_TOTAL), 0) RPC_TOTAL
							, ISNULL( SUM(F.TRB_TOTAL), 0) TRB_TOTAL
							
							, ISNULL( SUM(F.TOTAL_5), 0) TOTAL_5
							, ISNULL( SUM(F.TOTAL_6), 0) TOTAL_6
							, ISNULL( SUM(F.TOTAL_7), 0) TOTAL_7
				
							, ISNULL(CAST( SUM(F.PRCS_TOTAL) / C.GRAVITY * 1000 AS FLOAT ), 0) PRCS_EA
							, ISNULL(CAST( SUM(F.MATRL_TOTAL) / C.GRAVITY * 1000 AS FLOAT ), 0) MATRL_EA
							, ISNULL(CAST( SUM(F.RPC_TOTAL)	/ C.GRAVITY * 1000 AS FLOAT ), 0) RPC_EA
							, ISNULL(CAST( SUM(F.TRB_TOTAL)	/ C.GRAVITY * 1000 AS FLOAT ), 0) TRB_EA
							
							, ISNULL(CAST( SUM(F.TOTAL_5)	/ C.GRAVITY * 1000 AS FLOAT ), 0) EA_5
							, ISNULL(CAST( SUM(F.TOTAL_6)	/ C.GRAVITY * 1000 AS FLOAT ), 0) EA_6
							, ISNULL(CAST( SUM(F.TOTAL_7)	/ C.GRAVITY * 1000 AS FLOAT ), 0) EA_7
							
							, ISNULL(SUM(FF.APPEAR_FAULTY_CNT),0) APPEAR_FAULTY_CNT  
							, ISNULL(SUM(GG.EDGE_FAULTY_CNT),0) EDGE_FAULTY_CNT
							, ISNULL(SUM(HH.SHIP_FAULTY_CNT),0) SHIP_FAULTY_CNT 
							, ISNULL(SUM(II.RE_SHIP_FAULTY_CNT),0) RE_SHIP_FAULTY_CNT 
							, ISNULL(SUM(FF.APPEAR_FAULTY_CNT),0)   
							+ ISNULL(SUM(GG.EDGE_FAULTY_CNT),0) 
							+ ISNULL(SUM(HH.SHIP_FAULTY_CNT),0)  
							+ ISNULL(SUM(II.RE_SHIP_FAULTY_CNT),0) OUTPUT_FAULTY_CNT 
						FROM (
								(
									SELECT
										B.EQUIP_CD
										, B.EQUIP_NM
										, B.ETC1
										, AA.DAY_NIGHT_CD
									FROM TB_EQUIP_CODE_ADM B									
									LEFT OUTER JOIN
										TB_EQUIP_CODE_ADM D
									ON 1=1
									AND B.EQUIP_NM = D.ETC1
									FULL OUTER JOIN
										(	
											SELECT 'D' DAY_NIGHT_CD
											UNION
											SELECT 'N' DAY_NIGHT_CD
										) AA
									ON 1=1
									WHERE 1=1
									AND B.USE_YN_CD = '001'
									AND B.ETC1 != ''
									GROUP BY
										B.EQUIP_CD
										, B.EQUIP_NM
										, B.ETC1
										, AA.DAY_NIGHT_CD
								) A
								
									LEFT OUTER JOIN
									(
										SELECT
											A.EQUIP_CD
											, A.GOODS_CD
											, B.GUBUN
											, A.TARGET_CNT AS SUM_TARGET_CNT
											, SUM(B.SUM_OUTPUT_CNT) SUM_OUTPUT_CNT
										FROM TB_WORK_ORDER A
											, (	SELECT
													MAX(A.WORK_ORD_NO) AS WORK_ORD_NO
													, A.GUBUN
													, SUM(A.OUTPUT_CNT + A.VISION_EDGE_CNT) SUM_OUTPUT_CNT
													, B.EQUIP_CD
													, B.GOODS_CD
												FROM TB_WORK_ORDER_OUTPUT_SUB A, TB_WORK_ORDER B, TB_EQUIP_CODE_ADM C
												WHERE 1=1
												AND A.WORK_ORD_NO = B.WORK_ORD_NO
												AND B.EQUIP_CD = C.EQUIP_CD
												AND C.ETC1 != ''
												AND WORK_ORD_DATE >= #{chooseDate1}
												AND WORK_ORD_DATE <= #{chooseDate2}
							
												GROUP BY
													 A.GUBUN
													, B.EQUIP_CD
													, B.GOODS_CD
											) B
										WHERE 1=1
										AND A.WORK_ORD_NO = B.WORK_ORD_NO
										GROUP BY
											A.EQUIP_CD
											, A.GOODS_CD
											, B.GUBUN
											, A.TARGET_CNT
									) B
								ON 1=1
								AND A.EQUIP_CD = B.EQUIP_CD
								AND A.DAY_NIGHT_CD = B.GUBUN
							
								
								LEFT OUTER JOIN
		
								(	SELECT 
								
									 ISNULL(SUM(FAULTY_CNT),0) APPEAR_FAULTY_CNT
									,GOODS_CD
									,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM  WHERE GOODS_CD = E.GOODS_CD) GOODS_NM
									,EQUIP_CD
									,(SELECT EQUIP_NM FROM TB_EQUIP_CODE_ADM  WHERE EQUIP_CD = E.EQUIP_CD) EQUIP_NM
									,E.ORD_GUBUN GUBUN
								FROM TB_GOODS_FAULTY_ADM_CODE B,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X
								WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
								AND E.WORK_ORD_NO = X.WORK_ORD_NO
								GROUP BY GOODS_CD,EQUIP_CD,E.ORD_GUBUN
								) FF
		
							ON A.EQUIP_CD = FF.EQUIP_CD
							AND A.DAY_NIGHT_CD = FF.GUBUN
							AND FF.GOODS_CD = B.GOODS_CD
		
							LEFT OUTER JOIN
		
								(	SELECT 						
									 ISNULL(SUM(FAULTY_CNT),0) EDGE_FAULTY_CNT
									,GOODS_CD
									,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM  WHERE GOODS_CD = E.GOODS_CD) GOODS_NM
									,EQUIP_CD
									,(SELECT EQUIP_NM FROM TB_EQUIP_CODE_ADM  WHERE EQUIP_CD = E.EQUIP_CD) EQUIP_NM
									,E.ORD_GUBUN GUBUN
								FROM TB_EDGE_GOODS_FAULTY_ADM_CODE B,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X
								WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
								AND E.WORK_ORD_NO = X.WORK_ORD_NO
								GROUP BY GOODS_CD,EQUIP_CD,E.ORD_GUBUN
								) GG
		
							ON A.EQUIP_CD = GG.EQUIP_CD
							AND A.DAY_NIGHT_CD = GG.GUBUN
							AND B.GOODS_CD = GG.GOODS_CD
		
							LEFT OUTER JOIN
		
								(	SELECT 
									
									 ISNULL(SUM(A.FAULTY_CNT),0) SHIP_FAULTY_CNT
									,GOODS_CD
									,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM  WHERE GOODS_CD = E.GOODS_CD) GOODS_NM
									,EQUIP_CD
									,(SELECT EQUIP_NM FROM TB_EQUIP_CODE_ADM  WHERE EQUIP_CD = E.EQUIP_CD) EQUIP_NM
									,E.ORD_GUBUN GUBUN
								FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X
								WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
								AND E.WORK_ORD_NO = X.WORK_ORD_NO
								AND A.SHIP_INSP_IDX = B.IDX
								AND RE_INSP_STATUS != '002'
								GROUP BY GOODS_CD,EQUIP_CD,E.ORD_GUBUN
								) HH
		
							ON A.EQUIP_CD = HH.EQUIP_CD
							AND A.DAY_NIGHT_CD = HH.GUBUN
							AND B.GOODS_CD = HH.GOODS_CD
		
							LEFT OUTER JOIN
		
								(	SELECT 
									
										 ISNULL(SUM(A.FAULTY_CNT),0) RE_SHIP_FAULTY_CNT
										,GOODS_CD
										,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM  WHERE GOODS_CD = E.GOODS_CD) GOODS_NM
										,EQUIP_CD
										,(SELECT EQUIP_NM FROM TB_EQUIP_CODE_ADM  WHERE EQUIP_CD = E.EQUIP_CD) EQUIP_NM
										,E.ORD_GUBUN GUBUN
										FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X
										WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
										AND E.WORK_ORD_NO = X.WORK_ORD_NO
										AND A.SHIP_INSP_IDX = B.IDX
										AND RE_INSP_STATUS = '002'
										GROUP BY GOODS_CD,EQUIP_CD,E.ORD_GUBUN
								) II
		
							ON A.EQUIP_CD = II.EQUIP_CD
							AND A.DAY_NIGHT_CD = II.GUBUN
							AND B.GOODS_CD = II.GOODS_CD
							
				
								LEFT OUTER JOIN
									(
										SELECT
											TT.GOODS_CD
											, TT.EQUIP_CD
											, TT.DAY_NIGHT_CD
											, ISNULL(TT.[001], 0) PRCS_CNT
											, ISNULL(TT.[002], 0) MATRL_CNT
											, ISNULL(TT.[003], 0) RPC_CNT
											, ISNULL(TT.[004], 0) TRB_CNT
											
											, ISNULL(TT.[005], 0) CNT_5
											, ISNULL(TT.[006], 0) CNT_6
											, ISNULL(TT.[007], 0) CNT_7
										
										FROM (
											SELECT
												C.GOODS_CD
												, D.EQUIP_CD
												, A.DAY_NIGHT_CD
												, COUNT(FAULTY) PRCS_CNT 
												, A.GUBUN
											FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B, TB_GOODS_CODE_ADM C,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X, TB_EQUIP_CODE_ADM D
											WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
											AND B.GOODS_CD = C.GOODS_CD
											AND B.EQUIP_CD = D.EQUIP_CD
											AND D.USE_YN_CD = '001'
											AND X.WORK_ORD_NO = A.WORK_ORD_NO
											AND D.ETC1 != ''
											GROUP BY
												C.GOODS_CD
												, D.EQUIP_CD
												, A.DAY_NIGHT_CD
												, A.GUBUN
										) AS t
										PIVOT (
											SUM(t.PRCS_CNT)
											FOR t.GUBUN IN ([001], [002], [003], [004], [005], [006], [007])
										) AS TT
									) E
								ON A.EQUIP_CD = E.EQUIP_CD
								AND A.DAY_NIGHT_CD = E.DAY_NIGHT_CD
								AND B.GOODS_CD = E.GOODS_CD
				
								LEFT OUTER JOIN
									(	
										SELECT
											TT.GOODS_CD
											, TT.EQUIP_CD
											, TT.DAY_NIGHT_CD
											, ISNULL(TT.[001], 0) PRCS_TOTAL
											, ISNULL(TT.[002], 0) MATRL_TOTAL
											, ISNULL(TT.[003], 0) RPC_TOTAL
											, ISNULL(TT.[004], 0) TRB_TOTAL
											
											, ISNULL(TT.[005], 0) TOTAL_5
											, ISNULL(TT.[006], 0) TOTAL_6
											, ISNULL(TT.[007], 0) TOTAL_7
											
										FROM (
											SELECT
												C.GOODS_CD
												, D.EQUIP_CD
												, A.DAY_NIGHT_CD
												, SUM(A.FAULTY) FAULTY
												, A.GUBUN
											FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B, TB_GOODS_CODE_ADM C,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X, TB_EQUIP_CODE_ADM D
											WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
											AND B.GOODS_CD = C.GOODS_CD
											AND B.EQUIP_CD = D.EQUIP_CD
											AND X.WORK_ORD_NO = A.WORK_ORD_NO
											AND D.ETC1 != ''
											GROUP BY C.GOODS_CD
												, D.EQUIP_CD
												, A.DAY_NIGHT_CD
												, A.GUBUN
										) AS t 
										PIVOT (
											SUM(t.FAULTY)
											FOR t.GUBUN IN ([001], [002], [003], [004], [005], [006], [007]) 
										) AS TT
									) F
								ON A.EQUIP_CD = F.EQUIP_CD
								AND A.DAY_NIGHT_CD = F.DAY_NIGHT_CD
								AND B.GOODS_CD = F.GOODS_CD
				
								LEFT JOIN
									TB_GOODS_CODE_ADM AS C
								ON B.GOODS_CD = C.GOODS_CD
								LEFT JOIN
									TB_MATRL_CODE_ADM AS D
								ON C.ALNICU_MATRL_CD = D.MATRL_CD
							)
							
						WHERE 1=1
						AND C.GOODS_CD IS NOT NULL
							
						GROUP BY
							 A.ETC1
							, A.DAY_NIGHT_CD
							, C.GOODS_CD
							, C.GOODS_NM
							, C.GRAVITY
							, C.MODEL
							, D.QUTY_CD
							, B.SUM_TARGET_CNT
					) BB
					
					ON 1=1
					AND AA.EQUIP_NM = BB.ETC1
					AND AA.DAY_NIGHT_CD = BB.DAY_NIGHT_CD
					AND AA.GOODS_CD = BB.GOODS_CD
				) CC
				ON 1=1
				AND CC.EQUIP_CD =  DD.EQUIP_CD
				AND CC.DAY_NIGHT_CD =  DD.DAY_NIGHT_CD
			
				ORDER BY DAY_NIGHT_CD, EQUIP_NM ASC
		
		
		]]>
	</select>
	
	
	<!-- 생산실적 설비별(불량내역전체 포함) -->
	<select id="readActualOutputEquipsList_F3" resultMap="FaultyHistoryVo">
		<![CDATA[
			SELECT 
				DD.EQUIP_CD
				, DD.EQUIP_NM
				, DD.DAY_NIGHT_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = DD.DAY_NIGHT_CD) AS DAY_NIGHT_NM
				, CC.GOODS_CD
				, CC.GOODS_NM
				, CC.QUTY_CD
				, CC.QUTY_NM
				, CC.MODEL
				
				, ISNULL( CC.GRAVITY, 0 ) AS GRAVITY
				, ISNULL( CC.SUM_TARGET_CNT, 0 ) AS SUM_TARGET_CNT
				, ISNULL( CC.SUM_OUTPUT_CNT, 0 ) AS SUM_OUTPUT_CNT
				
				, ISNULL( CC.PRCS_CNT, 0 ) AS PRCS_CNT
				, ISNULL( CC.MATRL_CNT, 0 ) AS MATRL_CNT
				, ISNULL( CC.RPC_CNT, 0 ) AS RPC_CNT
				, ISNULL( CC.TRB_CNT, 0 ) AS TRB_CNT
				, ISNULL(CC.CNT_5, 0) CNT_5
				, ISNULL(CC.CNT_6, 0) CNT_6
				, ISNULL(CC.CNT_7, 0) CNT_7
				
				--, ISNULL( CC.PRCS_TOTAL, 0 ) AS PRCS_TOTAL
				--, ISNULL( CC.MATRL_TOTAL, 0 ) AS MATRL_TOTAL
				--, ISNULL( CC.RPC_TOTAL, 0 ) AS RPC_TOTAL
				--, ISNULL( CC.TRB_TOTAL, 0 ) AS TRB_TOTAL
				--, ISNULL(CC.TOTAL_5, 0) TOTAL_5
				--, ISNULL(CC.TOTAL_6, 0) TOTAL_6
				--, ISNULL(CC.TOTAL_7, 0) TOTAL_7
				
				
				, (CASE WHEN ISNULL(CC.PRCS_TOTAL, 0) = 0 THEN 0 ELSE CC.PRCS_TOTAL - BASKET_WEIGHT.ETC1 END ) PRCS_TOTAL
				, (CASE WHEN ISNULL(CC.MATRL_TOTAL, 0) = 0 THEN 0 ELSE CC.MATRL_TOTAL - BASKET_WEIGHT.ETC1 END ) MATRL_TOTAL
				, (CASE WHEN ISNULL(CC.RPC_TOTAL, 0) = 0 THEN 0 ELSE CC.RPC_TOTAL - BASKET_WEIGHT.ETC1 END ) RPC_TOTAL
				, (CASE WHEN ISNULL(CC.TRB_TOTAL, 0) = 0 THEN 0 ELSE CC.TRB_TOTAL - BASKET_WEIGHT.ETC1 END ) TRB_TOTAL
				, ISNULL(CC.TOTAL_5, 0) TOTAL_5
				, (CASE WHEN ISNULL(CC.TOTAL_6, 0) = 0 THEN 0 ELSE CC.TOTAL_6 - BASKET_WEIGHT.ETC1 END ) TOTAL_6
				, (CASE WHEN ISNULL(CC.TOTAL_7, 0) = 0 THEN 0 ELSE CC.TOTAL_7 - BASKET_WEIGHT.ETC1 END ) TOTAL_7
				
				
				--, ISNULL ( CAST( CAST(CC.PRCS_TOTAL AS float)  / CAST(CC.GRAVITY AS FLOAT) * 1000 AS float), 0 ) AS PRCS_EA
				--, ISNULL ( CAST( CAST(CC.MATRL_TOTAL AS float)  / CAST(CC.GRAVITY AS FLOAT) * 1000 AS float), 0 ) AS MATRL_EA
				--, ISNULL ( CAST( CAST(CC.RPC_TOTAL AS float)  / CAST(CC.GRAVITY AS FLOAT) * 1000 AS float), 0 ) AS RPC_EA
				--, ISNULL ( CAST( CAST(CC.TRB_TOTAL AS float)  / CAST(CC.GRAVITY AS FLOAT) * 1000 AS float), 0 ) AS TRB_EA
				--, ISNULL( CAST( CAST(CC.TOTAL_5 AS FLOAT) / CAST(CC.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS EA_5
				--, ISNULL( CAST( CAST(CC.TOTAL_6 AS FLOAT) / CAST(CC.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS EA_6
				--, ISNULL( CAST( CAST(CC.TOTAL_7 AS FLOAT) / CAST(CC.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS EA_7
				
				
				
				, (CASE WHEN ISNULL(CC.PRCS_TOTAL, 0) = 0 THEN 0 ELSE ISNULL( CAST( ( CAST(CC.PRCS_TOTAL AS FLOAT) - BASKET_WEIGHT.ETC1) / CAST(CC.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) END ) PRCS_EA
				, (CASE WHEN ISNULL(CC.MATRL_TOTAL, 0) = 0 THEN 0 ELSE ISNULL( CAST( ( CAST(CC.MATRL_TOTAL AS FLOAT) - BASKET_WEIGHT.ETC1) / CAST(CC.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) END ) MATRL_EA
				, (CASE WHEN ISNULL(CC.RPC_TOTAL, 0) = 0 THEN 0 ELSE ISNULL( CAST( ( CAST(CC.RPC_TOTAL AS FLOAT) - BASKET_WEIGHT.ETC1) / CAST(CC.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) END ) RPC_EA
				, (CASE WHEN ISNULL(CC.TRB_TOTAL, 0) = 0 THEN 0 ELSE ISNULL( CAST( ( CAST(CC.TRB_TOTAL AS FLOAT) - BASKET_WEIGHT.ETC1) / CAST(CC.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) END ) TRB_EA
				, ISNULL( CAST( CAST(CC.TOTAL_5 AS FLOAT) / CAST(CC.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS EA_5
				, (CASE WHEN ISNULL(CC.TOTAL_6, 0) = 0 THEN 0 ELSE ISNULL( CAST( ( CAST(CC.TOTAL_6 AS FLOAT) - BASKET_WEIGHT.ETC1) / CAST(CC.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) END ) EA_6
				, (CASE WHEN ISNULL(CC.TOTAL_7, 0) = 0 THEN 0 ELSE ISNULL( CAST( ( CAST(CC.TOTAL_7 AS FLOAT) - BASKET_WEIGHT.ETC1) / CAST(CC.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) END ) EA_7
				
				
				, ISNULL(CC.APPEAR_FAULTY_CNT,0) APPEAR_FAULTY_CNT  
				, ISNULL(CC.EDGE_FAULTY_CNT,0) EDGE_FAULTY_CNT
				, ISNULL(CC.SHIP_FAULTY_CNT,0) SHIP_FAULTY_CNT 
				, ISNULL(CC.RE_SHIP_FAULTY_CNT,0) RE_SHIP_FAULTY_CNT 
				, ISNULL(CC.OUTPUT_FAULTY_CNT,0) OUTPUT_FAULTY_CNT
				
			FROM
				(
					SELECT A.EQUIP_CD
						, A.EQUIP_NM
						, A.ETC1
						, B.DAY_NIGHT_CD
					FROM TB_EQUIP_CODE_ADM A
					, (
						SELECT
							'D' DAY_NIGHT_CD
						UNION
						SELECT
							'N' DAY_NIGHT_CD
							) B
					WHERE USE_YN_CD = '001'
					AND ETC1 = ''
				)DD
		
				FULL OUTER JOIN
		
					(
			
					SELECT
						COALESCE(AA.EQUIP_CD, ( SELECT X.EQUIP_CD FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_CD
						, COALESCE(AA.EQUIP_NM, ( SELECT X.EQUIP_NM FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_NM
						, ISNULL(AA.DAY_NIGHT_CD, BB.DAY_NIGHT_CD) AS DAY_NIGHT_CD
						, ISNULL( (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = AA.DAY_NIGHT_CD)
								, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = BB.DAY_NIGHT_CD) ) AS DAY_NIGHT_NM
						, ISNULL(AA.GOODS_CD, BB.GOODS_CD) AS GOODS_CD
						, ISNULL(AA.GOODS_NM, BB.GOODS_NM) AS GOODS_NM
						, ISNULL(AA.GRAVITY, BB.GRAVITY) AS GRAVITY
						, ISNULL(AA.MODEL, BB.MODEL) AS MODEL
						, ISNULL(AA.QUTY_CD, BB.QUTY_CD) AS QUTY_CD
						, ISNULL( (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = AA.QUTY_CD)
								, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = BB.QUTY_CD) ) AS QUTY_NM
						, ISNULL(AA.SUM_TARGET_CNT, ISNULL(BB.SUM_TARGET_CNT, 0)) AS SUM_TARGET_CNT
						, ( ISNULL(AA.SUM_OUTPUT_CNT, 0) + ISNULL(BB.SUM_OUTPUT_CNT, 0) ) AS SUM_OUTPUT_CNT
						
						, ( ISNULL(AA.PRCS_CNT, 0) + ISNULL(BB.PRCS_CNT, 0) ) AS PRCS_CNT
						, ( ISNULL(AA.MATRL_CNT, 0) + ISNULL(BB.MATRL_CNT, 0) ) AS MATRL_CNT
						, ( ISNULL(AA.RPC_CNT, 0) + ISNULL(BB.RPC_CNT, 0) ) AS RPC_CNT
						, ( ISNULL(AA.TRB_CNT, 0) + ISNULL(BB.TRB_CNT, 0) ) AS TRB_CNT
						
						, ( ISNULL(AA.CNT_5, 0) + ISNULL(BB.CNT_5, 0) ) AS CNT_5
						, ( ISNULL(AA.CNT_6, 0) + ISNULL(BB.CNT_6, 0) ) AS CNT_6
						, ( ISNULL(AA.CNT_7, 0) + ISNULL(BB.CNT_7, 0) ) AS CNT_7
						
						, ( ISNULL(AA.PRCS_TOTAL, 0) + ISNULL(BB.PRCS_TOTAL, 0) ) AS PRCS_TOTAL
						, ( ISNULL(AA.MATRL_TOTAL, 0) + ISNULL(BB.MATRL_TOTAL, 0) ) AS MATRL_TOTAL
						, ( ISNULL(AA.RPC_TOTAL, 0) + ISNULL(BB.RPC_TOTAL, 0) ) AS RPC_TOTAL
						, ( ISNULL(AA.TRB_TOTAL, 0) + ISNULL(BB.TRB_TOTAL, 0) ) AS TRB_TOTAL
						
						, ( ISNULL(AA.TOTAL_5, 0) + ISNULL(BB.TOTAL_5, 0) ) AS TOTAL_5
						, ( ISNULL(AA.TOTAL_6, 0) + ISNULL(BB.TOTAL_6, 0) ) AS TOTAL_6
						, ( ISNULL(AA.TOTAL_7, 0) + ISNULL(BB.TOTAL_7, 0) ) AS TOTAL_7
						
						, ISNULL( CAST( ISNULL(AA.PRCS_TOTAL, 0) + ISNULL(BB.PRCS_TOTAL, 0) / ISNULL(AA.GRAVITY, BB.GRAVITY) * 1000 AS FLOAT ), 0 ) PRCS_EA
						, ISNULL( CAST( ISNULL(AA.MATRL_TOTAL, 0) + ISNULL(BB.MATRL_TOTAL, 0) / ISNULL(AA.GRAVITY, BB.GRAVITY) * 1000 AS FLOAT ), 0) MATRL_EA
						, ISNULL( CAST( ISNULL(AA.RPC_TOTAL, 0) + ISNULL(BB.RPC_TOTAL, 0) / ISNULL(AA.GRAVITY, BB.GRAVITY) * 1000 AS FLOAT ), 0) RPC_EA
						, ISNULL( CAST( ISNULL(AA.TRB_TOTAL, 0) + ISNULL(BB.TRB_TOTAL, 0) / ISNULL(AA.GRAVITY, BB.GRAVITY) * 1000 AS FLOAT ), 0) TRB_EA
						
						, ISNULL( CAST( ISNULL(AA.TOTAL_5, 0) + ISNULL(BB.TOTAL_5, 0) / ISNULL(AA.GRAVITY, BB.GRAVITY) * 1000 AS FLOAT ), 0) EA_5
						, ISNULL( CAST( ISNULL(AA.TOTAL_6, 0) + ISNULL(BB.TOTAL_6, 0) / ISNULL(AA.GRAVITY, BB.GRAVITY) * 1000 AS FLOAT ), 0) EA_6
						, ISNULL( CAST( ISNULL(AA.TOTAL_7, 0) + ISNULL(BB.TOTAL_7, 0) / ISNULL(AA.GRAVITY, BB.GRAVITY) * 1000 AS FLOAT ), 0) EA_7
						
						, ISNULL(AA.APPEAR_FAULTY_CNT,0) + ISNULL(BB.APPEAR_FAULTY_CNT,0) APPEAR_FAULTY_CNT  
						, ISNULL(AA.EDGE_FAULTY_CNT,0) + ISNULL(BB.EDGE_FAULTY_CNT,0)EDGE_FAULTY_CNT
						, ISNULL(AA.SHIP_FAULTY_CNT,0) + ISNULL(BB.SHIP_FAULTY_CNT,0) SHIP_FAULTY_CNT 
						, ISNULL(AA.RE_SHIP_FAULTY_CNT,0) + ISNULL(BB.RE_SHIP_FAULTY_CNT,0) RE_SHIP_FAULTY_CNT 
						, ISNULL(AA.OUTPUT_FAULTY_CNT,0) + ISNULL(BB.OUTPUT_FAULTY_CNT,0) OUTPUT_FAULTY_CNT 
					FROM
					(	
						SELECT
							A.EQUIP_CD
							, A.EQUIP_NM
							, A.ETC1
							, A.DAY_NIGHT_CD
							, B.GUBUN
							, B.SUM_OUTPUT_CNT
							, B.SUM_TARGET_CNT
							, C.GOODS_CD
							, C.GOODS_NM
							, C.GRAVITY
							, C.MODEL
							, D.QUTY_CD
				
							, ISNULL( E.PRCS_CNT, 0) PRCS_CNT
							, ISNULL( E.MATRL_CNT, 0) MATRL_CNT
							, ISNULL( E.RPC_CNT, 0) RPC_CNT
							, ISNULL( E.TRB_CNT, 0) TRB_CNT
							
							, ISNULL(E.CNT_5, 0) CNT_5
							, ISNULL(E.CNT_6, 0) CNT_6
							, ISNULL(E.CNT_7, 0) CNT_7
				
							, ISNULL( F.PRCS_TOTAL, 0) PRCS_TOTAL
							, ISNULL( F.MATRL_TOTAL, 0) MATRL_TOTAL
							, ISNULL( F.RPC_TOTAL, 0) RPC_TOTAL
							, ISNULL( F.TRB_TOTAL, 0) TRB_TOTAL
							
							, ISNULL(F.TOTAL_5, 0) TOTAL_5
							, ISNULL(F.TOTAL_6, 0) TOTAL_6
							, ISNULL(F.TOTAL_7, 0) TOTAL_7
				
							, ISNULL(CAST( F.PRCS_TOTAL / C.GRAVITY * 1000 AS FLOAT ), 0) PRCS_EA
							, ISNULL(CAST( F.MATRL_TOTAL / C.GRAVITY * 1000 AS FLOAT ), 0) MATRL_EA
							, ISNULL(CAST( F.RPC_TOTAL	/ C.GRAVITY * 1000 AS FLOAT ), 0) RPC_EA
							, ISNULL(CAST( F.TRB_TOTAL	/ C.GRAVITY * 1000 AS FLOAT ), 0) TRB_EA
							
							, ISNULL(CAST( F.TOTAL_5	/ C.GRAVITY * 1000 AS FLOAT ), 0) EA_5
							, ISNULL(CAST( F.TOTAL_6	/ C.GRAVITY * 1000 AS FLOAT ), 0) EA_6
							, ISNULL(CAST( F.TOTAL_7	/ C.GRAVITY * 1000 AS FLOAT ), 0) EA_7
							
							, ISNULL(FF.APPEAR_FAULTY_CNT,0) APPEAR_FAULTY_CNT  
							, ISNULL(GG.EDGE_FAULTY_CNT,0) EDGE_FAULTY_CNT
							, ISNULL(HH.SHIP_FAULTY_CNT,0) SHIP_FAULTY_CNT 
							, ISNULL(II.RE_SHIP_FAULTY_CNT,0) RE_SHIP_FAULTY_CNT 
							, ISNULL(FF.APPEAR_FAULTY_CNT,0)   
							+ ISNULL(GG.EDGE_FAULTY_CNT,0) 
							+ ISNULL(HH.SHIP_FAULTY_CNT,0)  
							+ ISNULL(II.RE_SHIP_FAULTY_CNT,0)  OUTPUT_FAULTY_CNT
						FROM
						(
							(
								SELECT
									BB.EQUIP_CD
									, BB.EQUIP_NM
									, BB.ETC1
									, BB.USE_YN_CD
									, AA.DAY_NIGHT_CD 
								FROM (
										SELECT 'D' DAY_NIGHT_CD
										UNION
										SELECT 'N' DAY_NIGHT_CD
								) AA
								FULL OUTER JOIN
									TB_EQUIP_CODE_ADM BB
								ON 1=1
								AND BB.USE_YN_CD = '001'
								AND BB.ETC1 = ''
							) A
							
							LEFT OUTER JOIN
								(	SELECT
										A.EQUIP_CD
										, A.GOODS_CD
										, B.GUBUN
										, A.TARGET_CNT AS SUM_TARGET_CNT
										, SUM(B.SUM_OUTPUT_CNT) SUM_OUTPUT_CNT
									FROM TB_WORK_ORDER A
									, (	SELECT
											A.WORK_ORD_NO
											, A.GUBUN
											, SUM(A.OUTPUT_CNT + A.VISION_EDGE_CNT) SUM_OUTPUT_CNT
										FROM TB_WORK_ORDER_OUTPUT_SUB A, TB_WORK_ORDER B, TB_EQUIP_CODE_ADM C
										WHERE 1=1
										AND A.WORK_ORD_NO = B.WORK_ORD_NO
										AND B.EQUIP_CD = C.EQUIP_CD
										AND C.ETC1 = ''
										AND WORK_ORD_DATE >= #{chooseDate1}
										AND WORK_ORD_DATE <= #{chooseDate2}
			
										GROUP BY
											A.WORK_ORD_NO
											, A.GUBUN
									) B
									WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
									GROUP BY A.EQUIP_CD
										, A.GOODS_CD
										, B.GUBUN
										, A.TARGET_CNT
								) B
							ON A.EQUIP_CD = B.EQUIP_CD
							AND A.DAY_NIGHT_CD = B.GUBUN
							
							LEFT OUTER JOIN
		
								(	SELECT 
								
									 ISNULL(SUM(FAULTY_CNT),0) APPEAR_FAULTY_CNT
									,GOODS_CD
									,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM  WHERE GOODS_CD = E.GOODS_CD) GOODS_NM
									,EQUIP_CD
									,(SELECT EQUIP_NM FROM TB_EQUIP_CODE_ADM  WHERE EQUIP_CD = E.EQUIP_CD) EQUIP_NM
									,B.DAY_NIGHT_CD GUBUN
								FROM TB_GOODS_FAULTY_ADM_CODE B,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X
								WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
								AND E.WORK_ORD_NO = X.WORK_ORD_NO
								GROUP BY GOODS_CD,EQUIP_CD,B.DAY_NIGHT_CD
								) FF
		
							ON A.EQUIP_CD = FF.EQUIP_CD
							AND A.DAY_NIGHT_CD = FF.GUBUN
							--AND B.GOODS_CD = FF.GOODS_CD
		
							LEFT OUTER JOIN
		
								(	SELECT 						
									 ISNULL(SUM(FAULTY_CNT),0) EDGE_FAULTY_CNT
									,GOODS_CD
									,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM  WHERE GOODS_CD = E.GOODS_CD) GOODS_NM
									,EQUIP_CD
									,(SELECT EQUIP_NM FROM TB_EQUIP_CODE_ADM  WHERE EQUIP_CD = E.EQUIP_CD) EQUIP_NM
									,B.DAY_NIGHT_CD GUBUN
								FROM TB_EDGE_GOODS_FAULTY_ADM_CODE B,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X
								WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
								AND E.WORK_ORD_NO = X.WORK_ORD_NO
								GROUP BY GOODS_CD,EQUIP_CD,B.DAY_NIGHT_CD
								) GG
		
							ON A.EQUIP_CD = GG.EQUIP_CD
							AND A.DAY_NIGHT_CD = GG.GUBUN
							--AND B.GOODS_CD = GG.GOODS_CD
		
							LEFT OUTER JOIN
		
								(	SELECT 
									
									 ISNULL(SUM(B.FAULTY_CNT),0) SHIP_FAULTY_CNT
									,GOODS_CD
									,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM  WHERE GOODS_CD = E.GOODS_CD) GOODS_NM
									,EQUIP_CD
									,(SELECT EQUIP_NM FROM TB_EQUIP_CODE_ADM  WHERE EQUIP_CD = E.EQUIP_CD) EQUIP_NM
									,B.DAY_NIGHT_CD GUBUN
								FROM TB_SHIP_INSPECT_ADM B, TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X
								WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
								AND E.WORK_ORD_NO = X.WORK_ORD_NO			
								AND RE_INSP_STATUS != '002'
								GROUP BY GOODS_CD,EQUIP_CD,B.DAY_NIGHT_CD
								) HH
		
							ON A.EQUIP_CD = HH.EQUIP_CD
							AND A.DAY_NIGHT_CD = HH.GUBUN
							--AND B.GOODS_CD = HH.GOODS_CD
		
							LEFT OUTER JOIN
		
								(	SELECT 
									
										 ISNULL(SUM(B.FAULTY_CNT),0) RE_SHIP_FAULTY_CNT
										,GOODS_CD
										,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM  WHERE GOODS_CD = E.GOODS_CD) GOODS_NM
										,EQUIP_CD
										,(SELECT EQUIP_NM FROM TB_EQUIP_CODE_ADM  WHERE EQUIP_CD = E.EQUIP_CD) EQUIP_NM
										,B.DAY_NIGHT_CD GUBUN
										FROM TB_SHIP_INSPECT_ADM B,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X
										WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
										AND E.WORK_ORD_NO = X.WORK_ORD_NO										
										AND RE_INSP_STATUS = '002'
										GROUP BY GOODS_CD,EQUIP_CD,B.DAY_NIGHT_CD
								) II
		
							ON A.EQUIP_CD = II.EQUIP_CD
							AND A.DAY_NIGHT_CD = II.GUBUN
							--AND B.GOODS_CD = II.GOODS_CD
										
							LEFT OUTER JOIN
								(	SELECT
										TT.GOODS_CD
										, TT.EQUIP_CD
										, TT.DAY_NIGHT_CD
										, ISNULL(TT.[001], 0) PRCS_CNT
										, ISNULL(TT.[002], 0) MATRL_CNT
										, ISNULL(TT.[003], 0) RPC_CNT
										, ISNULL(TT.[004], 0) TRB_CNT
										
										, ISNULL(TT.[005], 0) CNT_5
										, ISNULL(TT.[006], 0) CNT_6
										, ISNULL(TT.[007], 0) CNT_7
									FROM (
											SELECT
												C.GOODS_CD
												, D.EQUIP_CD
												, A.DAY_NIGHT_CD
												, COUNT(FAULTY) PRCS_CNT 
												, A.GUBUN
											FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X, TB_GOODS_CODE_ADM C, TB_EQUIP_CODE_ADM D
											WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
											AND A.WORK_ORD_NO = X.WORK_ORD_NO									
											AND B.GOODS_CD = C.GOODS_CD
											AND B.EQUIP_CD = D.EQUIP_CD
											AND D.USE_YN_CD = '001'
										
											GROUP BY C.GOODS_CD, D.EQUIP_CD, A.DAY_NIGHT_CD, A.GUBUN
										) AS t
									PIVOT (
										SUM(t.PRCS_CNT)
										FOR t.GUBUN IN ([001], [002], [003], [004], [005], [006], [007])
									) AS TT
								) E
							ON A.EQUIP_CD = E.EQUIP_CD
							AND A.DAY_NIGHT_CD = E.DAY_NIGHT_CD
							AND B.GOODS_CD = E.GOODS_CD
			
							LEFT OUTER JOIN
								(	SELECT
											TT.GOODS_CD
											, TT.EQUIP_CD
											, TT.DAY_NIGHT_CD
											, ISNULL(TT.[001], 0) PRCS_TOTAL
											, ISNULL(TT.[002], 0) MATRL_TOTAL
											, ISNULL(TT.[003], 0) RPC_TOTAL
											, ISNULL(TT.[004], 0) TRB_TOTAL
											
											, ISNULL(TT.[005], 0) TOTAL_5
											, ISNULL(TT.[006], 0) TOTAL_6
											, ISNULL(TT.[007], 0) TOTAL_7
										FROM (
											SELECT
												C.GOODS_CD
												, D.EQUIP_CD
												, A.DAY_NIGHT_CD
												, SUM(A.FAULTY) FAULTY
												, A.GUBUN
											FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X, TB_GOODS_CODE_ADM C, TB_EQUIP_CODE_ADM D
											WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
											AND B.GOODS_CD = C.GOODS_CD
											AND B.EQUIP_CD = D.EQUIP_CD
											AND A.WORK_ORD_NO = X.WORK_ORD_NO
											GROUP BY C.GOODS_CD
												, D.EQUIP_CD
												, A.DAY_NIGHT_CD
												, A.GUBUN
										) AS t 
									PIVOT (
										SUM(t.FAULTY)
										FOR t.GUBUN IN ([001], [002], [003], [004], [005], [006], [007]) 
									) AS TT
								) F
							ON A.EQUIP_CD = F.EQUIP_CD
							AND A.DAY_NIGHT_CD = F.DAY_NIGHT_CD
							AND B.GOODS_CD = F.GOODS_CD
			
							LEFT JOIN
								TB_GOODS_CODE_ADM AS C
							ON B.GOODS_CD = C.GOODS_CD
							LEFT JOIN
								TB_MATRL_CODE_ADM AS D
							ON C.ALNICU_MATRL_CD = D.MATRL_CD
						)
						WHERE 1=1
						AND A.USE_YN_CD = '001'
						AND A.ETC1 = ''
						--AND C.GOODS_CD IS NOT NULL
					) AA
						
					FULL OUTER JOIN
					
					(
						SELECT
							A.ETC1
							, A.DAY_NIGHT_CD
							, C.GOODS_CD
							, C.GOODS_NM
							, C.GRAVITY
							, C.MODEL
							, D.QUTY_CD
							, B.SUM_TARGET_CNT
							, SUM(B.SUM_OUTPUT_CNT) SUM_OUTPUT_CNT
							
							, ISNULL( SUM(E.PRCS_CNT), 0) PRCS_CNT
							, ISNULL( SUM(E.MATRL_CNT), 0) MATRL_CNT
							, ISNULL( SUM(E.RPC_CNT), 0) RPC_CNT
							, ISNULL( SUM(E.TRB_CNT), 0) TRB_CNT
							
							, ISNULL( SUM(E.CNT_5), 0) CNT_5
							, ISNULL( SUM(E.CNT_6), 0) CNT_6
							, ISNULL( SUM(E.CNT_7), 0) CNT_7
				
							, ISNULL( SUM(F.PRCS_TOTAL), 0) PRCS_TOTAL
							, ISNULL( SUM(F.MATRL_TOTAL), 0) MATRL_TOTAL
							, ISNULL( SUM(F.RPC_TOTAL), 0) RPC_TOTAL
							, ISNULL( SUM(F.TRB_TOTAL), 0) TRB_TOTAL
							
							, ISNULL( SUM(F.TOTAL_5), 0) TOTAL_5
							, ISNULL( SUM(F.TOTAL_6), 0) TOTAL_6
							, ISNULL( SUM(F.TOTAL_7), 0) TOTAL_7
				
							, ISNULL(CAST( SUM(F.PRCS_TOTAL) / C.GRAVITY * 1000 AS FLOAT ), 0) PRCS_EA
							, ISNULL(CAST( SUM(F.MATRL_TOTAL) / C.GRAVITY * 1000 AS FLOAT ), 0) MATRL_EA
							, ISNULL(CAST( SUM(F.RPC_TOTAL)	/ C.GRAVITY * 1000 AS FLOAT ), 0) RPC_EA
							, ISNULL(CAST( SUM(F.TRB_TOTAL)	/ C.GRAVITY * 1000 AS FLOAT ), 0) TRB_EA
							
							, ISNULL(CAST( SUM(F.TOTAL_5)	/ C.GRAVITY * 1000 AS FLOAT ), 0) EA_5
							, ISNULL(CAST( SUM(F.TOTAL_6)	/ C.GRAVITY * 1000 AS FLOAT ), 0) EA_6
							, ISNULL(CAST( SUM(F.TOTAL_7)	/ C.GRAVITY * 1000 AS FLOAT ), 0) EA_7
							
							, ISNULL(SUM(FF.APPEAR_FAULTY_CNT),0) APPEAR_FAULTY_CNT  
							, ISNULL(SUM(GG.EDGE_FAULTY_CNT),0) EDGE_FAULTY_CNT
							, ISNULL(SUM(HH.SHIP_FAULTY_CNT),0) SHIP_FAULTY_CNT 
							, ISNULL(SUM(II.RE_SHIP_FAULTY_CNT),0) RE_SHIP_FAULTY_CNT 
							, ISNULL(SUM(FF.APPEAR_FAULTY_CNT),0)   
							+ ISNULL(SUM(GG.EDGE_FAULTY_CNT),0) 
							+ ISNULL(SUM(HH.SHIP_FAULTY_CNT),0)  
							+ ISNULL(SUM(II.RE_SHIP_FAULTY_CNT),0) OUTPUT_FAULTY_CNT 
						FROM (
								(
									SELECT
										B.EQUIP_CD
										, B.EQUIP_NM
										, B.ETC1
										, AA.DAY_NIGHT_CD
									FROM TB_EQUIP_CODE_ADM B									
									LEFT OUTER JOIN
										TB_EQUIP_CODE_ADM D
									ON 1=1
									AND B.EQUIP_NM = D.ETC1
									FULL OUTER JOIN
										(	
											SELECT 'D' DAY_NIGHT_CD
											UNION
											SELECT 'N' DAY_NIGHT_CD
										) AA
									ON 1=1
									WHERE 1=1
									AND B.USE_YN_CD = '001'
									AND B.ETC1 != ''
									GROUP BY
										B.EQUIP_CD
										, B.EQUIP_NM
										, B.ETC1
										, AA.DAY_NIGHT_CD
								) A
								
									LEFT OUTER JOIN
									(
										SELECT
											A.EQUIP_CD
											, A.GOODS_CD
											, B.GUBUN
											, A.TARGET_CNT AS SUM_TARGET_CNT
											, SUM(B.SUM_OUTPUT_CNT) SUM_OUTPUT_CNT
										FROM TB_WORK_ORDER A
											, (	SELECT
													MAX(A.WORK_ORD_NO) AS WORK_ORD_NO
													, A.GUBUN
													, SUM(A.OUTPUT_CNT + A.VISION_EDGE_CNT) SUM_OUTPUT_CNT
													, B.EQUIP_CD
													, B.GOODS_CD
												FROM TB_WORK_ORDER_OUTPUT_SUB A, TB_WORK_ORDER B, TB_EQUIP_CODE_ADM C
												WHERE 1=1
												AND A.WORK_ORD_NO = B.WORK_ORD_NO
												AND B.EQUIP_CD = C.EQUIP_CD
												AND C.ETC1 != ''
												AND WORK_ORD_DATE >= #{chooseDate1}
												AND WORK_ORD_DATE <= #{chooseDate2}
							
												GROUP BY
													 A.GUBUN
													, B.EQUIP_CD
													, B.GOODS_CD
											) B
										WHERE 1=1
										AND A.WORK_ORD_NO = B.WORK_ORD_NO
										GROUP BY
											A.EQUIP_CD
											, A.GOODS_CD
											, B.GUBUN
											, A.TARGET_CNT
									) B
								ON 1=1
								AND A.EQUIP_CD = B.EQUIP_CD
								AND A.DAY_NIGHT_CD = B.GUBUN
								
								LEFT OUTER JOIN
		
								(	SELECT 
								
									 ISNULL(SUM(FAULTY_CNT),0) APPEAR_FAULTY_CNT
									,GOODS_CD
									,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM  WHERE GOODS_CD = E.GOODS_CD) GOODS_NM
									,EQUIP_CD
									,(SELECT EQUIP_NM FROM TB_EQUIP_CODE_ADM  WHERE EQUIP_CD = E.EQUIP_CD) EQUIP_NM
									,B.DAY_NIGHT_CD GUBUN
								FROM TB_GOODS_FAULTY_ADM_CODE B,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X
								WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
								AND E.WORK_ORD_NO = X.WORK_ORD_NO
								GROUP BY GOODS_CD,EQUIP_CD,B.DAY_NIGHT_CD
								) FF
		
							ON A.EQUIP_CD = FF.EQUIP_CD
							AND A.DAY_NIGHT_CD = FF.GUBUN
							--AND B.GOODS_CD = FF.GOODS_CD
		
							LEFT OUTER JOIN
		
								(	SELECT 						
									 ISNULL(SUM(FAULTY_CNT),0) EDGE_FAULTY_CNT
									,GOODS_CD
									,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM  WHERE GOODS_CD = E.GOODS_CD) GOODS_NM
									,EQUIP_CD
									,(SELECT EQUIP_NM FROM TB_EQUIP_CODE_ADM  WHERE EQUIP_CD = E.EQUIP_CD) EQUIP_NM
									,B.DAY_NIGHT_CD GUBUN
								FROM TB_EDGE_GOODS_FAULTY_ADM_CODE B,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X
								WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
								AND E.WORK_ORD_NO = X.WORK_ORD_NO
								GROUP BY GOODS_CD,EQUIP_CD,B.DAY_NIGHT_CD
								) GG
		
							ON A.EQUIP_CD = GG.EQUIP_CD
							AND A.DAY_NIGHT_CD = GG.GUBUN
							--AND B.GOODS_CD = GG.GOODS_CD
		
							LEFT OUTER JOIN
		
								(	SELECT 
									
									 ISNULL(SUM(B.FAULTY_CNT),0) SHIP_FAULTY_CNT
									,GOODS_CD
									,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM  WHERE GOODS_CD = E.GOODS_CD) GOODS_NM
									,EQUIP_CD
									,(SELECT EQUIP_NM FROM TB_EQUIP_CODE_ADM  WHERE EQUIP_CD = E.EQUIP_CD) EQUIP_NM
									,B.DAY_NIGHT_CD GUBUN
								FROM TB_SHIP_INSPECT_ADM B,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X
								WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
								AND E.WORK_ORD_NO = X.WORK_ORD_NO						
								AND RE_INSP_STATUS != '002'
								GROUP BY GOODS_CD,EQUIP_CD,B.DAY_NIGHT_CD
								) HH
		
							ON A.EQUIP_CD = HH.EQUIP_CD
							AND A.DAY_NIGHT_CD = HH.GUBUN
							--AND B.GOODS_CD = HH.GOODS_CD
		
							LEFT OUTER JOIN
		
								(	SELECT 
									
										 ISNULL(SUM(B.FAULTY_CNT),0) RE_SHIP_FAULTY_CNT
										,GOODS_CD
										,(SELECT GOODS_NM FROM TB_GOODS_CODE_ADM  WHERE GOODS_CD = E.GOODS_CD) GOODS_NM
										,EQUIP_CD
										,(SELECT EQUIP_NM FROM TB_EQUIP_CODE_ADM  WHERE EQUIP_CD = E.EQUIP_CD) EQUIP_NM
										,B.DAY_NIGHT_CD GUBUN
										FROM TB_SHIP_INSPECT_ADM B,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X
										WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
										AND E.WORK_ORD_NO = X.WORK_ORD_NO							
										AND RE_INSP_STATUS = '002'
										GROUP BY GOODS_CD,EQUIP_CD,B.DAY_NIGHT_CD
								) II
		
							ON A.EQUIP_CD = II.EQUIP_CD
							AND A.DAY_NIGHT_CD = II.GUBUN
							--AND B.GOODS_CD = II.GOODS_CD
							
				
								LEFT OUTER JOIN
									(
										SELECT
											TT.GOODS_CD
											, TT.EQUIP_CD
											, TT.DAY_NIGHT_CD
											, ISNULL(TT.[001], 0) PRCS_CNT
											, ISNULL(TT.[002], 0) MATRL_CNT
											, ISNULL(TT.[003], 0) RPC_CNT
											, ISNULL(TT.[004], 0) TRB_CNT
											
											, ISNULL(TT.[005], 0) CNT_5
											, ISNULL(TT.[006], 0) CNT_6
											, ISNULL(TT.[007], 0) CNT_7
										
										FROM (
											SELECT
												C.GOODS_CD
												, D.EQUIP_CD
												, A.DAY_NIGHT_CD
												, COUNT(FAULTY) PRCS_CNT 
												, A.GUBUN
											FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B, TB_GOODS_CODE_ADM C,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X, TB_EQUIP_CODE_ADM D
											WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
											AND B.GOODS_CD = C.GOODS_CD
											AND B.EQUIP_CD = D.EQUIP_CD
											AND D.USE_YN_CD = '001'
											AND X.WORK_ORD_NO = A.WORK_ORD_NO
											AND D.ETC1 != ''
											GROUP BY
												C.GOODS_CD
												, D.EQUIP_CD
												, A.DAY_NIGHT_CD
												, A.GUBUN
										) AS t
										PIVOT (
											SUM(t.PRCS_CNT)
											FOR t.GUBUN IN ([001], [002], [003], [004], [005], [006], [007])
										) AS TT
									) E
								ON A.EQUIP_CD = E.EQUIP_CD
								AND A.DAY_NIGHT_CD = E.DAY_NIGHT_CD
								AND B.GOODS_CD = E.GOODS_CD
				
								LEFT OUTER JOIN
									(	
										SELECT
											TT.GOODS_CD
											, TT.EQUIP_CD
											, TT.DAY_NIGHT_CD
											, ISNULL(TT.[001], 0) PRCS_TOTAL
											, ISNULL(TT.[002], 0) MATRL_TOTAL
											, ISNULL(TT.[003], 0) RPC_TOTAL
											, ISNULL(TT.[004], 0) TRB_TOTAL
											
											, ISNULL(TT.[005], 0) TOTAL_5
											, ISNULL(TT.[006], 0) TOTAL_6
											, ISNULL(TT.[007], 0) TOTAL_7
											
										FROM (
											SELECT
												C.GOODS_CD
												, D.EQUIP_CD
												, A.DAY_NIGHT_CD
												, SUM(A.FAULTY) FAULTY
												, A.GUBUN
											FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B, TB_GOODS_CODE_ADM C,(SELECT DISTINCT WORK_ORD_NO FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2}) X, TB_EQUIP_CODE_ADM D
											WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
											AND B.GOODS_CD = C.GOODS_CD
											AND B.EQUIP_CD = D.EQUIP_CD
											AND X.WORK_ORD_NO = A.WORK_ORD_NO
											AND D.ETC1 != ''
											GROUP BY C.GOODS_CD
												, D.EQUIP_CD
												, A.DAY_NIGHT_CD
												, A.GUBUN
										) AS t 
										PIVOT (
											SUM(t.FAULTY)
											FOR t.GUBUN IN ([001], [002], [003], [004], [005], [006], [007]) 
										) AS TT
									) F
								ON A.EQUIP_CD = F.EQUIP_CD
								AND A.DAY_NIGHT_CD = F.DAY_NIGHT_CD
								AND B.GOODS_CD = F.GOODS_CD
				
								LEFT JOIN
									TB_GOODS_CODE_ADM AS C
								ON B.GOODS_CD = C.GOODS_CD
								LEFT JOIN
									TB_MATRL_CODE_ADM AS D
								ON C.ALNICU_MATRL_CD = D.MATRL_CD
							)
							
						WHERE 1=1
						AND C.GOODS_CD IS NOT NULL
							
						GROUP BY
							 A.ETC1
							, A.DAY_NIGHT_CD
							, C.GOODS_CD
							, C.GOODS_NM
							, C.GRAVITY
							, C.MODEL
							, D.QUTY_CD
							, B.SUM_TARGET_CNT
					) BB
					
					ON 1=1
					AND AA.EQUIP_NM = BB.ETC1
					AND AA.DAY_NIGHT_CD = BB.DAY_NIGHT_CD
					AND AA.GOODS_CD = BB.GOODS_CD
				) CC
				ON 1=1
				AND CC.EQUIP_CD =  DD.EQUIP_CD
				AND CC.DAY_NIGHT_CD =  DD.DAY_NIGHT_CD
				, ( SELECT ETC1 FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD = '117' AND BASE_CD = '001' ) AS BASKET_WEIGHT
			
				ORDER BY DAY_NIGHT_CD, EQUIP_NM ASC
		]]>
	</select>
	
	
	
	
	<!-- 생산실적 직원별(불량내역전체 포함) -->
	<select id="readActualOutputPeopolesList" resultMap="FaultyHistoryVo">
		<!-- 
			SELECT
				CC.MAIN_WORK_CHARGR
				, EE.USER_NM
				, EE.TEAM_CD
				, DD.GOODS_CD
				, DD.GOODS_NM
				, DD.GRAVITY
				, DD.MODEL
				, FF.QUTY_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = FF.QUTY_CD) QUTY_NM
				, ISNULL(CC.SUM_TARGET_CNT, 0) SUM_TARGET_CNT
				, ISNULL(CC.SUM_OUTPUT_CNT, 0) SUM_OUTPUT_CNT
				, ISNULL(BB.PRCS_CNT, 0) PRCS_CNT
				, ISNULL(BB.MATRL_CNT, 0) MATRL_CNT
				, ISNULL(BB.RPC_CNT, 0) RPC_CNT
				, ISNULL(BB.TRB_CNT, 0) TRB_CNT
				, ISNULL(AA.PRCS_TOTAL, 0) PRCS_TOTAL
				, ISNULL(AA.MATRL_TOTAL, 0) MATRL_TOTAL
				, ISNULL(AA.RPC_TOTAL, 0) RPC_TOTAL
				, ISNULL(AA.TRB_TOTAL, 0) TRB_TOTAL
				
				, ISNULL( CAST( CAST(AA.PRCS_TOTAL AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS INT), 0 ) AS PRCS_EA
				, ISNULL( CAST( CAST(AA.MATRL_TOTAL AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS INT), 0 ) AS MATRL_EA
				, ISNULL( CAST( CAST(AA.RPC_TOTAL AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS INT), 0 ) AS RPC_EA
				, ISNULL( CAST( CAST(AA.TRB_TOTAL AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS INT), 0 ) AS TRB_EA
				
				, ISNULL(GG.APPEAR_FAULTY_CNT,0) APPEAR_FAULTY_CNT  
				, ISNULL(HH.EDGE_FAULTY_CNT,0) EDGE_FAULTY_CNT
				, ISNULL(II.SHIP_FAULTY_CNT,0) SHIP_FAULTY_CNT 
				, ISNULL(JJ.RE_SHIP_FAULTY_CNT,0) RE_SHIP_FAULTY_CNT 
				, ISNULL(GG.APPEAR_FAULTY_CNT,0) + ISNULL(HH.EDGE_FAULTY_CNT,0) + ISNULL(II.SHIP_FAULTY_CNT,0) + ISNULL(JJ.RE_SHIP_FAULTY_CNT,0) OUTPUT_FAULTY_CNT
			FROM
				(SELECT
					A.GOODS_CD
					, A.MAIN_WORK_CHARGR
					, SUM(A.TARGET_CNT) SUM_TARGET_CNT
					, SUM(A.SUM_OUTPUT_CNT) SUM_OUTPUT_CNT
				FROM (SELECT
						B.GOODS_CD
						, B.TARGET_CNT
						, A.WORK_ORD_NO
						, A.MAIN_WORK_CHARGR
						, SUM(A.OUTPUT_CNT + A.VISION_EDGE_CNT) SUM_OUTPUT_CNT
					FROM TB_WORK_ORDER_OUTPUT_SUB A, TB_WORK_ORDER B
					WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
					AND WORK_ORD_DATE >= #{chooseDate1}
					AND WORK_ORD_DATE <= #{chooseDate2}
		
					AND A.MAIN_WORK_CHARGR = #{userNumber}
		
					GROUP BY B.GOODS_CD, B.TARGET_CNT, A.WORK_ORD_NO, A.MAIN_WORK_CHARGR) A
				GROUP BY A.GOODS_CD, A.MAIN_WORK_CHARGR) CC 
				
				LEFT JOIN

				(	SELECT
						B.MAIN_WORK_CHARGR			
						,A.GOODS_CD					
						, SUM(B.APPEAR_FAULTY_CNT) APPEAR_FAULTY_CNT					
					FROM TB_WORK_ORDER A
						, (SELECT
							WORK_ORD_NO
							,MAIN_WORK_CHARGR
							, SUM(APPEAR_FAULTY_CNT) APPEAR_FAULTY_CNT					
							FROM TB_WORK_ORDER_OUTPUT_SUB
							WHERE APPEAR_INSPCT_DATE >= #{chooseDate1}
							AND APPEAR_INSPCT_DATE <= #{chooseDate2}
							GROUP BY WORK_ORD_NO,MAIN_WORK_CHARGR) B
					WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
					GROUP BY B.MAIN_WORK_CHARGR,GOODS_CD
				) GG				
				ON CC.GOODS_CD = GG.GOODS_CD 
				AND CC.MAIN_WORK_CHARGR = GG.MAIN_WORK_CHARGR

				 LEFT JOIN
				(	SELECT
						B.MAIN_WORK_CHARGR			
						,A.GOODS_CD					
						, SUM(B.EDGE_FAULTY_CNT) EDGE_FAULTY_CNT					
					FROM TB_WORK_ORDER A
						, (SELECT
							WORK_ORD_NO
							,MAIN_WORK_CHARGR
							, SUM(EDGE_FAULTY_CNT) EDGE_FAULTY_CNT					
							FROM TB_WORK_ORDER_OUTPUT_SUB
							WHERE APPEAR_INSPCT_DATE >= #{chooseDate1}
							AND APPEAR_INSPCT_DATE <= #{chooseDate2}
							GROUP BY WORK_ORD_NO,MAIN_WORK_CHARGR) B
					WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
					GROUP BY B.MAIN_WORK_CHARGR,GOODS_CD
				) HH				
				ON CC.GOODS_CD = HH.GOODS_CD 
				AND CC.MAIN_WORK_CHARGR = HH.MAIN_WORK_CHARGR

				 LEFT JOIN
				(	SELECT
						A.GOODS_CD			
						, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT	
						, C.MAIN_WORK_CHARGR

					FROM TB_WORK_ORDER A
						, (SELECT
							WORK_ORD_NO						
							, SUM(FAULTY_CNT) FAULTY_CNT					
							FROM TB_SHIP_INSPECT_ADM
							WHERE INSP_DATE >= #{chooseDate1}
							AND INSP_DATE <= #{chooseDate2}
							AND RE_INSP_STATUS = '001'
							GROUP BY WORK_ORD_NO) B
						,  (SELECT DISTINCT WORK_ORD_NO,MAIN_WORK_CHARGR FROM TB_WORK_ORDER_OUTPUT_SUB) C
					WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
					AND A.WORK_ORD_NO = C.WORK_ORD_NO
					GROUP BY GOODS_CD,C.MAIN_WORK_CHARGR
				) II				
				ON CC.GOODS_CD = II.GOODS_CD 
				AND CC.MAIN_WORK_CHARGR = II.MAIN_WORK_CHARGR

								 LEFT JOIN
				(	SELECT
						A.GOODS_CD			
						, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT	
						, C.MAIN_WORK_CHARGR
					FROM TB_WORK_ORDER A
						, (SELECT
							WORK_ORD_NO						
							, SUM(FAULTY_CNT) FAULTY_CNT					
							FROM TB_SHIP_INSPECT_ADM
							WHERE INSP_DATE >= #{chooseDate1}
							AND INSP_DATE <= #{chooseDate2}
							AND RE_INSP_STATUS = '002'
							GROUP BY WORK_ORD_NO) B
						,  (SELECT DISTINCT WORK_ORD_NO,MAIN_WORK_CHARGR FROM TB_WORK_ORDER_OUTPUT_SUB) C
					WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
					AND A.WORK_ORD_NO = C.WORK_ORD_NO
					GROUP BY GOODS_CD,C.MAIN_WORK_CHARGR
				) JJ				
				ON CC.GOODS_CD = JJ.GOODS_CD 
				AND CC.MAIN_WORK_CHARGR = JJ.MAIN_WORK_CHARGR
				
				LEFT JOIN
				
				(SELECT
					TT.GOODS_CD
					, TT.USER_NUMBER
					, ISNULL(TT.[001], 0) PRCS_TOTAL
					, ISNULL(TT.[002], 0) MATRL_TOTAL
					, ISNULL(TT.[003], 0) RPC_TOTAL
					, ISNULL(TT.[004], 0) TRB_TOTAL
				FROM (
					SELECT
						C.GOODS_CD
						, D.USER_NUMBER
						, SUM(A.FAULTY) FAULTY
						, A.GUBUN
					FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B, TB_GOODS_CODE_ADM C, TB_USER D
					WHERE A.FAULTY_REG_DATE >= #{chooseDate1}
					AND A.FAULTY_REG_DATE <= #{chooseDate2}
					AND A.WORK_ORD_NO = B.WORK_ORD_NO
					AND B.GOODS_CD = C.GOODS_CD
					AND A.REG_ID = D.USER_ID
					GROUP BY C.GOODS_CD, A.GUBUN, D.USER_NUMBER
				) AS t PIVOT (SUM(t.FAULTY) FOR t.GUBUN IN ([001], [002], [003], [004])) AS TT) AA ON AA.GOODS_CD = CC.GOODS_CD AND AA.USER_NUMBER = CC.MAIN_WORK_CHARGR
				LEFT JOIN
				(SELECT
					TT.GOODS_CD
					, TT.USER_NUMBER
					, ISNULL(TT.[001], 0) PRCS_CNT
					, ISNULL(TT.[002], 0) MATRL_CNT
					, ISNULL(TT.[003], 0) RPC_CNT
					, ISNULL(TT.[004], 0) TRB_CNT
				FROM (
					SELECT
						C.GOODS_CD
						, A.GUBUN
						, D.USER_NUMBER
						, COUNT(FAULTY) PRCS_CNT 
					FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B, TB_GOODS_CODE_ADM C, TB_USER D
					WHERE A.FAULTY_REG_DATE >= #{chooseDate1}
					AND A.FAULTY_REG_DATE <= #{chooseDate2}
					AND A.WORK_ORD_NO = B.WORK_ORD_NO
					AND B.GOODS_CD = C.GOODS_CD
					AND A.REG_ID = D.USER_ID
					GROUP BY C.GOODS_CD, A.GUBUN, D.USER_NUMBER
				) AS t PIVOT ( SUM(t.PRCS_CNT) FOR t.GUBUN IN ([001], [002], [003], [004])) AS TT) BB ON CC.GOODS_CD = BB.GOODS_CD AND BB.USER_NUMBER = CC.MAIN_WORK_CHARGR,
				TB_GOODS_CODE_ADM DD, TB_USER EE, TB_MATRL_CODE_ADM FF
			WHERE CC.GOODS_CD = DD.GOODS_CD
			AND DD.ALNICU_MATRL_CD = FF.MATRL_CD
			AND CC.MAIN_WORK_CHARGR = EE.USER_NUMBER
			ORDER BY EE.USER_NM, DD.GOODS_NM -->
			
		
		<![CDATA[
			SELECT
				CC.MAIN_WORK_CHARGR
				, EE.USER_NM
				, EE.TEAM_CD
				, DD.GOODS_CD
				, DD.GOODS_NM
				, DD.GRAVITY
				, DD.MODEL
				, FF.QUTY_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = FF.QUTY_CD) QUTY_NM
				, ISNULL(CC.SUM_TARGET_CNT, 0) SUM_TARGET_CNT
				, ISNULL(CC.SUM_OUTPUT_CNT, 0) SUM_OUTPUT_CNT
				
				, ISNULL(BB.PRCS_CNT, 0) PRCS_CNT
				, ISNULL(BB.MATRL_CNT, 0) MATRL_CNT
				, ISNULL(BB.RPC_CNT, 0) RPC_CNT
				, ISNULL(BB.TRB_CNT, 0) TRB_CNT
				
				, ISNULL(BB.CNT_5, 0) CNT_5
				, ISNULL(BB.CNT_6, 0) CNT_6
				, ISNULL(BB.CNT_7, 0) CNT_7
				
				, ISNULL(AA.PRCS_TOTAL, 0) PRCS_TOTAL
				, ISNULL(AA.MATRL_TOTAL, 0) MATRL_TOTAL
				, ISNULL(AA.RPC_TOTAL, 0) RPC_TOTAL
				, ISNULL(AA.TRB_TOTAL, 0) TRB_TOTAL
				
				, ISNULL(AA.TOTAL_5, 0) TOTAL_5
				, ISNULL(AA.TOTAL_6, 0) TOTAL_6
				, ISNULL(AA.TOTAL_7, 0) TOTAL_7
				
				, ISNULL( CAST( CAST(AA.PRCS_TOTAL AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS PRCS_EA
				, ISNULL( CAST( CAST(AA.MATRL_TOTAL AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS MATRL_EA
				, ISNULL( CAST( CAST(AA.RPC_TOTAL AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS RPC_EA
				, ISNULL( CAST( CAST(AA.TRB_TOTAL AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS TRB_EA
				
				, ISNULL( CAST( CAST(AA.TOTAL_5 AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS EA_5
				, ISNULL( CAST( CAST(AA.TOTAL_6 AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS EA_6
				, ISNULL( CAST( CAST(AA.TOTAL_7 AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS EA_7
				
				, ISNULL(GG.APPEAR_FAULTY_CNT,0) APPEAR_FAULTY_CNT  
				, ISNULL(HH.EDGE_FAULTY_CNT,0) EDGE_FAULTY_CNT
				, ISNULL(II.SHIP_FAULTY_CNT,0) SHIP_FAULTY_CNT 
				, ISNULL(JJ.RE_SHIP_FAULTY_CNT,0) RE_SHIP_FAULTY_CNT 
				, ISNULL(GG.APPEAR_FAULTY_CNT,0) + ISNULL(HH.EDGE_FAULTY_CNT,0) + ISNULL(II.SHIP_FAULTY_CNT,0) + ISNULL(JJ.RE_SHIP_FAULTY_CNT,0) OUTPUT_FAULTY_CNT
			FROM
				(SELECT
					A.GOODS_CD
					, A.MAIN_WORK_CHARGR
					, SUM(A.TARGET_CNT) SUM_TARGET_CNT
					, SUM(A.SUM_OUTPUT_CNT) SUM_OUTPUT_CNT
				FROM (SELECT
						B.GOODS_CD
						, B.TARGET_CNT
						, A.WORK_ORD_NO
						, A.MAIN_WORK_CHARGR
						, SUM(A.OUTPUT_CNT + A.VISION_EDGE_CNT) SUM_OUTPUT_CNT
					FROM TB_WORK_ORDER_OUTPUT_SUB A, TB_WORK_ORDER B
					WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
					AND WORK_ORD_DATE >= #{chooseDate1}
					AND WORK_ORD_DATE <= #{chooseDate2}
					]]>
					<if test="userNumber != null and userNumber != ''"> 
						AND A.MAIN_WORK_CHARGR = #{userNumber}
					</if>
			<![CDATA[
						GROUP BY B.GOODS_CD, B.TARGET_CNT, A.WORK_ORD_NO, A.MAIN_WORK_CHARGR) A
				GROUP BY A.GOODS_CD, A.MAIN_WORK_CHARGR) CC 
				
				LEFT OUTER JOIN

				(	SELECT 

						ISNULL(SUM(FAULTY_CNT),0) APPEAR_FAULTY_CNT
						,GOODS_CD
						,X.MAIN_WORK_CHARGR
						FROM TB_GOODS_FAULTY_ADM_CODE B,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO, MAX(MAIN_WORK_CHARGR) MAIN_WORK_CHARGR FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2} GROUP BY WORK_ORD_NO) X
						WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
						AND E.WORK_ORD_NO = X.WORK_ORD_NO
						GROUP BY GOODS_CD,X.MAIN_WORK_CHARGR
				) GG				
				ON CC.GOODS_CD = GG.GOODS_CD 
				AND CC.MAIN_WORK_CHARGR = GG.MAIN_WORK_CHARGR

				 LEFT OUTER JOIN
				(	SELECT 

						ISNULL(SUM(FAULTY_CNT),0) EDGE_FAULTY_CNT
						,GOODS_CD
						,X.MAIN_WORK_CHARGR
						FROM TB_EDGE_GOODS_FAULTY_ADM_CODE B,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO, MAX(MAIN_WORK_CHARGR) MAIN_WORK_CHARGR FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2} GROUP BY WORK_ORD_NO) X
						WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
						AND E.WORK_ORD_NO = X.WORK_ORD_NO
						GROUP BY GOODS_CD,X.MAIN_WORK_CHARGR
				) HH				
				ON CC.GOODS_CD = HH.GOODS_CD 
				AND CC.MAIN_WORK_CHARGR = HH.MAIN_WORK_CHARGR

				 LEFT OUTER JOIN
				(	SELECT 							
					ISNULL(SUM(A.FAULTY_CNT),0) SHIP_FAULTY_CNT
					,GOODS_CD				
					,X.MAIN_WORK_CHARGR					
					FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO, MAX(MAIN_WORK_CHARGR) MAIN_WORK_CHARGR FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2} GROUP BY WORK_ORD_NO) X
					WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
					AND E.WORK_ORD_NO = X.WORK_ORD_NO
					AND A.SHIP_INSP_IDX = B.IDX
					AND RE_INSP_STATUS != '002'
					GROUP BY GOODS_CD,X.MAIN_WORK_CHARGR
				) II				
				ON CC.GOODS_CD = II.GOODS_CD 
				AND CC.MAIN_WORK_CHARGR = II.MAIN_WORK_CHARGR

								 LEFT OUTER JOIN
				(	SELECT 							
					ISNULL(SUM(A.FAULTY_CNT),0) RE_SHIP_FAULTY_CNT
					,GOODS_CD				
					,X.MAIN_WORK_CHARGR					
					FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO, MAX(MAIN_WORK_CHARGR) MAIN_WORK_CHARGR FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2} GROUP BY WORK_ORD_NO) X
					WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
					AND E.WORK_ORD_NO = X.WORK_ORD_NO
					AND A.SHIP_INSP_IDX = B.IDX
					AND RE_INSP_STATUS = '002'
					GROUP BY GOODS_CD,X.MAIN_WORK_CHARGR
				) JJ				
				ON CC.GOODS_CD = JJ.GOODS_CD 
				AND CC.MAIN_WORK_CHARGR = JJ.MAIN_WORK_CHARGR
				
				LEFT OUTER JOIN
				
				(SELECT
					TT.GOODS_CD
					, TT.MAIN_WORK_CHARGR USER_NUMBER
					, ISNULL(TT.[001], 0) PRCS_TOTAL
					, ISNULL(TT.[002], 0) MATRL_TOTAL
					, ISNULL(TT.[003], 0) RPC_TOTAL
					, ISNULL(TT.[004], 0) TRB_TOTAL
					
					, ISNULL(TT.[005], 0) TOTAL_5
					, ISNULL(TT.[006], 0) TOTAL_6
					, ISNULL(TT.[007], 0) TOTAL_7
				FROM (
					SELECT
						C.GOODS_CD
						, X.MAIN_WORK_CHARGR
						, SUM(A.FAULTY) FAULTY
						, A.GUBUN
					FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B, TB_GOODS_CODE_ADM C, (SELECT DISTINCT WORK_ORD_NO, MAX(MAIN_WORK_CHARGR) MAIN_WORK_CHARGR FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2} GROUP BY WORK_ORD_NO) X
					WHERE X.WORK_ORD_NO = A.WORK_ORD_NO
					AND A.WORK_ORD_NO = B.WORK_ORD_NO
					AND B.GOODS_CD = C.GOODS_CD
				
					GROUP BY C.GOODS_CD, X.MAIN_WORK_CHARGR,GUBUN
				) AS t PIVOT (SUM(t.FAULTY) FOR t.GUBUN IN ([001], [002], [003], [004], [005], [006], [007])) AS TT) AA 
				ON AA.GOODS_CD = CC.GOODS_CD 
				AND AA.USER_NUMBER = CC.MAIN_WORK_CHARGR
				LEFT OUTER JOIN
				(SELECT
					TT.GOODS_CD
					, TT.MAIN_WORK_CHARGR USER_NUMBER
					, ISNULL(TT.[001], 0) PRCS_CNT
					, ISNULL(TT.[002], 0) MATRL_CNT
					, ISNULL(TT.[003], 0) RPC_CNT
					, ISNULL(TT.[004], 0) TRB_CNT
					
					, ISNULL(TT.[005], 0) CNT_5
					, ISNULL(TT.[006], 0) CNT_6
					, ISNULL(TT.[007], 0) CNT_7
					
				FROM (
					SELECT
						C.GOODS_CD
						, A.GUBUN
						, X.MAIN_WORK_CHARGR
						, COUNT(FAULTY) PRCS_CNT 
					FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B, TB_GOODS_CODE_ADM C, (SELECT DISTINCT WORK_ORD_NO, MAX(MAIN_WORK_CHARGR) MAIN_WORK_CHARGR FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2} GROUP BY WORK_ORD_NO) X
					WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
					AND A.WORK_ORD_NO = B.WORK_ORD_NO
					AND B.GOODS_CD = C.GOODS_CD		
					GROUP BY C.GOODS_CD, A.GUBUN, X.MAIN_WORK_CHARGR
				) AS t PIVOT ( SUM(t.PRCS_CNT) FOR t.GUBUN IN ([001], [002], [003], [004], [005], [006], [007])) AS TT) BB 
				ON CC.GOODS_CD = BB.GOODS_CD 
				AND BB.USER_NUMBER = CC.MAIN_WORK_CHARGR
				
				,TB_GOODS_CODE_ADM DD
				, TB_USER EE
				, TB_MATRL_CODE_ADM FF
			WHERE CC.GOODS_CD = DD.GOODS_CD
			AND DD.ALNICU_MATRL_CD = FF.MATRL_CD
			AND CC.MAIN_WORK_CHARGR = EE.USER_NUMBER
			ORDER BY EE.USER_NM, DD.GOODS_NM
			
			]]>
	</select>
	
	
	
	<!-- 생산실적 직원별(불량내역전체 포함) -->
	<select id="readActualOutputPeopolesList_F3" resultMap="FaultyHistoryVo">
		<![CDATA[
			SELECT
				CC.MAIN_WORK_CHARGR
				, EE.USER_NM
				, EE.TEAM_CD
				, DD.GOODS_CD
				, DD.GOODS_NM
				, DD.GRAVITY
				, DD.MODEL
				, FF.QUTY_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = FF.QUTY_CD) QUTY_NM
				, ISNULL(CC.SUM_TARGET_CNT, 0) SUM_TARGET_CNT
				, ISNULL(CC.SUM_OUTPUT_CNT, 0) SUM_OUTPUT_CNT
				
				, ISNULL(BB.PRCS_CNT, 0) PRCS_CNT
				, ISNULL(BB.MATRL_CNT, 0) MATRL_CNT
				, ISNULL(BB.RPC_CNT, 0) RPC_CNT
				, ISNULL(BB.TRB_CNT, 0) TRB_CNT
				, ISNULL(BB.CNT_5, 0) CNT_5
				, ISNULL(BB.CNT_6, 0) CNT_6
				, ISNULL(BB.CNT_7, 0) CNT_7
				
				--, ISNULL(AA.PRCS_TOTAL, 0) PRCS_TOTAL
				--, ISNULL(AA.MATRL_TOTAL, 0) MATRL_TOTAL
				--, ISNULL(AA.RPC_TOTAL, 0) RPC_TOTAL
				--, ISNULL(AA.TRB_TOTAL, 0) TRB_TOTAL
				--, ISNULL(AA.TOTAL_5, 0) TOTAL_5
				--, ISNULL(AA.TOTAL_6, 0) TOTAL_6
				--, ISNULL(AA.TOTAL_7, 0) TOTAL_7
				
				
				, (CASE WHEN ISNULL(AA.PRCS_TOTAL, 0) = 0 THEN 0 ELSE AA.PRCS_TOTAL - BASKET_WEIGHT.ETC1 END ) PRCS_TOTAL
				, (CASE WHEN ISNULL(AA.MATRL_TOTAL, 0) = 0 THEN 0 ELSE AA.MATRL_TOTAL - BASKET_WEIGHT.ETC1 END ) MATRL_TOTAL
				, (CASE WHEN ISNULL(AA.RPC_TOTAL, 0) = 0 THEN 0 ELSE AA.RPC_TOTAL - BASKET_WEIGHT.ETC1 END ) RPC_TOTAL
				, (CASE WHEN ISNULL(AA.TRB_TOTAL, 0) = 0 THEN 0 ELSE AA.TRB_TOTAL - BASKET_WEIGHT.ETC1 END ) TRB_TOTAL
				, ISNULL(AA.TOTAL_5, 0) TOTAL_5
				, (CASE WHEN ISNULL(AA.TOTAL_6, 0) = 0 THEN 0 ELSE AA.TOTAL_6 - BASKET_WEIGHT.ETC1 END ) TOTAL_6
				, (CASE WHEN ISNULL(AA.TOTAL_7, 0) = 0 THEN 0 ELSE AA.TOTAL_7 - BASKET_WEIGHT.ETC1 END ) TOTAL_7
				
				
				--, ISNULL( CAST( CAST(AA.PRCS_TOTAL AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS PRCS_EA
				--, ISNULL( CAST( CAST(AA.MATRL_TOTAL AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS MATRL_EA
				--, ISNULL( CAST( CAST(AA.RPC_TOTAL AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS RPC_EA
				--, ISNULL( CAST( CAST(AA.TRB_TOTAL AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS TRB_EA
				--, ISNULL( CAST( CAST(AA.TOTAL_5 AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS EA_5
				--, ISNULL( CAST( CAST(AA.TOTAL_6 AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS EA_6
				--, ISNULL( CAST( CAST(AA.TOTAL_7 AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS EA_7
				
				
				, (CASE WHEN ISNULL(AA.PRCS_TOTAL, 0) = 0 THEN 0 ELSE ISNULL( CAST( ( CAST(AA.PRCS_TOTAL AS FLOAT) - BASKET_WEIGHT.ETC1) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) END ) PRCS_EA
				, (CASE WHEN ISNULL(AA.MATRL_TOTAL, 0) = 0 THEN 0 ELSE ISNULL( CAST( ( CAST(AA.MATRL_TOTAL AS FLOAT) - BASKET_WEIGHT.ETC1) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) END ) MATRL_EA
				, (CASE WHEN ISNULL(AA.RPC_TOTAL, 0) = 0 THEN 0 ELSE ISNULL( CAST( ( CAST(AA.RPC_TOTAL AS FLOAT) - BASKET_WEIGHT.ETC1) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) END ) RPC_EA
				, (CASE WHEN ISNULL(AA.TRB_TOTAL, 0) = 0 THEN 0 ELSE ISNULL( CAST( ( CAST(AA.TRB_TOTAL AS FLOAT) - BASKET_WEIGHT.ETC1) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) END ) TRB_EA
				, ISNULL( CAST( CAST(AA.TOTAL_5 AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) AS EA_5
				, (CASE WHEN ISNULL(AA.TOTAL_6, 0) = 0 THEN 0 ELSE ISNULL( CAST( ( CAST(AA.TOTAL_6 AS FLOAT) - BASKET_WEIGHT.ETC1) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) END ) EA_6
				, (CASE WHEN ISNULL(AA.TOTAL_7, 0) = 0 THEN 0 ELSE ISNULL( CAST( ( CAST(AA.TOTAL_7 AS FLOAT) - BASKET_WEIGHT.ETC1) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) END ) EA_7
				
				
				, ISNULL(GG.APPEAR_FAULTY_CNT,0) APPEAR_FAULTY_CNT  
				, ISNULL(HH.EDGE_FAULTY_CNT,0) EDGE_FAULTY_CNT
				, ISNULL(II.SHIP_FAULTY_CNT,0) SHIP_FAULTY_CNT 
				, ISNULL(JJ.RE_SHIP_FAULTY_CNT,0) RE_SHIP_FAULTY_CNT 
				, ISNULL(GG.APPEAR_FAULTY_CNT,0) + ISNULL(HH.EDGE_FAULTY_CNT,0) + ISNULL(II.SHIP_FAULTY_CNT,0) + ISNULL(JJ.RE_SHIP_FAULTY_CNT,0) OUTPUT_FAULTY_CNT
			FROM
				(SELECT
					A.GOODS_CD
					, A.MAIN_WORK_CHARGR
					, SUM(A.TARGET_CNT) SUM_TARGET_CNT
					, SUM(A.SUM_OUTPUT_CNT) SUM_OUTPUT_CNT
				FROM (SELECT
						B.GOODS_CD
						, B.TARGET_CNT
						, A.WORK_ORD_NO
						, A.MAIN_WORK_CHARGR
						, SUM(A.OUTPUT_CNT + A.VISION_EDGE_CNT) SUM_OUTPUT_CNT
					FROM TB_WORK_ORDER_OUTPUT_SUB A, TB_WORK_ORDER B
					WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
					AND WORK_ORD_DATE >= #{chooseDate1}
					AND WORK_ORD_DATE <= #{chooseDate2}
					]]>
					<if test="userNumber != null and userNumber != ''"> 
						AND A.MAIN_WORK_CHARGR = #{userNumber}
					</if>
			<![CDATA[
						GROUP BY B.GOODS_CD, B.TARGET_CNT, A.WORK_ORD_NO, A.MAIN_WORK_CHARGR) A
				GROUP BY A.GOODS_CD, A.MAIN_WORK_CHARGR) CC 
				
				LEFT OUTER JOIN

				(	SELECT 

						ISNULL(SUM(FAULTY_CNT),0) APPEAR_FAULTY_CNT
						,GOODS_CD
						,X.MAIN_WORK_CHARGR
						FROM TB_GOODS_FAULTY_ADM_CODE B,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO, MAX(MAIN_WORK_CHARGR) MAIN_WORK_CHARGR FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2} GROUP BY WORK_ORD_NO) X
						WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
						AND E.WORK_ORD_NO = X.WORK_ORD_NO
						GROUP BY GOODS_CD,X.MAIN_WORK_CHARGR
				) GG				
				ON CC.GOODS_CD = GG.GOODS_CD 
				AND CC.MAIN_WORK_CHARGR = GG.MAIN_WORK_CHARGR

				 LEFT OUTER JOIN
				(	SELECT 

						ISNULL(SUM(FAULTY_CNT),0) EDGE_FAULTY_CNT
						,GOODS_CD
						,X.MAIN_WORK_CHARGR
						FROM TB_EDGE_GOODS_FAULTY_ADM_CODE B,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO, MAX(MAIN_WORK_CHARGR) MAIN_WORK_CHARGR FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2} GROUP BY WORK_ORD_NO) X
						WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
						AND E.WORK_ORD_NO = X.WORK_ORD_NO
						GROUP BY GOODS_CD,X.MAIN_WORK_CHARGR
				) HH				
				ON CC.GOODS_CD = HH.GOODS_CD 
				AND CC.MAIN_WORK_CHARGR = HH.MAIN_WORK_CHARGR

				 LEFT OUTER JOIN
				(	SELECT 							
					ISNULL(SUM(A.FAULTY_CNT),0) SHIP_FAULTY_CNT
					,GOODS_CD				
					,X.MAIN_WORK_CHARGR					
					FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO, MAX(MAIN_WORK_CHARGR) MAIN_WORK_CHARGR FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2} GROUP BY WORK_ORD_NO) X
					WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
					AND E.WORK_ORD_NO = X.WORK_ORD_NO
					AND A.SHIP_INSP_IDX = B.IDX
					AND RE_INSP_STATUS != '002'
					GROUP BY GOODS_CD,X.MAIN_WORK_CHARGR
				) II				
				ON CC.GOODS_CD = II.GOODS_CD 
				AND CC.MAIN_WORK_CHARGR = II.MAIN_WORK_CHARGR

								 LEFT OUTER JOIN
				(	SELECT 							
					ISNULL(SUM(A.FAULTY_CNT),0) RE_SHIP_FAULTY_CNT
					,GOODS_CD				
					,X.MAIN_WORK_CHARGR					
					FROM TB_SHIP_INSPECT_ADM B, TB_SHIP_INSPECT_DTL A,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO, MAX(MAIN_WORK_CHARGR) MAIN_WORK_CHARGR FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2} GROUP BY WORK_ORD_NO) X
					WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
					AND E.WORK_ORD_NO = X.WORK_ORD_NO
					AND A.SHIP_INSP_IDX = B.IDX
					AND RE_INSP_STATUS = '002'
					GROUP BY GOODS_CD,X.MAIN_WORK_CHARGR
				) JJ				
				ON CC.GOODS_CD = JJ.GOODS_CD 
				AND CC.MAIN_WORK_CHARGR = JJ.MAIN_WORK_CHARGR
				
				LEFT OUTER JOIN
				
				(SELECT
					TT.GOODS_CD
					, TT.MAIN_WORK_CHARGR USER_NUMBER
					, ISNULL(TT.[001], 0) PRCS_TOTAL
					, ISNULL(TT.[002], 0) MATRL_TOTAL
					, ISNULL(TT.[003], 0) RPC_TOTAL
					, ISNULL(TT.[004], 0) TRB_TOTAL
					
					, ISNULL(TT.[005], 0) TOTAL_5
					, ISNULL(TT.[006], 0) TOTAL_6
					, ISNULL(TT.[007], 0) TOTAL_7
				FROM (
					SELECT
						C.GOODS_CD
						, X.MAIN_WORK_CHARGR
						, SUM(A.FAULTY) FAULTY
						, A.GUBUN
					FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B, TB_GOODS_CODE_ADM C, (SELECT DISTINCT WORK_ORD_NO, MAX(MAIN_WORK_CHARGR) MAIN_WORK_CHARGR FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2} GROUP BY WORK_ORD_NO) X
					WHERE X.WORK_ORD_NO = A.WORK_ORD_NO
					AND A.WORK_ORD_NO = B.WORK_ORD_NO
					AND B.GOODS_CD = C.GOODS_CD
				
					GROUP BY C.GOODS_CD, X.MAIN_WORK_CHARGR,GUBUN
				) AS t PIVOT (SUM(t.FAULTY) FOR t.GUBUN IN ([001], [002], [003], [004], [005], [006], [007])) AS TT) AA 
				ON AA.GOODS_CD = CC.GOODS_CD 
				AND AA.USER_NUMBER = CC.MAIN_WORK_CHARGR
				LEFT OUTER JOIN
				(SELECT
					TT.GOODS_CD
					, TT.MAIN_WORK_CHARGR USER_NUMBER
					, ISNULL(TT.[001], 0) PRCS_CNT
					, ISNULL(TT.[002], 0) MATRL_CNT
					, ISNULL(TT.[003], 0) RPC_CNT
					, ISNULL(TT.[004], 0) TRB_CNT
					
					, ISNULL(TT.[005], 0) CNT_5
					, ISNULL(TT.[006], 0) CNT_6
					, ISNULL(TT.[007], 0) CNT_7
					
				FROM (
					SELECT
						C.GOODS_CD
						, A.GUBUN
						, X.MAIN_WORK_CHARGR
						, COUNT(FAULTY) PRCS_CNT 
					FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B, TB_GOODS_CODE_ADM C, (SELECT DISTINCT WORK_ORD_NO, MAX(MAIN_WORK_CHARGR) MAIN_WORK_CHARGR FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2} GROUP BY WORK_ORD_NO) X
					WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
					AND A.WORK_ORD_NO = B.WORK_ORD_NO
					AND B.GOODS_CD = C.GOODS_CD		
					GROUP BY C.GOODS_CD, A.GUBUN, X.MAIN_WORK_CHARGR
				) AS t PIVOT ( SUM(t.PRCS_CNT) FOR t.GUBUN IN ([001], [002], [003], [004], [005], [006], [007])) AS TT) BB 
				ON CC.GOODS_CD = BB.GOODS_CD 
				AND BB.USER_NUMBER = CC.MAIN_WORK_CHARGR
				
				,TB_GOODS_CODE_ADM DD
				, TB_USER EE
				, TB_MATRL_CODE_ADM FF
				, ( SELECT ETC1 FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD = '117' AND BASE_CD = '001' ) AS BASKET_WEIGHT
			WHERE CC.GOODS_CD = DD.GOODS_CD
			AND DD.ALNICU_MATRL_CD = FF.MATRL_CD
			AND CC.MAIN_WORK_CHARGR = EE.USER_NUMBER
			ORDER BY EE.USER_NM, DD.GOODS_NM
			
			]]>
	</select>
	
		<!-- 생산실적 일자별(불량내역전체 포함) -->
	<select id="readActualOutputDateList_F3" resultMap="FaultyHistoryVo">
		<![CDATA[
			SELECT		
				DD.DATE	ORD_DATE
				
				, SUM(ISNULL(CC.SUM_TARGET_CNT, 0)) SUM_TARGET_CNT
				, SUM(ISNULL(CC.SUM_OUTPUT_CNT, 0)) SUM_OUTPUT_CNT
				
				, SUM(ISNULL(BB.PRCS_CNT, 0)) PRCS_CNT
				, SUM(ISNULL(BB.MATRL_CNT, 0)) MATRL_CNT
				, SUM(ISNULL(BB.RPC_CNT, 0)) RPC_CNT
				, SUM(ISNULL(BB.TRB_CNT, 0)) TRB_CNT
				, SUM(ISNULL(BB.CNT_5, 0)) CNT_5
				, SUM(ISNULL(BB.CNT_6, 0)) CNT_6
				, SUM(ISNULL(BB.CNT_7, 0)) CNT_7
				
				, SUM((CASE WHEN ISNULL(AA.PRCS_TOTAL, 0) = 0 THEN 0 ELSE AA.PRCS_TOTAL - BASKET_WEIGHT.ETC1 END )) PRCS_TOTAL
				, SUM((CASE WHEN ISNULL(AA.MATRL_TOTAL, 0) = 0 THEN 0 ELSE AA.MATRL_TOTAL - BASKET_WEIGHT.ETC1 END )) MATRL_TOTAL
				, SUM((CASE WHEN ISNULL(AA.RPC_TOTAL, 0) = 0 THEN 0 ELSE AA.RPC_TOTAL - BASKET_WEIGHT.ETC1 END )) RPC_TOTAL
				, SUM((CASE WHEN ISNULL(AA.TRB_TOTAL, 0) = 0 THEN 0 ELSE AA.TRB_TOTAL - BASKET_WEIGHT.ETC1 END )) TRB_TOTAL
				, SUM(ISNULL(AA.TOTAL_5, 0)) TOTAL_5
				, SUM((CASE WHEN ISNULL(AA.TOTAL_6, 0) = 0 THEN 0 ELSE AA.TOTAL_6 - BASKET_WEIGHT.ETC1 END )) TOTAL_6
				, SUM((CASE WHEN ISNULL(AA.TOTAL_7, 0) = 0 THEN 0 ELSE AA.TOTAL_7 - BASKET_WEIGHT.ETC1 END )) TOTAL_7
				
				, SUM(CASE WHEN ISNULL(AA.PRCS_TOTAL, 0) = 0 THEN 0 ELSE ISNULL( CAST( ( CAST(AA.PRCS_TOTAL AS FLOAT) - BASKET_WEIGHT.ETC1) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) END ) PRCS_EA
				, SUM(CASE WHEN ISNULL(AA.MATRL_TOTAL, 0) = 0 THEN 0 ELSE ISNULL( CAST( ( CAST(AA.MATRL_TOTAL AS FLOAT) - BASKET_WEIGHT.ETC1) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) END ) MATRL_EA
				, SUM(CASE WHEN ISNULL(AA.RPC_TOTAL, 0) = 0 THEN 0 ELSE ISNULL( CAST( ( CAST(AA.RPC_TOTAL AS FLOAT) - BASKET_WEIGHT.ETC1) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) END ) RPC_EA
				, SUM(CASE WHEN ISNULL(AA.TRB_TOTAL, 0) = 0 THEN 0 ELSE ISNULL( CAST( ( CAST(AA.TRB_TOTAL AS FLOAT) - BASKET_WEIGHT.ETC1) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) END ) TRB_EA
				, SUM(ISNULL( CAST( CAST(AA.TOTAL_5 AS FLOAT) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 )) AS EA_5
				, SUM(CASE WHEN ISNULL(AA.TOTAL_6, 0) = 0 THEN 0 ELSE ISNULL( CAST( ( CAST(AA.TOTAL_6 AS FLOAT) - BASKET_WEIGHT.ETC1) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) END ) EA_6
				, SUM(CASE WHEN ISNULL(AA.TOTAL_7, 0) = 0 THEN 0 ELSE ISNULL( CAST( ( CAST(AA.TOTAL_7 AS FLOAT) - BASKET_WEIGHT.ETC1) / CAST(DD.GRAVITY AS FLOAT) * 1000 AS FLOAT), 0 ) END ) EA_7
				
				, SUM(ISNULL(FF.APPEAR_FAULTY_CNT,0))  APPEAR_FAULTY_CNT
				, SUM(ISNULL(GG.EDGE_FAULTY_CNT,0))  EDGE_FAULTY_CNT
				, SUM(ISNULL(HH.SHIP_FAULTY_CNT,0))  SHIP_FAULTY_CNT
				, SUM(ISNULL(II.RE_SHIP_FAULTY_CNT,0))  RE_SHIP_FAULTY_CNT

				, SUM((ISNULL(FF.APPEAR_FAULTY_CNT,0) + ISNULL(GG.EDGE_FAULTY_CNT,0) + ISNULL(HH.SHIP_FAULTY_CNT,0) + ISNULL(II.RE_SHIP_FAULTY_CNT,0))) OUTPUT_FAULTY_CNT
			FROM
				TB_MATRL_CODE_ADM EE,
				
				(
					SELECT
						A.*
						,B.DATE
					FROM TB_GOODS_CODE_ADM A
					FULL OUTER JOIN
					(select DATE from CALENDAR A
					where A.DATE >= #{chooseDate1} AND A.DATE <= #{chooseDate2}) B
					ON 1=1
					
				) DD
			
				LEFT JOIN
				(
					SELECT
						A.GOODS_CD
						,B.WORK_ORD_DATE
						, SUM(A.TARGET_CNT) SUM_TARGET_CNT
						, SUM(B.SUM_OUTPUT_CNT) SUM_OUTPUT_CNT
					FROM TB_WORK_ORDER A
					, (
						SELECT
							WORK_ORD_NO
							, SUM(OUTPUT_CNT + VISION_EDGE_CNT) SUM_OUTPUT_CNT
							, WORK_ORD_DATE
						FROM TB_WORK_ORDER_OUTPUT_SUB
						WHERE WORK_ORD_DATE >= #{chooseDate1}
						AND WORK_ORD_DATE <= #{chooseDate2}
						GROUP BY WORK_ORD_NO,WORK_ORD_DATE
					) B
					WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
					GROUP BY GOODS_CD, WORK_ORD_DATE
				) CC
				ON DD.GOODS_CD = CC.GOODS_CD
				AND DD.DATE = CC.WORK_ORD_DATE
				LEFT JOIN
				(
					SELECT
						TT.GOODS_CD
						, WORK_ORD_DATE
						, ISNULL(TT.[001], 0) PRCS_TOTAL
						, ISNULL(TT.[002], 0) MATRL_TOTAL
						, ISNULL(TT.[003], 0) RPC_TOTAL
						, ISNULL(TT.[004], 0) TRB_TOTAL
						
						, ISNULL(TT.[005], 0) TOTAL_5
						, ISNULL(TT.[006], 0) TOTAL_6
						, ISNULL(TT.[007], 0) TOTAL_7
					FROM
					(
						SELECT
							C.GOODS_CD
							, SUM(A.FAULTY) FAULTY
							, A.GUBUN
							, WORK_ORD_DATE
						FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B,(SELECT DISTINCT WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2} GROUP BY WORK_ORD_NO) X, TB_GOODS_CODE_ADM C
						WHERE X.WORK_ORD_NO = B.WORK_ORD_NO  
						AND A.WORK_ORD_NO = B.WORK_ORD_NO
						AND B.GOODS_CD = C.GOODS_CD
						GROUP BY C.GOODS_CD, A.GUBUN, WORK_ORD_DATE
					) AS t PIVOT (SUM(t.FAULTY) FOR t.GUBUN IN ([001], [002], [003], [004], [005], [006], [007])) AS TT
				) AA ON DD.GOODS_CD = AA.GOODS_CD
				AND AA.WORK_ORD_DATE = DD.DATE
				LEFT JOIN 
				(SELECT
					TT.GOODS_CD
					,WORK_ORD_DATE
					, ISNULL(TT.[001], 0) PRCS_CNT
					, ISNULL(TT.[002], 0) MATRL_CNT
					, ISNULL(TT.[003], 0) RPC_CNT
					, ISNULL(TT.[004], 0) TRB_CNT
					
					, ISNULL(TT.[005], 0) CNT_5
					, ISNULL(TT.[006], 0) CNT_6
					, ISNULL(TT.[007], 0) CNT_7
					
				FROM (
					SELECT
						C.GOODS_CD
						, COUNT(FAULTY) PRCS_CNT 
						--, SUM(A.FAULTY) FAULTY
						, A.GUBUN
						, WORK_ORD_DATE
					FROM TB_ALL_FAULTY_ADM A, TB_WORK_ORDER B,(SELECT DISTINCT WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2} GROUP BY WORK_ORD_NO) X, TB_GOODS_CODE_ADM C
					WHERE  X.WORK_ORD_NO = B.WORK_ORD_NO  
					AND A.WORK_ORD_NO = B.WORK_ORD_NO
					AND B.GOODS_CD = C.GOODS_CD
					GROUP BY C.GOODS_CD, A.GUBUN, WORK_ORD_DATE
				) AS t PIVOT ( SUM(t.PRCS_CNT) FOR t.GUBUN IN ([001], [002], [003], [004], [005], [006], [007])) AS TT) BB ON DD.GOODS_CD = BB.GOODS_CD AND BB.WORK_ORD_DATE = DD.DATE
				LEFT JOIN
				(
				SELECT 
							
							
							 ISNULL(SUM(FAULTY_CNT),0) APPEAR_FAULTY_CNT
							,GOODS_CD
							,X.WORK_ORD_DATE
						FROM TB_GOODS_FAULTY_ADM_CODE B,  TB_WORK_ORDER E,(SELECT DISTINCT WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2} GROUP BY WORK_ORD_NO) X
						WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
						AND E.WORK_ORD_NO = X.WORK_ORD_NO
						GROUP BY GOODS_CD,X.WORK_ORD_DATE
				) FF
				ON DD.GOODS_CD = FF.GOODS_CD
				AND FF.WORK_ORD_DATE = DD.DATE
				LEFT JOIN			
								(
				SELECT  ISNULL(SUM(FAULTY_CNT),0) EDGE_FAULTY_CNT
					,GOODS_CD
					,X.WORK_ORD_DATE
				FROM TB_EDGE_GOODS_FAULTY_ADM_CODE B,  TB_WORK_ORDER E, (SELECT DISTINCT WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2} GROUP BY WORK_ORD_NO) X
				WHERE B.WORK_ORD_NO = X.WORK_ORD_NO					
				AND E.WORK_ORD_NO = X.WORK_ORD_NO
				GROUP BY GOODS_CD,X.WORK_ORD_DATE
				) GG
				ON DD.GOODS_CD = GG.GOODS_CD
				AND GG.WORK_ORD_DATE = DD.DATE
				LEFT JOIN
				(
				SELECT
					A.GOODS_CD					
					, SUM(B.FAULTY_CNT) SHIP_FAULTY_CNT		
					,WORK_ORD_DATE
				FROM TB_WORK_ORDER A
					, (SELECT
						X.WORK_ORD_NO
						, SUM(FAULTY_CNT) FAULTY_CNT		
						,X.WORK_ORD_DATE
						FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2} GROUP BY WORK_ORD_NO) X
						WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
						AND RE_INSP_STATUS != '002'
						GROUP BY X.WORK_ORD_NO,X.WORK_ORD_DATE) B
				WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
				GROUP BY GOODS_CD,WORK_ORD_DATE
				) HH
				ON DD.GOODS_CD = HH.GOODS_CD
				AND HH.WORK_ORD_DATE = DD.DATE
				LEFT JOIN
				(
				SELECT
					A.GOODS_CD					
					, SUM(B.FAULTY_CNT) RE_SHIP_FAULTY_CNT			
					,WORK_ORD_DATE
				FROM TB_WORK_ORDER A
					, (SELECT
						X.WORK_ORD_NO
						, SUM(FAULTY_CNT) FAULTY_CNT	
						, X.WORK_ORD_DATE
						FROM TB_SHIP_INSPECT_ADM A,(SELECT DISTINCT WORK_ORD_NO,MAX(WORK_ORD_DATE) WORK_ORD_DATE FROM TB_WORK_ORDER_OUTPUT_SUB X WHERE X.WORK_ORD_DATE BETWEEN #{chooseDate1} AND #{chooseDate2} GROUP BY WORK_ORD_NO) X
						WHERE A.WORK_ORD_NO = X.WORK_ORD_NO
						AND RE_INSP_STATUS = '002'
						GROUP BY X.WORK_ORD_NO,X.WORK_ORD_DATE) B
				WHERE A.WORK_ORD_NO = B.WORK_ORD_NO
				GROUP BY GOODS_CD,WORK_ORD_DATE
				) II
				ON DD.GOODS_CD = II.GOODS_CD
				AND II.WORK_ORD_DATE = DD.DATE
				, ( SELECT ETC1 FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD = '117' AND BASE_CD = '001' ) AS BASKET_WEIGHT
				WHERE DD.USE_YN_CD = '001'
			AND EE.MATRL_CD = DD.ALNICU_MATRL_CD
			GROUP BY DATE
			ORDER BY DD.DATE
			
			]]>
	</select>
	
	
	
	
	
	
	<!-- 생산실적 자재별(불량내역전체 포함) -->
	<select id="readActualOutputMatrlsList" resultMap="FaultyHistoryVo">
		<![CDATA[
			
		]]>
	</select>
	<!-- __________________________________________wmsc0070__________________________________________ -->
	
	<!-- __________________________________________불량내역조회(상세)_wmsc0080__________________________________________ -->
	<!-- 공정불량 통계 리스트 -->
	<select id="readPrcssFaultyListKg"  resultType="HashMap" >
		SELECT
			CAL.*
			--, ISNULL(EQUIP_CD,'') EQUIP_CD
			--, ISNULL(EQUIP_NM,'') EQUIP_NM
			, ISNULL(GOODS_CD,'') GOODS_CD
			--, ISNULL(DAY_NIGHT_CD,'') ORD_GUBUN
			--, ISNULL(DAY_NIGHT_NM,'') DAY_NIGHT_NM
			, ISNULL(ALNICU_MATRL_NM,'') ALNICU_MATRL_NM
			--, ISNULL(FAULTY_REG_DATE,'') ORD_DATE
			, ISNULL(DATE,'') ORD_DATE
			, ISNULL(GRAVITY,'1') GRAVITY
			, ISNULL(GOODS_NM,'') GOODS_NM
			, ISNULL([001],0) '001'
			, ISNULL([002],0) '002'
			, ISNULL([003],0) '003'
			, ISNULL([004],0) '004'
			, ISNULL([005],0) '005'
			, ISNULL([006],0) '006'
			, ISNULL([007],0) '007'
			, ISNULL([008],0) '008'
			, ISNULL([009],0) '009'
			, ISNULL([010],0) '010'
			, ISNULL([011],0) '011'
			, ISNULL([012],0) '012'
			, ISNULL([013],0) '013'
			, ISNULL([014],0) '014'
			, ISNULL([015],0) '015'
			, ISNULL([016],0) '016'
			, ISNULL([017],0) '017'
			, ISNULL([018],0) '018'
			, ISNULL([019],0) '019'
			, ISNULL([020],0) '020'
			, ISNULL([021],0) '021'
			, ISNULL([022],0) '022'
			, ISNULL([023],0) '023'
			, ISNULL([024],0) '024'
			, ISNULL([025],0) '025'
			, ISNULL([026],0) '026'
			, ISNULL([027],0) '027'
			, ISNULL([028],0) '028'
			, ISNULL([029],0) '029'
			, ISNULL([030],0) '030'
			, ISNULL([031],0) '031'
			, ISNULL([032],0) '032'
			, ISNULL([033],0) '033'
			, ISNULL([034],0) '034'
			, ISNULL([035],0) '035'
			, ISNULL([036],0) '036'
			, ISNULL([037],0) '037'
			, ISNULL([038],0) '038'
			, ISNULL([039],0) '039'
			, ISNULL([040],0) '040'
		FROM
			(SELECT
				B.EQUIP_CD
				, B.EQUIP_NM
				, B.ETC1
				, B.USE_YN_CD
				, TEMP.DAY_NIGHT_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD = '028' AND BASE_CD = TEMP.DAY_NIGHT_CD) DAY_NIGHT_NM
				, CALENDAR.DATE
			FROM TB_EQUIP_CODE_ADM B
			LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
			ON B.EQUIP_NM = D.ETC1
		      
			FULL OUTER JOIN
		
			(SELECT DATE FROM CALENDAR
			WHERE 1=1
		<![CDATA[
			AND DATE >= #{faultyDateFrom}
			AND DATE <= #{faultyDateTo}
		]]>
			) CALENDAR
			ON 1=1
		
			FULL OUTER JOIN
			(SELECT 'D' DAY_NIGHT_CD
			UNION
			SELECT 'N' DAY_NIGHT_CD) TEMP
			ON 1=1
		
			WHERE B.ETC1 = ''
			GROUP BY
				B.EQUIP_CD
				, B.EQUIP_NM
				, B.ETC1
				, B.USE_YN_CD
				, CALENDAR.DATE
			   , TEMP.DAY_NIGHT_CD
			) CAL
		
			LEFT OUTER JOIN 
		
			(SELECT
			   ISNULL(EQUIP_CD,'') EQUIP_CD
			   , ISNULL(EQUIP_NM,'') EQUIP_NM
			   , ISNULL(GOODS_CD,'') GOODS_CD
			   , ISNULL(DAY_NIGHT_CD,'') ORD_GUBUN
			   , ISNULL(DAY_NIGHT_NM,'') DAY_NIGHT_NM
			   , ISNULL(ALNICU_MATRL_NM,'') ALNICU_MATRL_NM
			   --, ISNULL(FAULTY_REG_DATE,'') ORD_DATE
			   , ISNULL(DATE,'') ORD_DATE
			   , ISNULL(GRAVITY,'') GRAVITY
			   , ISNULL(GOODS_NM,'') GOODS_NM
			   , ISNULL([001],0) '001'
			   , ISNULL([002],0) '002'
			   , ISNULL([003],0) '003'
			   , ISNULL([004],0) '004'
			   , ISNULL([005],0) '005'
			   , ISNULL([006],0) '006'
			   , ISNULL([007],0) '007'
			   , ISNULL([008],0) '008'
			   , ISNULL([009],0) '009'
			   , ISNULL([010],0) '010'
			   , ISNULL([011],0) '011'
			   , ISNULL([012],0) '012'
			   , ISNULL([013],0) '013'
			   , ISNULL([014],0) '014'
			   , ISNULL([015],0) '015'
			   , ISNULL([016],0) '016'
			   , ISNULL([017],0) '017'
			   , ISNULL([018],0) '018'
			   , ISNULL([019],0) '019'
			   , ISNULL([020],0) '020'
			   , ISNULL([021],0) '021'
			   , ISNULL([022],0) '022'
			   , ISNULL([023],0) '023'
			   , ISNULL([024],0) '024'
			   , ISNULL([025],0) '025'
			   , ISNULL([026],0) '026'
			   , ISNULL([027],0) '027'
			   , ISNULL([028],0) '028'
			   , ISNULL([029],0) '029'
			   , ISNULL([030],0) '030'
			   , ISNULL([031],0) '031'
			   , ISNULL([032],0) '032'
			   , ISNULL([033],0) '033'
			   , ISNULL([034],0) '034'
			   , ISNULL([035],0) '035'
			   , ISNULL([036],0) '036'
			   , ISNULL([037],0) '037'
			   , ISNULL([038],0) '038'
			   , ISNULL([039],0) '039'
			   , ISNULL([040],0) '040'
			FROM (
			   SELECT
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.USE_YN_CD
				  , ISNULL(B.GOODS_CD, '') GOODS_CD
				  , ISNULL(F.GOODS_NM, '') GOODS_NM
				  , ISNULL(B.DAY_NIGHT_CD, 'D') DAY_NIGHT_CD
				  , (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = ISNULL(B.DAY_NIGHT_CD, 'D')) DAY_NIGHT_NM
				  , FAULTY_REG_DATE
				  , ISNULL(G.QUTY_CD, '') QUTY_CD
				  , ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = G.QUTY_CD), '') ALNICU_MATRL_NM
				  , ISNULL(B.SYSTEM_CODE, '') SYSTEM_CODE
				  , ISNULL(B.FAULTY, '0') FAULTY
				  , ISNULL(F.GRAVITY, '1') GRAVITY
				  , DATE
			   FROM TB_EQUIP_CODE_ADM A
				  LEFT OUTER JOIN (   SELECT 
									COALESCE(AA.EQUIP_CD, ( SELECT X.EQUIP_CD FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_CD
									, COALESCE(AA.EQUIP_NM, ( SELECT X.EQUIP_NM FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_NM
									, BB.ETC1
									, ISNULL(AA.DAY_NIGHT_CD, BB.DAY_NIGHT_CD) AS DAY_NIGHT_CD
									, ISNULL(AA.GUBUN, BB.GUBUN) AS GUBUN
									, ISNULL(AA.SYSTEM_CODE, BB.SYSTEM_CODE) AS SYSTEM_CODE
									--, ISNULL(AA.WORK_ORD_NO, BB.WORK_ORD_NO) AS WORK_ORD_NO
									, ISNULL(AA.FAULTY_REG_DATE, BB.FAULTY_REG_DATE) AS FAULTY_REG_DATE
									, ISNULL(AA.GOODS_CD, BB.GOODS_CD) AS GOODS_CD
									, (CONVERT(FLOAT, ISNULL(AA.FAULTY,0)) + CONVERT(FLOAT, ISNULL(BB.FAULTY,0))) FAULTY
									, ISNULL(AA.DATE, BB.DATE) DATE
								 FROM
									(   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'D' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , SUM(FAULTY) AS FAULTY
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 = ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'D'
											 AND C.GUBUN = '001'
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									) AA
		                                 
									FULL OUTER JOIN 
		                                 
									   (   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'D' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , SUM(FAULTY) AS FAULTY
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 != ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'D'
											 AND C.GUBUN = '001'
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									   ) BB
									   ON AA.EQUIP_NM = BB.ETC1
									   AND AA.SYSTEM_CODE = BB.SYSTEM_CODE
									   AND AA.DATE = BB.DATE
									   AND AA.GOODS_CD = BB.GOODS_CD
		      
									WHERE 1=1
									AND (AA.SYSTEM_CODE IS NOT NULL OR  BB.SYSTEM_CODE IS NOT NULL)
							  ) AS B
				  ON A.EQUIP_CD = B.EQUIP_CD
		            
				  LEFT OUTER JOIN TB_GOODS_CODE_ADM F ON B.GOODS_CD = F.GOODS_CD
				  LEFT OUTER JOIN TB_MATRL_CODE_ADM G ON F.ALNICU_MATRL_CD = G.MATRL_CD
			   GROUP BY 
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.ETC1
				  , A.USE_YN_CD
				  , B.GOODS_CD
				  , GOODS_NM
				  , DAY_NIGHT_CD
				  , FAULTY_REG_DATE
				  , QUTY_CD
				  , SYSTEM_CODE
				  , FAULTY
				  , GRAVITY
				  , DATE
			   HAVING A.USE_YN_CD = '001'
			   AND  A.ETC1 = ''
		      
			   UNION ALL
		      
			   SELECT
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.USE_YN_CD
				  , ISNULL(B.GOODS_CD, '') GOODS_CD
				  , ISNULL(F.GOODS_NM, '') GOODS_NM
				  , ISNULL(B.DAY_NIGHT_CD, 'N') DAY_NIGHT_CD
				  , (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = ISNULL(B.DAY_NIGHT_CD, 'N')) DAY_NIGHT_NM
				  , FAULTY_REG_DATE
				  , ISNULL(G.QUTY_CD, '') QUTY_CD
				  , ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = G.QUTY_CD), '') ALNICU_MATRL_NM
				  , ISNULL(B.SYSTEM_CODE, '') SYSTEM_CODE
				  , ISNULL(B.FAULTY, '0') FAULTY
				  , ISNULL(F.GRAVITY, '1') GRAVITY
				  , DATE
			   FROM TB_EQUIP_CODE_ADM A
				  LEFT OUTER JOIN (   SELECT 
									COALESCE(AA.EQUIP_CD, ( SELECT X.EQUIP_CD FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_CD
									, COALESCE(AA.EQUIP_NM, ( SELECT X.EQUIP_NM FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_NM
									, BB.ETC1
									, ISNULL(AA.DAY_NIGHT_CD, BB.DAY_NIGHT_CD) AS DAY_NIGHT_CD
									, ISNULL(AA.GUBUN, BB.GUBUN) AS GUBUN
									, ISNULL(AA.SYSTEM_CODE, BB.SYSTEM_CODE) AS SYSTEM_CODE
									--, ISNULL(AA.WORK_ORD_NO, BB.WORK_ORD_NO) AS WORK_ORD_NO
									, ISNULL(AA.FAULTY_REG_DATE, BB.FAULTY_REG_DATE) AS FAULTY_REG_DATE
									, ISNULL(AA.GOODS_CD, BB.GOODS_CD) AS GOODS_CD
									, (CONVERT(FLOAT, ISNULL(AA.FAULTY,0)) + CONVERT(FLOAT, ISNULL(BB.FAULTY,0))) FAULTY
									, ISNULL(AA.DATE, BB.DATE) DATE
								 FROM
									(   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'N' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , SUM(FAULTY) AS FAULTY
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 = ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'N'
											 AND C.GUBUN = '001'
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									) AA
		                                 
									FULL OUTER JOIN
		                                 
									   (   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'N' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , SUM(FAULTY) AS FAULTY
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 != ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'N'
											 AND C.GUBUN = '001'
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									   ) BB
									   ON AA.EQUIP_NM = BB.ETC1
									   AND AA.SYSTEM_CODE = BB.SYSTEM_CODE
									   AND AA.DATE = BB.DATE
									   AND AA.GOODS_CD = BB.GOODS_CD
		                           
		      
									WHERE 1=1
									AND (AA.SYSTEM_CODE IS NOT NULL OR  BB.SYSTEM_CODE IS NOT NULL)
							  ) AS B
				  ON A.EQUIP_CD = B.EQUIP_CD
		            
				  LEFT OUTER JOIN TB_GOODS_CODE_ADM F ON B.GOODS_CD = F.GOODS_CD
				  LEFT OUTER JOIN TB_MATRL_CODE_ADM G ON F.ALNICU_MATRL_CD = G.MATRL_CD
			   GROUP BY 
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.ETC1
				  , A.USE_YN_CD
				  , B.GOODS_CD
				  , GOODS_NM
				  , DAY_NIGHT_CD
				  , FAULTY_REG_DATE
				  , QUTY_CD
				  , SYSTEM_CODE
				  , FAULTY
				  , GRAVITY
				  , DATE
			   HAVING A.USE_YN_CD = '001'
			   AND  A.ETC1 = ''
			) AS t
			PIVOT (SUM(t.FAULTY) FOR t.SYSTEM_CODE IN (${systemCode}))
		
			AS pivot_result
		
			) AS BIG_AAA
		
			ON CAL.EQUIP_CD = BIG_AAA.EQUIP_CD
			AND CAL.DATE = BIG_AAA.ORD_DATE
			AND CAL.DAY_NIGHT_CD = BIG_AAA.ORD_GUBUN
			
		WHERE CAL.USE_YN_CD = '001'
		ORDER BY CAL.DATE, CAL.DAY_NIGHT_CD, CAL.EQUIP_NM
	</select>
	
	
	
	<!-- 원자재불량 통계 리스트 -->
	<select id="readMatrlFaultyListKg" resultType="HashMap">
		SELECT
			CAL.*
			--, ISNULL(EQUIP_CD,'') EQUIP_CD
			--, ISNULL(EQUIP_NM,'') EQUIP_NM
			, ISNULL(GOODS_CD,'') GOODS_CD
			--, ISNULL(DAY_NIGHT_CD,'') ORD_GUBUN
			--, ISNULL(DAY_NIGHT_NM,'') DAY_NIGHT_NM
			, ISNULL(ALNICU_MATRL_NM,'') ALNICU_MATRL_NM
			--, ISNULL(FAULTY_REG_DATE,'') ORD_DATE
			, ISNULL(DATE,'') ORD_DATE
			, ISNULL(GRAVITY,'1') GRAVITY
			, ISNULL(GOODS_NM,'') GOODS_NM
			, ISNULL([001],0) '001'
			, ISNULL([002],0) '002'
			, ISNULL([003],0) '003'
			, ISNULL([004],0) '004'
			, ISNULL([005],0) '005'
			, ISNULL([006],0) '006'
			, ISNULL([007],0) '007'
			, ISNULL([008],0) '008'
			, ISNULL([009],0) '009'
			, ISNULL([010],0) '010'
			, ISNULL([011],0) '011'
			, ISNULL([012],0) '012'
			, ISNULL([013],0) '013'
			, ISNULL([014],0) '014'
			, ISNULL([015],0) '015'
			, ISNULL([016],0) '016'
			, ISNULL([017],0) '017'
			, ISNULL([018],0) '018'
			, ISNULL([019],0) '019'
			, ISNULL([020],0) '020'
			, ISNULL([021],0) '021'
			, ISNULL([022],0) '022'
			, ISNULL([023],0) '023'
			, ISNULL([024],0) '024'
			, ISNULL([025],0) '025'
			, ISNULL([026],0) '026'
			, ISNULL([027],0) '027'
			, ISNULL([028],0) '028'
			, ISNULL([029],0) '029'
			, ISNULL([030],0) '030'
			, ISNULL([031],0) '031'
			, ISNULL([032],0) '032'
			, ISNULL([033],0) '033'
			, ISNULL([034],0) '034'
			, ISNULL([035],0) '035'
			, ISNULL([036],0) '036'
			, ISNULL([037],0) '037'
			, ISNULL([038],0) '038'
			, ISNULL([039],0) '039'
			, ISNULL([040],0) '040'
		FROM
			(SELECT
				B.EQUIP_CD
				, B.EQUIP_NM
				, B.ETC1
				, B.USE_YN_CD
				, TEMP.DAY_NIGHT_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD = '028' AND BASE_CD = TEMP.DAY_NIGHT_CD) DAY_NIGHT_NM
				, CALENDAR.DATE
			FROM TB_EQUIP_CODE_ADM B
			LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
			ON B.EQUIP_NM = D.ETC1
		      
			FULL OUTER JOIN
		
			(SELECT DATE FROM CALENDAR
			WHERE 1=1
		<![CDATA[
			AND DATE >= #{faultyDateFrom}
			AND DATE <= #{faultyDateTo}
		]]>
			) CALENDAR
			ON 1=1
		
			FULL OUTER JOIN
			(SELECT 'D' DAY_NIGHT_CD
			UNION
			SELECT 'N' DAY_NIGHT_CD) TEMP
			ON 1=1
		
			WHERE B.ETC1 = ''
			GROUP BY
				B.EQUIP_CD
				, B.EQUIP_NM
				, B.ETC1
				, B.USE_YN_CD
				, CALENDAR.DATE
			   , TEMP.DAY_NIGHT_CD
			) CAL
		
			LEFT OUTER JOIN 
		
			(SELECT
			   ISNULL(EQUIP_CD,'') EQUIP_CD
			   , ISNULL(EQUIP_NM,'') EQUIP_NM
			   , ISNULL(GOODS_CD,'') GOODS_CD
			   , ISNULL(DAY_NIGHT_CD,'') ORD_GUBUN
			   , ISNULL(DAY_NIGHT_NM,'') DAY_NIGHT_NM
			   , ISNULL(ALNICU_MATRL_NM,'') ALNICU_MATRL_NM
			   --, ISNULL(FAULTY_REG_DATE,'') ORD_DATE
			   , ISNULL(DATE,'') ORD_DATE
			   , ISNULL(GRAVITY,'') GRAVITY
			   , ISNULL(GOODS_NM,'') GOODS_NM
			   , ISNULL([001],0) '001'
			   , ISNULL([002],0) '002'
			   , ISNULL([003],0) '003'
			   , ISNULL([004],0) '004'
			   , ISNULL([005],0) '005'
			   , ISNULL([006],0) '006'
			   , ISNULL([007],0) '007'
			   , ISNULL([008],0) '008'
			   , ISNULL([009],0) '009'
			   , ISNULL([010],0) '010'
			   , ISNULL([011],0) '011'
			   , ISNULL([012],0) '012'
			   , ISNULL([013],0) '013'
			   , ISNULL([014],0) '014'
			   , ISNULL([015],0) '015'
			   , ISNULL([016],0) '016'
			   , ISNULL([017],0) '017'
			   , ISNULL([018],0) '018'
			   , ISNULL([019],0) '019'
			   , ISNULL([020],0) '020'
			   , ISNULL([021],0) '021'
			   , ISNULL([022],0) '022'
			   , ISNULL([023],0) '023'
			   , ISNULL([024],0) '024'
			   , ISNULL([025],0) '025'
			   , ISNULL([026],0) '026'
			   , ISNULL([027],0) '027'
			   , ISNULL([028],0) '028'
			   , ISNULL([029],0) '029'
			   , ISNULL([030],0) '030'
			   , ISNULL([031],0) '031'
			   , ISNULL([032],0) '032'
			   , ISNULL([033],0) '033'
			   , ISNULL([034],0) '034'
			   , ISNULL([035],0) '035'
			   , ISNULL([036],0) '036'
			   , ISNULL([037],0) '037'
			   , ISNULL([038],0) '038'
			   , ISNULL([039],0) '039'
			   , ISNULL([040],0) '040'
			FROM (
			   SELECT
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.USE_YN_CD
				  , ISNULL(B.GOODS_CD, '') GOODS_CD
				  , ISNULL(F.GOODS_NM, '') GOODS_NM
				  , ISNULL(B.DAY_NIGHT_CD, 'D') DAY_NIGHT_CD
				  , (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = ISNULL(B.DAY_NIGHT_CD, 'D')) DAY_NIGHT_NM
				  , FAULTY_REG_DATE
				  , ISNULL(G.QUTY_CD, '') QUTY_CD
				  , ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = G.QUTY_CD), '') ALNICU_MATRL_NM
				  , ISNULL(B.SYSTEM_CODE, '') SYSTEM_CODE
				  , ISNULL(B.FAULTY, '0') FAULTY
				  , ISNULL(F.GRAVITY, '1') GRAVITY
				  , DATE
			   FROM TB_EQUIP_CODE_ADM A
				  LEFT OUTER JOIN (   SELECT 
									COALESCE(AA.EQUIP_CD, ( SELECT X.EQUIP_CD FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_CD
									, COALESCE(AA.EQUIP_NM, ( SELECT X.EQUIP_NM FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_NM
									, BB.ETC1
									, ISNULL(AA.DAY_NIGHT_CD, BB.DAY_NIGHT_CD) AS DAY_NIGHT_CD
									, ISNULL(AA.GUBUN, BB.GUBUN) AS GUBUN
									, ISNULL(AA.SYSTEM_CODE, BB.SYSTEM_CODE) AS SYSTEM_CODE
									--, ISNULL(AA.WORK_ORD_NO, BB.WORK_ORD_NO) AS WORK_ORD_NO
									, ISNULL(AA.FAULTY_REG_DATE, BB.FAULTY_REG_DATE) AS FAULTY_REG_DATE
									, ISNULL(AA.GOODS_CD, BB.GOODS_CD) AS GOODS_CD
									, (CONVERT(FLOAT, ISNULL(AA.FAULTY,0)) + CONVERT(FLOAT, ISNULL(BB.FAULTY,0))) FAULTY
									, ISNULL(AA.DATE, BB.DATE) DATE
								 FROM
									(   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'D' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , SUM(FAULTY) AS FAULTY
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 = ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'D'
											 AND C.GUBUN = '002'
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									) AA
		                                 
									FULL OUTER JOIN 
		                                 
									   (   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'D' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , SUM(FAULTY) AS FAULTY
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 != ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'D'
											 AND C.GUBUN = '002'
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									   ) BB
									   ON AA.EQUIP_NM = BB.ETC1
									   AND AA.SYSTEM_CODE = BB.SYSTEM_CODE
									   AND AA.DATE = BB.DATE
									   AND AA.GOODS_CD = BB.GOODS_CD
		      
									WHERE 1=1
									AND (AA.SYSTEM_CODE IS NOT NULL OR  BB.SYSTEM_CODE IS NOT NULL)
							  ) AS B
				  ON A.EQUIP_CD = B.EQUIP_CD
		            
				  LEFT OUTER JOIN TB_GOODS_CODE_ADM F ON B.GOODS_CD = F.GOODS_CD
				  LEFT OUTER JOIN TB_MATRL_CODE_ADM G ON F.ALNICU_MATRL_CD = G.MATRL_CD
			   GROUP BY 
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.ETC1
				  , A.USE_YN_CD
				  , B.GOODS_CD
				  , GOODS_NM
				  , DAY_NIGHT_CD
				  , FAULTY_REG_DATE
				  , QUTY_CD
				  , SYSTEM_CODE
				  , FAULTY
				  , GRAVITY
				  , DATE
			   HAVING A.USE_YN_CD = '001'
			   AND  A.ETC1 = ''
		      
			   UNION ALL
		      
			   SELECT
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.USE_YN_CD
				  , ISNULL(B.GOODS_CD, '') GOODS_CD
				  , ISNULL(F.GOODS_NM, '') GOODS_NM
				  , ISNULL(B.DAY_NIGHT_CD, 'N') DAY_NIGHT_CD
				  , (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = ISNULL(B.DAY_NIGHT_CD, 'N')) DAY_NIGHT_NM
				  , FAULTY_REG_DATE
				  , ISNULL(G.QUTY_CD, '') QUTY_CD
				  , ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = G.QUTY_CD), '') ALNICU_MATRL_NM
				  , ISNULL(B.SYSTEM_CODE, '') SYSTEM_CODE
				  , ISNULL(B.FAULTY, '0') FAULTY
				  , ISNULL(F.GRAVITY, '1') GRAVITY
				  , DATE
			   FROM TB_EQUIP_CODE_ADM A
				  LEFT OUTER JOIN (   SELECT 
									COALESCE(AA.EQUIP_CD, ( SELECT X.EQUIP_CD FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_CD
									, COALESCE(AA.EQUIP_NM, ( SELECT X.EQUIP_NM FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_NM
									, BB.ETC1
									, ISNULL(AA.DAY_NIGHT_CD, BB.DAY_NIGHT_CD) AS DAY_NIGHT_CD
									, ISNULL(AA.GUBUN, BB.GUBUN) AS GUBUN
									, ISNULL(AA.SYSTEM_CODE, BB.SYSTEM_CODE) AS SYSTEM_CODE
									--, ISNULL(AA.WORK_ORD_NO, BB.WORK_ORD_NO) AS WORK_ORD_NO
									, ISNULL(AA.FAULTY_REG_DATE, BB.FAULTY_REG_DATE) AS FAULTY_REG_DATE
									, ISNULL(AA.GOODS_CD, BB.GOODS_CD) AS GOODS_CD
									, (CONVERT(FLOAT, ISNULL(AA.FAULTY,0)) + CONVERT(FLOAT, ISNULL(BB.FAULTY,0))) FAULTY
									, ISNULL(AA.DATE, BB.DATE) DATE
								 FROM
									(   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'N' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , SUM(FAULTY) AS FAULTY
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 = ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'N'
											 AND C.GUBUN = '002'
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									) AA
		                                 
									FULL OUTER JOIN
		                                 
									   (   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'N' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , SUM(FAULTY) AS FAULTY
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 != ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'N'
											 AND C.GUBUN = '002'
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									   ) BB
									   ON AA.EQUIP_NM = BB.ETC1
									   AND AA.SYSTEM_CODE = BB.SYSTEM_CODE
									   AND AA.DATE = BB.DATE
									   AND AA.GOODS_CD = BB.GOODS_CD
		                           
		      
									WHERE 1=1
									AND (AA.SYSTEM_CODE IS NOT NULL OR  BB.SYSTEM_CODE IS NOT NULL)
							  ) AS B
				  ON A.EQUIP_CD = B.EQUIP_CD
		            
				  LEFT OUTER JOIN TB_GOODS_CODE_ADM F ON B.GOODS_CD = F.GOODS_CD
				  LEFT OUTER JOIN TB_MATRL_CODE_ADM G ON F.ALNICU_MATRL_CD = G.MATRL_CD
			   GROUP BY 
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.ETC1
				  , A.USE_YN_CD
				  , B.GOODS_CD
				  , GOODS_NM
				  , DAY_NIGHT_CD
				  , FAULTY_REG_DATE
				  , QUTY_CD
				  , SYSTEM_CODE
				  , FAULTY
				  , GRAVITY
				  , DATE
			   HAVING A.USE_YN_CD = '001'
			   AND  A.ETC1 = ''
			) AS t
			PIVOT (SUM(t.FAULTY) FOR t.SYSTEM_CODE IN (${systemCode}))
		
			AS pivot_result
		
			) AS BIG_AAA
		
			ON CAL.EQUIP_CD = BIG_AAA.EQUIP_CD
			AND CAL.DATE = BIG_AAA.ORD_DATE
			AND CAL.DAY_NIGHT_CD = BIG_AAA.ORD_GUBUN
			
		WHERE CAL.USE_YN_CD = '001'
		ORDER BY CAL.DATE, CAL.DAY_NIGHT_CD, CAL.EQUIP_NM
	</select>
	
	<!-- 원자재불량 통계 리스트 -->
	<!-- 
	<select id="readMatrlFaultyListCount" resultType="HashMap">
		SELECT
			ISNULL(EQUIP_CD,'') EQUIP_CD
			, ISNULL(EQUIP_NM,'') EQUIP_NM
			, ISNULL(GOODS_CD,'') GOODS_CD
			, ISNULL(DAY_NIGHT_CD,'') ORD_GUBUN
			, ISNULL(DAY_NIGHT_NM,'') DAY_NIGHT_NM
			, ISNULL(ALNICU_MATRL_NM,'') ALNICU_MATRL_NM
			, ISNULL(FAULTY_REG_DATE,'') ORD_DATE
			, ISNULL(GRAVITY,'') GRAVITY
			, ISNULL(GOODS_NM,'') GOODS_NM
			, ISNULL([001],0) '001'
			, ISNULL([002],0) '002'
			, ISNULL([003],0) '003'
			, ISNULL([004],0) '004'
			, ISNULL([005],0) '005'
			, ISNULL([006],0) '006'
			, ISNULL([007],0) '007'
			, ISNULL([008],0) '008'
			, ISNULL([009],0) '009'
			, ISNULL([010],0) '010'
			, ISNULL([011],0) '011'
			, ISNULL([012],0) '012'
			, ISNULL([013],0) '013'
			, ISNULL([014],0) '014'
			, ISNULL([015],0) '015'
			, ISNULL([016],0) '016'
			, ISNULL([017],0) '017'
			, ISNULL([018],0) '018'
			, ISNULL([019],0) '019'
			, ISNULL([020],0) '020'
			, ISNULL([021],0) '021'
			, ISNULL([022],0) '022'
			, ISNULL([023],0) '023'
			, ISNULL([024],0) '024'
			, ISNULL([025],0) '025'
			, ISNULL([026],0) '026'
			, ISNULL([027],0) '027'
			, ISNULL([028],0) '028'
			, ISNULL([029],0) '029'
			, ISNULL([030],0) '030'
			, ISNULL([031],0) '031'
			, ISNULL([032],0) '032'
			, ISNULL([033],0) '033'
			, ISNULL([034],0) '034'
			, ISNULL([035],0) '035'
			, ISNULL([036],0) '036'
			, ISNULL([037],0) '037'
			, ISNULL([038],0) '038'
			, ISNULL([039],0) '039'
			, ISNULL([040],0) '040'
		FROM (
			SELECT
				A.EQUIP_CD
			   , A.EQUIP_NM
			   , ISNULL(C.GOODS_CD, '') GOODS_CD
			   , ISNULL(F.GOODS_NM, '') GOODS_NM
			   , ISNULL(B.DAY_NIGHT_CD, 'D') DAY_NIGHT_CD
			   , (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = ISNULL(B.DAY_NIGHT_CD, 'D')) DAY_NIGHT_NM
			   , ISNULL(B.FAULTY_REG_DATE, #{faultyDateTo}) FAULTY_REG_DATE
			   , ISNULL(G.QUTY_CD, '') QUTY_CD
			   , ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = G.QUTY_CD), '') ALNICU_MATRL_NM
			   , ISNULL(B.SYSTEM_CODE, '') SYSTEM_CODE
			   , ISNULL(B.FAULTY, '0') FAULTY
			   , ISNULL(F.GRAVITY, '1') GRAVITY
			FROM TB_EQUIP_CODE_ADM A
				LEFT OUTER JOIN TB_ALL_FAULTY_ADM B ON A.EQUIP_CD = B.EQUIP_CD AND B.DAY_NIGHT_CD = 'D' AND B.GUBUN = '002' AND B.FAULTY_REG_DATE = #{faultyDateTo}
				LEFT OUTER JOIN TB_WORK_ORDER C ON A.EQUIP_CD = C.EQUIP_CD AND C.ORD_DATE = #{faultyDateTo}
				LEFT OUTER JOIN TB_GOODS_CODE_ADM F ON C.GOODS_CD = F.GOODS_CD
				LEFT OUTER JOIN TB_MATRL_CODE_ADM G ON F.ALNICU_MATRL_CD = G.MATRL_CD
			GROUP BY A.EQUIP_CD, EQUIP_NM, C.GOODS_CD, GOODS_NM, DAY_NIGHT_CD, FAULTY_REG_DATE, QUTY_CD,  SYSTEM_CODE, FAULTY, GRAVITY

			UNION ALL

			SELECT
				A.EQUIP_CD
			   , A.EQUIP_NM
			   , ISNULL(C.GOODS_CD, '') GOODS_CD
			   , ISNULL(F.GOODS_NM, '') GOODS_NM
			   , ISNULL(B.DAY_NIGHT_CD, 'N') DAY_NIGHT_CD
			   , (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = ISNULL(B.DAY_NIGHT_CD, 'N')) DAY_NIGHT_NM
			   , ISNULL(B.FAULTY_REG_DATE, #{faultyDateTo}) FAULTY_REG_DATE
			   , ISNULL(G.QUTY_CD, '') QUTY_CD
			   , ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = G.QUTY_CD), '') ALNICU_MATRL_NM
			   , ISNULL(B.SYSTEM_CODE, '') SYSTEM_CODE
			   , ISNULL(B.FAULTY, '0') FAULTY
			   , ISNULL(F.GRAVITY, '1') GRAVITY
			FROM TB_EQUIP_CODE_ADM A
				LEFT OUTER JOIN TB_ALL_FAULTY_ADM B ON A.EQUIP_CD = B.EQUIP_CD AND B.DAY_NIGHT_CD = 'N' AND B.GUBUN = '002' AND B.FAULTY_REG_DATE = #{faultyDateTo}
				LEFT OUTER JOIN TB_WORK_ORDER C ON A.EQUIP_CD = C.EQUIP_CD AND C.ORD_DATE = #{faultyDateTo}
				LEFT OUTER JOIN TB_GOODS_CODE_ADM F ON C.GOODS_CD = F.GOODS_CD
				LEFT OUTER JOIN TB_MATRL_CODE_ADM G ON F.ALNICU_MATRL_CD = G.MATRL_CD
			GROUP BY A.EQUIP_CD, EQUIP_NM, C.GOODS_CD, GOODS_NM, DAY_NIGHT_CD, FAULTY_REG_DATE, QUTY_CD,  SYSTEM_CODE, FAULTY, GRAVITY
		) AS t
		PIVOT (COUNT(t.FAULTY) FOR t.SYSTEM_CODE IN (${systemCode})) AS pivot_result
		ORDER BY ORD_GUBUN, EQUIP_NM
	</select>
	 -->
	 
	<!-- 교체불량 통계 무게 -->
	<select id="readReplaceFaultyListKg" resultType="HashMap">
		SELECT
			CAL.*
			--, ISNULL(EQUIP_CD,'') EQUIP_CD
			--, ISNULL(EQUIP_NM,'') EQUIP_NM
			, ISNULL(GOODS_CD,'') GOODS_CD
			--, ISNULL(DAY_NIGHT_CD,'') ORD_GUBUN
			--, ISNULL(DAY_NIGHT_NM,'') DAY_NIGHT_NM
			, ISNULL(ALNICU_MATRL_NM,'') ALNICU_MATRL_NM
			--, ISNULL(FAULTY_REG_DATE,'') ORD_DATE
			, ISNULL(DATE,'') ORD_DATE
			, ISNULL(GRAVITY,'1') GRAVITY
			, ISNULL(GOODS_NM,'') GOODS_NM
			, ISNULL([001],0) '001'
			, ISNULL([002],0) '002'
			, ISNULL([003],0) '003'
			, ISNULL([004],0) '004'
			, ISNULL([005],0) '005'
			, ISNULL([006],0) '006'
			, ISNULL([007],0) '007'
			, ISNULL([008],0) '008'
			, ISNULL([009],0) '009'
			, ISNULL([010],0) '010'
			, ISNULL([011],0) '011'
			, ISNULL([012],0) '012'
			, ISNULL([013],0) '013'
			, ISNULL([014],0) '014'
			, ISNULL([015],0) '015'
			, ISNULL([016],0) '016'
			, ISNULL([017],0) '017'
			, ISNULL([018],0) '018'
			, ISNULL([019],0) '019'
			, ISNULL([020],0) '020'
			, ISNULL([021],0) '021'
			, ISNULL([022],0) '022'
			, ISNULL([023],0) '023'
			, ISNULL([024],0) '024'
			, ISNULL([025],0) '025'
			, ISNULL([026],0) '026'
			, ISNULL([027],0) '027'
			, ISNULL([028],0) '028'
			, ISNULL([029],0) '029'
			, ISNULL([030],0) '030'
			, ISNULL([031],0) '031'
			, ISNULL([032],0) '032'
			, ISNULL([033],0) '033'
			, ISNULL([034],0) '034'
			, ISNULL([035],0) '035'
			, ISNULL([036],0) '036'
			, ISNULL([037],0) '037'
			, ISNULL([038],0) '038'
			, ISNULL([039],0) '039'
			, ISNULL([040],0) '040'
		FROM
			(SELECT
				B.EQUIP_CD
				, B.EQUIP_NM
				, B.ETC1
				, B.USE_YN_CD
				, TEMP.DAY_NIGHT_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD = '028' AND BASE_CD = TEMP.DAY_NIGHT_CD) DAY_NIGHT_NM
				, CALENDAR.DATE
			FROM TB_EQUIP_CODE_ADM B
			LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
			ON B.EQUIP_NM = D.ETC1
			
		      
			FULL OUTER JOIN
		
			(SELECT DATE FROM CALENDAR
			WHERE 1=1
		<![CDATA[
			AND DATE >= #{faultyDateFrom}
			AND DATE <= #{faultyDateTo}
		]]>
			) CALENDAR
			ON 1=1
		
			FULL OUTER JOIN
			(SELECT 'D' DAY_NIGHT_CD
			UNION
			SELECT 'N' DAY_NIGHT_CD) TEMP
			ON 1=1
		
			WHERE B.ETC1 = ''
			GROUP BY
				B.EQUIP_CD
				, B.EQUIP_NM
				, B.ETC1
				, B.USE_YN_CD
				, CALENDAR.DATE
			   , TEMP.DAY_NIGHT_CD
			) CAL
		
			LEFT OUTER JOIN 
		
			(SELECT
			   ISNULL(EQUIP_CD,'') EQUIP_CD
			   , ISNULL(EQUIP_NM,'') EQUIP_NM
			   , ISNULL(GOODS_CD,'') GOODS_CD
			   , ISNULL(DAY_NIGHT_CD,'') ORD_GUBUN
			   , ISNULL(DAY_NIGHT_NM,'') DAY_NIGHT_NM
			   , ISNULL(ALNICU_MATRL_NM,'') ALNICU_MATRL_NM
			   --, ISNULL(FAULTY_REG_DATE,'') ORD_DATE
			   , ISNULL(DATE,'') ORD_DATE
			   , ISNULL(GRAVITY,'') GRAVITY
			   , ISNULL(GOODS_NM,'') GOODS_NM
			   , ISNULL([001],0) '001'
			   , ISNULL([002],0) '002'
			   , ISNULL([003],0) '003'
			   , ISNULL([004],0) '004'
			   , ISNULL([005],0) '005'
			   , ISNULL([006],0) '006'
			   , ISNULL([007],0) '007'
			   , ISNULL([008],0) '008'
			   , ISNULL([009],0) '009'
			   , ISNULL([010],0) '010'
			   , ISNULL([011],0) '011'
			   , ISNULL([012],0) '012'
			   , ISNULL([013],0) '013'
			   , ISNULL([014],0) '014'
			   , ISNULL([015],0) '015'
			   , ISNULL([016],0) '016'
			   , ISNULL([017],0) '017'
			   , ISNULL([018],0) '018'
			   , ISNULL([019],0) '019'
			   , ISNULL([020],0) '020'
			   , ISNULL([021],0) '021'
			   , ISNULL([022],0) '022'
			   , ISNULL([023],0) '023'
			   , ISNULL([024],0) '024'
			   , ISNULL([025],0) '025'
			   , ISNULL([026],0) '026'
			   , ISNULL([027],0) '027'
			   , ISNULL([028],0) '028'
			   , ISNULL([029],0) '029'
			   , ISNULL([030],0) '030'
			   , ISNULL([031],0) '031'
			   , ISNULL([032],0) '032'
			   , ISNULL([033],0) '033'
			   , ISNULL([034],0) '034'
			   , ISNULL([035],0) '035'
			   , ISNULL([036],0) '036'
			   , ISNULL([037],0) '037'
			   , ISNULL([038],0) '038'
			   , ISNULL([039],0) '039'
			   , ISNULL([040],0) '040'
			FROM (
			   SELECT
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.USE_YN_CD
				  , ISNULL(B.GOODS_CD, '') GOODS_CD
				  , ISNULL(F.GOODS_NM, '') GOODS_NM
				  , ISNULL(B.DAY_NIGHT_CD, 'D') DAY_NIGHT_CD
				  , (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = ISNULL(B.DAY_NIGHT_CD, 'D')) DAY_NIGHT_NM
				  , FAULTY_REG_DATE
				  , ISNULL(G.QUTY_CD, '') QUTY_CD
				  , ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = G.QUTY_CD), '') ALNICU_MATRL_NM
				  , ISNULL(B.SYSTEM_CODE, '') SYSTEM_CODE
				  , ISNULL(B.FAULTY, '0') FAULTY
				  , ISNULL(F.GRAVITY, '1') GRAVITY
				  , DATE
			   FROM TB_EQUIP_CODE_ADM A
				  LEFT OUTER JOIN (   SELECT 
									COALESCE(AA.EQUIP_CD, ( SELECT X.EQUIP_CD FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_CD
									, COALESCE(AA.EQUIP_NM, ( SELECT X.EQUIP_NM FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_NM
									, BB.ETC1
									, ISNULL(AA.DAY_NIGHT_CD, BB.DAY_NIGHT_CD) AS DAY_NIGHT_CD
									, ISNULL(AA.GUBUN, BB.GUBUN) AS GUBUN
									, ISNULL(AA.SYSTEM_CODE, BB.SYSTEM_CODE) AS SYSTEM_CODE
									--, ISNULL(AA.WORK_ORD_NO, BB.WORK_ORD_NO) AS WORK_ORD_NO
									, ISNULL(AA.FAULTY_REG_DATE, BB.FAULTY_REG_DATE) AS FAULTY_REG_DATE
									, ISNULL(AA.GOODS_CD, BB.GOODS_CD) AS GOODS_CD
									, (CONVERT(FLOAT, ISNULL(AA.FAULTY,0)) + CONVERT(FLOAT, ISNULL(BB.FAULTY,0))) FAULTY
									, ISNULL(AA.DATE, BB.DATE) DATE
								 FROM
									(   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'D' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , SUM(FAULTY) AS FAULTY
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 = ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'D'
											 AND C.GUBUN = '003'
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									) AA
		                                 
									FULL OUTER JOIN 
		                                 
									   (   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'D' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , SUM(FAULTY) AS FAULTY
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 != ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'D'
											 AND C.GUBUN = '003'
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									   ) BB
									   ON AA.EQUIP_NM = BB.ETC1
									   AND AA.SYSTEM_CODE = BB.SYSTEM_CODE
									   AND AA.DATE = BB.DATE
									   AND AA.GOODS_CD = BB.GOODS_CD
		      
									WHERE 1=1
									AND (AA.SYSTEM_CODE IS NOT NULL OR  BB.SYSTEM_CODE IS NOT NULL)
							  ) AS B
				  ON A.EQUIP_CD = B.EQUIP_CD
		            
				  LEFT OUTER JOIN TB_GOODS_CODE_ADM F ON B.GOODS_CD = F.GOODS_CD
				  LEFT OUTER JOIN TB_MATRL_CODE_ADM G ON F.ALNICU_MATRL_CD = G.MATRL_CD
			   GROUP BY 
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.ETC1
				  , A.USE_YN_CD
				  , B.GOODS_CD
				  , GOODS_NM
				  , DAY_NIGHT_CD
				  , FAULTY_REG_DATE
				  , QUTY_CD
				  , SYSTEM_CODE
				  , FAULTY
				  , GRAVITY
				  , DATE
			   HAVING A.USE_YN_CD = '001'
			   AND  A.ETC1 = ''
		      
			   UNION ALL
		      
			   SELECT
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.USE_YN_CD
				  , ISNULL(B.GOODS_CD, '') GOODS_CD
				  , ISNULL(F.GOODS_NM, '') GOODS_NM
				  , ISNULL(B.DAY_NIGHT_CD, 'N') DAY_NIGHT_CD
				  , (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = ISNULL(B.DAY_NIGHT_CD, 'N')) DAY_NIGHT_NM
				  , FAULTY_REG_DATE
				  , ISNULL(G.QUTY_CD, '') QUTY_CD
				  , ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = G.QUTY_CD), '') ALNICU_MATRL_NM
				  , ISNULL(B.SYSTEM_CODE, '') SYSTEM_CODE
				  , ISNULL(B.FAULTY, '0') FAULTY
				  , ISNULL(F.GRAVITY, '1') GRAVITY
				  , DATE
			   FROM TB_EQUIP_CODE_ADM A
				  LEFT OUTER JOIN (   SELECT 
									COALESCE(AA.EQUIP_CD, ( SELECT X.EQUIP_CD FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_CD
									, COALESCE(AA.EQUIP_NM, ( SELECT X.EQUIP_NM FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_NM
									, BB.ETC1
									, ISNULL(AA.DAY_NIGHT_CD, BB.DAY_NIGHT_CD) AS DAY_NIGHT_CD
									, ISNULL(AA.GUBUN, BB.GUBUN) AS GUBUN
									, ISNULL(AA.SYSTEM_CODE, BB.SYSTEM_CODE) AS SYSTEM_CODE
									--, ISNULL(AA.WORK_ORD_NO, BB.WORK_ORD_NO) AS WORK_ORD_NO
									, ISNULL(AA.FAULTY_REG_DATE, BB.FAULTY_REG_DATE) AS FAULTY_REG_DATE
									, ISNULL(AA.GOODS_CD, BB.GOODS_CD) AS GOODS_CD
									, (CONVERT(FLOAT, ISNULL(AA.FAULTY,0)) + CONVERT(FLOAT, ISNULL(BB.FAULTY,0))) FAULTY
									, ISNULL(AA.DATE, BB.DATE) DATE
								 FROM
									(   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'N' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , SUM(FAULTY) AS FAULTY
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 = ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'N'
											 AND C.GUBUN = '003'
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									) AA
		                                 
									FULL OUTER JOIN
		                                 
									   (   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'N' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , SUM(FAULTY) AS FAULTY
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 != ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'N'
											 AND C.GUBUN = '003'
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									   ) BB
									   ON AA.EQUIP_NM = BB.ETC1
									   AND AA.SYSTEM_CODE = BB.SYSTEM_CODE
									   AND AA.DATE = BB.DATE
									   AND AA.GOODS_CD = BB.GOODS_CD
		                           
		      
									WHERE 1=1
									AND (AA.SYSTEM_CODE IS NOT NULL OR  BB.SYSTEM_CODE IS NOT NULL)
							  ) AS B
				  ON A.EQUIP_CD = B.EQUIP_CD
		            
				  LEFT OUTER JOIN TB_GOODS_CODE_ADM F ON B.GOODS_CD = F.GOODS_CD
				  LEFT OUTER JOIN TB_MATRL_CODE_ADM G ON F.ALNICU_MATRL_CD = G.MATRL_CD
			   GROUP BY 
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.ETC1
				  , A.USE_YN_CD
				  , B.GOODS_CD
				  , GOODS_NM
				  , DAY_NIGHT_CD
				  , FAULTY_REG_DATE
				  , QUTY_CD
				  , SYSTEM_CODE
				  , FAULTY
				  , GRAVITY
				  , DATE
			   HAVING A.USE_YN_CD = '001'
			   AND  A.ETC1 = ''
			) AS t
			PIVOT (SUM(t.FAULTY) FOR t.SYSTEM_CODE IN (${systemCode}))
		
			AS pivot_result
		
			) AS BIG_AAA
		
			ON CAL.EQUIP_CD = BIG_AAA.EQUIP_CD
			AND CAL.DATE = BIG_AAA.ORD_DATE
			AND CAL.DAY_NIGHT_CD = BIG_AAA.ORD_GUBUN
			
		WHERE CAL.USE_YN_CD = '001'
		ORDER BY CAL.DATE, CAL.DAY_NIGHT_CD, CAL.EQUIP_NM
	</select>
	
	<!-- 교체불량 통계 횟수 -->
	<select id="readReplaceFaultyListCount" resultType="HashMap">
		SELECT
			CAL.*
			--, ISNULL(EQUIP_CD,'') EQUIP_CD
			--, ISNULL(EQUIP_NM,'') EQUIP_NM
			, ISNULL(GOODS_CD,'') GOODS_CD
			--, ISNULL(DAY_NIGHT_CD,'') ORD_GUBUN
			--, ISNULL(DAY_NIGHT_NM,'') DAY_NIGHT_NM
			, ISNULL(ALNICU_MATRL_NM,'') ALNICU_MATRL_NM
			--, ISNULL(FAULTY_REG_DATE,'') ORD_DATE
			, ISNULL(DATE,'') ORD_DATE
			, ISNULL(GRAVITY,'1') GRAVITY
			, ISNULL(GOODS_NM,'') GOODS_NM
			, ISNULL([001],0) '001'
			, ISNULL([002],0) '002'
			, ISNULL([003],0) '003'
			, ISNULL([004],0) '004'
			, ISNULL([005],0) '005'
			, ISNULL([006],0) '006'
			, ISNULL([007],0) '007'
			, ISNULL([008],0) '008'
			, ISNULL([009],0) '009'
			, ISNULL([010],0) '010'
			, ISNULL([011],0) '011'
			, ISNULL([012],0) '012'
			, ISNULL([013],0) '013'
			, ISNULL([014],0) '014'
			, ISNULL([015],0) '015'
			, ISNULL([016],0) '016'
			, ISNULL([017],0) '017'
			, ISNULL([018],0) '018'
			, ISNULL([019],0) '019'
			, ISNULL([020],0) '020'
			, ISNULL([021],0) '021'
			, ISNULL([022],0) '022'
			, ISNULL([023],0) '023'
			, ISNULL([024],0) '024'
			, ISNULL([025],0) '025'
			, ISNULL([026],0) '026'
			, ISNULL([027],0) '027'
			, ISNULL([028],0) '028'
			, ISNULL([029],0) '029'
			, ISNULL([030],0) '030'
			, ISNULL([031],0) '031'
			, ISNULL([032],0) '032'
			, ISNULL([033],0) '033'
			, ISNULL([034],0) '034'
			, ISNULL([035],0) '035'
			, ISNULL([036],0) '036'
			, ISNULL([037],0) '037'
			, ISNULL([038],0) '038'
			, ISNULL([039],0) '039'
			, ISNULL([040],0) '040'
		FROM
			(SELECT
				B.EQUIP_CD
				, B.EQUIP_NM
				, B.ETC1
				, B.USE_YN_CD
				, TEMP.DAY_NIGHT_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD = '028' AND BASE_CD = TEMP.DAY_NIGHT_CD) DAY_NIGHT_NM
				, CALENDAR.DATE
			FROM TB_EQUIP_CODE_ADM B
			LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
			ON B.EQUIP_NM = D.ETC1
		      
			FULL OUTER JOIN
		
			(SELECT DATE FROM CALENDAR
			WHERE 1=1
		<![CDATA[
			AND DATE >= #{faultyDateFrom}
			AND DATE <= #{faultyDateTo}
		]]>
			) CALENDAR
			ON 1=1
		
			FULL OUTER JOIN
			(SELECT 'D' DAY_NIGHT_CD
			UNION
			SELECT 'N' DAY_NIGHT_CD) TEMP
			ON 1=1
		
			WHERE B.ETC1 = ''
			GROUP BY
				B.EQUIP_CD
				, B.EQUIP_NM
				, B.ETC1
				, B.USE_YN_CD
				, CALENDAR.DATE
			   , TEMP.DAY_NIGHT_CD
			) CAL
		
			LEFT OUTER JOIN 
		
			(SELECT
			   ISNULL(EQUIP_CD,'') EQUIP_CD
			   , ISNULL(EQUIP_NM,'') EQUIP_NM
			   , ISNULL(GOODS_CD,'') GOODS_CD
			   , ISNULL(DAY_NIGHT_CD,'') ORD_GUBUN
			   , ISNULL(DAY_NIGHT_NM,'') DAY_NIGHT_NM
			   , ISNULL(ALNICU_MATRL_NM,'') ALNICU_MATRL_NM
			   --, ISNULL(FAULTY_REG_DATE,'') ORD_DATE
			   , ISNULL(DATE,'') ORD_DATE
			   , ISNULL(GRAVITY,'') GRAVITY
			   , ISNULL(GOODS_NM,'') GOODS_NM
			   , ISNULL([001],0) '001'
			   , ISNULL([002],0) '002'
			   , ISNULL([003],0) '003'
			   , ISNULL([004],0) '004'
			   , ISNULL([005],0) '005'
			   , ISNULL([006],0) '006'
			   , ISNULL([007],0) '007'
			   , ISNULL([008],0) '008'
			   , ISNULL([009],0) '009'
			   , ISNULL([010],0) '010'
			   , ISNULL([011],0) '011'
			   , ISNULL([012],0) '012'
			   , ISNULL([013],0) '013'
			   , ISNULL([014],0) '014'
			   , ISNULL([015],0) '015'
			   , ISNULL([016],0) '016'
			   , ISNULL([017],0) '017'
			   , ISNULL([018],0) '018'
			   , ISNULL([019],0) '019'
			   , ISNULL([020],0) '020'
			   , ISNULL([021],0) '021'
			   , ISNULL([022],0) '022'
			   , ISNULL([023],0) '023'
			   , ISNULL([024],0) '024'
			   , ISNULL([025],0) '025'
			   , ISNULL([026],0) '026'
			   , ISNULL([027],0) '027'
			   , ISNULL([028],0) '028'
			   , ISNULL([029],0) '029'
			   , ISNULL([030],0) '030'
			   , ISNULL([031],0) '031'
			   , ISNULL([032],0) '032'
			   , ISNULL([033],0) '033'
			   , ISNULL([034],0) '034'
			   , ISNULL([035],0) '035'
			   , ISNULL([036],0) '036'
			   , ISNULL([037],0) '037'
			   , ISNULL([038],0) '038'
			   , ISNULL([039],0) '039'
			   , ISNULL([040],0) '040'
			FROM (
			   SELECT
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.USE_YN_CD
				  , ISNULL(B.GOODS_CD, '') GOODS_CD
				  , ISNULL(F.GOODS_NM, '') GOODS_NM
				  , ISNULL(B.DAY_NIGHT_CD, 'D') DAY_NIGHT_CD
				  , (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = ISNULL(B.DAY_NIGHT_CD, 'D')) DAY_NIGHT_NM
				  , FAULTY_REG_DATE
				  , ISNULL(G.QUTY_CD, '') QUTY_CD
				  , ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = G.QUTY_CD), '') ALNICU_MATRL_NM
				  , ISNULL(B.SYSTEM_CODE, '') SYSTEM_CODE
				  , ISNULL(B.FAULTY_COUNT, '0') FAULTY_COUNT
				  , ISNULL(F.GRAVITY, '1') GRAVITY
				  , DATE
			   FROM TB_EQUIP_CODE_ADM A
				  LEFT OUTER JOIN (   SELECT 
									COALESCE(AA.EQUIP_CD, ( SELECT X.EQUIP_CD FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_CD
									, COALESCE(AA.EQUIP_NM, ( SELECT X.EQUIP_NM FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_NM
									, BB.ETC1
									, ISNULL(AA.DAY_NIGHT_CD, BB.DAY_NIGHT_CD) AS DAY_NIGHT_CD
									, ISNULL(AA.GUBUN, BB.GUBUN) AS GUBUN
									, ISNULL(AA.SYSTEM_CODE, BB.SYSTEM_CODE) AS SYSTEM_CODE
									--, ISNULL(AA.WORK_ORD_NO, BB.WORK_ORD_NO) AS WORK_ORD_NO
									, ISNULL(AA.FAULTY_REG_DATE, BB.FAULTY_REG_DATE) AS FAULTY_REG_DATE
									, ISNULL(AA.GOODS_CD, BB.GOODS_CD) AS GOODS_CD
									, (CONVERT(INT, ISNULL(AA.FAULTY_COUNT,0)) + CONVERT(INT, ISNULL(BB.FAULTY_COUNT,0))) FAULTY_COUNT
									, ISNULL(AA.DATE, BB.DATE) DATE
								 FROM
									(   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'D' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , COUNT(FAULTY) AS FAULTY_COUNT
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 = ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'D'
											 AND C.GUBUN = '003'
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									) AA
		                                 
									FULL OUTER JOIN 
		                                 
									   (   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'D' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , COUNT(FAULTY_COUNT) AS FAULTY_COUNT
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 != ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'D'
											 AND C.GUBUN = '003'
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									   ) BB
									   ON AA.EQUIP_NM = BB.ETC1
									   AND AA.SYSTEM_CODE = BB.SYSTEM_CODE
									   AND AA.DATE = BB.DATE
									   AND AA.GOODS_CD = BB.GOODS_CD
		      
									WHERE 1=1
									AND (AA.SYSTEM_CODE IS NOT NULL OR  BB.SYSTEM_CODE IS NOT NULL)
									
		
							  ) AS B
				  ON A.EQUIP_CD = B.EQUIP_CD
		            
				  LEFT OUTER JOIN TB_GOODS_CODE_ADM F ON B.GOODS_CD = F.GOODS_CD
				  LEFT OUTER JOIN TB_MATRL_CODE_ADM G ON F.ALNICU_MATRL_CD = G.MATRL_CD
			   GROUP BY 
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.ETC1
				  , A.USE_YN_CD
				  , B.GOODS_CD
				  , GOODS_NM
				  , DAY_NIGHT_CD
				  , FAULTY_REG_DATE
				  , QUTY_CD
				  , SYSTEM_CODE
				  , FAULTY_COUNT
				  , GRAVITY
				  , DATE
			   HAVING A.USE_YN_CD = '001'
			   AND  A.ETC1 = ''
			  
			   UNION ALL
		      
			   SELECT
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.USE_YN_CD
				  , ISNULL(B.GOODS_CD, '') GOODS_CD
				  , ISNULL(F.GOODS_NM, '') GOODS_NM
				  , ISNULL(B.DAY_NIGHT_CD, 'N') DAY_NIGHT_CD
				  , (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = ISNULL(B.DAY_NIGHT_CD, 'N')) DAY_NIGHT_NM
				  , FAULTY_REG_DATE
				  , ISNULL(G.QUTY_CD, '') QUTY_CD
				  , ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = G.QUTY_CD), '') ALNICU_MATRL_NM
				  , ISNULL(B.SYSTEM_CODE, '') SYSTEM_CODE
				  , ISNULL(B.FAULTY_COUNT, '0') FAULTY_COUNT
				  , ISNULL(F.GRAVITY, '1') GRAVITY
				  , DATE
			   FROM TB_EQUIP_CODE_ADM A
				  LEFT OUTER JOIN (   SELECT 
									COALESCE(AA.EQUIP_CD, ( SELECT X.EQUIP_CD FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_CD
									, COALESCE(AA.EQUIP_NM, ( SELECT X.EQUIP_NM FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_NM
									, BB.ETC1
									, ISNULL(AA.DAY_NIGHT_CD, BB.DAY_NIGHT_CD) AS DAY_NIGHT_CD
									, ISNULL(AA.GUBUN, BB.GUBUN) AS GUBUN
									, ISNULL(AA.SYSTEM_CODE, BB.SYSTEM_CODE) AS SYSTEM_CODE
									--, ISNULL(AA.WORK_ORD_NO, BB.WORK_ORD_NO) AS WORK_ORD_NO
									, ISNULL(AA.FAULTY_REG_DATE, BB.FAULTY_REG_DATE) AS FAULTY_REG_DATE
									, ISNULL(AA.GOODS_CD, BB.GOODS_CD) AS GOODS_CD
									, (CONVERT(INT, ISNULL(AA.FAULTY_COUNT,0)) + CONVERT(INT, ISNULL(BB.FAULTY_COUNT,0))) FAULTY_COUNT
									, ISNULL(AA.DATE, BB.DATE) DATE
								 FROM
									(   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'N' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , COUNT(FAULTY) AS FAULTY_COUNT
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 = ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'N'
											 AND C.GUBUN = '003'
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									) AA
		                                 
									FULL OUTER JOIN 
		                                 
									   (   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'N' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , COUNT(FAULTY_COUNT) AS FAULTY_COUNT
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 != ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'N'
											 AND C.GUBUN = '003'
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									   ) BB
									   ON AA.EQUIP_NM = BB.ETC1
									   AND AA.SYSTEM_CODE = BB.SYSTEM_CODE
									   AND AA.DATE = BB.DATE
									   AND AA.GOODS_CD = BB.GOODS_CD
		      
									WHERE 1=1
									AND (AA.SYSTEM_CODE IS NOT NULL OR  BB.SYSTEM_CODE IS NOT NULL)
									
		
							  ) AS B
				  ON A.EQUIP_CD = B.EQUIP_CD
		            
				  LEFT OUTER JOIN TB_GOODS_CODE_ADM F ON B.GOODS_CD = F.GOODS_CD
				  LEFT OUTER JOIN TB_MATRL_CODE_ADM G ON F.ALNICU_MATRL_CD = G.MATRL_CD
			   GROUP BY 
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.ETC1
				  , A.USE_YN_CD
				  , B.GOODS_CD
				  , GOODS_NM
				  , DAY_NIGHT_CD
				  , FAULTY_REG_DATE
				  , QUTY_CD
				  , SYSTEM_CODE
				  , FAULTY_COUNT
				  , GRAVITY
				  , DATE
			   HAVING A.USE_YN_CD = '001'
			   AND  A.ETC1 = ''
			) AS t
			PIVOT (SUM(t.FAULTY_COUNT) FOR t.SYSTEM_CODE IN (${systemCode}))
		
			AS pivot_result
		
			) AS BIG_AAA
		
			ON CAL.EQUIP_CD = BIG_AAA.EQUIP_CD
			AND CAL.DATE = BIG_AAA.ORD_DATE
			AND CAL.DAY_NIGHT_CD = BIG_AAA.ORD_GUBUN
			
		WHERE CAL.USE_YN_CD = '001'
		ORDER BY CAL.DATE, CAL.DAY_NIGHT_CD, CAL.EQUIP_NM
	</select>
	
	<!-- 설비Trouble 통계 리스트 -->
	<select id="readTroubleFaultyListKg" resultType="HashMap">
		SELECT
			CAL.*
			--, ISNULL(EQUIP_CD,'') EQUIP_CD
			--, ISNULL(EQUIP_NM,'') EQUIP_NM
			, ISNULL(GOODS_CD,'') GOODS_CD
			--, ISNULL(DAY_NIGHT_CD,'') ORD_GUBUN
			--, ISNULL(DAY_NIGHT_NM,'') DAY_NIGHT_NM
			, ISNULL(ALNICU_MATRL_NM,'') ALNICU_MATRL_NM
			--, ISNULL(FAULTY_REG_DATE,'') ORD_DATE
			, ISNULL(DATE,'') ORD_DATE
			, ISNULL(GRAVITY,'1') GRAVITY
			, ISNULL(GOODS_NM,'') GOODS_NM
			, ISNULL([001],0) '001'
			, ISNULL([002],0) '002'
			, ISNULL([003],0) '003'
			, ISNULL([004],0) '004'
			, ISNULL([005],0) '005'
			, ISNULL([006],0) '006'
			, ISNULL([007],0) '007'
			, ISNULL([008],0) '008'
			, ISNULL([009],0) '009'
			, ISNULL([010],0) '010'
			, ISNULL([011],0) '011'
			, ISNULL([012],0) '012'
			, ISNULL([013],0) '013'
			, ISNULL([014],0) '014'
			, ISNULL([015],0) '015'
			, ISNULL([016],0) '016'
			, ISNULL([017],0) '017'
			, ISNULL([018],0) '018'
			, ISNULL([019],0) '019'
			, ISNULL([020],0) '020'
			, ISNULL([021],0) '021'
			, ISNULL([022],0) '022'
			, ISNULL([023],0) '023'
			, ISNULL([024],0) '024'
			, ISNULL([025],0) '025'
			, ISNULL([026],0) '026'
			, ISNULL([027],0) '027'
			, ISNULL([028],0) '028'
			, ISNULL([029],0) '029'
			, ISNULL([030],0) '030'
			, ISNULL([031],0) '031'
			, ISNULL([032],0) '032'
			, ISNULL([033],0) '033'
			, ISNULL([034],0) '034'
			, ISNULL([035],0) '035'
			, ISNULL([036],0) '036'
			, ISNULL([037],0) '037'
			, ISNULL([038],0) '038'
			, ISNULL([039],0) '039'
			, ISNULL([040],0) '040'
		FROM
			(SELECT
				B.EQUIP_CD
				, B.EQUIP_NM
				, B.ETC1
				, B.USE_YN_CD
				, TEMP.DAY_NIGHT_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD = '028' AND BASE_CD = TEMP.DAY_NIGHT_CD) DAY_NIGHT_NM
				, CALENDAR.DATE
			FROM TB_EQUIP_CODE_ADM B
			LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
			ON B.EQUIP_NM = D.ETC1
		      
			FULL OUTER JOIN
		
			(SELECT DATE FROM CALENDAR
			WHERE 1=1
		<![CDATA[
			AND DATE >= #{faultyDateFrom}
			AND DATE <= #{faultyDateTo}
		]]>
			) CALENDAR
			ON 1=1
		
			FULL OUTER JOIN
			(SELECT 'D' DAY_NIGHT_CD
			UNION
			SELECT 'N' DAY_NIGHT_CD) TEMP
			ON 1=1
		
			WHERE B.ETC1 = ''
			GROUP BY
				B.EQUIP_CD
				, B.EQUIP_NM
				, B.ETC1
				, B.USE_YN_CD
				, CALENDAR.DATE
			   , TEMP.DAY_NIGHT_CD
			) CAL
		
			LEFT OUTER JOIN 
		
			(SELECT
			   ISNULL(EQUIP_CD,'') EQUIP_CD
			   , ISNULL(EQUIP_NM,'') EQUIP_NM
			   , ISNULL(GOODS_CD,'') GOODS_CD
			   , ISNULL(DAY_NIGHT_CD,'') ORD_GUBUN
			   , ISNULL(DAY_NIGHT_NM,'') DAY_NIGHT_NM
			   , ISNULL(ALNICU_MATRL_NM,'') ALNICU_MATRL_NM
			   --, ISNULL(FAULTY_REG_DATE,'') ORD_DATE
			   , ISNULL(DATE,'') ORD_DATE
			   , ISNULL(GRAVITY,'') GRAVITY
			   , ISNULL(GOODS_NM,'') GOODS_NM
			   , ISNULL([001],0) '001'
			   , ISNULL([002],0) '002'
			   , ISNULL([003],0) '003'
			   , ISNULL([004],0) '004'
			   , ISNULL([005],0) '005'
			   , ISNULL([006],0) '006'
			   , ISNULL([007],0) '007'
			   , ISNULL([008],0) '008'
			   , ISNULL([009],0) '009'
			   , ISNULL([010],0) '010'
			   , ISNULL([011],0) '011'
			   , ISNULL([012],0) '012'
			   , ISNULL([013],0) '013'
			   , ISNULL([014],0) '014'
			   , ISNULL([015],0) '015'
			   , ISNULL([016],0) '016'
			   , ISNULL([017],0) '017'
			   , ISNULL([018],0) '018'
			   , ISNULL([019],0) '019'
			   , ISNULL([020],0) '020'
			   , ISNULL([021],0) '021'
			   , ISNULL([022],0) '022'
			   , ISNULL([023],0) '023'
			   , ISNULL([024],0) '024'
			   , ISNULL([025],0) '025'
			   , ISNULL([026],0) '026'
			   , ISNULL([027],0) '027'
			   , ISNULL([028],0) '028'
			   , ISNULL([029],0) '029'
			   , ISNULL([030],0) '030'
			   , ISNULL([031],0) '031'
			   , ISNULL([032],0) '032'
			   , ISNULL([033],0) '033'
			   , ISNULL([034],0) '034'
			   , ISNULL([035],0) '035'
			   , ISNULL([036],0) '036'
			   , ISNULL([037],0) '037'
			   , ISNULL([038],0) '038'
			   , ISNULL([039],0) '039'
			   , ISNULL([040],0) '040'
			FROM (
			   SELECT
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.USE_YN_CD
				  , ISNULL(B.GOODS_CD, '') GOODS_CD
				  , ISNULL(F.GOODS_NM, '') GOODS_NM
				  , ISNULL(B.DAY_NIGHT_CD, 'D') DAY_NIGHT_CD
				  , (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = ISNULL(B.DAY_NIGHT_CD, 'D')) DAY_NIGHT_NM
				  , FAULTY_REG_DATE
				  , ISNULL(G.QUTY_CD, '') QUTY_CD
				  , ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = G.QUTY_CD), '') ALNICU_MATRL_NM
				  , ISNULL(B.SYSTEM_CODE, '') SYSTEM_CODE
				  , ISNULL(B.FAULTY, '0') FAULTY
				  , ISNULL(F.GRAVITY, '1') GRAVITY
				  , DATE
			   FROM TB_EQUIP_CODE_ADM A
				  LEFT OUTER JOIN (   SELECT 
									COALESCE(AA.EQUIP_CD, ( SELECT X.EQUIP_CD FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_CD
									, COALESCE(AA.EQUIP_NM, ( SELECT X.EQUIP_NM FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_NM
									, BB.ETC1
									, ISNULL(AA.DAY_NIGHT_CD, BB.DAY_NIGHT_CD) AS DAY_NIGHT_CD
									, ISNULL(AA.GUBUN, BB.GUBUN) AS GUBUN
									, ISNULL(AA.SYSTEM_CODE, BB.SYSTEM_CODE) AS SYSTEM_CODE
									--, ISNULL(AA.WORK_ORD_NO, BB.WORK_ORD_NO) AS WORK_ORD_NO
									, ISNULL(AA.FAULTY_REG_DATE, BB.FAULTY_REG_DATE) AS FAULTY_REG_DATE
									, ISNULL(AA.GOODS_CD, BB.GOODS_CD) AS GOODS_CD
									, (CONVERT(FLOAT, ISNULL(AA.FAULTY,0)) + CONVERT(FLOAT, ISNULL(BB.FAULTY,0))) FAULTY
									, ISNULL(AA.DATE, BB.DATE) DATE
								 FROM
									(   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'D' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , SUM(FAULTY) AS FAULTY
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 = ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'D'
											 AND C.GUBUN = '004'
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									) AA
		                                 
									FULL OUTER JOIN 
		                                 
									   (   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'D' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , SUM(FAULTY) AS FAULTY
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 != ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'D'
											 AND C.GUBUN = '004'
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									   ) BB
									   ON AA.EQUIP_NM = BB.ETC1
									   AND AA.SYSTEM_CODE = BB.SYSTEM_CODE
									   AND AA.DATE = BB.DATE
									   AND AA.GOODS_CD = BB.GOODS_CD
		      
									WHERE 1=1
									AND (AA.SYSTEM_CODE IS NOT NULL OR  BB.SYSTEM_CODE IS NOT NULL)
							  ) AS B
				  ON A.EQUIP_CD = B.EQUIP_CD
		            
				  LEFT OUTER JOIN TB_GOODS_CODE_ADM F ON B.GOODS_CD = F.GOODS_CD
				  LEFT OUTER JOIN TB_MATRL_CODE_ADM G ON F.ALNICU_MATRL_CD = G.MATRL_CD
			   GROUP BY 
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.ETC1
				  , A.USE_YN_CD
				  , B.GOODS_CD
				  , GOODS_NM
				  , DAY_NIGHT_CD
				  , FAULTY_REG_DATE
				  , QUTY_CD
				  , SYSTEM_CODE
				  , FAULTY
				  , GRAVITY
				  , DATE
			   HAVING A.USE_YN_CD = '001'
			   AND  A.ETC1 = ''
		      
			   UNION ALL
		      
			   SELECT
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.USE_YN_CD
				  , ISNULL(B.GOODS_CD, '') GOODS_CD
				  , ISNULL(F.GOODS_NM, '') GOODS_NM
				  , ISNULL(B.DAY_NIGHT_CD, 'N') DAY_NIGHT_CD
				  , (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = ISNULL(B.DAY_NIGHT_CD, 'N')) DAY_NIGHT_NM
				  , FAULTY_REG_DATE
				  , ISNULL(G.QUTY_CD, '') QUTY_CD
				  , ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = G.QUTY_CD), '') ALNICU_MATRL_NM
				  , ISNULL(B.SYSTEM_CODE, '') SYSTEM_CODE
				  , ISNULL(B.FAULTY, '0') FAULTY
				  , ISNULL(F.GRAVITY, '1') GRAVITY
				  , DATE
			   FROM TB_EQUIP_CODE_ADM A
				  LEFT OUTER JOIN (   SELECT 
									COALESCE(AA.EQUIP_CD, ( SELECT X.EQUIP_CD FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_CD
									, COALESCE(AA.EQUIP_NM, ( SELECT X.EQUIP_NM FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_NM
									, BB.ETC1
									, ISNULL(AA.DAY_NIGHT_CD, BB.DAY_NIGHT_CD) AS DAY_NIGHT_CD
									, ISNULL(AA.GUBUN, BB.GUBUN) AS GUBUN
									, ISNULL(AA.SYSTEM_CODE, BB.SYSTEM_CODE) AS SYSTEM_CODE
									--, ISNULL(AA.WORK_ORD_NO, BB.WORK_ORD_NO) AS WORK_ORD_NO
									, ISNULL(AA.FAULTY_REG_DATE, BB.FAULTY_REG_DATE) AS FAULTY_REG_DATE
									, ISNULL(AA.GOODS_CD, BB.GOODS_CD) AS GOODS_CD
									, (CONVERT(FLOAT, ISNULL(AA.FAULTY,0)) + CONVERT(FLOAT, ISNULL(BB.FAULTY,0))) FAULTY
									, ISNULL(AA.DATE, BB.DATE) DATE
								 FROM
									(   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'N' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , SUM(FAULTY) AS FAULTY
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 = ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'N'
											 AND C.GUBUN = '004'
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									) AA
		                                 
									FULL OUTER JOIN
		                                 
									   (   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'N' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , SUM(FAULTY) AS FAULTY
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 != ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'N'
											 AND C.GUBUN = '004'
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									   ) BB
									   ON AA.EQUIP_NM = BB.ETC1
									   AND AA.SYSTEM_CODE = BB.SYSTEM_CODE
									   AND AA.DATE = BB.DATE
									   AND AA.GOODS_CD = BB.GOODS_CD
		                           
		      
									WHERE 1=1
									AND (AA.SYSTEM_CODE IS NOT NULL OR  BB.SYSTEM_CODE IS NOT NULL)
							  ) AS B
				  ON A.EQUIP_CD = B.EQUIP_CD
		            
				  LEFT OUTER JOIN TB_GOODS_CODE_ADM F ON B.GOODS_CD = F.GOODS_CD
				  LEFT OUTER JOIN TB_MATRL_CODE_ADM G ON F.ALNICU_MATRL_CD = G.MATRL_CD
			   GROUP BY 
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.ETC1
				  , A.USE_YN_CD
				  , B.GOODS_CD
				  , GOODS_NM
				  , DAY_NIGHT_CD
				  , FAULTY_REG_DATE
				  , QUTY_CD
				  , SYSTEM_CODE
				  , FAULTY
				  , GRAVITY
				  , DATE
			   HAVING A.USE_YN_CD = '001'
			   AND  A.ETC1 = ''
			) AS t
			PIVOT (SUM(t.FAULTY) FOR t.SYSTEM_CODE IN (${systemCode}))
		
			AS pivot_result
		
			) AS BIG_AAA
		
			ON CAL.EQUIP_CD = BIG_AAA.EQUIP_CD
			AND CAL.DATE = BIG_AAA.ORD_DATE
			AND CAL.DAY_NIGHT_CD = BIG_AAA.ORD_GUBUN
			
		WHERE CAL.USE_YN_CD = '001'
		ORDER BY CAL.DATE, CAL.DAY_NIGHT_CD, CAL.EQUIP_NM
	</select>
	
	<!-- 설비Trouble 통계 리스트 -->
	<select id="readTroubleFaultyListCount" resultType="HashMap">
		SELECT
			CAL.*
			--, ISNULL(EQUIP_CD,'') EQUIP_CD
			--, ISNULL(EQUIP_NM,'') EQUIP_NM
			, ISNULL(GOODS_CD,'') GOODS_CD
			--, ISNULL(DAY_NIGHT_CD,'') ORD_GUBUN
			--, ISNULL(DAY_NIGHT_NM,'') DAY_NIGHT_NM
			, ISNULL(ALNICU_MATRL_NM,'') ALNICU_MATRL_NM
			--, ISNULL(FAULTY_REG_DATE,'') ORD_DATE
			, ISNULL(DATE,'') ORD_DATE
			, ISNULL(GRAVITY,'1') GRAVITY
			, ISNULL(GOODS_NM,'') GOODS_NM
			, ISNULL([001],0) '001'
			, ISNULL([002],0) '002'
			, ISNULL([003],0) '003'
			, ISNULL([004],0) '004'
			, ISNULL([005],0) '005'
			, ISNULL([006],0) '006'
			, ISNULL([007],0) '007'
			, ISNULL([008],0) '008'
			, ISNULL([009],0) '009'
			, ISNULL([010],0) '010'
			, ISNULL([011],0) '011'
			, ISNULL([012],0) '012'
			, ISNULL([013],0) '013'
			, ISNULL([014],0) '014'
			, ISNULL([015],0) '015'
			, ISNULL([016],0) '016'
			, ISNULL([017],0) '017'
			, ISNULL([018],0) '018'
			, ISNULL([019],0) '019'
			, ISNULL([020],0) '020'
			, ISNULL([021],0) '021'
			, ISNULL([022],0) '022'
			, ISNULL([023],0) '023'
			, ISNULL([024],0) '024'
			, ISNULL([025],0) '025'
			, ISNULL([026],0) '026'
			, ISNULL([027],0) '027'
			, ISNULL([028],0) '028'
			, ISNULL([029],0) '029'
			, ISNULL([030],0) '030'
			, ISNULL([031],0) '031'
			, ISNULL([032],0) '032'
			, ISNULL([033],0) '033'
			, ISNULL([034],0) '034'
			, ISNULL([035],0) '035'
			, ISNULL([036],0) '036'
			, ISNULL([037],0) '037'
			, ISNULL([038],0) '038'
			, ISNULL([039],0) '039'
			, ISNULL([040],0) '040'
		FROM
			(SELECT
				B.EQUIP_CD
				, B.EQUIP_NM
				, B.ETC1
				, B.USE_YN_CD
				, TEMP.DAY_NIGHT_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD = '028' AND BASE_CD = TEMP.DAY_NIGHT_CD) DAY_NIGHT_NM
				, CALENDAR.DATE
			FROM TB_EQUIP_CODE_ADM B
			LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
			ON B.EQUIP_NM = D.ETC1
		      
			FULL OUTER JOIN
		
			(SELECT DATE FROM CALENDAR
			WHERE 1=1
		<![CDATA[
			AND DATE >= #{faultyDateFrom}
			AND DATE <= #{faultyDateTo}
		]]>
			) CALENDAR
			ON 1=1
		
			FULL OUTER JOIN
			(SELECT 'D' DAY_NIGHT_CD
			UNION
			SELECT 'N' DAY_NIGHT_CD) TEMP
			ON 1=1
		
			WHERE B.ETC1 = ''
			GROUP BY
				B.EQUIP_CD
				, B.EQUIP_NM
				, B.ETC1
				, B.USE_YN_CD
				, CALENDAR.DATE
			   , TEMP.DAY_NIGHT_CD
			) CAL
		
			LEFT OUTER JOIN 
		
			(SELECT
			   ISNULL(EQUIP_CD,'') EQUIP_CD
			   , ISNULL(EQUIP_NM,'') EQUIP_NM
			   , ISNULL(GOODS_CD,'') GOODS_CD
			   , ISNULL(DAY_NIGHT_CD,'') ORD_GUBUN
			   , ISNULL(DAY_NIGHT_NM,'') DAY_NIGHT_NM
			   , ISNULL(ALNICU_MATRL_NM,'') ALNICU_MATRL_NM
			   --, ISNULL(FAULTY_REG_DATE,'') ORD_DATE
			   , ISNULL(DATE,'') ORD_DATE
			   , ISNULL(GRAVITY,'') GRAVITY
			   , ISNULL(GOODS_NM,'') GOODS_NM
			   , ISNULL([001],0) '001'
			   , ISNULL([002],0) '002'
			   , ISNULL([003],0) '003'
			   , ISNULL([004],0) '004'
			   , ISNULL([005],0) '005'
			   , ISNULL([006],0) '006'
			   , ISNULL([007],0) '007'
			   , ISNULL([008],0) '008'
			   , ISNULL([009],0) '009'
			   , ISNULL([010],0) '010'
			   , ISNULL([011],0) '011'
			   , ISNULL([012],0) '012'
			   , ISNULL([013],0) '013'
			   , ISNULL([014],0) '014'
			   , ISNULL([015],0) '015'
			   , ISNULL([016],0) '016'
			   , ISNULL([017],0) '017'
			   , ISNULL([018],0) '018'
			   , ISNULL([019],0) '019'
			   , ISNULL([020],0) '020'
			   , ISNULL([021],0) '021'
			   , ISNULL([022],0) '022'
			   , ISNULL([023],0) '023'
			   , ISNULL([024],0) '024'
			   , ISNULL([025],0) '025'
			   , ISNULL([026],0) '026'
			   , ISNULL([027],0) '027'
			   , ISNULL([028],0) '028'
			   , ISNULL([029],0) '029'
			   , ISNULL([030],0) '030'
			   , ISNULL([031],0) '031'
			   , ISNULL([032],0) '032'
			   , ISNULL([033],0) '033'
			   , ISNULL([034],0) '034'
			   , ISNULL([035],0) '035'
			   , ISNULL([036],0) '036'
			   , ISNULL([037],0) '037'
			   , ISNULL([038],0) '038'
			   , ISNULL([039],0) '039'
			   , ISNULL([040],0) '040'
			FROM (
			   SELECT
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.USE_YN_CD
				  , ISNULL(B.GOODS_CD, '') GOODS_CD
				  , ISNULL(F.GOODS_NM, '') GOODS_NM
				  , ISNULL(B.DAY_NIGHT_CD, 'D') DAY_NIGHT_CD
				  , (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = ISNULL(B.DAY_NIGHT_CD, 'D')) DAY_NIGHT_NM
				  , FAULTY_REG_DATE
				  , ISNULL(G.QUTY_CD, '') QUTY_CD
				  , ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = G.QUTY_CD), '') ALNICU_MATRL_NM
				  , ISNULL(B.SYSTEM_CODE, '') SYSTEM_CODE
				  , ISNULL(B.FAULTY_COUNT, '0') FAULTY_COUNT
				  , ISNULL(F.GRAVITY, '1') GRAVITY
				  , DATE
			   FROM TB_EQUIP_CODE_ADM A
				  LEFT OUTER JOIN (   SELECT 
									COALESCE(AA.EQUIP_CD, ( SELECT X.EQUIP_CD FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_CD
									, COALESCE(AA.EQUIP_NM, ( SELECT X.EQUIP_NM FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_NM
									, BB.ETC1
									, ISNULL(AA.DAY_NIGHT_CD, BB.DAY_NIGHT_CD) AS DAY_NIGHT_CD
									, ISNULL(AA.GUBUN, BB.GUBUN) AS GUBUN
									, ISNULL(AA.SYSTEM_CODE, BB.SYSTEM_CODE) AS SYSTEM_CODE
									--, ISNULL(AA.WORK_ORD_NO, BB.WORK_ORD_NO) AS WORK_ORD_NO
									, ISNULL(AA.FAULTY_REG_DATE, BB.FAULTY_REG_DATE) AS FAULTY_REG_DATE
									, ISNULL(AA.GOODS_CD, BB.GOODS_CD) AS GOODS_CD
									, (CONVERT(INT, ISNULL(AA.FAULTY_COUNT,0)) + CONVERT(INT, ISNULL(BB.FAULTY_COUNT,0))) FAULTY_COUNT
									, ISNULL(AA.DATE, BB.DATE) DATE
								 FROM
									(   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'D' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , COUNT(FAULTY) AS FAULTY_COUNT
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 = ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'D'
											 AND C.GUBUN = '004'
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									) AA
		                                 
									FULL OUTER JOIN 
		                                 
									   (   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'D' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , COUNT(FAULTY_COUNT) AS FAULTY_COUNT
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 != ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'D'
											 AND C.GUBUN = '004'
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									   ) BB
									   ON AA.EQUIP_NM = BB.ETC1
									   AND AA.SYSTEM_CODE = BB.SYSTEM_CODE
									   AND AA.DATE = BB.DATE
									   AND AA.GOODS_CD = BB.GOODS_CD
		      
									WHERE 1=1
									AND (AA.SYSTEM_CODE IS NOT NULL OR  BB.SYSTEM_CODE IS NOT NULL)
									
		
							  ) AS B
				  ON A.EQUIP_CD = B.EQUIP_CD
		            
				  LEFT OUTER JOIN TB_GOODS_CODE_ADM F ON B.GOODS_CD = F.GOODS_CD
				  LEFT OUTER JOIN TB_MATRL_CODE_ADM G ON F.ALNICU_MATRL_CD = G.MATRL_CD
			   GROUP BY 
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.ETC1
				  , A.USE_YN_CD
				  , B.GOODS_CD
				  , GOODS_NM
				  , DAY_NIGHT_CD
				  , FAULTY_REG_DATE
				  , QUTY_CD
				  , SYSTEM_CODE
				  , FAULTY_COUNT
				  , GRAVITY
				  , DATE
			   HAVING A.USE_YN_CD = '001'
			   AND  A.ETC1 = ''
			  
			   UNION ALL
		      
			   SELECT
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.USE_YN_CD
				  , ISNULL(B.GOODS_CD, '') GOODS_CD
				  , ISNULL(F.GOODS_NM, '') GOODS_NM
				  , ISNULL(B.DAY_NIGHT_CD, 'N') DAY_NIGHT_CD
				  , (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = ISNULL(B.DAY_NIGHT_CD, 'N')) DAY_NIGHT_NM
				  , FAULTY_REG_DATE
				  , ISNULL(G.QUTY_CD, '') QUTY_CD
				  , ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = G.QUTY_CD), '') ALNICU_MATRL_NM
				  , ISNULL(B.SYSTEM_CODE, '') SYSTEM_CODE
				  , ISNULL(B.FAULTY_COUNT, '0') FAULTY_COUNT
				  , ISNULL(F.GRAVITY, '1') GRAVITY
				  , DATE
			   FROM TB_EQUIP_CODE_ADM A
				  LEFT OUTER JOIN (   SELECT 
									COALESCE(AA.EQUIP_CD, ( SELECT X.EQUIP_CD FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_CD
									, COALESCE(AA.EQUIP_NM, ( SELECT X.EQUIP_NM FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_NM
									, BB.ETC1
									, ISNULL(AA.DAY_NIGHT_CD, BB.DAY_NIGHT_CD) AS DAY_NIGHT_CD
									, ISNULL(AA.GUBUN, BB.GUBUN) AS GUBUN
									, ISNULL(AA.SYSTEM_CODE, BB.SYSTEM_CODE) AS SYSTEM_CODE
									--, ISNULL(AA.WORK_ORD_NO, BB.WORK_ORD_NO) AS WORK_ORD_NO
									, ISNULL(AA.FAULTY_REG_DATE, BB.FAULTY_REG_DATE) AS FAULTY_REG_DATE
									, ISNULL(AA.GOODS_CD, BB.GOODS_CD) AS GOODS_CD
									, (CONVERT(INT, ISNULL(AA.FAULTY_COUNT,0)) + CONVERT(INT, ISNULL(BB.FAULTY_COUNT,0))) FAULTY_COUNT
									, ISNULL(AA.DATE, BB.DATE) DATE
								 FROM
									(   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'N' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , COUNT(FAULTY) AS FAULTY_COUNT
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 = ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'N'
											 AND C.GUBUN = '004'
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									) AA
		                                 
									FULL OUTER JOIN 
		                                 
									   (   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'N' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , COUNT(FAULTY_COUNT) AS FAULTY_COUNT
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 != ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'N'
											 AND C.GUBUN = '004'
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									   ) BB
									   ON AA.EQUIP_NM = BB.ETC1
									   AND AA.SYSTEM_CODE = BB.SYSTEM_CODE
									   AND AA.DATE = BB.DATE
									   AND AA.GOODS_CD = BB.GOODS_CD
		      
									WHERE 1=1
									AND (AA.SYSTEM_CODE IS NOT NULL OR  BB.SYSTEM_CODE IS NOT NULL)
									
		
							  ) AS B
				  ON A.EQUIP_CD = B.EQUIP_CD
		            
				  LEFT OUTER JOIN TB_GOODS_CODE_ADM F ON B.GOODS_CD = F.GOODS_CD
				  LEFT OUTER JOIN TB_MATRL_CODE_ADM G ON F.ALNICU_MATRL_CD = G.MATRL_CD
			   GROUP BY 
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.ETC1
				  , A.USE_YN_CD
				  , B.GOODS_CD
				  , GOODS_NM
				  , DAY_NIGHT_CD
				  , FAULTY_REG_DATE
				  , QUTY_CD
				  , SYSTEM_CODE
				  , FAULTY_COUNT
				  , GRAVITY
				  , DATE
			   HAVING A.USE_YN_CD = '001'
			   AND  A.ETC1 = ''
			) AS t
			PIVOT (SUM(t.FAULTY_COUNT) FOR t.SYSTEM_CODE IN (${systemCode}))
		
			AS pivot_result
		
			) AS BIG_AAA
		
			ON CAL.EQUIP_CD = BIG_AAA.EQUIP_CD
			AND CAL.DATE = BIG_AAA.ORD_DATE
			AND CAL.DAY_NIGHT_CD = BIG_AAA.ORD_GUBUN
			
		WHERE CAL.USE_YN_CD = '001'
		ORDER BY CAL.DATE, CAL.DAY_NIGHT_CD, CAL.EQUIP_NM
	</select>
	
	<!-- 설비Trouble 통계 리스트 -->
	<select id="readTroubleFaultyListContent" resultType="HashMap">
		SELECT
			CAL.*
			--, ISNULL(EQUIP_CD,'') EQUIP_CD
			--, ISNULL(EQUIP_NM,'') EQUIP_NM
			, ISNULL(GOODS_CD,'') GOODS_CD
			--, ISNULL(DAY_NIGHT_CD,'') ORD_GUBUN
			--, ISNULL(DAY_NIGHT_NM,'') DAY_NIGHT_NM
			, ISNULL(ALNICU_MATRL_NM,'') ALNICU_MATRL_NM
			--, ISNULL(FAULTY_REG_DATE,'') ORD_DATE
			, ISNULL(DATE,'') ORD_DATE
			, ISNULL(GRAVITY,'1') GRAVITY
			, ISNULL(GOODS_NM,'') GOODS_NM
			, ISNULL([001],0) '001'
			, ISNULL([002],0) '002'
			, ISNULL([003],0) '003'
			, ISNULL([004],0) '004'
			, ISNULL([005],0) '005'
			, ISNULL([006],0) '006'
			, ISNULL([007],0) '007'
			, ISNULL([008],0) '008'
			, ISNULL([009],0) '009'
			, ISNULL([010],0) '010'
			, ISNULL([011],0) '011'
			, ISNULL([012],0) '012'
			, ISNULL([013],0) '013'
			, ISNULL([014],0) '014'
			, ISNULL([015],0) '015'
			, ISNULL([016],0) '016'
			, ISNULL([017],0) '017'
			, ISNULL([018],0) '018'
			, ISNULL([019],0) '019'
			, ISNULL([020],0) '020'
			, ISNULL([021],0) '021'
			, ISNULL([022],0) '022'
			, ISNULL([023],0) '023'
			, ISNULL([024],0) '024'
			, ISNULL([025],0) '025'
			, ISNULL([026],0) '026'
			, ISNULL([027],0) '027'
			, ISNULL([028],0) '028'
			, ISNULL([029],0) '029'
			, ISNULL([030],0) '030'
			, ISNULL([031],0) '031'
			, ISNULL([032],0) '032'
			, ISNULL([033],0) '033'
			, ISNULL([034],0) '034'
			, ISNULL([035],0) '035'
			, ISNULL([036],0) '036'
			, ISNULL([037],0) '037'
			, ISNULL([038],0) '038'
			, ISNULL([039],0) '039'
			, ISNULL([040],0) '040'
		FROM
			(SELECT
				B.EQUIP_CD
				, B.EQUIP_NM
				, B.ETC1
				, B.USE_YN_CD
				, TEMP.DAY_NIGHT_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD = '028' AND BASE_CD = TEMP.DAY_NIGHT_CD) DAY_NIGHT_NM
				, CALENDAR.DATE
			FROM TB_EQUIP_CODE_ADM B
			LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
			ON B.EQUIP_NM = D.ETC1
			
			FULL OUTER JOIN
			
			(SELECT DATE FROM CALENDAR
			WHERE 1=1
		<![CDATA[
			AND DATE >= #{faultyDateFrom}
			AND DATE <= #{faultyDateTo}
		]]>
			) CALENDAR
			ON 1=1
				
			FULL OUTER JOIN
			(SELECT 'D' DAY_NIGHT_CD
			UNION
			SELECT 'N' DAY_NIGHT_CD) TEMP
			ON 1=1
				
			WHERE B.ETC1 = ''
			GROUP BY
				B.EQUIP_CD
				, B.EQUIP_NM
				, B.ETC1
				, B.USE_YN_CD
				, CALENDAR.DATE
				, TEMP.DAY_NIGHT_CD
			) CAL
				
			LEFT OUTER JOIN 
		
			(SELECT
				ISNULL(EQUIP_CD,'') EQUIP_CD
				, ISNULL(EQUIP_NM,'') EQUIP_NM
				, ISNULL(GOODS_CD,'') GOODS_CD
				, ISNULL(DAY_NIGHT_CD,'') ORD_GUBUN
				, ISNULL(DAY_NIGHT_NM,'') DAY_NIGHT_NM
				, ISNULL(ALNICU_MATRL_NM,'') ALNICU_MATRL_NM
				--, ISNULL(FAULTY_REG_DATE,'') ORD_DATE
				, ISNULL(DATE,'') ORD_DATE
				, ISNULL(GRAVITY,'') GRAVITY
				, ISNULL(GOODS_NM,'') GOODS_NM
				, ISNULL([001],0) '001'
				, ISNULL([002],0) '002'
				, ISNULL([003],0) '003'
				, ISNULL([004],0) '004'
				, ISNULL([005],0) '005'
				, ISNULL([006],0) '006'
				, ISNULL([007],0) '007'
				, ISNULL([008],0) '008'
				, ISNULL([009],0) '009'
				, ISNULL([010],0) '010'
				, ISNULL([011],0) '011'
				, ISNULL([012],0) '012'
				, ISNULL([013],0) '013'
				, ISNULL([014],0) '014'
				, ISNULL([015],0) '015'
				, ISNULL([016],0) '016'
				, ISNULL([017],0) '017'
				, ISNULL([018],0) '018'
				, ISNULL([019],0) '019'
				, ISNULL([020],0) '020'
				, ISNULL([021],0) '021'
				, ISNULL([022],0) '022'
				, ISNULL([023],0) '023'
				, ISNULL([024],0) '024'
				, ISNULL([025],0) '025'
				, ISNULL([026],0) '026'
				, ISNULL([027],0) '027'
				, ISNULL([028],0) '028'
				, ISNULL([029],0) '029'
				, ISNULL([030],0) '030'
				, ISNULL([031],0) '031'
				, ISNULL([032],0) '032'
				, ISNULL([033],0) '033'
				, ISNULL([034],0) '034'
				, ISNULL([035],0) '035'
				, ISNULL([036],0) '036'
				, ISNULL([037],0) '037'
				, ISNULL([038],0) '038'
				, ISNULL([039],0) '039'
				, ISNULL([040],0) '040'
			FROM (
				SELECT
					A.EQUIP_CD
					, A.EQUIP_NM
					, A.USE_YN_CD
					, ISNULL(B.GOODS_CD, '') GOODS_CD
					, ISNULL(F.GOODS_NM, '') GOODS_NM
					, ISNULL(B.DAY_NIGHT_CD, 'D') DAY_NIGHT_CD
					, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = ISNULL(B.DAY_NIGHT_CD, 'D')) DAY_NIGHT_NM
					, ISNULL(B.FAULTY_REG_DATE, '') FAULTY_REG_DATE
					, ISNULL(G.QUTY_CD, '') QUTY_CD
					, ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = G.QUTY_CD), '') ALNICU_MATRL_NM
					, ISNULL(B.SYSTEM_CODE, '') SYSTEM_CODE
					, ISNULL(F.GRAVITY, '1') GRAVITY
					, B.FAULTY_DESC
					, DATE
				FROM TB_EQUIP_CODE_ADM A
					LEFT OUTER JOIN(	SELECT 
											COALESCE(AA.EQUIP_CD, ( SELECT X.EQUIP_CD FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_CD
											, COALESCE(AA.EQUIP_NM, ( SELECT X.EQUIP_NM FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_NM
											, ISNULL(AA.DAY_NIGHT_CD, BB.DAY_NIGHT_CD) AS DAY_NIGHT_CD
											, ISNULL(AA.GUBUN, BB.GUBUN) AS GUBUN
											, ISNULL(AA.SYSTEM_CODE, BB.SYSTEM_CODE) AS SYSTEM_CODE
											--, ISNULL(AA.WORK_ORD_NO, BB.WORK_ORD_NO) AS WORK_ORD_NO
											, ISNULL(AA.GOODS_CD, BB.GOODS_CD) AS GOODS_CD
											, (	ISNULL('원호기 ' +AA.EQUIP_NM+ ': ', '') + ISNULL(AA.FAULTY_DESC,'')
												+ CASE WHEN AA.EQUIP_NM IS NULL OR  AA.EQUIP_NM = '' THEN '' ELSE CHAR(13) + CHAR(10) END
												+ ISNULL('가상호기 ' +BB.STRING_ATTACHED,'')
												) AS FAULTY_DESC
											, ISNULL(AA.FAULTY_REG_DATE, BB.FAULTY_REG_DATE) AS FAULTY_REG_DATE
											, ISNULL(AA.DATE, BB.DATE) DATE
										FROM
											(	SELECT A.EQUIP_CD
													, A.EQUIP_NM
													, A.ETC1
													, 'D' DAY_NIGHT_CD
													, GUBUN
													, SYSTEM_CODE
													, FAULTY_DESC
													--, C.WORK_ORD_NO
													, D.GOODS_CD
													, FAULTY_REG_DATE
													, A.DATE
												FROM (
														(	SELECT B.EQUIP_CD
																, B.EQUIP_NM
																, B.ETC1
																, CALENDAR.DATE
															FROM TB_EQUIP_CODE_ADM B									
															LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
															ON B.EQUIP_NM = D.ETC1
		
															FULL OUTER JOIN
															(SELECT DATE FROM CALENDAR
															WHERE 1=1
														<![CDATA[
															AND DATE >= #{faultyDateFrom}
															AND DATE <= #{faultyDateTo}
														]]>
															) CALENDAR
															ON 1=1
		
															WHERE B.ETC1 = ''
															GROUP BY
																B.EQUIP_CD
																, B.EQUIP_NM
																, B.ETC1
																, CALENDAR.DATE
														) A
														LEFT OUTER JOIN
															TB_ALL_FAULTY_ADM C
														ON  A.EQUIP_CD = C.EQUIP_CD
														AND C.DAY_NIGHT_CD = 'D'
														AND C.GUBUN = '004'
													<![CDATA[
														AND FAULTY_REG_DATE >= #{faultyDateFrom}
														AND FAULTY_REG_DATE <= #{faultyDateTo}
													]]>
														AND FAULTY_REG_DATE = A.DATE
		
														LEFT OUTER JOIN
															TB_WORK_ORDER D
														ON C.EQUIP_CD = D.EQUIP_CD
														AND C.WORK_ORD_NO = D.WORK_ORD_NO
		
													)
													GROUP BY
														A.EQUIP_CD
														, A.EQUIP_NM
														, A.ETC1
														, DAY_NIGHT_CD
														, GUBUN
														, SYSTEM_CODE
														, FAULTY_DESC
														--, C.WORK_ORD_NO
														, D.GOODS_CD
														, FAULTY_REG_DATE
														, A.DATE
											) AA
																			
											LEFT OUTER JOIN 
																			
												(	SELECT A.EQUIP_CD
													, A.EQUIP_NM
													, A.ETC1
													, 'D' DAY_NIGHT_CD
													, GUBUN
													, SYSTEM_CODE
													, FAULTY_DESC
													, STRING_AGG(EQUIP_NM +': '+ FAULTY_DESC, ', ') AS STRING_ATTACHED
													--, C.WORK_ORD_NO
													, D.GOODS_CD
													, FAULTY_REG_DATE
													, A.DATE
												FROM (
														(	SELECT B.EQUIP_CD
																, B.EQUIP_NM
																, B.ETC1
																, CALENDAR.DATE
															FROM TB_EQUIP_CODE_ADM B									
															LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
															ON B.EQUIP_NM = D.ETC1
		
															FULL OUTER JOIN
															(SELECT DATE FROM CALENDAR
															WHERE 1=1
														<![CDATA[
															AND DATE >= #{faultyDateFrom}
															AND DATE <= #{faultyDateTo}
														]]>
															) CALENDAR
															ON 1=1
		
															WHERE B.ETC1 != ''
															GROUP BY
																B.EQUIP_CD
																, B.EQUIP_NM
																, B.ETC1
																, CALENDAR.DATE
														) A
														LEFT OUTER JOIN
															TB_ALL_FAULTY_ADM C
														ON  A.EQUIP_CD = C.EQUIP_CD
														AND C.DAY_NIGHT_CD = 'D'
														AND C.GUBUN = '004'
													<![CDATA[
														AND FAULTY_REG_DATE >= #{faultyDateFrom}
														AND FAULTY_REG_DATE <= #{faultyDateTo}
													]]>
														AND FAULTY_REG_DATE = A.DATE
		
														LEFT OUTER JOIN
															TB_WORK_ORDER D
														ON C.EQUIP_CD = D.EQUIP_CD
														AND C.WORK_ORD_NO = D.WORK_ORD_NO
		
													)
													GROUP BY
														A.EQUIP_CD
														, A.EQUIP_NM
														, A.ETC1
														, DAY_NIGHT_CD
														, GUBUN
														, SYSTEM_CODE
														, FAULTY_DESC
														--, C.WORK_ORD_NO
														, D.GOODS_CD
														, FAULTY_REG_DATE
														, A.DATE
												) BB
												ON AA.EQUIP_NM = BB.ETC1
												--AND AA.SYSTEM_CODE = BB.SYSTEM_CODE
												AND AA.DATE = BB.DATE
												--AND AA.GOODS_CD = BB.GOODS_CD
		
											WHERE 1=1 	
											--AND (AA.SYSTEM_CODE IS NOT NULL OR  BB.SYSTEM_CODE IS NOT NULL)
				) B
				ON A.EQUIP_CD = B.EQUIP_CD
		
					LEFT OUTER JOIN TB_GOODS_CODE_ADM F ON B.GOODS_CD = F.GOODS_CD
					LEFT OUTER JOIN TB_MATRL_CODE_ADM G ON F.ALNICU_MATRL_CD = G.MATRL_CD
				GROUP BY
					A.EQUIP_CD
					, A.EQUIP_NM
					, A.ETC1
					, A.USE_YN_CD
					, B.GOODS_CD
					, GOODS_NM
					, DAY_NIGHT_CD
					, FAULTY_REG_DATE
					, QUTY_CD
					,  SYSTEM_CODE
						, GRAVITY
						, FAULTY_DESC
						, DATE
				HAVING A.USE_YN_CD = '001'
				AND A.ETC1 = ''
		
				UNION ALL
		
				SELECT
					A.EQUIP_CD
					, A.EQUIP_NM
					, A.USE_YN_CD
					, ISNULL(B.GOODS_CD, '') GOODS_CD
					, ISNULL(F.GOODS_NM, '') GOODS_NM
					, ISNULL(B.DAY_NIGHT_CD, 'N') DAY_NIGHT_CD
					, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = ISNULL(B.DAY_NIGHT_CD, 'N')) DAY_NIGHT_NM
					, ISNULL(B.FAULTY_REG_DATE, '') FAULTY_REG_DATE
					, ISNULL(G.QUTY_CD, '') QUTY_CD
					, ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = G.QUTY_CD), '') ALNICU_MATRL_NM
					, ISNULL(B.SYSTEM_CODE, '') SYSTEM_CODE
					, ISNULL(F.GRAVITY, '1') GRAVITY
					, B.FAULTY_DESC
					, DATE
				FROM TB_EQUIP_CODE_ADM A
					LEFT OUTER JOIN(	SELECT 
											COALESCE(AA.EQUIP_CD, ( SELECT X.EQUIP_CD FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_CD
											, COALESCE(AA.EQUIP_NM, ( SELECT X.EQUIP_NM FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_NM
											, ISNULL(AA.DAY_NIGHT_CD, BB.DAY_NIGHT_CD) AS DAY_NIGHT_CD
											, ISNULL(AA.GUBUN, BB.GUBUN) AS GUBUN
											, ISNULL(AA.SYSTEM_CODE, BB.SYSTEM_CODE) AS SYSTEM_CODE
											--, ISNULL(AA.WORK_ORD_NO, BB.WORK_ORD_NO) AS WORK_ORD_NO
											, ISNULL(AA.GOODS_CD, BB.GOODS_CD) AS GOODS_CD
											, (	ISNULL('원호기 ' +AA.EQUIP_NM+ ': ', '') + ISNULL(AA.FAULTY_DESC,'')
												+ CASE WHEN AA.EQUIP_NM IS NULL OR  AA.EQUIP_NM = '' THEN '' ELSE CHAR(13) + CHAR(10) END
												+ ISNULL('가상호기 ' +BB.STRING_ATTACHED,'')
												) AS FAULTY_DESC
											, ISNULL(AA.FAULTY_REG_DATE, BB.FAULTY_REG_DATE) AS FAULTY_REG_DATE
											, ISNULL(AA.DATE, BB.DATE) DATE
										FROM
											(	SELECT A.EQUIP_CD
													, A.EQUIP_NM
													, A.ETC1
													, 'N' DAY_NIGHT_CD
													, GUBUN
													, SYSTEM_CODE
													, FAULTY_DESC
													--, C.WORK_ORD_NO
													, D.GOODS_CD
													, FAULTY_REG_DATE
													, A.DATE
												FROM (
														(	SELECT B.EQUIP_CD
																, B.EQUIP_NM
																, B.ETC1
																, CALENDAR.DATE
															FROM TB_EQUIP_CODE_ADM B									
															LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
															ON B.EQUIP_NM = D.ETC1
		
															FULL OUTER JOIN
															(SELECT DATE FROM CALENDAR
															WHERE 1=1
														<![CDATA[
															AND DATE >= #{faultyDateFrom}
															AND DATE <= #{faultyDateTo}
														]]>
															) CALENDAR
															ON 1=1
		
															WHERE B.ETC1 = ''
															GROUP BY
																B.EQUIP_CD
																, B.EQUIP_NM
																, B.ETC1
																, CALENDAR.DATE
														) A
														LEFT OUTER JOIN
															TB_ALL_FAULTY_ADM C
														ON  A.EQUIP_CD = C.EQUIP_CD
														AND C.DAY_NIGHT_CD = 'N'
														AND C.GUBUN = '004'
													<![CDATA[
														AND FAULTY_REG_DATE >= #{faultyDateFrom}
														AND FAULTY_REG_DATE <= #{faultyDateTo}
													]]>
														AND FAULTY_REG_DATE = A.DATE
		
														LEFT OUTER JOIN
															TB_WORK_ORDER D
														ON C.EQUIP_CD = D.EQUIP_CD
														AND C.WORK_ORD_NO = D.WORK_ORD_NO
		
													)
													GROUP BY
														A.EQUIP_CD
														, A.EQUIP_NM
														, A.ETC1
														, DAY_NIGHT_CD
														, GUBUN
														, SYSTEM_CODE
														, FAULTY_DESC
														--, C.WORK_ORD_NO
														, D.GOODS_CD
														, FAULTY_REG_DATE
														, A.DATE
											) AA
																			
											LEFT OUTER JOIN 
																			
												(SELECT
													A.EQUIP_CD
													, A.EQUIP_NM
													, A.ETC1
													, 'D' DAY_NIGHT_CD
													, GUBUN
													, SYSTEM_CODE
													, FAULTY_DESC
													, STRING_AGG(EQUIP_NM +': '+ FAULTY_DESC, ', ') AS STRING_ATTACHED
													--, C.WORK_ORD_NO
													, D.GOODS_CD
													, FAULTY_REG_DATE
													, A.DATE
												FROM (
														(	SELECT B.EQUIP_CD
																, B.EQUIP_NM
																, B.ETC1
																, CALENDAR.DATE
															FROM TB_EQUIP_CODE_ADM B									
															LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
															ON B.EQUIP_NM = D.ETC1
		
															FULL OUTER JOIN
															(SELECT DATE FROM CALENDAR
															WHERE 1=1
														<![CDATA[
															AND DATE >= #{faultyDateFrom}
															AND DATE <= #{faultyDateTo}
														]]>
															) CALENDAR
															ON 1=1
		
															WHERE B.ETC1 != ''
															GROUP BY
																B.EQUIP_CD
																, B.EQUIP_NM
																, B.ETC1
																, CALENDAR.DATE
														) A
														LEFT OUTER JOIN
															TB_ALL_FAULTY_ADM C
														ON  A.EQUIP_CD = C.EQUIP_CD
														AND C.DAY_NIGHT_CD = 'N'
														AND C.GUBUN = '004'
													<![CDATA[
														AND FAULTY_REG_DATE >= #{faultyDateFrom}
														AND FAULTY_REG_DATE <= #{faultyDateTo}
													]]>
														AND FAULTY_REG_DATE = A.DATE
		
														LEFT OUTER JOIN
															TB_WORK_ORDER D
														ON C.EQUIP_CD = D.EQUIP_CD
														AND C.WORK_ORD_NO = D.WORK_ORD_NO
		
													)
													GROUP BY
														A.EQUIP_CD
														, A.EQUIP_NM
														, A.ETC1
														, DAY_NIGHT_CD
														, GUBUN
														, SYSTEM_CODE
														, FAULTY_DESC
														--, C.WORK_ORD_NO
														, D.GOODS_CD
														, FAULTY_REG_DATE
														, A.DATE
												) BB
												ON AA.EQUIP_NM = BB.ETC1
												--AND AA.SYSTEM_CODE = BB.SYSTEM_CODE
												AND AA.DATE = BB.DATE
												--AND AA.GOODS_CD = BB.GOODS_CD
													
											WHERE 1=1
											--AND (AA.SYSTEM_CODE IS NOT NULL OR  BB.SYSTEM_CODE IS NOT NULL)
				) B
				ON A.EQUIP_CD = B.EQUIP_CD
		
					LEFT OUTER JOIN TB_GOODS_CODE_ADM F ON B.GOODS_CD = F.GOODS_CD
					LEFT OUTER JOIN TB_MATRL_CODE_ADM G ON F.ALNICU_MATRL_CD = G.MATRL_CD
				GROUP BY
					A.EQUIP_CD
					, A.EQUIP_NM
					, A.ETC1
					, A.USE_YN_CD
					, B.GOODS_CD
					, GOODS_NM
					, DAY_NIGHT_CD
					, FAULTY_REG_DATE
					, QUTY_CD
					,  SYSTEM_CODE
						, GRAVITY
						, FAULTY_DESC
						, DATE
				HAVING A.USE_YN_CD = '001'
				AND A.ETC1 = ''
		
				) AS t
					
				PIVOT (MAX(t.FAULTY_DESC)
					FOR t.SYSTEM_CODE IN (${systemCode})
					) AS pivot_result
	
			) AS BIG_AAA
			
			ON CAL.EQUIP_CD = BIG_AAA.EQUIP_CD
			AND CAL.DATE = BIG_AAA.ORD_DATE
			AND CAL.DAY_NIGHT_CD = BIG_AAA.ORD_GUBUN
			
		WHERE CAL.USE_YN_CD = '001'
		ORDER BY CAL.DATE, CAL.DAY_NIGHT_CD, CAL.EQUIP_NM
	</select>
	
	<select id="readFaultyQty" resultMap="FaultyQtyVo">
			<!-- SELECT
				AA.EQUIP_CD
				, AA.EQUIP_NM
				, AA.ORD_DATE
				, AA.ORD_GUBUN
				, BB.GOODS_CD
				, BB.GOODS_NM
				, BB.QUTY_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE E WHERE E.BASE_GROUP_CD = '007' AND BASE_CD = BB.QUTY_CD) QUTY_NM
				, BB.MAIN_FAULTY_QTY
				, BB.SUB_FAULTY_QTY
				, BB.WORK_TEAM_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE E WHERE E.BASE_GROUP_CD = '016' AND BASE_CD = BB.WORK_TEAM_CD) WORK_TEAM_NM
				, BB.MAIN_WORK_CHARGR
				, (SELECT USER_NM FROM TB_USER WHERE USER_NUMBER = BB.MAIN_WORK_CHARGR) USER_NM
			FROM
			(SELECT A.EQUIP_CD, A.EQUIP_NM, B.ORD_DATE, B.ORD_GUBUN FROM TB_EQUIP_CODE_ADM A
			LEFT OUTER JOIN
			(SELECT EQUIP_CD, EQUIP_NM, 'D' ORD_GUBUN, #{faultyDateTo} ORD_DATE FROM TB_EQUIP_CODE_ADM WHERE USE_YN_CD = '001'
			UNION
			SELECT EQUIP_CD, EQUIP_NM, 'N' ORD_GUBUN, #{faultyDateTo} ORD_DATE FROM TB_EQUIP_CODE_ADM WHERE USE_YN_CD = '001') B
			ON A.EQUIP_CD = B.EQUIP_CD) AA LEFT OUTER JOIN
			(
				SELECT
					AAA.ORD_DATE
					, AAA.EQUIP_CD
					, AAA.ORD_GUBUN
					, AAA.GOODS_CD
					, AAA.GOODS_NM
					, AAA.QUTY_CD
					, AAA.WORK_TEAM_CD
					, AAA.MAIN_WORK_CHARGR
					, AAA.FAULTY_QTY AS MAIN_FAULTY_QTY
					, BBB.FAULTY_QTY AS SUB_FAULTY_QTY
				FROM 
					(SELECT
						C.ORD_DATE
						, C.EQUIP_CD
						, C.ORD_GUBUN
						, MAX(C.GOODS_CD) GOODS_CD
						, MAX(G.GOODS_NM) GOODS_NM
						, MAX(E.QUTY_CD) QUTY_CD
						, SUM(CONVERT(FLOAT, D.FAULTY_QTY)) FAULTY_QTY
						, MAX(C.WORK_TEAM_CD) WORK_TEAM_CD
						, MAX(C.MAIN_WORK_CHARGR) MAIN_WORK_CHARGR
					FROM
						TB_WORK_ORDER C
						, TB_WORK_ORDER_DTL D
						, TB_MATRL_CODE_ADM E
						, (SELECT BASE_CD FROM TB_SYSTEM_COMMON_CODE E WHERE E.BASE_GROUP_CD = '007' AND BASE_CD_ABBR IN ('A', 'N')) F
						, TB_GOODS_CODE_ADM G
					WHERE C.WORK_ORD_NO = D.WORK_ORD_NO AND E.MATRL_CD = D.MATRL_CD AND E.QUTY_CD = F.BASE_CD AND C.ORD_DATE = #{faultyDateTo} AND G.GOODS_CD = C.GOODS_CD
					GROUP BY C.ORD_DATE, C.EQUIP_CD, C.ORD_GUBUN) AAA
					, (SELECT
							C.ORD_DATE
							, C.EQUIP_CD
							, C.ORD_GUBUN
							, MAX(C.GOODS_CD) GOODS_CD
							, MAX(G.GOODS_NM) GOODS_NM
							, MAX(E.QUTY_CD) QUTY_CD
							, SUM(CONVERT(FLOAT, D.FAULTY_QTY)) FAULTY_QTY
							, MAX(C.WORK_TEAM_CD) WORK_TEAM_CD
							, MAX(C.MAIN_WORK_CHARGR) MAIN_WORK_CHARGR
						FROM TB_WORK_ORDER C
							, TB_WORK_ORDER_DTL D
							, TB_MATRL_CODE_ADM E
							, (SELECT BASE_CD FROM TB_SYSTEM_COMMON_CODE E WHERE E.BASE_GROUP_CD = '007' AND BASE_CD_ABBR NOT IN ('A', 'N')) F
							, TB_GOODS_CODE_ADM G
						WHERE C.WORK_ORD_NO = D.WORK_ORD_NO
						AND E.MATRL_CD = D.MATRL_CD
						AND E.QUTY_CD = F.BASE_CD
						AND C.ORD_DATE = #{faultyDateTo}
						AND G.GOODS_CD = C.GOODS_CD
						GROUP BY C.ORD_DATE, C.EQUIP_CD, C.ORD_GUBUN) BBB
				WHERE AAA.ORD_DATE = BBB.ORD_DATE
				AND AAA.EQUIP_CD = BBB.EQUIP_CD
				AND AAA.ORD_GUBUN = BBB.ORD_GUBUN
				) BB
			ON AA.EQUIP_CD = BB.EQUIP_CD
			AND AA.ORD_GUBUN = BB.ORD_GUBUN
			AND AA.ORD_DATE = BB.ORD_DATE
		WHERE AA.ORD_DATE IS NOT NULL
		ORDER BY ORD_GUBUN, EQUIP_NM -->
		<![CDATA[
		SELECT
				AA.EQUIP_CD
				, AA.EQUIP_NM
				, BB.ORD_DATE
				, AA.ORD_GUBUN
				, BB.GOODS_CD
				, BB.GOODS_NM
				, BB.QUTY_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE E WHERE E.BASE_GROUP_CD = '007' AND BASE_CD = BB.QUTY_CD) QUTY_NM
				, BB.MAIN_FAULTY_QTY
				, BB.SUB_FAULTY_QTY
				, BB.WORK_TEAM_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE E WHERE E.BASE_GROUP_CD = '016' AND BASE_CD = BB.WORK_TEAM_CD) WORK_TEAM_NM
				, BB.MAIN_WORK_CHARGR
				, (SELECT USER_NM FROM TB_USER WHERE USER_NUMBER = BB.MAIN_WORK_CHARGR) USER_NM
			FROM
			(SELECT A.EQUIP_CD, A.EQUIP_NM, B.ORD_GUBUN FROM TB_EQUIP_CODE_ADM A
			LEFT OUTER JOIN
			(SELECT EQUIP_CD, EQUIP_NM, 'D' ORD_GUBUN FROM TB_EQUIP_CODE_ADM WHERE USE_YN_CD = '001'
			UNION
			SELECT EQUIP_CD, EQUIP_NM, 'N' ORD_GUBUN FROM TB_EQUIP_CODE_ADM WHERE USE_YN_CD = '001') B
			ON A.EQUIP_CD = B.EQUIP_CD) AA,
			(
				SELECT
					AAA.ORD_DATE
					, AAA.EQUIP_CD
					, AAA.ORD_GUBUN
					, AAA.GOODS_CD
					, AAA.GOODS_NM
					, AAA.QUTY_CD
					, AAA.WORK_TEAM_CD
					, AAA.MAIN_WORK_CHARGR
					, AAA.FAULTY_QTY AS MAIN_FAULTY_QTY
					, BBB.FAULTY_QTY AS SUB_FAULTY_QTY
				FROM 
					(SELECT
						C.ORD_DATE
						, C.EQUIP_CD
						, C.ORD_GUBUN
						, MAX(C.GOODS_CD) GOODS_CD
						, MAX(G.GOODS_NM) GOODS_NM
						, MAX(E.QUTY_CD) QUTY_CD
						, SUM(CONVERT(FLOAT, D.FAULTY_QTY)) FAULTY_QTY
						, MAX(C.WORK_TEAM_CD) WORK_TEAM_CD
						, MAX(C.MAIN_WORK_CHARGR) MAIN_WORK_CHARGR
					FROM
						TB_WORK_ORDER C
						, TB_WORK_ORDER_DTL D
						, TB_MATRL_CODE_ADM E
						, (SELECT BASE_CD FROM TB_SYSTEM_COMMON_CODE E WHERE E.BASE_GROUP_CD = '007' AND BASE_CD_ABBR IN ('A', 'N')) F
						, TB_GOODS_CODE_ADM G
					WHERE C.WORK_ORD_NO = D.WORK_ORD_NO 
					AND E.MATRL_CD = D.MATRL_CD 
					AND E.QUTY_CD = F.BASE_CD 
					AND C.ORD_DATE >= #{faultyDateFrom}
					AND C.ORD_DATE <= #{faultyDateTo}
					AND G.GOODS_CD = C.GOODS_CD
					GROUP BY C.ORD_DATE, C.EQUIP_CD, C.ORD_GUBUN) AAA
					, (SELECT
							C.ORD_DATE
							, C.EQUIP_CD
							, C.ORD_GUBUN
							, MAX(C.GOODS_CD) GOODS_CD
							, MAX(G.GOODS_NM) GOODS_NM
							, MAX(E.QUTY_CD) QUTY_CD
							, SUM(CONVERT(FLOAT, D.FAULTY_QTY)) FAULTY_QTY
							, MAX(C.WORK_TEAM_CD) WORK_TEAM_CD
							, MAX(C.MAIN_WORK_CHARGR) MAIN_WORK_CHARGR
						FROM TB_WORK_ORDER C
							, TB_WORK_ORDER_DTL D
							, TB_MATRL_CODE_ADM E
							, (SELECT BASE_CD FROM TB_SYSTEM_COMMON_CODE E WHERE E.BASE_GROUP_CD = '007' AND BASE_CD_ABBR NOT IN ('A', 'N')) F
							, TB_GOODS_CODE_ADM G
						WHERE C.WORK_ORD_NO = D.WORK_ORD_NO
						AND E.MATRL_CD = D.MATRL_CD
						AND E.QUTY_CD = F.BASE_CD
						
						AND C.ORD_DATE >= #{faultyDateFrom}
						AND C.ORD_DATE <= #{faultyDateTo}
						
						AND G.GOODS_CD = C.GOODS_CD
						GROUP BY C.ORD_DATE, C.EQUIP_CD, C.ORD_GUBUN) BBB
				WHERE AAA.ORD_DATE = BBB.ORD_DATE
				AND AAA.EQUIP_CD = BBB.EQUIP_CD
				AND AAA.ORD_GUBUN = BBB.ORD_GUBUN
				) BB
			WHERE AA.EQUIP_CD = BB.EQUIP_CD
			AND AA.ORD_GUBUN = BB.ORD_GUBUN
			
		 
		ORDER BY ORD_DATE,ORD_GUBUN, EQUIP_NM
		]]>
	</select>
	
	<!-- 생산실적 입력기준 주재료로 변경 후 귄취중량(주야 구분 삭제) -->
	<select id="readFaultyQtyNotOrdGubun" resultMap="FaultyQtyVo">
		SELECT
			AA.EQUIP_CD
			, AA.EQUIP_NM
			, BB.ORD_DATE
			, AA.ORD_GUBUN
			, BB.GOODS_CD
			, BB.GOODS_NM
			, BB.QUTY_CD
			, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE E WHERE E.BASE_GROUP_CD = '007' AND BASE_CD = BB.QUTY_CD) QUTY_NM
			, BB.MAIN_FAULTY_QTY
			, BB.SUB_FAULTY_QTY
			<!-- , BB.WORK_TEAM_CD
			, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE E WHERE E.BASE_GROUP_CD = '016' AND BASE_CD = BB.WORK_TEAM_CD) WORK_TEAM_NM -->
			, (	SELECT
					STRING_AGG(BASE_CD_NM, ', ')
				FROM ( 
					SELECT
						DISTINCT Z.BASE_CD_NM
					FROM TB_WORK_ORDER X, TB_SYSTEM_COMMON_CODE Z
					WHERE 1=1
					AND Z.BASE_GROUP_CD = '016'
					AND X.EQUIP_CD = BB.EQUIP_CD
					AND X.ORD_DATE = BB.ORD_DATE
					AND X.ORD_GUBUN = BB.ORD_GUBUN
					AND X.WORK_TEAM_CD = Z.BASE_CD
				) A
			) AS WORK_TEAM_NM
			
			<!-- <if test="factoryCode == 003">
				,(	SELECT
						STRING_AGG(USER_NM, ', ')
					FROM (	SELECT
								DISTINCT Z.USER_NM
							FROM   TB_WORKER_CHANGE X, TB_USER Z
							WHERE  1 = 1
	                        AND X.EQUIP_CD = BB.EQUIP_CD
	                        AND X.ORD_DATE = BB.ORD_DATE
							AND Z.USER_NUMBER = X.WORKER_ID
					) A
				) AS USER_NM
			</if>  -->
			
			
			, BB.MAIN_WORK_CHARGR
			, (SELECT USER_NM FROM TB_USER WHERE USER_NUMBER = BB.MAIN_WORK_CHARGR) USER_NM
		FROM
		
		<!-- 변경됨 -->
		<if test="factoryCode == 001 or factoryCode == 002">
			(
				SELECT A.EQUIP_CD, A.EQUIP_NM, B.ORD_GUBUN FROM TB_EQUIP_CODE_ADM A
				LEFT OUTER JOIN 
				(	SELECT EQUIP_CD, EQUIP_NM, 'D' ORD_GUBUN FROM TB_EQUIP_CODE_ADM WHERE USE_YN_CD = '001'
					UNION
					SELECT EQUIP_CD, EQUIP_NM, 'N' ORD_GUBUN FROM TB_EQUIP_CODE_ADM WHERE USE_YN_CD = '001'
				) B
				ON A.EQUIP_CD = B.EQUIP_CD
			) AA
		</if>
		
		<if test="factoryCode == 003">
			(
				SELECT A.EQUIP_CD, A.EQUIP_NM, B.ORD_GUBUN FROM TB_EQUIP_CODE_ADM A
				LEFT OUTER JOIN
				(	
					SELECT EQUIP_CD, EQUIP_NM, '' ORD_GUBUN FROM TB_EQUIP_CODE_ADM WHERE USE_YN_CD = '001'
				) B
				ON A.EQUIP_CD = B.EQUIP_CD
			) AA
		</if>
		
		LEFT OUTER JOIN
		(
			SELECT
				AAA.ORD_DATE
				, AAA.EQUIP_CD
				, AAA.ORD_GUBUN
				, AAA.GOODS_CD
				, AAA.GOODS_NM
				, AAA.QUTY_CD
				, AAA.WORK_TEAM_CD
				, AAA.MAIN_WORK_CHARGR
				, AAA.FAULTY_QTY AS MAIN_FAULTY_QTY
				, BBB.FAULTY_QTY AS SUB_FAULTY_QTY
			FROM 
				(SELECT
					C.ORD_DATE
					, C.EQUIP_CD
					, C.ORD_GUBUN
					, MAX(C.GOODS_CD) GOODS_CD
					, MAX(G.GOODS_NM) GOODS_NM
					, MAX(E.QUTY_CD) QUTY_CD
					, SUM(CONVERT(FLOAT, D.FAULTY_QTY)) FAULTY_QTY
					, MAX(C.WORK_TEAM_CD) WORK_TEAM_CD
					, MAX(C.MAIN_WORK_CHARGR) MAIN_WORK_CHARGR
				FROM
					TB_WORK_ORDER C
					, TB_WORK_ORDER_DTL D
					, TB_MATRL_CODE_ADM E
					, (SELECT BASE_CD FROM TB_SYSTEM_COMMON_CODE E WHERE E.BASE_GROUP_CD = '007' AND BASE_CD_ABBR IN ('A', 'N')) F
					, TB_GOODS_CODE_ADM G
				WHERE C.WORK_ORD_NO = D.WORK_ORD_NO 
				AND E.MATRL_CD = D.MATRL_CD 
				AND E.QUTY_CD = F.BASE_CD 
				<![CDATA[
					AND C.ORD_DATE >= #{faultyDateFrom}
					AND C.ORD_DATE <= #{faultyDateTo}
				]]>
				AND G.GOODS_CD = C.GOODS_CD
				GROUP BY C.ORD_DATE, C.EQUIP_CD, C.ORD_GUBUN) AAA
				, (SELECT
						C.ORD_DATE
						, C.EQUIP_CD
						, C.ORD_GUBUN
						, MAX(C.GOODS_CD) GOODS_CD
						, MAX(G.GOODS_NM) GOODS_NM
						, MAX(E.QUTY_CD) QUTY_CD
						, SUM(CONVERT(FLOAT, D.FAULTY_QTY)) FAULTY_QTY
						, MAX(C.WORK_TEAM_CD) WORK_TEAM_CD
						, MAX(C.MAIN_WORK_CHARGR) MAIN_WORK_CHARGR
					FROM TB_WORK_ORDER C
						, TB_WORK_ORDER_DTL D
						, TB_MATRL_CODE_ADM E
						, (SELECT BASE_CD FROM TB_SYSTEM_COMMON_CODE E WHERE E.BASE_GROUP_CD = '007' AND BASE_CD_ABBR NOT IN ('A', 'N')) F
						, TB_GOODS_CODE_ADM G
					WHERE C.WORK_ORD_NO = D.WORK_ORD_NO
					AND E.MATRL_CD = D.MATRL_CD
					AND E.QUTY_CD = F.BASE_CD
					<![CDATA[
					AND C.ORD_DATE >= #{faultyDateFrom}
					AND C.ORD_DATE <= #{faultyDateTo}
					]]>
					AND G.GOODS_CD = C.GOODS_CD
					GROUP BY C.ORD_DATE, C.EQUIP_CD, C.ORD_GUBUN) BBB
			WHERE 1=1
			AND AAA.ORD_DATE = BBB.ORD_DATE
			AND AAA.EQUIP_CD = BBB.EQUIP_CD
			<if test="factoryCode == 001 or factoryCode == 002">
				AND AAA.ORD_GUBUN = BBB.ORD_GUBUN		<!-- 추가 됨 -->
			</if>
			
		) BB
		ON AA.EQUIP_CD = BB.EQUIP_CD
		
		
		<if test="factoryCode == 001 or factoryCode == 002">
			AND AA.ORD_GUBUN = BB.ORD_GUBUN				<!-- 추가 됨 -->
		</if>
		
		WHERE 1=1
		AND BB.ORD_DATE IS NOT NULL
		ORDER BY ORD_DATE, ORD_GUBUN, EQUIP_NM
	</select>
	
	<!-- __________________________________________wmsc0080__________________________________________ -->
	
	
	
	
	
	
	
	
	
	<!-- __________________________________________wmsc3080__________________________________________ -->
	<!-- 공정불량 통계 리스트 kg-->
	<select id="faultyIntegratedListKg"  resultType="HashMap" >
		SELECT
			CAL.*
			--, ISNULL(EQUIP_CD,'') EQUIP_CD
			--, ISNULL(EQUIP_NM,'') EQUIP_NM
			, ISNULL(GOODS_CD,'') GOODS_CD
			--, ISNULL(DAY_NIGHT_CD,'') ORD_GUBUN
			--, ISNULL(DAY_NIGHT_NM,'') DAY_NIGHT_NM
			, ISNULL(ALNICU_MATRL_NM,'') ALNICU_MATRL_NM
			--, ISNULL(FAULTY_REG_DATE,'') ORD_DATE
			, ISNULL(DATE,'') ORD_DATE
			, ISNULL(GRAVITY,'1') GRAVITY
			, ISNULL(GOODS_NM,'') GOODS_NM
			, ISNULL([001],0) '001'
			, ISNULL([002],0) '002'
			, ISNULL([003],0) '003'
			, ISNULL([004],0) '004'
			, ISNULL([005],0) '005'
			, ISNULL([006],0) '006'
			, ISNULL([007],0) '007'
			, ISNULL([008],0) '008'
			, ISNULL([009],0) '009'
			, ISNULL([010],0) '010'
			, ISNULL([011],0) '011'
			, ISNULL([012],0) '012'
			, ISNULL([013],0) '013'
			, ISNULL([014],0) '014'
			, ISNULL([015],0) '015'
			, ISNULL([016],0) '016'
			, ISNULL([017],0) '017'
			, ISNULL([018],0) '018'
			, ISNULL([019],0) '019'
			, ISNULL([020],0) '020'
			, ISNULL([021],0) '021'
			, ISNULL([022],0) '022'
			, ISNULL([023],0) '023'
			, ISNULL([024],0) '024'
			, ISNULL([025],0) '025'
			, ISNULL([026],0) '026'
			, ISNULL([027],0) '027'
			, ISNULL([028],0) '028'
			, ISNULL([029],0) '029'
			, ISNULL([030],0) '030'
			, ISNULL([031],0) '031'
			, ISNULL([032],0) '032'
			, ISNULL([033],0) '033'
			, ISNULL([034],0) '034'
			, ISNULL([035],0) '035'
			, ISNULL([036],0) '036'
			, ISNULL([037],0) '037'
			, ISNULL([038],0) '038'
			, ISNULL([039],0) '039'
			, ISNULL([040],0) '040'
		FROM
			(SELECT
				B.EQUIP_CD
				, B.EQUIP_NM
				, B.ETC1
				, B.USE_YN_CD
				, TEMP.DAY_NIGHT_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD = '028' AND BASE_CD = TEMP.DAY_NIGHT_CD) DAY_NIGHT_NM
				, CALENDAR.DATE
			FROM TB_EQUIP_CODE_ADM B
			LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
			ON B.EQUIP_NM = D.ETC1
		      
			FULL OUTER JOIN
		
			(SELECT DATE FROM CALENDAR
			WHERE 1=1
		<![CDATA[
			AND DATE >= #{faultyDateFrom}
			AND DATE <= #{faultyDateTo}
		]]>
			) CALENDAR
			ON 1=1
		
			FULL OUTER JOIN
			(SELECT 'D' DAY_NIGHT_CD
			UNION
			SELECT 'N' DAY_NIGHT_CD) TEMP
			ON 1=1
		
			WHERE B.ETC1 = ''
			GROUP BY
				B.EQUIP_CD
				, B.EQUIP_NM
				, B.ETC1
				, B.USE_YN_CD
				, CALENDAR.DATE
			   , TEMP.DAY_NIGHT_CD
			) CAL
		
			LEFT OUTER JOIN 
		
			(SELECT
			   ISNULL(EQUIP_CD,'') EQUIP_CD
			   , ISNULL(EQUIP_NM,'') EQUIP_NM
			   , ISNULL(GOODS_CD,'') GOODS_CD
			   , ISNULL(DAY_NIGHT_CD,'') ORD_GUBUN
			   , ISNULL(DAY_NIGHT_NM,'') DAY_NIGHT_NM
			   , ISNULL(ALNICU_MATRL_NM,'') ALNICU_MATRL_NM
			   --, ISNULL(FAULTY_REG_DATE,'') ORD_DATE
			   , ISNULL(DATE,'') ORD_DATE
			   , ISNULL(GRAVITY,'') GRAVITY
			   , ISNULL(GOODS_NM,'') GOODS_NM
			   , ISNULL([001],0) '001'
			   , ISNULL([002],0) '002'
			   , ISNULL([003],0) '003'
			   , ISNULL([004],0) '004'
			   , ISNULL([005],0) '005'
			   , ISNULL([006],0) '006'
			   , ISNULL([007],0) '007'
			   , ISNULL([008],0) '008'
			   , ISNULL([009],0) '009'
			   , ISNULL([010],0) '010'
			   , ISNULL([011],0) '011'
			   , ISNULL([012],0) '012'
			   , ISNULL([013],0) '013'
			   , ISNULL([014],0) '014'
			   , ISNULL([015],0) '015'
			   , ISNULL([016],0) '016'
			   , ISNULL([017],0) '017'
			   , ISNULL([018],0) '018'
			   , ISNULL([019],0) '019'
			   , ISNULL([020],0) '020'
			   , ISNULL([021],0) '021'
			   , ISNULL([022],0) '022'
			   , ISNULL([023],0) '023'
			   , ISNULL([024],0) '024'
			   , ISNULL([025],0) '025'
			   , ISNULL([026],0) '026'
			   , ISNULL([027],0) '027'
			   , ISNULL([028],0) '028'
			   , ISNULL([029],0) '029'
			   , ISNULL([030],0) '030'
			   , ISNULL([031],0) '031'
			   , ISNULL([032],0) '032'
			   , ISNULL([033],0) '033'
			   , ISNULL([034],0) '034'
			   , ISNULL([035],0) '035'
			   , ISNULL([036],0) '036'
			   , ISNULL([037],0) '037'
			   , ISNULL([038],0) '038'
			   , ISNULL([039],0) '039'
			   , ISNULL([040],0) '040'
			FROM (
			   SELECT
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.USE_YN_CD
				  , ISNULL(B.GOODS_CD, '') GOODS_CD
				  , ISNULL(F.GOODS_NM, '') GOODS_NM
				  , ISNULL(B.DAY_NIGHT_CD, 'D') DAY_NIGHT_CD
				  , (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = ISNULL(B.DAY_NIGHT_CD, 'D')) DAY_NIGHT_NM
				  , FAULTY_REG_DATE
				  , ISNULL(G.QUTY_CD, '') QUTY_CD
				  , ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = G.QUTY_CD), '') ALNICU_MATRL_NM
				  , ISNULL(B.SYSTEM_CODE, '') SYSTEM_CODE
				  , ISNULL(B.FAULTY, '0') FAULTY
				  , ISNULL(F.GRAVITY, '1') GRAVITY
				  , DATE
			   FROM TB_EQUIP_CODE_ADM A
				  LEFT OUTER JOIN (   SELECT 
									COALESCE(AA.EQUIP_CD, ( SELECT X.EQUIP_CD FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_CD
									, COALESCE(AA.EQUIP_NM, ( SELECT X.EQUIP_NM FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_NM
									, BB.ETC1
									, ISNULL(AA.DAY_NIGHT_CD, BB.DAY_NIGHT_CD) AS DAY_NIGHT_CD
									, ISNULL(AA.GUBUN, BB.GUBUN) AS GUBUN
									, ISNULL(AA.SYSTEM_CODE, BB.SYSTEM_CODE) AS SYSTEM_CODE
									--, ISNULL(AA.WORK_ORD_NO, BB.WORK_ORD_NO) AS WORK_ORD_NO
									, ISNULL(AA.FAULTY_REG_DATE, BB.FAULTY_REG_DATE) AS FAULTY_REG_DATE
									, ISNULL(AA.GOODS_CD, BB.GOODS_CD) AS GOODS_CD
									, (CONVERT(FLOAT, ISNULL(AA.FAULTY,0)) + CONVERT(FLOAT, ISNULL(BB.FAULTY,0))) FAULTY
									, ISNULL(AA.DATE, BB.DATE) DATE
								 FROM
									(   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'D' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , SUM(FAULTY) AS FAULTY
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 = ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'D'
											 AND C.GUBUN = #{gubun}
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									) AA
		                                 
									FULL OUTER JOIN 
		                                 
									   (   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'D' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , SUM(FAULTY) AS FAULTY
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 != ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'D'
											 AND C.GUBUN = #{gubun}
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									   ) BB
									   ON AA.EQUIP_NM = BB.ETC1
									   AND AA.SYSTEM_CODE = BB.SYSTEM_CODE
									   AND AA.DATE = BB.DATE
									   AND AA.GOODS_CD = BB.GOODS_CD
		      
									WHERE 1=1
									AND (AA.SYSTEM_CODE IS NOT NULL OR  BB.SYSTEM_CODE IS NOT NULL)
							  ) AS B
				  ON A.EQUIP_CD = B.EQUIP_CD
		            
				  LEFT OUTER JOIN TB_GOODS_CODE_ADM F ON B.GOODS_CD = F.GOODS_CD
				  LEFT OUTER JOIN TB_MATRL_CODE_ADM G ON F.ALNICU_MATRL_CD = G.MATRL_CD
			   GROUP BY 
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.ETC1
				  , A.USE_YN_CD
				  , B.GOODS_CD
				  , GOODS_NM
				  , DAY_NIGHT_CD
				  , FAULTY_REG_DATE
				  , QUTY_CD
				  , SYSTEM_CODE
				  , FAULTY
				  , GRAVITY
				  , DATE
			   HAVING A.USE_YN_CD = '001'
			   AND  A.ETC1 = ''
		      
			   UNION ALL
		      
			   SELECT
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.USE_YN_CD
				  , ISNULL(B.GOODS_CD, '') GOODS_CD
				  , ISNULL(F.GOODS_NM, '') GOODS_NM
				  , ISNULL(B.DAY_NIGHT_CD, 'N') DAY_NIGHT_CD
				  , (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = ISNULL(B.DAY_NIGHT_CD, 'N')) DAY_NIGHT_NM
				  , FAULTY_REG_DATE
				  , ISNULL(G.QUTY_CD, '') QUTY_CD
				  , ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = G.QUTY_CD), '') ALNICU_MATRL_NM
				  , ISNULL(B.SYSTEM_CODE, '') SYSTEM_CODE
				  , ISNULL(B.FAULTY, '0') FAULTY
				  , ISNULL(F.GRAVITY, '1') GRAVITY
				  , DATE
			   FROM TB_EQUIP_CODE_ADM A
				  LEFT OUTER JOIN (   SELECT 
									COALESCE(AA.EQUIP_CD, ( SELECT X.EQUIP_CD FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_CD
									, COALESCE(AA.EQUIP_NM, ( SELECT X.EQUIP_NM FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_NM
									, BB.ETC1
									, ISNULL(AA.DAY_NIGHT_CD, BB.DAY_NIGHT_CD) AS DAY_NIGHT_CD
									, ISNULL(AA.GUBUN, BB.GUBUN) AS GUBUN
									, ISNULL(AA.SYSTEM_CODE, BB.SYSTEM_CODE) AS SYSTEM_CODE
									--, ISNULL(AA.WORK_ORD_NO, BB.WORK_ORD_NO) AS WORK_ORD_NO
									, ISNULL(AA.FAULTY_REG_DATE, BB.FAULTY_REG_DATE) AS FAULTY_REG_DATE
									, ISNULL(AA.GOODS_CD, BB.GOODS_CD) AS GOODS_CD
									, (CONVERT(FLOAT, ISNULL(AA.FAULTY,0)) + CONVERT(FLOAT, ISNULL(BB.FAULTY,0))) FAULTY
									, ISNULL(AA.DATE, BB.DATE) DATE
								 FROM
									(   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'N' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , SUM(FAULTY) AS FAULTY
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 = ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'N'
											 AND C.GUBUN = #{gubun}
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									) AA
		                                 
									FULL OUTER JOIN
		                                 
									   (   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'N' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , SUM(FAULTY) AS FAULTY
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 != ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'N'
											 AND C.GUBUN = #{gubun}
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									   ) BB
									   ON AA.EQUIP_NM = BB.ETC1
									   AND AA.SYSTEM_CODE = BB.SYSTEM_CODE
									   AND AA.DATE = BB.DATE
									   AND AA.GOODS_CD = BB.GOODS_CD
		                           
		      
									WHERE 1=1
									AND (AA.SYSTEM_CODE IS NOT NULL OR  BB.SYSTEM_CODE IS NOT NULL)
							  ) AS B
				  ON A.EQUIP_CD = B.EQUIP_CD
		            
				  LEFT OUTER JOIN TB_GOODS_CODE_ADM F ON B.GOODS_CD = F.GOODS_CD
				  LEFT OUTER JOIN TB_MATRL_CODE_ADM G ON F.ALNICU_MATRL_CD = G.MATRL_CD
			   GROUP BY 
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.ETC1
				  , A.USE_YN_CD
				  , B.GOODS_CD
				  , GOODS_NM
				  , DAY_NIGHT_CD
				  , FAULTY_REG_DATE
				  , QUTY_CD
				  , SYSTEM_CODE
				  , FAULTY
				  , GRAVITY
				  , DATE
			   HAVING A.USE_YN_CD = '001'
			   AND  A.ETC1 = ''
			) AS t
			PIVOT (SUM(t.FAULTY) FOR t.SYSTEM_CODE IN (${systemCode}))
		
			AS pivot_result
		
			) AS BIG_AAA
		
			ON CAL.EQUIP_CD = BIG_AAA.EQUIP_CD
			AND CAL.DATE = BIG_AAA.ORD_DATE
			AND CAL.DAY_NIGHT_CD = BIG_AAA.ORD_GUBUN
			
		WHERE CAL.USE_YN_CD = '001'
		ORDER BY CAL.DATE, CAL.DAY_NIGHT_CD, CAL.EQUIP_NM
	</select>
	<!-- 공정불량 통계 리스트 kg -->
	
	
	<!-- 공정불량 통계 리스트  횟수 -->
	<select id="faultyIntegratedListCount" resultType="HashMap">
		SELECT
			CAL.*
			--, ISNULL(EQUIP_CD,'') EQUIP_CD
			--, ISNULL(EQUIP_NM,'') EQUIP_NM
			, ISNULL(GOODS_CD,'') GOODS_CD
			--, ISNULL(DAY_NIGHT_CD,'') ORD_GUBUN
			--, ISNULL(DAY_NIGHT_NM,'') DAY_NIGHT_NM
			, ISNULL(ALNICU_MATRL_NM,'') ALNICU_MATRL_NM
			--, ISNULL(FAULTY_REG_DATE,'') ORD_DATE
			, ISNULL(DATE,'') ORD_DATE
			, ISNULL(GRAVITY,'1') GRAVITY
			, ISNULL(GOODS_NM,'') GOODS_NM
			, ISNULL([001],0) '001'
			, ISNULL([002],0) '002'
			, ISNULL([003],0) '003'
			, ISNULL([004],0) '004'
			, ISNULL([005],0) '005'
			, ISNULL([006],0) '006'
			, ISNULL([007],0) '007'
			, ISNULL([008],0) '008'
			, ISNULL([009],0) '009'
			, ISNULL([010],0) '010'
			, ISNULL([011],0) '011'
			, ISNULL([012],0) '012'
			, ISNULL([013],0) '013'
			, ISNULL([014],0) '014'
			, ISNULL([015],0) '015'
			, ISNULL([016],0) '016'
			, ISNULL([017],0) '017'
			, ISNULL([018],0) '018'
			, ISNULL([019],0) '019'
			, ISNULL([020],0) '020'
			, ISNULL([021],0) '021'
			, ISNULL([022],0) '022'
			, ISNULL([023],0) '023'
			, ISNULL([024],0) '024'
			, ISNULL([025],0) '025'
			, ISNULL([026],0) '026'
			, ISNULL([027],0) '027'
			, ISNULL([028],0) '028'
			, ISNULL([029],0) '029'
			, ISNULL([030],0) '030'
			, ISNULL([031],0) '031'
			, ISNULL([032],0) '032'
			, ISNULL([033],0) '033'
			, ISNULL([034],0) '034'
			, ISNULL([035],0) '035'
			, ISNULL([036],0) '036'
			, ISNULL([037],0) '037'
			, ISNULL([038],0) '038'
			, ISNULL([039],0) '039'
			, ISNULL([040],0) '040'
		FROM
			(SELECT
				B.EQUIP_CD
				, B.EQUIP_NM
				, B.ETC1
				, B.USE_YN_CD
				, TEMP.DAY_NIGHT_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD = '028' AND BASE_CD = TEMP.DAY_NIGHT_CD) DAY_NIGHT_NM
				, CALENDAR.DATE
			FROM TB_EQUIP_CODE_ADM B
			LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
			ON B.EQUIP_NM = D.ETC1
		      
			FULL OUTER JOIN
		
			(SELECT DATE FROM CALENDAR
			WHERE 1=1
		<![CDATA[
			AND DATE >= #{faultyDateFrom}
			AND DATE <= #{faultyDateTo}
		]]>
			) CALENDAR
			ON 1=1
		
			FULL OUTER JOIN
			(SELECT 'D' DAY_NIGHT_CD
			UNION
			SELECT 'N' DAY_NIGHT_CD) TEMP
			ON 1=1
		
			WHERE B.ETC1 = ''
			GROUP BY
				B.EQUIP_CD
				, B.EQUIP_NM
				, B.ETC1
				, B.USE_YN_CD
				, CALENDAR.DATE
			   , TEMP.DAY_NIGHT_CD
			) CAL
		
			LEFT OUTER JOIN 
		
			(SELECT
			   ISNULL(EQUIP_CD,'') EQUIP_CD
			   , ISNULL(EQUIP_NM,'') EQUIP_NM
			   , ISNULL(GOODS_CD,'') GOODS_CD
			   , ISNULL(DAY_NIGHT_CD,'') ORD_GUBUN
			   , ISNULL(DAY_NIGHT_NM,'') DAY_NIGHT_NM
			   , ISNULL(ALNICU_MATRL_NM,'') ALNICU_MATRL_NM
			   --, ISNULL(FAULTY_REG_DATE,'') ORD_DATE
			   , ISNULL(DATE,'') ORD_DATE
			   , ISNULL(GRAVITY,'') GRAVITY
			   , ISNULL(GOODS_NM,'') GOODS_NM
			   , ISNULL([001],0) '001'
			   , ISNULL([002],0) '002'
			   , ISNULL([003],0) '003'
			   , ISNULL([004],0) '004'
			   , ISNULL([005],0) '005'
			   , ISNULL([006],0) '006'
			   , ISNULL([007],0) '007'
			   , ISNULL([008],0) '008'
			   , ISNULL([009],0) '009'
			   , ISNULL([010],0) '010'
			   , ISNULL([011],0) '011'
			   , ISNULL([012],0) '012'
			   , ISNULL([013],0) '013'
			   , ISNULL([014],0) '014'
			   , ISNULL([015],0) '015'
			   , ISNULL([016],0) '016'
			   , ISNULL([017],0) '017'
			   , ISNULL([018],0) '018'
			   , ISNULL([019],0) '019'
			   , ISNULL([020],0) '020'
			   , ISNULL([021],0) '021'
			   , ISNULL([022],0) '022'
			   , ISNULL([023],0) '023'
			   , ISNULL([024],0) '024'
			   , ISNULL([025],0) '025'
			   , ISNULL([026],0) '026'
			   , ISNULL([027],0) '027'
			   , ISNULL([028],0) '028'
			   , ISNULL([029],0) '029'
			   , ISNULL([030],0) '030'
			   , ISNULL([031],0) '031'
			   , ISNULL([032],0) '032'
			   , ISNULL([033],0) '033'
			   , ISNULL([034],0) '034'
			   , ISNULL([035],0) '035'
			   , ISNULL([036],0) '036'
			   , ISNULL([037],0) '037'
			   , ISNULL([038],0) '038'
			   , ISNULL([039],0) '039'
			   , ISNULL([040],0) '040'
			FROM (
			   SELECT
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.USE_YN_CD
				  , ISNULL(B.GOODS_CD, '') GOODS_CD
				  , ISNULL(F.GOODS_NM, '') GOODS_NM
				  , ISNULL(B.DAY_NIGHT_CD, 'D') DAY_NIGHT_CD
				  , (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = ISNULL(B.DAY_NIGHT_CD, 'D')) DAY_NIGHT_NM
				  , FAULTY_REG_DATE
				  , ISNULL(G.QUTY_CD, '') QUTY_CD
				  , ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = G.QUTY_CD), '') ALNICU_MATRL_NM
				  , ISNULL(B.SYSTEM_CODE, '') SYSTEM_CODE
				  , ISNULL(B.FAULTY_COUNT, '0') FAULTY_COUNT
				  , ISNULL(F.GRAVITY, '1') GRAVITY
				  , DATE
			   FROM TB_EQUIP_CODE_ADM A
				  LEFT OUTER JOIN (   SELECT 
									COALESCE(AA.EQUIP_CD, ( SELECT X.EQUIP_CD FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_CD
									, COALESCE(AA.EQUIP_NM, ( SELECT X.EQUIP_NM FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_NM
									, BB.ETC1
									, ISNULL(AA.DAY_NIGHT_CD, BB.DAY_NIGHT_CD) AS DAY_NIGHT_CD
									, ISNULL(AA.GUBUN, BB.GUBUN) AS GUBUN
									, ISNULL(AA.SYSTEM_CODE, BB.SYSTEM_CODE) AS SYSTEM_CODE
									--, ISNULL(AA.WORK_ORD_NO, BB.WORK_ORD_NO) AS WORK_ORD_NO
									, ISNULL(AA.FAULTY_REG_DATE, BB.FAULTY_REG_DATE) AS FAULTY_REG_DATE
									, ISNULL(AA.GOODS_CD, BB.GOODS_CD) AS GOODS_CD
									, (CONVERT(INT, ISNULL(AA.FAULTY_COUNT,0)) + CONVERT(INT, ISNULL(BB.FAULTY_COUNT,0))) FAULTY_COUNT
									, ISNULL(AA.DATE, BB.DATE) DATE
								 FROM
									(   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'D' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , COUNT(FAULTY) AS FAULTY_COUNT
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 = ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'D'
											 AND C.GUBUN = #{gubun}
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									) AA
		                                 
									FULL OUTER JOIN 
		                                 
									   (   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'D' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , COUNT(FAULTY_COUNT) AS FAULTY_COUNT
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 != ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'D'
											 AND C.GUBUN = #{gubun}
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									   ) BB
									   ON AA.EQUIP_NM = BB.ETC1
									   AND AA.SYSTEM_CODE = BB.SYSTEM_CODE
									   AND AA.DATE = BB.DATE
									   AND AA.GOODS_CD = BB.GOODS_CD
		      
									WHERE 1=1
									AND (AA.SYSTEM_CODE IS NOT NULL OR  BB.SYSTEM_CODE IS NOT NULL)
									
		
							  ) AS B
				  ON A.EQUIP_CD = B.EQUIP_CD
		            
				  LEFT OUTER JOIN TB_GOODS_CODE_ADM F ON B.GOODS_CD = F.GOODS_CD
				  LEFT OUTER JOIN TB_MATRL_CODE_ADM G ON F.ALNICU_MATRL_CD = G.MATRL_CD
			   GROUP BY 
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.ETC1
				  , A.USE_YN_CD
				  , B.GOODS_CD
				  , GOODS_NM
				  , DAY_NIGHT_CD
				  , FAULTY_REG_DATE
				  , QUTY_CD
				  , SYSTEM_CODE
				  , FAULTY_COUNT
				  , GRAVITY
				  , DATE
			   HAVING A.USE_YN_CD = '001'
			   AND  A.ETC1 = ''
			  
			   UNION ALL
		      
			   SELECT
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.USE_YN_CD
				  , ISNULL(B.GOODS_CD, '') GOODS_CD
				  , ISNULL(F.GOODS_NM, '') GOODS_NM
				  , ISNULL(B.DAY_NIGHT_CD, 'N') DAY_NIGHT_CD
				  , (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = ISNULL(B.DAY_NIGHT_CD, 'N')) DAY_NIGHT_NM
				  , FAULTY_REG_DATE
				  , ISNULL(G.QUTY_CD, '') QUTY_CD
				  , ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = G.QUTY_CD), '') ALNICU_MATRL_NM
				  , ISNULL(B.SYSTEM_CODE, '') SYSTEM_CODE
				  , ISNULL(B.FAULTY_COUNT, '0') FAULTY_COUNT
				  , ISNULL(F.GRAVITY, '1') GRAVITY
				  , DATE
			   FROM TB_EQUIP_CODE_ADM A
				  LEFT OUTER JOIN (   SELECT 
									COALESCE(AA.EQUIP_CD, ( SELECT X.EQUIP_CD FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_CD
									, COALESCE(AA.EQUIP_NM, ( SELECT X.EQUIP_NM FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_NM
									, BB.ETC1
									, ISNULL(AA.DAY_NIGHT_CD, BB.DAY_NIGHT_CD) AS DAY_NIGHT_CD
									, ISNULL(AA.GUBUN, BB.GUBUN) AS GUBUN
									, ISNULL(AA.SYSTEM_CODE, BB.SYSTEM_CODE) AS SYSTEM_CODE
									--, ISNULL(AA.WORK_ORD_NO, BB.WORK_ORD_NO) AS WORK_ORD_NO
									, ISNULL(AA.FAULTY_REG_DATE, BB.FAULTY_REG_DATE) AS FAULTY_REG_DATE
									, ISNULL(AA.GOODS_CD, BB.GOODS_CD) AS GOODS_CD
									, (CONVERT(INT, ISNULL(AA.FAULTY_COUNT,0)) + CONVERT(INT, ISNULL(BB.FAULTY_COUNT,0))) FAULTY_COUNT
									, ISNULL(AA.DATE, BB.DATE) DATE
								 FROM
									(   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'N' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , COUNT(FAULTY) AS FAULTY_COUNT
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 = ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'N'
											 AND C.GUBUN = #{gubun}
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									) AA
		                                 
									FULL OUTER JOIN 
		                                 
									   (   SELECT A.EQUIP_CD
										  , A.EQUIP_NM
										  , A.ETC1
										  , 'N' DAY_NIGHT_CD
										  , GUBUN
										  , FAULTY_REG_DATE
										  , SYSTEM_CODE
										  , COUNT(FAULTY_COUNT) AS FAULTY_COUNT
										  --, C.WORK_ORD_NO
										  , D.GOODS_CD
										  , A.DATE 
									   FROM (
											 (   SELECT B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
												FROM TB_EQUIP_CODE_ADM B
												LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
												ON B.EQUIP_NM = D.ETC1
		      
												FULL OUTER JOIN
												(SELECT DATE FROM CALENDAR
												WHERE 1=1
											<![CDATA[
												AND DATE >= #{faultyDateFrom}
												AND DATE <= #{faultyDateTo}
											]]>
												) CALENDAR
												ON 1=1
		      
												WHERE B.ETC1 != ''
												GROUP BY
												   B.EQUIP_CD
												   , B.EQUIP_NM
												   , B.ETC1
												   , CALENDAR.DATE
											 ) A
											 LEFT OUTER JOIN
												TB_ALL_FAULTY_ADM C
											 ON  A.EQUIP_CD = C.EQUIP_CD
											 AND C.DAY_NIGHT_CD = 'N'
											 AND C.GUBUN = #{gubun}
										<![CDATA[
											AND FAULTY_REG_DATE >= #{faultyDateFrom}
											AND FAULTY_REG_DATE <= #{faultyDateTo}
										]]>
											 AND FAULTY_REG_DATE = A.DATE
		                              
											 LEFT OUTER JOIN
												TB_WORK_ORDER D
											 ON C.EQUIP_CD = D.EQUIP_CD
											 AND C.WORK_ORD_NO = D.WORK_ORD_NO
		      
										  )
										  GROUP BY
											 A.EQUIP_CD
											 , A.EQUIP_NM
											 , A.ETC1
											 , DAY_NIGHT_CD
											 , GUBUN
											 , FAULTY_REG_DATE
											 , SYSTEM_CODE
											 --, C.WORK_ORD_NO
											 , D.GOODS_CD
											 , A.DATE
									   ) BB
									   ON AA.EQUIP_NM = BB.ETC1
									   AND AA.SYSTEM_CODE = BB.SYSTEM_CODE
									   AND AA.DATE = BB.DATE
									   AND AA.GOODS_CD = BB.GOODS_CD
		      
									WHERE 1=1
									AND (AA.SYSTEM_CODE IS NOT NULL OR  BB.SYSTEM_CODE IS NOT NULL)
									
		
							  ) AS B
				  ON A.EQUIP_CD = B.EQUIP_CD
		            
				  LEFT OUTER JOIN TB_GOODS_CODE_ADM F ON B.GOODS_CD = F.GOODS_CD
				  LEFT OUTER JOIN TB_MATRL_CODE_ADM G ON F.ALNICU_MATRL_CD = G.MATRL_CD
			   GROUP BY 
				  A.EQUIP_CD
				  , A.EQUIP_NM
				  , A.ETC1
				  , A.USE_YN_CD
				  , B.GOODS_CD
				  , GOODS_NM
				  , DAY_NIGHT_CD
				  , FAULTY_REG_DATE
				  , QUTY_CD
				  , SYSTEM_CODE
				  , FAULTY_COUNT
				  , GRAVITY
				  , DATE
			   HAVING A.USE_YN_CD = '001'
			   AND  A.ETC1 = ''
			) AS t
			PIVOT (SUM(t.FAULTY_COUNT) FOR t.SYSTEM_CODE IN (${systemCode}))
		
			AS pivot_result
		
			) AS BIG_AAA
		
			ON CAL.EQUIP_CD = BIG_AAA.EQUIP_CD
			AND CAL.DATE = BIG_AAA.ORD_DATE
			AND CAL.DAY_NIGHT_CD = BIG_AAA.ORD_GUBUN
			
		WHERE CAL.USE_YN_CD = '001'
		ORDER BY CAL.DATE, CAL.DAY_NIGHT_CD, CAL.EQUIP_NM
	</select>
	<!-- 공정불량 통계 리스트  횟수 -->
	
	<!-- 공정불량  통계 리스트 내용 -->
	<select id="faultyIntegratedListContent" resultType="HashMap">
		SELECT
			CAL.*
			--, ISNULL(EQUIP_CD,'') EQUIP_CD
			--, ISNULL(EQUIP_NM,'') EQUIP_NM
			, ISNULL(GOODS_CD,'') GOODS_CD
			--, ISNULL(DAY_NIGHT_CD,'') ORD_GUBUN
			--, ISNULL(DAY_NIGHT_NM,'') DAY_NIGHT_NM
			, ISNULL(ALNICU_MATRL_NM,'') ALNICU_MATRL_NM
			--, ISNULL(FAULTY_REG_DATE,'') ORD_DATE
			, ISNULL(DATE,'') ORD_DATE
			, ISNULL(GRAVITY,'1') GRAVITY
			, ISNULL(GOODS_NM,'') GOODS_NM
			, ISNULL([001],0) '001'
			, ISNULL([002],0) '002'
			, ISNULL([003],0) '003'
			, ISNULL([004],0) '004'
			, ISNULL([005],0) '005'
			, ISNULL([006],0) '006'
			, ISNULL([007],0) '007'
			, ISNULL([008],0) '008'
			, ISNULL([009],0) '009'
			, ISNULL([010],0) '010'
			, ISNULL([011],0) '011'
			, ISNULL([012],0) '012'
			, ISNULL([013],0) '013'
			, ISNULL([014],0) '014'
			, ISNULL([015],0) '015'
			, ISNULL([016],0) '016'
			, ISNULL([017],0) '017'
			, ISNULL([018],0) '018'
			, ISNULL([019],0) '019'
			, ISNULL([020],0) '020'
			, ISNULL([021],0) '021'
			, ISNULL([022],0) '022'
			, ISNULL([023],0) '023'
			, ISNULL([024],0) '024'
			, ISNULL([025],0) '025'
			, ISNULL([026],0) '026'
			, ISNULL([027],0) '027'
			, ISNULL([028],0) '028'
			, ISNULL([029],0) '029'
			, ISNULL([030],0) '030'
			, ISNULL([031],0) '031'
			, ISNULL([032],0) '032'
			, ISNULL([033],0) '033'
			, ISNULL([034],0) '034'
			, ISNULL([035],0) '035'
			, ISNULL([036],0) '036'
			, ISNULL([037],0) '037'
			, ISNULL([038],0) '038'
			, ISNULL([039],0) '039'
			, ISNULL([040],0) '040'
		FROM
			(SELECT
				B.EQUIP_CD
				, B.EQUIP_NM
				, B.ETC1
				, B.USE_YN_CD
				, TEMP.DAY_NIGHT_CD
				, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD = '028' AND BASE_CD = TEMP.DAY_NIGHT_CD) DAY_NIGHT_NM
				, CALENDAR.DATE
			FROM TB_EQUIP_CODE_ADM B
			LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
			ON B.EQUIP_NM = D.ETC1
			
			FULL OUTER JOIN
			
			(SELECT DATE FROM CALENDAR
			WHERE 1=1
		<![CDATA[
			AND DATE >= #{faultyDateFrom}
			AND DATE <= #{faultyDateTo}
		]]>
			) CALENDAR
			ON 1=1
				
			FULL OUTER JOIN
			(SELECT 'D' DAY_NIGHT_CD
			UNION
			SELECT 'N' DAY_NIGHT_CD) TEMP
			ON 1=1
				
			WHERE B.ETC1 = ''
			GROUP BY
				B.EQUIP_CD
				, B.EQUIP_NM
				, B.ETC1
				, B.USE_YN_CD
				, CALENDAR.DATE
				, TEMP.DAY_NIGHT_CD
			) CAL
				
			LEFT OUTER JOIN 
		
			(SELECT
				ISNULL(EQUIP_CD,'') EQUIP_CD
				, ISNULL(EQUIP_NM,'') EQUIP_NM
				, ISNULL(GOODS_CD,'') GOODS_CD
				, ISNULL(DAY_NIGHT_CD,'') ORD_GUBUN
				, ISNULL(DAY_NIGHT_NM,'') DAY_NIGHT_NM
				, ISNULL(ALNICU_MATRL_NM,'') ALNICU_MATRL_NM
				--, ISNULL(FAULTY_REG_DATE,'') ORD_DATE
				, ISNULL(DATE,'') ORD_DATE
				, ISNULL(GRAVITY,'') GRAVITY
				, ISNULL(GOODS_NM,'') GOODS_NM
				, ISNULL([001],0) '001'
				, ISNULL([002],0) '002'
				, ISNULL([003],0) '003'
				, ISNULL([004],0) '004'
				, ISNULL([005],0) '005'
				, ISNULL([006],0) '006'
				, ISNULL([007],0) '007'
				, ISNULL([008],0) '008'
				, ISNULL([009],0) '009'
				, ISNULL([010],0) '010'
				, ISNULL([011],0) '011'
				, ISNULL([012],0) '012'
				, ISNULL([013],0) '013'
				, ISNULL([014],0) '014'
				, ISNULL([015],0) '015'
				, ISNULL([016],0) '016'
				, ISNULL([017],0) '017'
				, ISNULL([018],0) '018'
				, ISNULL([019],0) '019'
				, ISNULL([020],0) '020'
				, ISNULL([021],0) '021'
				, ISNULL([022],0) '022'
				, ISNULL([023],0) '023'
				, ISNULL([024],0) '024'
				, ISNULL([025],0) '025'
				, ISNULL([026],0) '026'
				, ISNULL([027],0) '027'
				, ISNULL([028],0) '028'
				, ISNULL([029],0) '029'
				, ISNULL([030],0) '030'
				, ISNULL([031],0) '031'
				, ISNULL([032],0) '032'
				, ISNULL([033],0) '033'
				, ISNULL([034],0) '034'
				, ISNULL([035],0) '035'
				, ISNULL([036],0) '036'
				, ISNULL([037],0) '037'
				, ISNULL([038],0) '038'
				, ISNULL([039],0) '039'
				, ISNULL([040],0) '040'
			FROM (
				SELECT
					A.EQUIP_CD
					, A.EQUIP_NM
					, A.USE_YN_CD
					, ISNULL(B.GOODS_CD, '') GOODS_CD
					, ISNULL(F.GOODS_NM, '') GOODS_NM
					, ISNULL(B.DAY_NIGHT_CD, 'D') DAY_NIGHT_CD
					, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = ISNULL(B.DAY_NIGHT_CD, 'D')) DAY_NIGHT_NM
					, ISNULL(B.FAULTY_REG_DATE, '') FAULTY_REG_DATE
					, ISNULL(G.QUTY_CD, '') QUTY_CD
					, ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = G.QUTY_CD), '') ALNICU_MATRL_NM
					, ISNULL(B.SYSTEM_CODE, '') SYSTEM_CODE
					, ISNULL(F.GRAVITY, '1') GRAVITY
					, B.FAULTY_DESC
					, DATE
				FROM TB_EQUIP_CODE_ADM A
					LEFT OUTER JOIN(	SELECT 
											COALESCE(AA.EQUIP_CD, ( SELECT X.EQUIP_CD FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_CD
											, COALESCE(AA.EQUIP_NM, ( SELECT X.EQUIP_NM FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_NM
											, ISNULL(AA.DAY_NIGHT_CD, BB.DAY_NIGHT_CD) AS DAY_NIGHT_CD
											, ISNULL(AA.GUBUN, BB.GUBUN) AS GUBUN
											, ISNULL(AA.SYSTEM_CODE, BB.SYSTEM_CODE) AS SYSTEM_CODE
											--, ISNULL(AA.WORK_ORD_NO, BB.WORK_ORD_NO) AS WORK_ORD_NO
											, ISNULL(AA.GOODS_CD, BB.GOODS_CD) AS GOODS_CD
											, (	ISNULL('원호기 ' +AA.EQUIP_NM+ ': ', '') + ISNULL(AA.FAULTY_DESC,'')
												+ CASE WHEN AA.EQUIP_NM IS NULL OR  AA.EQUIP_NM = '' THEN '' ELSE CHAR(13) + CHAR(10) END
												+ ISNULL('가상호기 ' +BB.STRING_ATTACHED,'')
												) AS FAULTY_DESC
											, ISNULL(AA.FAULTY_REG_DATE, BB.FAULTY_REG_DATE) AS FAULTY_REG_DATE
											, ISNULL(AA.DATE, BB.DATE) DATE
										FROM
											(	SELECT A.EQUIP_CD
													, A.EQUIP_NM
													, A.ETC1
													, 'D' DAY_NIGHT_CD
													, GUBUN
													, SYSTEM_CODE
													, FAULTY_DESC
													--, C.WORK_ORD_NO
													, D.GOODS_CD
													, FAULTY_REG_DATE
													, A.DATE
												FROM (
														(	SELECT B.EQUIP_CD
																, B.EQUIP_NM
																, B.ETC1
																, CALENDAR.DATE
															FROM TB_EQUIP_CODE_ADM B									
															LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
															ON B.EQUIP_NM = D.ETC1
		
															FULL OUTER JOIN
															(SELECT DATE FROM CALENDAR
															WHERE 1=1
														<![CDATA[
															AND DATE >= #{faultyDateFrom}
															AND DATE <= #{faultyDateTo}
														]]>
															) CALENDAR
															ON 1=1
		
															WHERE B.ETC1 = ''
															GROUP BY
																B.EQUIP_CD
																, B.EQUIP_NM
																, B.ETC1
																, CALENDAR.DATE
														) A
														LEFT OUTER JOIN
															TB_ALL_FAULTY_ADM C
														ON  A.EQUIP_CD = C.EQUIP_CD
														AND C.DAY_NIGHT_CD = 'D'
														AND C.GUBUN = #{gubun}
													<![CDATA[
														AND FAULTY_REG_DATE >= #{faultyDateFrom}
														AND FAULTY_REG_DATE <= #{faultyDateTo}
													]]>
														AND FAULTY_REG_DATE = A.DATE
		
														LEFT OUTER JOIN
															TB_WORK_ORDER D
														ON C.EQUIP_CD = D.EQUIP_CD
														AND C.WORK_ORD_NO = D.WORK_ORD_NO
		
													)
													GROUP BY
														A.EQUIP_CD
														, A.EQUIP_NM
														, A.ETC1
														, DAY_NIGHT_CD
														, GUBUN
														, SYSTEM_CODE
														, FAULTY_DESC
														--, C.WORK_ORD_NO
														, D.GOODS_CD
														, FAULTY_REG_DATE
														, A.DATE
											) AA
																			
											LEFT OUTER JOIN 
																			
												(	SELECT A.EQUIP_CD
													, A.EQUIP_NM
													, A.ETC1
													, 'D' DAY_NIGHT_CD
													, GUBUN
													, SYSTEM_CODE
													, FAULTY_DESC
													, STRING_AGG(EQUIP_NM +': '+ FAULTY_DESC, ', ') AS STRING_ATTACHED
													--, C.WORK_ORD_NO
													, D.GOODS_CD
													, FAULTY_REG_DATE
													, A.DATE
												FROM (
														(	SELECT B.EQUIP_CD
																, B.EQUIP_NM
																, B.ETC1
																, CALENDAR.DATE
															FROM TB_EQUIP_CODE_ADM B									
															LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
															ON B.EQUIP_NM = D.ETC1
		
															FULL OUTER JOIN
															(SELECT DATE FROM CALENDAR
															WHERE 1=1
														<![CDATA[
															AND DATE >= #{faultyDateFrom}
															AND DATE <= #{faultyDateTo}
														]]>
															) CALENDAR
															ON 1=1
		
															WHERE B.ETC1 != ''
															GROUP BY
																B.EQUIP_CD
																, B.EQUIP_NM
																, B.ETC1
																, CALENDAR.DATE
														) A
														LEFT OUTER JOIN
															TB_ALL_FAULTY_ADM C
														ON  A.EQUIP_CD = C.EQUIP_CD
														AND C.DAY_NIGHT_CD = 'D'
														AND C.GUBUN = #{gubun}
													<![CDATA[
														AND FAULTY_REG_DATE >= #{faultyDateFrom}
														AND FAULTY_REG_DATE <= #{faultyDateTo}
													]]>
														AND FAULTY_REG_DATE = A.DATE
		
														LEFT OUTER JOIN
															TB_WORK_ORDER D
														ON C.EQUIP_CD = D.EQUIP_CD
														AND C.WORK_ORD_NO = D.WORK_ORD_NO
		
													)
													GROUP BY
														A.EQUIP_CD
														, A.EQUIP_NM
														, A.ETC1
														, DAY_NIGHT_CD
														, GUBUN
														, SYSTEM_CODE
														, FAULTY_DESC
														--, C.WORK_ORD_NO
														, D.GOODS_CD
														, FAULTY_REG_DATE
														, A.DATE
												) BB
												ON AA.EQUIP_NM = BB.ETC1
												--AND AA.SYSTEM_CODE = BB.SYSTEM_CODE
												AND AA.DATE = BB.DATE
												--AND AA.GOODS_CD = BB.GOODS_CD
		
											WHERE 1=1 	
											--AND (AA.SYSTEM_CODE IS NOT NULL OR  BB.SYSTEM_CODE IS NOT NULL)
				) B
				ON A.EQUIP_CD = B.EQUIP_CD
		
					LEFT OUTER JOIN TB_GOODS_CODE_ADM F ON B.GOODS_CD = F.GOODS_CD
					LEFT OUTER JOIN TB_MATRL_CODE_ADM G ON F.ALNICU_MATRL_CD = G.MATRL_CD
				GROUP BY
					A.EQUIP_CD
					, A.EQUIP_NM
					, A.ETC1
					, A.USE_YN_CD
					, B.GOODS_CD
					, GOODS_NM
					, DAY_NIGHT_CD
					, FAULTY_REG_DATE
					, QUTY_CD
					,  SYSTEM_CODE
						, GRAVITY
						, FAULTY_DESC
						, DATE
				HAVING A.USE_YN_CD = '001'
				AND A.ETC1 = ''
		
				UNION ALL
		
				SELECT
					A.EQUIP_CD
					, A.EQUIP_NM
					, A.USE_YN_CD
					, ISNULL(B.GOODS_CD, '') GOODS_CD
					, ISNULL(F.GOODS_NM, '') GOODS_NM
					, ISNULL(B.DAY_NIGHT_CD, 'N') DAY_NIGHT_CD
					, (SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='028' AND BASE_CD = ISNULL(B.DAY_NIGHT_CD, 'N')) DAY_NIGHT_NM
					, ISNULL(B.FAULTY_REG_DATE, '') FAULTY_REG_DATE
					, ISNULL(G.QUTY_CD, '') QUTY_CD
					, ISNULL((SELECT BASE_CD_NM FROM TB_SYSTEM_COMMON_CODE WHERE BASE_GROUP_CD='007' AND BASE_CD = G.QUTY_CD), '') ALNICU_MATRL_NM
					, ISNULL(B.SYSTEM_CODE, '') SYSTEM_CODE
					, ISNULL(F.GRAVITY, '1') GRAVITY
					, B.FAULTY_DESC
					, DATE
				FROM TB_EQUIP_CODE_ADM A
					LEFT OUTER JOIN(	SELECT 
											COALESCE(AA.EQUIP_CD, ( SELECT X.EQUIP_CD FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_CD
											, COALESCE(AA.EQUIP_NM, ( SELECT X.EQUIP_NM FROM TB_EQUIP_CODE_ADM X WHERE X.EQUIP_NM = BB.ETC1) ) AS EQUIP_NM
											, ISNULL(AA.DAY_NIGHT_CD, BB.DAY_NIGHT_CD) AS DAY_NIGHT_CD
											, ISNULL(AA.GUBUN, BB.GUBUN) AS GUBUN
											, ISNULL(AA.SYSTEM_CODE, BB.SYSTEM_CODE) AS SYSTEM_CODE
											--, ISNULL(AA.WORK_ORD_NO, BB.WORK_ORD_NO) AS WORK_ORD_NO
											, ISNULL(AA.GOODS_CD, BB.GOODS_CD) AS GOODS_CD
											, (	ISNULL('원호기 ' +AA.EQUIP_NM+ ': ', '') + ISNULL(AA.FAULTY_DESC,'')
												+ CASE WHEN AA.EQUIP_NM IS NULL OR  AA.EQUIP_NM = '' THEN '' ELSE CHAR(13) + CHAR(10) END
												+ ISNULL('가상호기 ' +BB.STRING_ATTACHED,'')
												) AS FAULTY_DESC
											, ISNULL(AA.FAULTY_REG_DATE, BB.FAULTY_REG_DATE) AS FAULTY_REG_DATE
											, ISNULL(AA.DATE, BB.DATE) DATE
										FROM
											(	SELECT A.EQUIP_CD
													, A.EQUIP_NM
													, A.ETC1
													, 'N' DAY_NIGHT_CD
													, GUBUN
													, SYSTEM_CODE
													, FAULTY_DESC
													--, C.WORK_ORD_NO
													, D.GOODS_CD
													, FAULTY_REG_DATE
													, A.DATE
												FROM (
														(	SELECT B.EQUIP_CD
																, B.EQUIP_NM
																, B.ETC1
																, CALENDAR.DATE
															FROM TB_EQUIP_CODE_ADM B									
															LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
															ON B.EQUIP_NM = D.ETC1
		
															FULL OUTER JOIN
															(SELECT DATE FROM CALENDAR
															WHERE 1=1
														<![CDATA[
															AND DATE >= #{faultyDateFrom}
															AND DATE <= #{faultyDateTo}
														]]>
															) CALENDAR
															ON 1=1
		
															WHERE B.ETC1 = ''
															GROUP BY
																B.EQUIP_CD
																, B.EQUIP_NM
																, B.ETC1
																, CALENDAR.DATE
														) A
														LEFT OUTER JOIN
															TB_ALL_FAULTY_ADM C
														ON  A.EQUIP_CD = C.EQUIP_CD
														AND C.DAY_NIGHT_CD = 'N'
														AND C.GUBUN = #{gubun}
													<![CDATA[
														AND FAULTY_REG_DATE >= #{faultyDateFrom}
														AND FAULTY_REG_DATE <= #{faultyDateTo}
													]]>
														AND FAULTY_REG_DATE = A.DATE
		
														LEFT OUTER JOIN
															TB_WORK_ORDER D
														ON C.EQUIP_CD = D.EQUIP_CD
														AND C.WORK_ORD_NO = D.WORK_ORD_NO
		
													)
													GROUP BY
														A.EQUIP_CD
														, A.EQUIP_NM
														, A.ETC1
														, DAY_NIGHT_CD
														, GUBUN
														, SYSTEM_CODE
														, FAULTY_DESC
														--, C.WORK_ORD_NO
														, D.GOODS_CD
														, FAULTY_REG_DATE
														, A.DATE
											) AA
																			
											LEFT OUTER JOIN 
																			
												(SELECT
													A.EQUIP_CD
													, A.EQUIP_NM
													, A.ETC1
													, 'D' DAY_NIGHT_CD
													, GUBUN
													, SYSTEM_CODE
													, FAULTY_DESC
													, STRING_AGG(EQUIP_NM +': '+ FAULTY_DESC, ', ') AS STRING_ATTACHED
													--, C.WORK_ORD_NO
													, D.GOODS_CD
													, FAULTY_REG_DATE
													, A.DATE
												FROM (
														(	SELECT B.EQUIP_CD
																, B.EQUIP_NM
																, B.ETC1
																, CALENDAR.DATE
															FROM TB_EQUIP_CODE_ADM B									
															LEFT OUTER JOIN TB_EQUIP_CODE_ADM D
															ON B.EQUIP_NM = D.ETC1
		
															FULL OUTER JOIN
															(SELECT DATE FROM CALENDAR
															WHERE 1=1
														<![CDATA[
															AND DATE >= #{faultyDateFrom}
															AND DATE <= #{faultyDateTo}
														]]>
															) CALENDAR
															ON 1=1
		
															WHERE B.ETC1 != ''
															GROUP BY
																B.EQUIP_CD
																, B.EQUIP_NM
																, B.ETC1
																, CALENDAR.DATE
														) A
														LEFT OUTER JOIN
															TB_ALL_FAULTY_ADM C
														ON  A.EQUIP_CD = C.EQUIP_CD
														AND C.DAY_NIGHT_CD = 'N'
														AND C.GUBUN = #{gubun}
													<![CDATA[
														AND FAULTY_REG_DATE >= #{faultyDateFrom}
														AND FAULTY_REG_DATE <= #{faultyDateTo}
													]]>
														AND FAULTY_REG_DATE = A.DATE
		
														LEFT OUTER JOIN
															TB_WORK_ORDER D
														ON C.EQUIP_CD = D.EQUIP_CD
														AND C.WORK_ORD_NO = D.WORK_ORD_NO
		
													)
													GROUP BY
														A.EQUIP_CD
														, A.EQUIP_NM
														, A.ETC1
														, DAY_NIGHT_CD
														, GUBUN
														, SYSTEM_CODE
														, FAULTY_DESC
														--, C.WORK_ORD_NO
														, D.GOODS_CD
														, FAULTY_REG_DATE
														, A.DATE
												) BB
												ON AA.EQUIP_NM = BB.ETC1
												--AND AA.SYSTEM_CODE = BB.SYSTEM_CODE
												AND AA.DATE = BB.DATE
												--AND AA.GOODS_CD = BB.GOODS_CD
													
											WHERE 1=1
											--AND (AA.SYSTEM_CODE IS NOT NULL OR  BB.SYSTEM_CODE IS NOT NULL)
				) B
				ON A.EQUIP_CD = B.EQUIP_CD
		
					LEFT OUTER JOIN TB_GOODS_CODE_ADM F ON B.GOODS_CD = F.GOODS_CD
					LEFT OUTER JOIN TB_MATRL_CODE_ADM G ON F.ALNICU_MATRL_CD = G.MATRL_CD
				GROUP BY
					A.EQUIP_CD
					, A.EQUIP_NM
					, A.ETC1
					, A.USE_YN_CD
					, B.GOODS_CD
					, GOODS_NM
					, DAY_NIGHT_CD
					, FAULTY_REG_DATE
					, QUTY_CD
					,  SYSTEM_CODE
						, GRAVITY
						, FAULTY_DESC
						, DATE
				HAVING A.USE_YN_CD = '001'
				AND A.ETC1 = ''
		
				) AS t
					
				PIVOT (MAX(t.FAULTY_DESC)
					FOR t.SYSTEM_CODE IN (${systemCode})
					) AS pivot_result
	
			) AS BIG_AAA
			
			ON CAL.EQUIP_CD = BIG_AAA.EQUIP_CD
			AND CAL.DATE = BIG_AAA.ORD_DATE
			AND CAL.DAY_NIGHT_CD = BIG_AAA.ORD_GUBUN
			
		WHERE CAL.USE_YN_CD = '001'
		ORDER BY CAL.DATE, CAL.DAY_NIGHT_CD, CAL.EQUIP_NM
	</select>
	<!-- 공정불량  통계 리스트 내용 -->
	<!-- __________________________________________wmsc3080__________________________________________ -->
	
</mapper>